import{a as Mw,e as Fr,f as kw,g as Zc,h as zw}from"./chunk-LSEH3ZED.js";import{c as Nw,d as Lw,f as Qc,g as el,h as jw}from"./chunk-XAZLOLJU.js";import{$ as ve,$a as En,Aa as _e,Ab as gv,Bb as Pw,Ca as mw,Cb as Ew,D as dw,E as fw,Ea as yw,F as Sn,Fa as Ts,G as xi,H as lv,Ha as _w,Hb as Xc,I as Es,Ja as F,Ka as V,Kb as Ms,L as Rs,N as vw,Na as Sw,Nb as ks,O as uv,Ob as Rw,P as Uc,Pa as As,Pb as Iw,Qb as Tw,Rb as ca,Sa as Qt,Sb as Aw,Ta as bn,Ua as oa,V as gw,Va as wn,W as hv,Wb as Pe,X as Ji,Xb as Ow,Y as Te,Ya as jr,Z as Xi,Za as Cw,Zb as qr,_a as Pn,_b as Dw,a as se,ab as ge,ac as xw,b as ra,ba as pt,bb as zr,cb as bw,d as p,da as A,db as hi,e as WM,ea as re,eb as ww,f as je,fb as fv,g as v,ga as Lt,gb as vv,ha as Xt,hb as L,i as Di,ib as H,jb as me,k as na,ka as Vc,kb as Zi,lb as Ze,ma as sa,mb as jt,n as q,na as Je,nb as $c,o as Wc,oa as Xe,ob as Gc,p as av,pa as Cn,pb as Yc,q as cv,qa as Is,qb as Rn,ra as Kc,rb as Os,s as Hc,sa as Zt,sb as Ds,t as Ps,tb as we,ub as zt,va as Tt,vb as In,wa as xe,wb as xs,x as Yi,xb as qt,ya as pv,yb as Jc,za as dv,zb as aa}from"./chunk-OCYVAU27.js";var zv=p(jv=>{"use strict";Object.defineProperty(jv,"__esModule",{value:!0});jv.default=Gk;var Rl,$k=new Uint8Array(16);function Gk(){if(!Rl&&(Rl=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Rl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rl($k)}});var NP=p(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});Il.default=void 0;var Yk=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;Il.default=Yk});var ya=p(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});Tl.default=void 0;var Jk=Xk(NP());function Xk(i){return i&&i.__esModule?i:{default:i}}function Zk(i){return typeof i=="string"&&Jk.default.test(i)}var Qk=Zk;Tl.default=Qk});var Sa=p(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.default=void 0;_a.unsafeStringify=LP;var eN=tN(ya());function tN(i){return i&&i.__esModule?i:{default:i}}var tt=[];for(let i=0;i<256;++i)tt.push((i+256).toString(16).slice(1));function LP(i,e=0){return tt[i[e+0]]+tt[i[e+1]]+tt[i[e+2]]+tt[i[e+3]]+"-"+tt[i[e+4]]+tt[i[e+5]]+"-"+tt[i[e+6]]+tt[i[e+7]]+"-"+tt[i[e+8]]+tt[i[e+9]]+"-"+tt[i[e+10]]+tt[i[e+11]]+tt[i[e+12]]+tt[i[e+13]]+tt[i[e+14]]+tt[i[e+15]]}function iN(i,e=0){let t=LP(i,e);if(!(0,eN.default)(t))throw TypeError("Stringified UUID is invalid");return t}var rN=iN;_a.default=rN});var zP=p(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});Al.default=void 0;var nN=oN(zv()),sN=Sa();function oN(i){return i&&i.__esModule?i:{default:i}}var jP,qv,Fv=0,Bv=0;function aN(i,e,t){let r=e&&t||0,n=e||new Array(16);i=i||{};let s=i.node||jP,o=i.clockseq!==void 0?i.clockseq:qv;if(s==null||o==null){let d=i.random||(i.rng||nN.default)();s==null&&(s=jP=[d[0]|1,d[1],d[2],d[3],d[4],d[5]]),o==null&&(o=qv=(d[6]<<8|d[7])&16383)}let a=i.msecs!==void 0?i.msecs:Date.now(),c=i.nsecs!==void 0?i.nsecs:Bv+1,l=a-Fv+(c-Bv)/1e4;if(l<0&&i.clockseq===void 0&&(o=o+1&16383),(l<0||a>Fv)&&i.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Fv=a,Bv=c,qv=o,a+=122192928e5;let u=((a&268435455)*1e4+c)%4294967296;n[r++]=u>>>24&255,n[r++]=u>>>16&255,n[r++]=u>>>8&255,n[r++]=u&255;let h=a/4294967296*1e4&268435455;n[r++]=h>>>8&255,n[r++]=h&255,n[r++]=h>>>24&15|16,n[r++]=h>>>16&255,n[r++]=o>>>8|128,n[r++]=o&255;for(let d=0;d<6;++d)n[r+d]=s[d];return e||(0,sN.unsafeStringify)(n)}var cN=aN;Al.default=cN});var Wv=p(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});Ol.default=void 0;var lN=uN(ya());function uN(i){return i&&i.__esModule?i:{default:i}}function hN(i){if(!(0,lN.default)(i))throw TypeError("Invalid UUID");let e,t=new Uint8Array(16);return t[0]=(e=parseInt(i.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(i.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(i.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(i.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(i.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}var pN=hN;Ol.default=pN});var Hv=p(Mn=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:!0});Mn.URL=Mn.DNS=void 0;Mn.default=mN;var dN=Sa(),fN=vN(Wv());function vN(i){return i&&i.__esModule?i:{default:i}}function gN(i){i=unescape(encodeURIComponent(i));let e=[];for(let t=0;t<i.length;++t)e.push(i.charCodeAt(t));return e}var qP="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Mn.DNS=qP;var FP="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Mn.URL=FP;function mN(i,e,t){function r(n,s,o,a){var c;if(typeof n=="string"&&(n=gN(n)),typeof s=="string"&&(s=(0,fN.default)(s)),((c=s)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+n.length);if(l.set(s),l.set(n,s.length),l=t(l),l[6]=l[6]&15|e,l[8]=l[8]&63|128,o){a=a||0;for(let u=0;u<16;++u)o[a+u]=l[u];return o}return(0,dN.unsafeStringify)(l)}try{r.name=i}catch{}return r.DNS=qP,r.URL=FP,r}});var WP=p(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});xl.default=void 0;function yN(i){if(typeof i=="string"){let e=unescape(encodeURIComponent(i));i=new Uint8Array(e.length);for(let t=0;t<e.length;++t)i[t]=e.charCodeAt(t)}return _N(SN(CN(i),i.length*8))}function _N(i){let e=[],t=i.length*32,r="0123456789abcdef";for(let n=0;n<t;n+=8){let s=i[n>>5]>>>n%32&255,o=parseInt(r.charAt(s>>>4&15)+r.charAt(s&15),16);e.push(o)}return e}function BP(i){return(i+64>>>9<<4)+14+1}function SN(i,e){i[e>>5]|=128<<e%32,i[BP(e)-1]=e;let t=1732584193,r=-271733879,n=-1732584194,s=271733878;for(let o=0;o<i.length;o+=16){let a=t,c=r,l=n,u=s;t=vt(t,r,n,s,i[o],7,-680876936),s=vt(s,t,r,n,i[o+1],12,-389564586),n=vt(n,s,t,r,i[o+2],17,606105819),r=vt(r,n,s,t,i[o+3],22,-1044525330),t=vt(t,r,n,s,i[o+4],7,-176418897),s=vt(s,t,r,n,i[o+5],12,1200080426),n=vt(n,s,t,r,i[o+6],17,-1473231341),r=vt(r,n,s,t,i[o+7],22,-45705983),t=vt(t,r,n,s,i[o+8],7,1770035416),s=vt(s,t,r,n,i[o+9],12,-1958414417),n=vt(n,s,t,r,i[o+10],17,-42063),r=vt(r,n,s,t,i[o+11],22,-1990404162),t=vt(t,r,n,s,i[o+12],7,1804603682),s=vt(s,t,r,n,i[o+13],12,-40341101),n=vt(n,s,t,r,i[o+14],17,-1502002290),r=vt(r,n,s,t,i[o+15],22,1236535329),t=gt(t,r,n,s,i[o+1],5,-165796510),s=gt(s,t,r,n,i[o+6],9,-1069501632),n=gt(n,s,t,r,i[o+11],14,643717713),r=gt(r,n,s,t,i[o],20,-373897302),t=gt(t,r,n,s,i[o+5],5,-701558691),s=gt(s,t,r,n,i[o+10],9,38016083),n=gt(n,s,t,r,i[o+15],14,-660478335),r=gt(r,n,s,t,i[o+4],20,-405537848),t=gt(t,r,n,s,i[o+9],5,568446438),s=gt(s,t,r,n,i[o+14],9,-1019803690),n=gt(n,s,t,r,i[o+3],14,-187363961),r=gt(r,n,s,t,i[o+8],20,1163531501),t=gt(t,r,n,s,i[o+13],5,-1444681467),s=gt(s,t,r,n,i[o+2],9,-51403784),n=gt(n,s,t,r,i[o+7],14,1735328473),r=gt(r,n,s,t,i[o+12],20,-1926607734),t=mt(t,r,n,s,i[o+5],4,-378558),s=mt(s,t,r,n,i[o+8],11,-2022574463),n=mt(n,s,t,r,i[o+11],16,1839030562),r=mt(r,n,s,t,i[o+14],23,-35309556),t=mt(t,r,n,s,i[o+1],4,-1530992060),s=mt(s,t,r,n,i[o+4],11,1272893353),n=mt(n,s,t,r,i[o+7],16,-155497632),r=mt(r,n,s,t,i[o+10],23,-1094730640),t=mt(t,r,n,s,i[o+13],4,681279174),s=mt(s,t,r,n,i[o],11,-358537222),n=mt(n,s,t,r,i[o+3],16,-722521979),r=mt(r,n,s,t,i[o+6],23,76029189),t=mt(t,r,n,s,i[o+9],4,-640364487),s=mt(s,t,r,n,i[o+12],11,-421815835),n=mt(n,s,t,r,i[o+15],16,530742520),r=mt(r,n,s,t,i[o+2],23,-995338651),t=yt(t,r,n,s,i[o],6,-198630844),s=yt(s,t,r,n,i[o+7],10,1126891415),n=yt(n,s,t,r,i[o+14],15,-1416354905),r=yt(r,n,s,t,i[o+5],21,-57434055),t=yt(t,r,n,s,i[o+12],6,1700485571),s=yt(s,t,r,n,i[o+3],10,-1894986606),n=yt(n,s,t,r,i[o+10],15,-1051523),r=yt(r,n,s,t,i[o+1],21,-2054922799),t=yt(t,r,n,s,i[o+8],6,1873313359),s=yt(s,t,r,n,i[o+15],10,-30611744),n=yt(n,s,t,r,i[o+6],15,-1560198380),r=yt(r,n,s,t,i[o+13],21,1309151649),t=yt(t,r,n,s,i[o+4],6,-145523070),s=yt(s,t,r,n,i[o+11],10,-1120210379),n=yt(n,s,t,r,i[o+2],15,718787259),r=yt(r,n,s,t,i[o+9],21,-343485551),t=Wr(t,a),r=Wr(r,c),n=Wr(n,l),s=Wr(s,u)}return[t,r,n,s]}function CN(i){if(i.length===0)return[];let e=i.length*8,t=new Uint32Array(BP(e));for(let r=0;r<e;r+=8)t[r>>5]|=(i[r/8]&255)<<r%32;return t}function Wr(i,e){let t=(i&65535)+(e&65535);return(i>>16)+(e>>16)+(t>>16)<<16|t&65535}function bN(i,e){return i<<e|i>>>32-e}function Dl(i,e,t,r,n,s){return Wr(bN(Wr(Wr(e,i),Wr(r,s)),n),t)}function vt(i,e,t,r,n,s,o){return Dl(e&t|~e&r,i,e,n,s,o)}function gt(i,e,t,r,n,s,o){return Dl(e&r|t&~r,i,e,n,s,o)}function mt(i,e,t,r,n,s,o){return Dl(e^t^r,i,e,n,s,o)}function yt(i,e,t,r,n,s,o){return Dl(t^(e|~r),i,e,n,s,o)}var wN=yN;xl.default=wN});var UP=p(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});Ml.default=void 0;var PN=HP(Hv()),EN=HP(WP());function HP(i){return i&&i.__esModule?i:{default:i}}var RN=(0,PN.default)("v3",48,EN.default),IN=RN;Ml.default=IN});var VP=p(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});kl.default=void 0;var TN=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),AN={randomUUID:TN};kl.default=AN});var GP=p(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});Nl.default=void 0;var KP=$P(VP()),ON=$P(zv()),DN=Sa();function $P(i){return i&&i.__esModule?i:{default:i}}function xN(i,e,t){if(KP.default.randomUUID&&!e&&!i)return KP.default.randomUUID();i=i||{};let r=i.random||(i.rng||ON.default)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let n=0;n<16;++n)e[t+n]=r[n];return e}return(0,DN.unsafeStringify)(r)}var MN=xN;Nl.default=MN});var YP=p(Ll=>{"use strict";Object.defineProperty(Ll,"__esModule",{value:!0});Ll.default=void 0;function kN(i,e,t,r){switch(i){case 0:return e&t^~e&r;case 1:return e^t^r;case 2:return e&t^e&r^t&r;case 3:return e^t^r}}function Uv(i,e){return i<<e|i>>>32-e}function NN(i){let e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof i=="string"){let o=unescape(encodeURIComponent(i));i=[];for(let a=0;a<o.length;++a)i.push(o.charCodeAt(a))}else Array.isArray(i)||(i=Array.prototype.slice.call(i));i.push(128);let r=i.length/4+2,n=Math.ceil(r/16),s=new Array(n);for(let o=0;o<n;++o){let a=new Uint32Array(16);for(let c=0;c<16;++c)a[c]=i[o*64+c*4]<<24|i[o*64+c*4+1]<<16|i[o*64+c*4+2]<<8|i[o*64+c*4+3];s[o]=a}s[n-1][14]=(i.length-1)*8/Math.pow(2,32),s[n-1][14]=Math.floor(s[n-1][14]),s[n-1][15]=(i.length-1)*8&4294967295;for(let o=0;o<n;++o){let a=new Uint32Array(80);for(let f=0;f<16;++f)a[f]=s[o][f];for(let f=16;f<80;++f)a[f]=Uv(a[f-3]^a[f-8]^a[f-14]^a[f-16],1);let c=t[0],l=t[1],u=t[2],h=t[3],d=t[4];for(let f=0;f<80;++f){let g=Math.floor(f/20),m=Uv(c,5)+kN(g,l,u,h)+d+e[g]+a[f]>>>0;d=h,h=u,u=Uv(l,30)>>>0,l=c,c=m}t[0]=t[0]+c>>>0,t[1]=t[1]+l>>>0,t[2]=t[2]+u>>>0,t[3]=t[3]+h>>>0,t[4]=t[4]+d>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var LN=NN;Ll.default=LN});var XP=p(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});jl.default=void 0;var jN=JP(Hv()),zN=JP(YP());function JP(i){return i&&i.__esModule?i:{default:i}}var qN=(0,jN.default)("v5",80,zN.default),FN=qN;jl.default=FN});var ZP=p(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});zl.default=void 0;var BN="00000000-0000-0000-0000-000000000000";zl.default=BN});var QP=p(ql=>{"use strict";Object.defineProperty(ql,"__esModule",{value:!0});ql.default=void 0;var WN=HN(ya());function HN(i){return i&&i.__esModule?i:{default:i}}function UN(i){if(!(0,WN.default)(i))throw TypeError("Invalid UUID");return parseInt(i.slice(14,15),16)}var VN=UN;ql.default=VN});var e0=p(Mi=>{"use strict";Object.defineProperty(Mi,"__esModule",{value:!0});Object.defineProperty(Mi,"NIL",{enumerable:!0,get:function(){return JN.default}});Object.defineProperty(Mi,"parse",{enumerable:!0,get:function(){return eL.default}});Object.defineProperty(Mi,"stringify",{enumerable:!0,get:function(){return QN.default}});Object.defineProperty(Mi,"v1",{enumerable:!0,get:function(){return KN.default}});Object.defineProperty(Mi,"v3",{enumerable:!0,get:function(){return $N.default}});Object.defineProperty(Mi,"v4",{enumerable:!0,get:function(){return GN.default}});Object.defineProperty(Mi,"v5",{enumerable:!0,get:function(){return YN.default}});Object.defineProperty(Mi,"validate",{enumerable:!0,get:function(){return ZN.default}});Object.defineProperty(Mi,"version",{enumerable:!0,get:function(){return XN.default}});var KN=Sr(zP()),$N=Sr(UP()),GN=Sr(GP()),YN=Sr(XP()),JN=Sr(ZP()),XN=Sr(QP()),ZN=Sr(ya()),QN=Sr(Sa()),eL=Sr(Wv());function Sr(i){return i&&i.__esModule?i:{default:i}}});var Hr=p($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});$s.createNoDashGuid=$s.createGuid=void 0;var tL=e0(),t0=()=>tL.v4();$s.createGuid=t0;var iL=()=>t0().replace(new RegExp("-","g"),"").toUpperCase();$s.createNoDashGuid=iL});var Gs=p(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});kn.PlatformEvent=kn.EventType=void 0;var rL=Hr(),nL;(function(i){i[i.Debug=0]="Debug",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i[i.None=4]="None"})(nL=kn.EventType||(kn.EventType={}));var Vv=class{constructor(e,t){this.privName=e,this.privEventId=rL.createNoDashGuid(),this.privEventTime=new Date().toISOString(),this.privEventType=t,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}};kn.PlatformEvent=Vv});var i0=p(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.AudioStreamNodeErrorEvent=Ae.AudioStreamNodeDetachedEvent=Ae.AudioStreamNodeAttachedEvent=Ae.AudioStreamNodeAttachingEvent=Ae.AudioStreamNodeEvent=Ae.AudioSourceErrorEvent=Ae.AudioSourceOffEvent=Ae.AudioSourceReadyEvent=Ae.AudioSourceInitializingEvent=Ae.AudioSourceEvent=void 0;var Kv=Gs(),Ur=class extends Kv.PlatformEvent{constructor(e,t,r=Kv.EventType.Info){super(e,r),this.privAudioSourceId=t}get audioSourceId(){return this.privAudioSourceId}};Ae.AudioSourceEvent=Ur;var $v=class extends Ur{constructor(e){super("AudioSourceInitializingEvent",e)}};Ae.AudioSourceInitializingEvent=$v;var Gv=class extends Ur{constructor(e){super("AudioSourceReadyEvent",e)}};Ae.AudioSourceReadyEvent=Gv;var Yv=class extends Ur{constructor(e){super("AudioSourceOffEvent",e)}};Ae.AudioSourceOffEvent=Yv;var Jv=class extends Ur{constructor(e,t){super("AudioSourceErrorEvent",e,Kv.EventType.Error),this.privError=t}get error(){return this.privError}};Ae.AudioSourceErrorEvent=Jv;var Nn=class extends Ur{constructor(e,t,r){super(e,t),this.privAudioNodeId=r}get audioNodeId(){return this.privAudioNodeId}};Ae.AudioStreamNodeEvent=Nn;var Xv=class extends Nn{constructor(e,t){super("AudioStreamNodeAttachingEvent",e,t)}};Ae.AudioStreamNodeAttachingEvent=Xv;var Zv=class extends Nn{constructor(e,t){super("AudioStreamNodeAttachedEvent",e,t)}};Ae.AudioStreamNodeAttachedEvent=Zv;var Qv=class extends Nn{constructor(e,t){super("AudioStreamNodeDetachedEvent",e,t)}};Ae.AudioStreamNodeDetachedEvent=Qv;var eg=class extends Nn{constructor(e,t,r){super("AudioStreamNodeErrorEvent",e,t),this.privError=r}get error(){return this.privError}};Ae.AudioStreamNodeErrorEvent=eg});var r0=p(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.ConnectionMessageSentEvent=qe.ConnectionMessageReceivedEvent=qe.ConnectionEstablishErrorEvent=qe.ConnectionErrorEvent=qe.ConnectionClosedEvent=qe.ConnectionEstablishedEvent=qe.ConnectionStartEvent=qe.ConnectionEvent=qe.ServiceEvent=void 0;var Ln=Gs(),tg=class extends Ln.PlatformEvent{constructor(e,t,r=Ln.EventType.Info){super(e,r),this.privJsonResult=t}get jsonString(){return this.privJsonResult}};qe.ServiceEvent=tg;var er=class extends Ln.PlatformEvent{constructor(e,t,r=Ln.EventType.Info){super(e,r),this.privConnectionId=t}get connectionId(){return this.privConnectionId}};qe.ConnectionEvent=er;var ig=class extends er{constructor(e,t,r){super("ConnectionStartEvent",e),this.privUri=t,this.privHeaders=r}get uri(){return this.privUri}get headers(){return this.privHeaders}};qe.ConnectionStartEvent=ig;var rg=class extends er{constructor(e){super("ConnectionEstablishedEvent",e)}};qe.ConnectionEstablishedEvent=rg;var ng=class extends er{constructor(e,t,r){super("ConnectionClosedEvent",e,Ln.EventType.Debug),this.privReason=r,this.privStatusCode=t}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}};qe.ConnectionClosedEvent=ng;var sg=class extends er{constructor(e,t,r){super("ConnectionErrorEvent",e,Ln.EventType.Debug),this.privMessage=t,this.privType=r}get message(){return this.privMessage}get type(){return this.privType}};qe.ConnectionErrorEvent=sg;var og=class extends er{constructor(e,t,r){super("ConnectionEstablishErrorEvent",e,Ln.EventType.Error),this.privStatusCode=t,this.privReason=r}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}};qe.ConnectionEstablishErrorEvent=og;var ag=class extends er{constructor(e,t,r){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=t,this.privMessage=r}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}};qe.ConnectionMessageReceivedEvent=ag;var cg=class extends er{constructor(e,t,r){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=t,this.privMessage=r}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}};qe.ConnectionMessageSentEvent=cg});var ki=p(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});Vr.ObjectDisposedError=Vr.InvalidOperationError=Vr.ArgumentNullError=void 0;var lg=class extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}};Vr.ArgumentNullError=lg;var ug=class extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}};Vr.InvalidOperationError=ug;var hg=class extends Error{constructor(e,t){super(t),this.name=e+"ObjectDisposed",this.message=t}};Vr.ObjectDisposedError=hg});var dg=p(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});zn.ConnectionMessage=zn.MessageType=void 0;var Fl=ki(),sL=Hr(),jn;(function(i){i[i.Text=0]="Text",i[i.Binary=1]="Binary"})(jn=zn.MessageType||(zn.MessageType={}));var pg=class{constructor(e,t,r,n){if(this.privBody=null,e===jn.Text&&t&&typeof t!="string")throw new Fl.InvalidOperationError("Payload must be a string");if(e===jn.Binary&&t&&!(t instanceof ArrayBuffer))throw new Fl.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=t,this.privHeaders=r||{},this.privId=n||sL.createNoDashGuid(),this.messageType){case jn.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case jn.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===jn.Binary)throw new Fl.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===jn.Text)throw new Fl.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}};zn.ConnectionMessage=pg});var n0=p(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});Bl.ConnectionOpenResponse=void 0;var fg=class{constructor(e,t){this.privStatusCode=e,this.privReason=t}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};Bl.ConnectionOpenResponse=fg});var s0=p(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});Wl.DeferralMap=void 0;var vg=class{constructor(){this.privMap={}}add(e,t){this.privMap[e]=t}getId(e){return this.privMap[e]}complete(e,t){try{this.privMap[e].resolve(t)}catch(r){this.privMap[e].reject(r)}finally{this.privMap[e]=void 0}}};Wl.DeferralMap=vg});var mg=p(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.SendingAgentContextMessageEvent=Ys.DialogEvent=void 0;var o0=Gs(),Hl=class extends o0.PlatformEvent{constructor(e,t=o0.EventType.Info){super(e,t)}};Ys.DialogEvent=Hl;var gg=class extends Hl{constructor(e){super("SendingAgentContextMessageEvent"),this.privAgentConfig=e}get agentConfig(){return this.privAgentConfig}};Ys.SendingAgentContextMessageEvent=gg});var _g=p(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});Ul.EventSource=void 0;var oL=ki(),aL=Hr(),yg=class{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=e}onEvent(e){if(this.isDisposed())throw new oL.ObjectDisposedError("EventSource");if(this.metadata)for(let t in this.metadata)t&&e.metadata&&(e.metadata[t]||(e.metadata[t]=this.metadata[t]));for(let t in this.privEventListeners)t&&this.privEventListeners[t]&&this.privEventListeners[t](e)}attach(e){let t=aL.createNoDashGuid();return this.privEventListeners[t]=e,{detach:()=>(delete this.privEventListeners[t],Promise.resolve())}}attachListener(e){return this.attach(t=>e.onEvent(t))}attachConsoleListener(e){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(t=>e.onEvent(t)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};Ul.EventSource=yg});var a0=p(Kl=>{"use strict";Object.defineProperty(Kl,"__esModule",{value:!0});Kl.Events=void 0;var cL=ki(),lL=_g(),Vl=class i{static setEventSource(e){if(!e)throw new cL.ArgumentNullError("eventSource");i.privInstance=e}static get instance(){return i.privInstance}};Kl.Events=Vl;Vl.privInstance=new lL.EventSource});var l0=p(c0=>{"use strict";Object.defineProperty(c0,"__esModule",{value:!0})});var u0=p(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.ConnectionState=void 0;var uL;(function(i){i[i.None=0]="None",i[i.Connected=1]="Connected",i[i.Connecting=2]="Connecting",i[i.Disconnected=3]="Disconnected"})(uL=Ca.ConnectionState||(Ca.ConnectionState={}))});var p0=p(h0=>{"use strict";Object.defineProperty(h0,"__esModule",{value:!0})});var f0=p(d0=>{"use strict";Object.defineProperty(d0,"__esModule",{value:!0})});var g0=p(v0=>{"use strict";Object.defineProperty(v0,"__esModule",{value:!0})});var y0=p(m0=>{"use strict";Object.defineProperty(m0,"__esModule",{value:!0})});var S0=p(_0=>{"use strict";Object.defineProperty(_0,"__esModule",{value:!0})});var b0=p(C0=>{"use strict";Object.defineProperty(C0,"__esModule",{value:!0})});var P0=p(w0=>{"use strict";Object.defineProperty(w0,"__esModule",{value:!0})});var R0=p(E0=>{"use strict";Object.defineProperty(E0,"__esModule",{value:!0})});var Cg=p($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});$l.List=void 0;var hL=ki(),Sg=class i{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],e)for(let t of e)this.privList.push(t)}get(e){return this.throwIfDisposed(),this.privList[e]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(e){this.throwIfDisposed(),this.insertAt(this.privList.length,e)}insertAt(e,t){this.throwIfDisposed(),e===0?this.privList.unshift(t):e===this.privList.length?this.privList.push(t):this.privList.splice(e,0,t),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(e){return this.throwIfDisposed(),this.remove(e,1)[0]}remove(e,t){this.throwIfDisposed();let r=this.privList.splice(e,t);return this.triggerSubscriptions(this.privRemoveSubscriptions),r}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(e){this.throwIfDisposed();let t=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[t]=e,{detach:()=>(delete this.privAddSubscriptions[t],Promise.resolve())}}onRemoved(e){this.throwIfDisposed();let t=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[t]=e,{detach:()=>(delete this.privRemoveSubscriptions[t],Promise.resolve())}}onDisposed(e){this.throwIfDisposed();let t=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[t]=e,{detach:()=>(delete this.privDisposedSubscriptions[t],Promise.resolve())}}join(e){return this.throwIfDisposed(),this.privList.join(e)}toArray(){let e=Array();return this.privList.forEach(t=>{e.push(t)}),e}any(e){return this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0}all(e){return this.throwIfDisposed(),this.where(e).length()===this.length()}forEach(e){this.throwIfDisposed();for(let t=0;t<this.length();t++)e(this.privList[t],t)}select(e){this.throwIfDisposed();let t=[];for(let r=0;r<this.privList.length;r++)t.push(e(this.privList[r],r));return new i(t)}where(e){this.throwIfDisposed();let t=new i;for(let r=0;r<this.privList.length;r++)e(this.privList[r],r)&&t.add(this.privList[r]);return t}orderBy(e){this.throwIfDisposed();let r=this.toArray().sort(e);return new i(r)}orderByDesc(e){return this.throwIfDisposed(),this.orderBy((t,r)=>e(r,t))}clone(){return this.throwIfDisposed(),new i(this.toArray())}concat(e){return this.throwIfDisposed(),new i(this.privList.concat(e.toArray()))}concatArray(e){return this.throwIfDisposed(),new i(this.privList.concat(e))}isDisposed(){return this.privList==null}dispose(e){this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new hL.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(e){if(e)for(let t in e)t&&e[t]()}};$l.List=Sg});var Pg=p(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.marshalPromiseToCallbacks=Ot.Sink=Ot.Deferred=Ot.PromiseResultEventSource=Ot.PromiseResult=Ot.PromiseState=void 0;var Cr;(function(i){i[i.None=0]="None",i[i.Resolved=1]="Resolved",i[i.Rejected=2]="Rejected"})(Cr=Ot.PromiseState||(Ot.PromiseState={}));var Gl=class{constructor(e){this.throwIfError=()=>{if(this.isError)throw this.error},e.on(t=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=t)},t=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=t)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}};Ot.PromiseResult=Gl;var Yl=class{constructor(){this.setResult=e=>{this.privOnSetResult(e)},this.setError=e=>{this.privOnSetError(e)},this.on=(e,t)=>{this.privOnSetResult=e,this.privOnSetError=t}}};Ot.PromiseResultEventSource=Yl;var bg=class{constructor(){this.resolve=e=>(this.privResolve(e),this),this.reject=e=>(this.privReject(e),this),this.privPromise=new Promise((e,t)=>{this.privResolve=e,this.privReject=t})}get promise(){return this.privPromise}};Ot.Deferred=bg;var wg=class{constructor(){this.privState=Cr.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new Yl,this.privPromiseResult=new Gl(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(e){if(this.privState!==Cr.None)throw new Error("'Cannot resolve a completed promise'");this.privState=Cr.Resolved,this.privPromiseResultEvents.setResult(e);for(let t=0;t<this.privSuccessHandlers.length;t++)this.executeSuccessCallback(e,this.privSuccessHandlers[t],this.privErrorHandlers[t]);this.detachHandlers()}reject(e){if(this.privState!==Cr.None)throw new Error("'Cannot reject a completed promise'");this.privState=Cr.Rejected,this.privPromiseResultEvents.setError(e);for(let t of this.privErrorHandlers)this.executeErrorCallback(e,t);this.detachHandlers()}on(e,t){e==null&&(e=()=>{}),this.privState===Cr.None?(this.privSuccessHandlers.push(e),this.privErrorHandlers.push(t)):(this.privState===Cr.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,e,t):this.privState===Cr.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,t),this.detachHandlers())}executeSuccessCallback(e,t,r){try{t(e)}catch(n){this.executeErrorCallback(`'Unhandled callback error: ${n}'`,r)}}executeErrorCallback(e,t){if(t)try{t(e)}catch(r){throw new Error(`'Unhandled callback error: ${r}. InnerError: ${e}'`)}else throw new Error(`'Unhandled error: ${e}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}};Ot.Sink=wg;function pL(i,e,t){i.then(r=>{try{e&&e(r)}catch(n){if(t)try{if(n instanceof Error){let s=n;t(s.name+": "+s.message)}else t(n)}catch{}}},r=>{if(t)try{if(r instanceof Error){let n=r;t(n.name+": "+n.message)}else t(r)}catch{}})}Ot.marshalPromiseToCallbacks=pL});var Tg=p(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0});Xl.Queue=void 0;var Eg=ki(),Rg=Cg(),I0=Pg(),Jl=function(i){return i[i.Dequeue=0]="Dequeue",i[i.Peek=1]="Peek",i}(Jl||{}),Ig=class{constructor(e){this.privPromiseStore=new Rg.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=e||new Rg.List,this.privDetachables=[],this.privSubscribers=new Rg.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(e){this.throwIfDispose(),this.enqueueFromPromise(new Promise(t=>t(e)))}enqueueFromPromise(e){this.throwIfDispose(),e.then(t=>{this.privList.add(t)},()=>{})}dequeue(){this.throwIfDispose();let e=new I0.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:Jl.Dequeue}),this.drain()),e.promise}peek(){this.throwIfDispose();let e=new I0.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:Jl.Peek}),this.drain()),e.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}drainAndDispose(e,t){return v(this,null,function*(){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;let r=this.privSubscribers;if(r){for(;r.length()>0;)r.removeFirst().deferral.resolve(void 0);this.privSubscribers===r&&(this.privSubscribers=r)}for(let n of this.privDetachables)yield n.detach();if(this.privPromiseStore.length()>0&&e){let n=[];return this.privPromiseStore.toArray().forEach(s=>{n.push(s)}),Promise.all(n).finally(()=>{this.privSubscribers=null,this.privList.forEach(s=>{e(s)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}})}dispose(e){return v(this,null,function*(){yield this.drainAndDispose(null,e)})}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;let e=this.privSubscribers,t=this.privList;if(e&&t){for(;t.length()>0&&e.length()>0&&!this.privIsDisposing;){let r=e.removeFirst();if(r.type===Jl.Peek)r.deferral.resolve(t.first());else{let n=t.removeFirst();r.deferral.resolve(n)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new Eg.InvalidOperationError(this.privDisposeReason):new Eg.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new Eg.InvalidOperationError("Queue disposing")}};Xl.Queue=Ig});var T0=p(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});Ql.RawWebsocketMessage=void 0;var Zl=dg(),ba=ki(),dL=Hr(),Ag=class{constructor(e,t,r){if(this.privPayload=null,!t)throw new ba.ArgumentNullError("payload");if(e===Zl.MessageType.Binary&&Object.getPrototypeOf(t).constructor.name!=="ArrayBuffer")throw new ba.InvalidOperationError("Payload must be ArrayBuffer");if(e===Zl.MessageType.Text&&typeof t!="string")throw new ba.InvalidOperationError("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=r||dL.createNoDashGuid()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===Zl.MessageType.Binary)throw new ba.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===Zl.MessageType.Text)throw new ba.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};Ql.RawWebsocketMessage=Ag});var A0=p(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:!0});eu.RiffPcmEncoder=void 0;var Og=class{constructor(e,t){this.privActualSampleRate=e,this.privDesiredSampleRate=t}encode(e){let t=this.downSampleAudioFrame(e,this.privActualSampleRate,this.privDesiredSampleRate);if(!t)return null;let r=t.length*2,n=new ArrayBuffer(r),s=new DataView(n);return this.floatTo16BitPCM(s,0,t),n}setString(e,t,r){for(let n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))}floatTo16BitPCM(e,t,r){for(let n=0;n<r.length;n++,t+=2){let s=Math.max(-1,Math.min(1,r[n]));e.setInt16(t,s<0?s*32768:s*32767,!0)}}downSampleAudioFrame(e,t,r){if(!e)return null;if(r===t||r>t)return e;let n=t/r,s=Math.round(e.length/n),o=new Float32Array(s),a=0,c=0;for(;c<s;){let l=Math.round((c+1)*n),u=0,h=0;for(;a<l&&a<e.length;)u+=e[a++],h++;o[c++]=u/h}return o}};eu.RiffPcmEncoder=Og});var x0=p(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});tu.Stream=void 0;var O0=ki(),fL=Hr(),D0=Tg(),Dg=class{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=e||fL.createNoDashGuid(),this.privReaderQueue=new D0.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch{}}read(){if(this.privIsReadEnded)throw new O0.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(e=>v(this,null,function*(){return(e===void 0||e.isEnd)&&(yield this.privReaderQueue.dispose("End of stream reached")),e}))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new D0.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new O0.InvalidOperationError("Stream closed")}};tu.Stream=Dg});var iu=p(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.TranslationStatus=void 0;var vL;(function(i){i[i.Success=0]="Success",i[i.Error=1]="Error"})(vL=wa.TranslationStatus||(wa.TranslationStatus={}))});var M0=p(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:!0});ru.ChunkedArrayBufferStream=void 0;var gL=M(),xg=class extends gL.Stream{constructor(e,t){super(t),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||this.privNextBufferReadyBytes===0&&e.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(e);return}let t=0;for(;t<e.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);let r=Math.min(e.buffer.byteLength-t,this.privTargetChunkSize-this.privNextBufferReadyBytes),n=new Uint8Array(this.privNextBufferToWrite),s=new Uint8Array(e.buffer.slice(t,r+t));n.set(s,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=r,t+=r,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};ru.ChunkedArrayBufferStream=xg});var N0=p(k0=>{"use strict";Object.defineProperty(k0,"__esModule",{value:!0})});var L0=p(nu=>{"use strict";Object.defineProperty(nu,"__esModule",{value:!0});nu.Timeout=void 0;var tr=class i{static load(){let e=new Map([[0,()=>{}]]),t=new Map,n="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),s=new Worker(n);return s.addEventListener("message",({data:c})=>{if(i.isCallNotification(c)){let{params:{timerId:l}}=c,u=e.get(l);if(typeof u=="number"){let h=t.get(u);if(h===void 0||h!==l)throw new Error("The timer is in an undefined state.")}else if(typeof u<"u")u(),e.delete(l);else throw new Error("The timer is in an undefined state.")}else if(i.isClearResponse(c)){let{id:l}=c,u=t.get(l);if(u===void 0)throw new Error("The timer is in an undefined state.");t.delete(l),e.delete(u)}else{let{error:{message:l}}=c;throw new Error(l)}}),{clearTimeout:c=>{let l=Math.random();t.set(l,c),e.set(c,l),s.postMessage({id:l,method:"clear",params:{timerId:c}})},setTimeout:(c,l)=>{let u=Math.random();return e.set(u,c),s.postMessage({id:null,method:"set",params:{delay:l,now:performance.now(),timerId:u}}),u}}}static loadWorkerTimers(){return()=>(i.workerTimers!==null||(i.workerTimers=i.load()),i.workerTimers)}static isCallNotification(e){return e.method!==void 0&&e.method==="call"}static isClearResponse(e){return e.error===null&&typeof e.id=="number"}};nu.Timeout=tr;tr.workerTimers=null;tr.clearTimeout=i=>tr.timers().clearTimeout(i);tr.setTimeout=(i,e)=>tr.timers().setTimeout(i,e);tr.timers=tr.loadWorkerTimers()});var j0=p(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.OCSPCacheUpdateErrorEvent=X.OCSPResponseRetrievedEvent=X.OCSPCacheFetchErrorEvent=X.OCSPVerificationFailedEvent=X.OCSPCacheHitEvent=X.OCSPCacheEntryNeedsRefreshEvent=X.OCSPCacheEntryExpiredEvent=X.OCSPWSUpgradeStartedEvent=X.OCSPStapleReceivedEvent=X.OCSPCacheUpdateCompleteEvent=X.OCSPDiskCacheStoreEvent=X.OCSPMemoryCacheStoreEvent=X.OCSPCacheUpdateNeededEvent=X.OCSPDiskCacheHitEvent=X.OCSPCacheMissEvent=X.OCSPMemoryCacheHitEvent=X.OCSPEvent=void 0;var it=Gs(),He=class extends it.PlatformEvent{constructor(e,t,r){super(e,t),this.privSignature=r}};X.OCSPEvent=He;var Mg=class extends He{constructor(e){super("OCSPMemoryCacheHitEvent",it.EventType.Debug,e)}};X.OCSPMemoryCacheHitEvent=Mg;var kg=class extends He{constructor(e){super("OCSPCacheMissEvent",it.EventType.Debug,e)}};X.OCSPCacheMissEvent=kg;var Ng=class extends He{constructor(e){super("OCSPDiskCacheHitEvent",it.EventType.Debug,e)}};X.OCSPDiskCacheHitEvent=Ng;var Lg=class extends He{constructor(e){super("OCSPCacheUpdateNeededEvent",it.EventType.Debug,e)}};X.OCSPCacheUpdateNeededEvent=Lg;var jg=class extends He{constructor(e){super("OCSPMemoryCacheStoreEvent",it.EventType.Debug,e)}};X.OCSPMemoryCacheStoreEvent=jg;var zg=class extends He{constructor(e){super("OCSPDiskCacheStoreEvent",it.EventType.Debug,e)}};X.OCSPDiskCacheStoreEvent=zg;var qg=class extends He{constructor(e){super("OCSPCacheUpdateCompleteEvent",it.EventType.Debug,e)}};X.OCSPCacheUpdateCompleteEvent=qg;var Fg=class extends He{constructor(){super("OCSPStapleReceivedEvent",it.EventType.Debug,"")}};X.OCSPStapleReceivedEvent=Fg;var Bg=class extends He{constructor(e){super("OCSPWSUpgradeStartedEvent",it.EventType.Debug,e)}};X.OCSPWSUpgradeStartedEvent=Bg;var Wg=class extends He{constructor(e,t){super("OCSPCacheEntryExpiredEvent",it.EventType.Debug,e),this.privExpireTime=t}};X.OCSPCacheEntryExpiredEvent=Wg;var Hg=class extends He{constructor(e,t,r){super("OCSPCacheEntryNeedsRefreshEvent",it.EventType.Debug,e),this.privExpireTime=r,this.privStartTime=t}};X.OCSPCacheEntryNeedsRefreshEvent=Hg;var Ug=class extends He{constructor(e,t,r){super("OCSPCacheHitEvent",it.EventType.Debug,e),this.privExpireTime=r,this.privExpireTimeString=new Date(r).toLocaleDateString(),this.privStartTime=t,this.privStartTimeString=new Date(t).toLocaleTimeString()}};X.OCSPCacheHitEvent=Ug;var Vg=class extends He{constructor(e,t){super("OCSPVerificationFailedEvent",it.EventType.Debug,e),this.privError=t}};X.OCSPVerificationFailedEvent=Vg;var Kg=class extends He{constructor(e,t){super("OCSPCacheFetchErrorEvent",it.EventType.Debug,e),this.privError=t}};X.OCSPCacheFetchErrorEvent=Kg;var $g=class extends He{constructor(e){super("OCSPResponseRetrievedEvent",it.EventType.Debug,e)}};X.OCSPResponseRetrievedEvent=$g;var Gg=class extends He{constructor(e,t){super("OCSPCacheUpdateErrorEvent",it.EventType.Debug,e),this.privError=t}};X.OCSPCacheUpdateErrorEvent=Gg});var q0=p(su=>{"use strict";Object.defineProperty(su,"__esModule",{value:!0});su.BackgroundEvent=void 0;var z0=M(),Yg=class extends z0.PlatformEvent{constructor(e){super("BackgroundEvent",z0.EventType.Error),this.privError=e}get error(){return this.privError}};su.BackgroundEvent=Yg});var M=p(K=>{"use strict";var mL=K&&K.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),ne=K&&K.__exportStar||function(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&mL(e,i,t)};Object.defineProperty(K,"__esModule",{value:!0});ne(i0(),K);ne(r0(),K);ne(dg(),K);ne(n0(),K);ne(s0(),K);ne(mg(),K);ne(ki(),K);ne(a0(),K);ne(_g(),K);ne(Hr(),K);ne(l0(),K);ne(u0(),K);ne(p0(),K);ne(f0(),K);ne(g0(),K);ne(y0(),K);ne(S0(),K);ne(b0(),K);ne(P0(),K);ne(R0(),K);ne(Cg(),K);ne(Gs(),K);ne(Pg(),K);ne(Tg(),K);ne(T0(),K);ne(A0(),K);ne(x0(),K);var yL=iu();Object.defineProperty(K,"TranslationStatus",{enumerable:!0,get:function(){return yL.TranslationStatus}});ne(M0(),K);ne(N0(),K);ne(L0(),K);ne(j0(),K);ne(q0(),K)});var _t=p(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});ou.HeaderNames=void 0;var ii=class{};ou.HeaderNames=ii;ii.AuthKey="Ocp-Apim-Subscription-Key";ii.Authorization="Authorization";ii.SpIDAuthKey="Apim-Subscription-Id";ii.ConnectionId="X-ConnectionId";ii.ContentType="Content-Type";ii.CustomCommandsAppId="X-CommandsAppId";ii.Path="Path";ii.RequestId="X-RequestId";ii.RequestStreamId="X-StreamId";ii.RequestTimestamp="X-Timestamp"});var cu=p(au=>{"use strict";Object.defineProperty(au,"__esModule",{value:!0});au.AuthInfo=void 0;var Jg=class{constructor(e,t){this.privHeaderName=e,this.privToken=t}get headerName(){return this.privHeaderName}get token(){return this.privToken}};au.AuthInfo=Jg});var F0=p(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.CognitiveSubscriptionKeyAuthentication=void 0;var _L=M(),SL=_t(),CL=cu(),Xg=class{constructor(e){if(!e)throw new _L.ArgumentNullError("subscriptionKey");this.privAuthInfo=new CL.AuthInfo(SL.HeaderNames.AuthKey,e)}fetch(e){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(e){return Promise.resolve(this.privAuthInfo)}};lu.CognitiveSubscriptionKeyAuthentication=Xg});var U0=p(hu=>{"use strict";Object.defineProperty(hu,"__esModule",{value:!0});hu.CognitiveTokenAuthentication=void 0;var B0=M(),W0=cu(),H0=_t(),uu=class i{constructor(e,t){if(!e)throw new B0.ArgumentNullError("fetchCallback");if(!t)throw new B0.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t}fetch(e){return this.privFetchCallback(e).then(t=>new W0.AuthInfo(H0.HeaderNames.Authorization,t===void 0?void 0:i.privTokenPrefix+t))}fetchOnExpiry(e){return this.privFetchOnExpiryCallback(e).then(t=>new W0.AuthInfo(H0.HeaderNames.Authorization,t===void 0?void 0:i.privTokenPrefix+t))}};hu.CognitiveTokenAuthentication=uu;uu.privTokenPrefix="Bearer "});var K0=p(V0=>{"use strict";Object.defineProperty(V0,"__esModule",{value:!0})});var G0=p($0=>{"use strict";Object.defineProperty($0,"__esModule",{value:!0})});var Zg=p(()=>{"use strict"});var Qg=p(pu=>{"use strict";Object.defineProperty(pu,"__esModule",{value:!0});pu.LogLevel=void 0;var bL=M();Object.defineProperty(pu,"LogLevel",{enumerable:!0,get:function(){return bL.EventType}})});var j=p(du=>{"use strict";Object.defineProperty(du,"__esModule",{value:!0});du.Contracts=void 0;var em=class i{static throwIfNullOrUndefined(e,t){if(e==null)throw new Error("throwIfNullOrUndefined:"+t)}static throwIfNull(e,t){if(e===null)throw new Error("throwIfNull:"+t)}static throwIfNullOrWhitespace(e,t){if(i.throwIfNullOrUndefined(e,t),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+t)}static throwIfNullOrTooLong(e,t,r){if(i.throwIfNullOrUndefined(e,t),(""+e).length>r)throw new Error("throwIfNullOrTooLong:"+t+" (more than "+r.toString()+" characters)")}static throwIfNullOrTooShort(e,t,r){if(i.throwIfNullOrUndefined(e,t),(""+e).length<r)throw new Error("throwIfNullOrTooShort:"+t+" (less than "+r.toString()+" characters)")}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,t){if(i.throwIfNullOrUndefined(e,t),e.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+t);for(let r of e)i.throwIfNullOrWhitespace(r,t)}static throwIfFileDoesNotExist(e,t){i.throwIfNullOrWhitespace(e,t)}static throwIfNotUndefined(e,t){if(e!==void 0)throw new Error("throwIfNotUndefined:"+t)}};du.Contracts=em});var J0=p(ir=>{"use strict";var wL=ir&&ir.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),PL=ir&&ir.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),EL=ir&&ir.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.hasOwnProperty.call(i,t)&&wL(e,i,t);return PL(e,i),e};Object.defineProperty(ir,"__esModule",{value:!0});ir.ConsoleLoggingListener=void 0;var Y0=EL(Zg()),Pa=Qg(),RL=j(),tm=class{constructor(e=Pa.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=e}set logPath(e){RL.Contracts.throwIfNullOrUndefined(Y0.openSync,`
File System access not available`),this.privLogPath=e}set enableConsoleOutput(e){this.privEnableConsoleOutput=e}onEvent(e){if(e.eventType>=this.privLogLevelFilter){let t=this.toString(e);if(this.logCallback&&this.logCallback(t),this.privLogPath&&Y0.writeFileSync(this.privLogPath,t+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(e.eventType){case Pa.LogLevel.Debug:console.debug(t);break;case Pa.LogLevel.Info:console.info(t);break;case Pa.LogLevel.Warning:console.warn(t);break;case Pa.LogLevel.Error:console.error(t);break;default:console.log(t);break}}}toString(e){let t=[`${e.eventTime}`,`${e.name}`],r=e;for(let n in r)if(n&&e.hasOwnProperty(n)&&n!=="eventTime"&&n!=="eventType"&&n!=="eventId"&&n!=="name"&&n!=="constructor"){let s=r[n],o="<NULL>";s!=null&&(typeof s=="number"||typeof s=="string"?o=s.toString():o=JSON.stringify(s)),t.push(`${n}: ${o}`)}return t.join(" | ")}};ir.ConsoleLoggingListener=tm});var Z0=p(X0=>{"use strict";Object.defineProperty(X0,"__esModule",{value:!0})});var Kr=p(br=>{"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.AudioStreamFormatImpl=br.AudioStreamFormat=br.AudioFormatTag=void 0;var Ea;(function(i){i[i.PCM=1]="PCM",i[i.MuLaw=2]="MuLaw",i[i.Siren=3]="Siren",i[i.MP3=4]="MP3",i[i.SILKSkype=5]="SILKSkype",i[i.OGG_OPUS=6]="OGG_OPUS",i[i.WEBM_OPUS=7]="WEBM_OPUS",i[i.ALaw=8]="ALaw",i[i.FLAC=9]="FLAC",i[i.OPUS=10]="OPUS",i[i.AMR_WB=11]="AMR_WB",i[i.G722=12]="G722"})(Ea=br.AudioFormatTag||(br.AudioFormatTag={}));var fu=class{static getDefaultInputFormat(){return Js.getDefaultInputFormat()}static getWaveFormat(e,t,r,n){return new Js(e,t,r,n)}static getWaveFormatPCM(e,t,r){return new Js(e,t,r)}};br.AudioStreamFormat=fu;var Js=class i extends fu{constructor(e=16e3,t=16,r=1,n=Ea.PCM){super();let s=!0;switch(n){case Ea.PCM:this.formatTag=1;break;case Ea.ALaw:this.formatTag=6;break;case Ea.MuLaw:this.formatTag=7;break;default:s=!1}if(this.bitsPerSample=t,this.samplesPerSec=e,this.channels=r,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),s){this.privHeader=new ArrayBuffer(44);let o=new DataView(this.privHeader);this.setString(o,0,"RIFF"),o.setUint32(4,0,!0),this.setString(o,8,"WAVEfmt "),o.setUint32(16,16,!0),o.setUint16(20,this.formatTag,!0),o.setUint16(22,this.channels,!0),o.setUint32(24,this.samplesPerSec,!0),o.setUint32(28,this.avgBytesPerSec,!0),o.setUint16(32,this.channels*(this.bitsPerSample/8),!0),o.setUint16(34,this.bitsPerSample,!0),this.setString(o,36,"data"),o.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new i}static getAudioContext(e){let t=window.AudioContext||window.webkitAudioContext||!1;if(t)return e!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new t({sampleRate:e}):new t;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(e,t,r){for(let n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))}};br.AudioStreamFormatImpl=Js});var tE=p(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.MicAudioSource=qn.AudioWorkletSourceURLPropertyName=void 0;var Q0=T(),rt=M(),eE=Kr();qn.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";var vu=class i{constructor(e,t,r,n){this.privRecorder=e,this.deviceId=t,this.privStreams={},this.privOutputChunkSize=i.AUDIOFORMAT.avgBytesPerSec/10,this.privId=r||rt.createNoDashGuid(),this.privEvents=new rt.EventSource,this.privMediaStream=n||null,this.privIsClosing=!1}get format(){return Promise.resolve(i.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new rt.Deferred;try{this.createAudioContext()}catch(r){if(r instanceof Error){let n=r;this.privInitializeDeferral.reject(n.name+": "+n.message)}else this.privInitializeDeferral.reject(r);return this.privInitializeDeferral.promise}let e=window.navigator,t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=(r,n,s)=>{e.mediaDevices.getUserMedia(r).then(n).catch(s)}),t){let r=()=>{this.onEvent(new rt.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new rt.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):t({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},n=>{this.privMediaStream=n,this.onEvent(new rt.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},n=>{let s=`Error occurred during microphone initialization: ${n}`;this.privInitializeDeferral.reject(s),this.onEvent(new rt.AudioSourceErrorEvent(this.privId,s))})};this.privContext.state==="suspended"?this.privContext.resume().then(r).catch(n=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${n}`)}):r()}else{let r="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(r),this.onEvent(new rt.AudioSourceErrorEvent(r,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(e){return this.onEvent(new rt.AudioStreamNodeAttachingEvent(this.privId,e)),this.listen(e).then(t=>(this.onEvent(new rt.AudioStreamNodeAttachedEvent(this.privId,e)),{detach:()=>v(this,null,function*(){return t.readEnded(),delete this.privStreams[e],this.onEvent(new rt.AudioStreamNodeDetachedEvent(this.privId,e)),this.turnOff()}),id:()=>e,read:()=>t.read()}))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new rt.AudioStreamNodeDetachedEvent(this.privId,e)))}turnOff(){return v(this,null,function*(){for(let e in this.privStreams)if(e){let t=this.privStreams[e];t&&t.close()}this.onEvent(new rt.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(yield this.privInitializeDeferral,this.privInitializeDeferral=null),yield this.destroyAudioContext()})}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(e=>({bitspersample:i.AUDIOFORMAT.bitsPerSample,channelcount:i.AUDIOFORMAT.channels,connectivity:Q0.connectivity.Unknown,manufacturer:"Speech SDK",model:e,samplerate:i.AUDIOFORMAT.samplesPerSec,type:Q0.type.Microphones}))}setProperty(e,t){if(e===qn.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(t);else throw new Error("Property '"+e+"' is not supported on Microphone.")}getMicrophoneLabel(){let e="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(e);this.privMicrophoneLabel=e;let t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(t===void 0)return Promise.resolve(this.privMicrophoneLabel);let r=new rt.Deferred;return navigator.mediaDevices.enumerateDevices().then(n=>{for(let s of n)if(s.deviceId===t){this.privMicrophoneLabel=s.label;break}r.resolve(this.privMicrophoneLabel)},()=>r.resolve(this.privMicrophoneLabel)),r.promise}listen(e){return v(this,null,function*(){yield this.turnOn();let t=new rt.ChunkedArrayBufferStream(this.privOutputChunkSize,e);this.privStreams[e]=t;try{this.privRecorder.record(this.privContext,this.privMediaStream,t)}catch(n){throw this.onEvent(new rt.AudioStreamNodeErrorEvent(this.privId,e,n)),n}return t})}onEvent(e){this.privEvents.onEvent(e),rt.Events.instance.onEvent(e)}createAudioContext(){this.privContext||(this.privContext=eE.AudioStreamFormatImpl.getAudioContext(i.AUDIOFORMAT.samplesPerSec))}destroyAudioContext(){return v(this,null,function*(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?this.privIsClosing||(this.privIsClosing=!0,yield this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&(yield this.privContext.suspend())})}};qn.MicAudioSource=vu;vu.AUDIOFORMAT=eE.AudioStreamFormat.getDefaultInputFormat()});var rE=p(gu=>{"use strict";Object.defineProperty(gu,"__esModule",{value:!0});gu.FileAudioSource=void 0;var iE=T(),Bt=M(),IL=Kr(),im=class{constructor(e,t,r){this.privStreams={},this.privHeaderEnd=44,this.privId=r||Bt.createNoDashGuid(),this.privEvents=new Bt.EventSource,this.privSource=e,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=e.name:this.privFilename=t||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){let e=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new Bt.AudioSourceErrorEvent(e,"")),Promise.reject(e)}this.onEvent(new Bt.AudioSourceInitializingEvent(this.privId)),this.onEvent(new Bt.AudioSourceReadyEvent(this.privId))}id(){return this.privId}attach(e){return v(this,null,function*(){this.onEvent(new Bt.AudioStreamNodeAttachingEvent(this.privId,e));let t=yield this.upload(e);return this.onEvent(new Bt.AudioStreamNodeAttachedEvent(this.privId,e)),Promise.resolve({detach:()=>v(this,null,function*(){t.readEnded(),delete this.privStreams[e],this.onEvent(new Bt.AudioStreamNodeDetachedEvent(this.privId,e)),yield this.turnOff()}),id:()=>e,read:()=>t.read()})})}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new Bt.AudioStreamNodeDetachedEvent(this.privId,e)))}turnOff(){for(let e in this.privStreams)if(e){let t=this.privStreams[e];t&&!t.isClosed&&t.close()}return this.onEvent(new Bt.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(e=>Promise.resolve({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:iE.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:iE.type.File}))}readHeader(){let t=this.privSource.slice(0,4296),r=new Bt.Deferred,n=s=>{let o=new DataView(s),a=f=>String.fromCharCode(o.getUint8(f),o.getUint8(f+1),o.getUint8(f+2),o.getUint8(f+3));if(a(0)!=="RIFF"){r.reject("Invalid WAV header in file, RIFF was not found");return}if(a(8)!=="WAVE"||a(12)!=="fmt "){r.reject("Invalid WAV header in file, WAVEfmt was not found");return}let c=o.getInt32(16,!0),l=o.getUint16(22,!0),u=o.getUint32(24,!0),h=o.getUint16(34,!0),d=36+Math.max(c-16,0);for(;a(d)!=="data";d+=2)if(d>4288){r.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=d+8,r.resolve(IL.AudioStreamFormat.getWaveFormatPCM(u,h,l))};if(typeof window<"u"&&typeof Blob<"u"&&t instanceof Blob){let s=new FileReader;s.onload=o=>{let a=o.target.result;n(a)},s.readAsArrayBuffer(t)}else{let s=t;n(s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength))}return r.promise}upload(e){return v(this,null,function*(){let t=r=>{let n=`Error occurred while processing '${this.privFilename}'. ${r}`;throw this.onEvent(new Bt.AudioStreamNodeErrorEvent(this.privId,e,n)),new Error(n)};try{yield this.turnOn();let r=yield this.privAudioFormatPromise,n=new Bt.ChunkedArrayBufferStream(r.avgBytesPerSec/10,e);this.privStreams[e]=n;let s=this.privSource.slice(this.privHeaderEnd),o=a=>{n.isClosed||(n.writeStreamChunk({buffer:a,isEnd:!1,timeReceived:Date.now()}),n.close())};if(typeof window<"u"&&typeof Blob<"u"&&s instanceof Blob){let a=new FileReader;a.onerror=c=>t(c.toString()),a.onload=c=>{let l=c.target.result;o(l)},a.readAsArrayBuffer(s)}else{let a=s;o(a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength))}return n}catch(r){t(r)}})}onEvent(e){this.privEvents.onEvent(e),Bt.Events.instance.onEvent(e)}};gu.FileAudioSource=im});var nE=p(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.PcmRecorder=void 0;var TL=M(),rm=class{constructor(e){this.privStopInputOnRelease=e}record(e,t,r){let s=new TL.RiffPcmEncoder(e.sampleRate,16e3),o=e.createMediaStreamSource(t),a=()=>{let l=(()=>{let u=0;try{return e.createScriptProcessor(u,1,1)}catch{u=2048;let d=e.sampleRate;for(;u<16384&&d>=32e3;)u<<=1,d>>=1;return e.createScriptProcessor(u,1,1)}})();l.onaudioprocess=u=>{let h=u.inputBuffer.getChannelData(0);if(r&&!r.isClosed){let d=s.encode(h);d&&r.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}},o.connect(l),l.connect(e.destination),this.privMediaResources={scriptProcessorNode:l,source:o,stream:t}},c=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(e.audioWorklet&&!c){if(!this.privSpeechProcessorScript){let l=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,u=new Blob([l],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(u)}e.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{let l=new AudioWorkletNode(e,"speech-processor");l.port.onmessage=u=>{let h=u.data;if(r&&!r.isClosed){let d=s.encode(h);d&&r.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}},o.connect(l),l.connect(e.destination),this.privMediaResources={scriptProcessorNode:l,source:o,stream:t}}).catch(()=>{a()})}else try{a()}catch(l){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${l}`)}}releaseMediaResources(e){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(t=>t.stop()),this.privMediaResources.source=null))}setWorkletUrl(e){this.privSpeechProcessorScript=e}};mu.PcmRecorder=rm});var nm=p(()=>{"use strict"});var sm=p(()=>{"use strict"});var am=p((a9,om)=>{"use strict";var Xs=typeof Reflect=="object"?Reflect:null,sE=Xs&&typeof Xs.apply=="function"?Xs.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},yu;Xs&&typeof Xs.ownKeys=="function"?yu=Xs.ownKeys:Object.getOwnPropertySymbols?yu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:yu=function(e){return Object.getOwnPropertyNames(e)};function AL(i){console&&console.warn&&console.warn(i)}var aE=Number.isNaN||function(e){return e!==e};function he(){he.init.call(this)}om.exports=he;om.exports.once=ML;he.EventEmitter=he;he.prototype._events=void 0;he.prototype._eventsCount=0;he.prototype._maxListeners=void 0;var oE=10;function _u(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}Object.defineProperty(he,"defaultMaxListeners",{enumerable:!0,get:function(){return oE},set:function(i){if(typeof i!="number"||i<0||aE(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");oE=i}});he.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};he.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||aE(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function cE(i){return i._maxListeners===void 0?he.defaultMaxListeners:i._maxListeners}he.prototype.getMaxListeners=function(){return cE(this)};he.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")sE(c,this,t);else for(var l=c.length,u=dE(c,l),r=0;r<l;++r)sE(u[r],this,t);return!0};function lE(i,e,t,r){var n,s,o;if(_u(t),s=i._events,s===void 0?(s=i._events=Object.create(null),i._eventsCount=0):(s.newListener!==void 0&&(i.emit("newListener",e,t.listener?t.listener:t),s=i._events),o=s[e]),o===void 0)o=s[e]=t,++i._eventsCount;else if(typeof o=="function"?o=s[e]=r?[t,o]:[o,t]:r?o.unshift(t):o.push(t),n=cE(i),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=i,a.type=e,a.count=o.length,AL(a)}return i}he.prototype.addListener=function(e,t){return lE(this,e,t,!1)};he.prototype.on=he.prototype.addListener;he.prototype.prependListener=function(e,t){return lE(this,e,t,!0)};function OL(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function uE(i,e,t){var r={fired:!1,wrapFn:void 0,target:i,type:e,listener:t},n=OL.bind(r);return n.listener=t,r.wrapFn=n,n}he.prototype.once=function(e,t){return _u(t),this.on(e,uE(this,e,t)),this};he.prototype.prependOnceListener=function(e,t){return _u(t),this.prependListener(e,uE(this,e,t)),this};he.prototype.removeListener=function(e,t){var r,n,s,o,a;if(_u(t),n=this._events,n===void 0)return this;if(r=n[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():DL(r,s),r.length===1&&(n[e]=r[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};he.prototype.off=he.prototype.removeListener;he.prototype.removeAllListeners=function(e){var t,r,n;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function hE(i,e,t){var r=i._events;if(r===void 0)return[];var n=r[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?xL(n):dE(n,n.length)}he.prototype.listeners=function(e){return hE(this,e,!0)};he.prototype.rawListeners=function(e){return hE(this,e,!1)};he.listenerCount=function(i,e){return typeof i.listenerCount=="function"?i.listenerCount(e):pE.call(i,e)};he.prototype.listenerCount=pE;function pE(i){var e=this._events;if(e!==void 0){var t=e[i];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}he.prototype.eventNames=function(){return this._eventsCount>0?yu(this._events):[]};function dE(i,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=i[r];return t}function DL(i,e){for(;e+1<i.length;e++)i[e]=i[e+1];i.pop()}function xL(i){for(var e=new Array(i.length),t=0;t<e.length;++t)e[t]=i[t].listener||i[t];return e}function ML(i,e){return new Promise(function(t,r){function n(o){i.removeListener(e,s),r(o)}function s(){typeof i.removeListener=="function"&&i.removeListener("error",n),t([].slice.call(arguments))}fE(i,e,s,{once:!0}),e!=="error"&&kL(i,n,{once:!0})})}function kL(i,e,t){typeof i.on=="function"&&fE(i,"error",e,t)}function fE(i,e,t,r){if(typeof i.on=="function")r.once?i.once(e,t):i.on(e,t);else if(typeof i.addEventListener=="function")i.addEventListener(e,function n(s){r.once&&i.removeEventListener(e,n),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i)}});var gE=p((c9,vE)=>{"use strict";var Zs=1e3,Qs=Zs*60,eo=Qs*60,Fn=eo*24,NL=Fn*7,LL=Fn*365.25;vE.exports=function(i,e){e=e||{};var t=typeof i;if(t==="string"&&i.length>0)return jL(i);if(t==="number"&&isFinite(i))return e.long?qL(i):zL(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function jL(i){if(i=String(i),!(i.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(e){var t=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return t*LL;case"weeks":case"week":case"w":return t*NL;case"days":case"day":case"d":return t*Fn;case"hours":case"hour":case"hrs":case"hr":case"h":return t*eo;case"minutes":case"minute":case"mins":case"min":case"m":return t*Qs;case"seconds":case"second":case"secs":case"sec":case"s":return t*Zs;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function zL(i){var e=Math.abs(i);return e>=Fn?Math.round(i/Fn)+"d":e>=eo?Math.round(i/eo)+"h":e>=Qs?Math.round(i/Qs)+"m":e>=Zs?Math.round(i/Zs)+"s":i+"ms"}function qL(i){var e=Math.abs(i);return e>=Fn?Su(i,e,Fn,"day"):e>=eo?Su(i,e,eo,"hour"):e>=Qs?Su(i,e,Qs,"minute"):e>=Zs?Su(i,e,Zs,"second"):i+" ms"}function Su(i,e,t,r){var n=e>=t*1.5;return Math.round(i/t)+" "+r+(n?"s":"")}});var yE=p((l9,mE)=>{"use strict";function FL(i){t.debug=t,t.default=t,t.coerce=c,t.disable=s,t.enable=n,t.enabled=o,t.humanize=gE(),t.destroy=l,Object.keys(i).forEach(u=>{t[u]=i[u]}),t.names=[],t.skips=[],t.formatters={};function e(u){let h=0;for(let d=0;d<u.length;d++)h=(h<<5)-h+u.charCodeAt(d),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(u){let h,d=null,f,g;function m(...y){if(!m.enabled)return;let b=m,S=Number(new Date),_=S-(h||S);b.diff=_,b.prev=h,b.curr=S,h=S,y[0]=t.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let P=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(x,ie)=>{if(x==="%%")return"%";P++;let G=t.formatters[ie];if(typeof G=="function"){let ee=y[P];x=G.call(b,ee),y.splice(P,1),P--}return x}),t.formatArgs.call(b,y),(b.log||t.log).apply(b,y)}return m.namespace=u,m.useColors=t.useColors(),m.color=t.selectColor(u),m.extend=r,m.destroy=t.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(f!==t.namespaces&&(f=t.namespaces,g=t.enabled(u)),g),set:y=>{d=y}}),typeof t.init=="function"&&t.init(m),m}function r(u,h){let d=t(this.namespace+(typeof h>"u"?":":h)+u);return d.log=this.log,d}function n(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let h,d=(typeof u=="string"?u:"").split(/[\s,]+/),f=d.length;for(h=0;h<f;h++)d[h]&&(u=d[h].replace(/\*/g,".*?"),u[0]==="-"?t.skips.push(new RegExp("^"+u.slice(1)+"$")):t.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...t.names.map(a),...t.skips.map(a).map(h=>"-"+h)].join(",");return t.enable(""),u}function o(u){if(u[u.length-1]==="*")return!0;let h,d;for(h=0,d=t.skips.length;h<d;h++)if(t.skips[h].test(u))return!1;for(h=0,d=t.names.length;h<d;h++)if(t.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}mE.exports=FL});var cm=p((ri,Cu)=>{"use strict";ri.formatArgs=WL;ri.save=HL;ri.load=UL;ri.useColors=BL;ri.storage=VL();ri.destroy=(()=>{let i=!1;return()=>{i||(i=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ri.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function BL(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let i;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(i=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(i[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function WL(i){if(i[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+i[0]+(this.useColors?"%c ":" ")+"+"+Cu.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;i.splice(1,0,e,"color: inherit");let t=0,r=0;i[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(r=t))}),i.splice(r,0,e)}ri.log=console.debug||console.log||(()=>{});function HL(i){try{i?ri.storage.setItem("debug",i):ri.storage.removeItem("debug")}catch{}}function UL(){let i;try{i=ri.storage.getItem("debug")}catch{}return!i&&typeof process<"u"&&"env"in process&&(i=process.env.DEBUG),i}function VL(){try{return localStorage}catch{}}Cu.exports=yE()(ri);var{formatters:KL}=Cu.exports;KL.j=function(i){try{return JSON.stringify(i)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var _E=p(lm=>{"use strict";Object.defineProperty(lm,"__esModule",{value:!0});function $L(i){return function(e,t){return new Promise((r,n)=>{i.call(this,e,t,(s,o)=>{s?n(s):r(o)})})}}lm.default=$L});var bE=p((hm,CE)=>{"use strict";var SE=hm&&hm.__importDefault||function(i){return i&&i.__esModule?i:{default:i}},GL=am(),YL=SE(cm()),JL=SE(_E()),Ra=YL.default("agent-base");function XL(i){return!!i&&typeof i.addRequest=="function"}function um(){let{stack:i}=new Error;return typeof i!="string"?!1:i.split(`
`).some(e=>e.indexOf("(https.js:")!==-1||e.indexOf("node:https:")!==-1)}function bu(i,e){return new bu.Agent(i,e)}(function(i){class e extends GL.EventEmitter{constructor(r,n){super();let s=n;typeof r=="function"?this.callback=r:r&&(s=r),this.timeout=null,s&&typeof s.timeout=="number"&&(this.timeout=s.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:um()?443:80}set defaultPort(r){this.explicitDefaultPort=r}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:um()?"https:":"http:"}set protocol(r){this.explicitProtocol=r}callback(r,n,s){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(r,n){let s=Object.assign({},n);typeof s.secureEndpoint!="boolean"&&(s.secureEndpoint=um()),s.host==null&&(s.host="localhost"),s.port==null&&(s.port=s.secureEndpoint?443:80),s.protocol==null&&(s.protocol=s.secureEndpoint?"https:":"http:"),s.host&&s.path&&delete s.path,delete s.agent,delete s.hostname,delete s._defaultAgent,delete s.defaultPort,delete s.createConnection,r._last=!0,r.shouldKeepAlive=!1;let o=!1,a=null,c=s.timeout||this.timeout,l=f=>{r._hadError||(r.emit("error",f),r._hadError=!0)},u=()=>{a=null,o=!0;let f=new Error(`A "socket" was not created for HTTP request before ${c}ms`);f.code="ETIMEOUT",l(f)},h=f=>{o||(a!==null&&(clearTimeout(a),a=null),l(f))},d=f=>{if(o)return;if(a!=null&&(clearTimeout(a),a=null),XL(f)){Ra("Callback returned another Agent instance %o",f.constructor.name),f.addRequest(r,s);return}if(f){f.once("free",()=>{this.freeSocket(f,s)}),r.onSocket(f);return}let g=new Error(`no Duplex stream was returned to agent-base for \`${r.method} ${r.path}\``);l(g)};if(typeof this.callback!="function"){l(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(Ra("Converting legacy callback function to promise"),this.promisifiedCallback=JL.default(this.callback)):this.promisifiedCallback=this.callback),typeof c=="number"&&c>0&&(a=setTimeout(u,c)),"port"in s&&typeof s.port!="number"&&(s.port=Number(s.port));try{Ra("Resolving socket for %o request: %o",s.protocol,`${r.method} ${r.path}`),Promise.resolve(this.promisifiedCallback(r,s)).then(d,h)}catch(f){Promise.reject(f).catch(h)}}freeSocket(r,n){Ra("Freeing socket %o %o",r.constructor.name,n),r.destroy()}destroy(){Ra("Destroying agent %o",this.constructor.name)}}i.Agent=e,i.prototype=i.Agent.prototype})(bu||(bu={}));CE.exports=bu});var wE=p((to,io)=>{"use strict";(function(i){var e=typeof to=="object"&&to&&!to.nodeType&&to,t=typeof io=="object"&&io&&!io.nodeType&&io,r=typeof global=="object"&&global;(r.global===r||r.window===r||r.self===r)&&(i=r);var n,s=2147483647,o=36,a=1,c=26,l=38,u=700,h=72,d=128,f="-",g=/^xn--/,m=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=o-a,_=Math.floor,P=String.fromCharCode,O;function x(D){throw new RangeError(b[D])}function ie(D,z){for(var te=D.length,be=[];te--;)be[te]=z(D[te]);return be}function G(D,z){var te=D.split("@"),be="";te.length>1&&(be=te[0]+"@",D=te[1]),D=D.replace(y,".");var De=D.split("."),It=ie(De,z).join(".");return be+It}function ee(D){for(var z=[],te=0,be=D.length,De,It;te<be;)De=D.charCodeAt(te++),De>=55296&&De<=56319&&te<be?(It=D.charCodeAt(te++),(It&64512)==56320?z.push(((De&1023)<<10)+(It&1023)+65536):(z.push(De),te--)):z.push(De);return z}function de(D){return ie(D,function(z){var te="";return z>65535&&(z-=65536,te+=P(z>>>10&1023|55296),z=56320|z&1023),te+=P(z),te}).join("")}function Yt(D){return D-48<10?D-22:D-65<26?D-65:D-97<26?D-97:o}function Nt(D,z){return D+22+75*(D<26)-((z!=0)<<5)}function Le(D,z,te){var be=0;for(D=te?_(D/u):D>>1,D+=_(D/z);D>S*c>>1;be+=o)D=_(D/S);return _(be+(S+1)*D/(D+l))}function Et(D){var z=[],te=D.length,be,De=0,It=d,Ye=h,Jt,Ai,Gi,yr,ht,ui,Oi,Lr,_n;for(Jt=D.lastIndexOf(f),Jt<0&&(Jt=0),Ai=0;Ai<Jt;++Ai)D.charCodeAt(Ai)>=128&&x("not-basic"),z.push(D.charCodeAt(Ai));for(Gi=Jt>0?Jt+1:0;Gi<te;){for(yr=De,ht=1,ui=o;Gi>=te&&x("invalid-input"),Oi=Yt(D.charCodeAt(Gi++)),(Oi>=o||Oi>_((s-De)/ht))&&x("overflow"),De+=Oi*ht,Lr=ui<=Ye?a:ui>=Ye+c?c:ui-Ye,!(Oi<Lr);ui+=o)_n=o-Lr,ht>_(s/_n)&&x("overflow"),ht*=_n;be=z.length+1,Ye=Le(De-yr,be,yr==0),_(De/be)>s-It&&x("overflow"),It+=_(De/be),De%=be,z.splice(De++,0,It)}return de(z)}function Rt(D){var z,te,be,De,It,Ye,Jt,Ai,Gi,yr,ht,ui=[],Oi,Lr,_n,ov;for(D=ee(D),Oi=D.length,z=d,te=0,It=h,Ye=0;Ye<Oi;++Ye)ht=D[Ye],ht<128&&ui.push(P(ht));for(be=De=ui.length,De&&ui.push(f);be<Oi;){for(Jt=s,Ye=0;Ye<Oi;++Ye)ht=D[Ye],ht>=z&&ht<Jt&&(Jt=ht);for(Lr=be+1,Jt-z>_((s-te)/Lr)&&x("overflow"),te+=(Jt-z)*Lr,z=Jt,Ye=0;Ye<Oi;++Ye)if(ht=D[Ye],ht<z&&++te>s&&x("overflow"),ht==z){for(Ai=te,Gi=o;yr=Gi<=It?a:Gi>=It+c?c:Gi-It,!(Ai<yr);Gi+=o)ov=Ai-yr,_n=o-yr,ui.push(P(Nt(yr+ov%_n,0))),Ai=_(ov/_n);ui.push(P(Nt(Ai,0))),It=Le(te,Lr,be==De),te=0,++be}++te,++z}return ui.join("")}function li(D){return G(D,function(z){return g.test(z)?Et(z.slice(4).toLowerCase()):z})}function yn(D){return G(D,function(z){return m.test(z)?"xn--"+Rt(z):z})}if(n={version:"1.4.1",ucs2:{decode:ee,encode:de},decode:Et,encode:Rt,toASCII:yn,toUnicode:li},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return n});else if(e&&t)if(io.exports==e)t.exports=n;else for(O in n)n.hasOwnProperty(O)&&(e[O]=n[O]);else i.punycode=n})(to)});var EE=p((h9,PE)=>{"use strict";PE.exports=Error});var IE=p((p9,RE)=>{"use strict";RE.exports=EvalError});var AE=p((d9,TE)=>{"use strict";TE.exports=RangeError});var DE=p((f9,OE)=>{"use strict";OE.exports=ReferenceError});var pm=p((v9,xE)=>{"use strict";xE.exports=SyntaxError});var ro=p((g9,ME)=>{"use strict";ME.exports=TypeError});var NE=p((m9,kE)=>{"use strict";kE.exports=URIError});var wu=p((y9,LE)=>{"use strict";LE.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==n||o.enumerable!==!0)return!1}return!0}});var qE=p((_9,zE)=>{"use strict";var jE=typeof Symbol<"u"&&Symbol,ZL=wu();zE.exports=function(){return typeof jE!="function"||typeof Symbol!="function"||typeof jE("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:ZL()}});var BE=p((S9,FE)=>{"use strict";var dm={__proto__:null,foo:{}},QL=Object;FE.exports=function(){return{__proto__:dm}.foo===dm.foo&&!(dm instanceof QL)}});var UE=p((C9,HE)=>{"use strict";var ej="Function.prototype.bind called on incompatible ",tj=Object.prototype.toString,ij=Math.max,rj="[object Function]",WE=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var s=0;s<t.length;s+=1)r[s+e.length]=t[s];return r},nj=function(e,t){for(var r=[],n=t||0,s=0;n<e.length;n+=1,s+=1)r[s]=e[n];return r},sj=function(i,e){for(var t="",r=0;r<i.length;r+=1)t+=i[r],r+1<i.length&&(t+=e);return t};HE.exports=function(e){var t=this;if(typeof t!="function"||tj.apply(t)!==rj)throw new TypeError(ej+t);for(var r=nj(arguments,1),n,s=function(){if(this instanceof n){var u=t.apply(this,WE(r,arguments));return Object(u)===u?u:this}return t.apply(e,WE(r,arguments))},o=ij(0,t.length-r.length),a=[],c=0;c<o;c++)a[c]="$"+c;if(n=Function("binder","return function ("+sj(a,",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var l=function(){};l.prototype=t.prototype,n.prototype=new l,l.prototype=null}return n}});var Pu=p((b9,VE)=>{"use strict";var oj=UE();VE.exports=Function.prototype.bind||oj});var $E=p((w9,KE)=>{"use strict";var aj=Function.prototype.call,cj=Object.prototype.hasOwnProperty,lj=Pu();KE.exports=lj.call(aj,cj)});var Hn=p((P9,ZE)=>{"use strict";var Z,uj=EE(),hj=IE(),pj=AE(),dj=DE(),ao=pm(),oo=ro(),fj=NE(),XE=Function,fm=function(i){try{return XE('"use strict"; return ('+i+").constructor;")()}catch{}},Bn=Object.getOwnPropertyDescriptor;if(Bn)try{Bn({},"")}catch{Bn=null}var vm=function(){throw new oo},vj=Bn?function(){try{return arguments.callee,vm}catch{try{return Bn(arguments,"callee").get}catch{return vm}}}():vm,no=qE()(),gj=BE()(),Ke=Object.getPrototypeOf||(gj?function(i){return i.__proto__}:null),so={},mj=typeof Uint8Array>"u"||!Ke?Z:Ke(Uint8Array),Wn={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Z:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Z:ArrayBuffer,"%ArrayIteratorPrototype%":no&&Ke?Ke([][Symbol.iterator]()):Z,"%AsyncFromSyncIteratorPrototype%":Z,"%AsyncFunction%":so,"%AsyncGenerator%":so,"%AsyncGeneratorFunction%":so,"%AsyncIteratorPrototype%":so,"%Atomics%":typeof Atomics>"u"?Z:Atomics,"%BigInt%":typeof BigInt>"u"?Z:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Z:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Z:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Z:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":uj,"%eval%":eval,"%EvalError%":hj,"%Float32Array%":typeof Float32Array>"u"?Z:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Z:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Z:FinalizationRegistry,"%Function%":XE,"%GeneratorFunction%":so,"%Int8Array%":typeof Int8Array>"u"?Z:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Z:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Z:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":no&&Ke?Ke(Ke([][Symbol.iterator]())):Z,"%JSON%":typeof JSON=="object"?JSON:Z,"%Map%":typeof Map>"u"?Z:Map,"%MapIteratorPrototype%":typeof Map>"u"||!no||!Ke?Z:Ke(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Z:Promise,"%Proxy%":typeof Proxy>"u"?Z:Proxy,"%RangeError%":pj,"%ReferenceError%":dj,"%Reflect%":typeof Reflect>"u"?Z:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Z:Set,"%SetIteratorPrototype%":typeof Set>"u"||!no||!Ke?Z:Ke(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Z:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":no&&Ke?Ke(""[Symbol.iterator]()):Z,"%Symbol%":no?Symbol:Z,"%SyntaxError%":ao,"%ThrowTypeError%":vj,"%TypedArray%":mj,"%TypeError%":oo,"%Uint8Array%":typeof Uint8Array>"u"?Z:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Z:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Z:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Z:Uint32Array,"%URIError%":fj,"%WeakMap%":typeof WeakMap>"u"?Z:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Z:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Z:WeakSet};if(Ke)try{null.error}catch(i){GE=Ke(Ke(i)),Wn["%Error.prototype%"]=GE}var GE,yj=function i(e){var t;if(e==="%AsyncFunction%")t=fm("async function () {}");else if(e==="%GeneratorFunction%")t=fm("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=fm("async function* () {}");else if(e==="%AsyncGenerator%"){var r=i("%AsyncGeneratorFunction%");r&&(t=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=i("%AsyncGenerator%");n&&Ke&&(t=Ke(n.prototype))}return Wn[e]=t,t},YE={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ia=Pu(),Eu=$E(),_j=Ia.call(Function.call,Array.prototype.concat),Sj=Ia.call(Function.apply,Array.prototype.splice),JE=Ia.call(Function.call,String.prototype.replace),Ru=Ia.call(Function.call,String.prototype.slice),Cj=Ia.call(Function.call,RegExp.prototype.exec),bj=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,wj=/\\(\\)?/g,Pj=function(e){var t=Ru(e,0,1),r=Ru(e,-1);if(t==="%"&&r!=="%")throw new ao("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&t!=="%")throw new ao("invalid intrinsic syntax, expected opening `%`");var n=[];return JE(e,bj,function(s,o,a,c){n[n.length]=a?JE(c,wj,"$1"):o||s}),n},Ej=function(e,t){var r=e,n;if(Eu(YE,r)&&(n=YE[r],r="%"+n[0]+"%"),Eu(Wn,r)){var s=Wn[r];if(s===so&&(s=yj(r)),typeof s>"u"&&!t)throw new oo("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:s}}throw new ao("intrinsic "+e+" does not exist!")};ZE.exports=function(e,t){if(typeof e!="string"||e.length===0)throw new oo("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new oo('"allowMissing" argument must be a boolean');if(Cj(/^%?[^%]*%?$/,e)===null)throw new ao("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=Pj(e),n=r.length>0?r[0]:"",s=Ej("%"+n+"%",t),o=s.name,a=s.value,c=!1,l=s.alias;l&&(n=l[0],Sj(r,_j([0,1],l)));for(var u=1,h=!0;u<r.length;u+=1){var d=r[u],f=Ru(d,0,1),g=Ru(d,-1);if((f==='"'||f==="'"||f==="`"||g==='"'||g==="'"||g==="`")&&f!==g)throw new ao("property names with quotes must have matching quotes");if((d==="constructor"||!h)&&(c=!0),n+="."+d,o="%"+n+"%",Eu(Wn,o))a=Wn[o];else if(a!=null){if(!(d in a)){if(!t)throw new oo("base intrinsic for "+e+" exists, but the property is not available.");return}if(Bn&&u+1>=r.length){var m=Bn(a,d);h=!!m,h&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else h=Eu(a,d),a=a[d];h&&!c&&(Wn[o]=a)}}return a}});var Tu=p((E9,QE)=>{"use strict";var Rj=Hn(),Iu=Rj("%Object.defineProperty%",!0)||!1;if(Iu)try{Iu({},"a",{value:1})}catch{Iu=!1}QE.exports=Iu});var Ou=p((R9,eR)=>{"use strict";var Ij=Hn(),Au=Ij("%Object.getOwnPropertyDescriptor%",!0);if(Au)try{Au([],"length")}catch{Au=null}eR.exports=Au});var gm=p((I9,rR)=>{"use strict";var tR=Tu(),Tj=pm(),co=ro(),iR=Ou();rR.exports=function(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")throw new co("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new co("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new co("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new co("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new co("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new co("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,s=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,c=!!iR&&iR(e,t);if(tR)tR(e,t,{configurable:o===null&&c?c.configurable:!o,enumerable:n===null&&c?c.enumerable:!n,value:r,writable:s===null&&c?c.writable:!s});else if(a||!n&&!s&&!o)e[t]=r;else throw new Tj("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var ym=p((T9,sR)=>{"use strict";var mm=Tu(),nR=function(){return!!mm};nR.hasArrayLengthDefineBug=function(){if(!mm)return null;try{return mm([],"length",{value:1}).length!==1}catch{return!0}};sR.exports=nR});var uR=p((A9,lR)=>{"use strict";var Aj=Hn(),oR=gm(),Oj=ym()(),aR=Ou(),cR=ro(),Dj=Aj("%Math.floor%");lR.exports=function(e,t){if(typeof e!="function")throw new cR("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||Dj(t)!==t)throw new cR("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],n=!0,s=!0;if("length"in e&&aR){var o=aR(e,"length");o&&!o.configurable&&(n=!1),o&&!o.writable&&(s=!1)}return(n||s||!r)&&(Oj?oR(e,"length",t,!0,!0):oR(e,"length",t)),e}});var Ta=p((O9,Du)=>{"use strict";var _m=Pu(),xu=Hn(),xj=uR(),Mj=ro(),dR=xu("%Function.prototype.apply%"),fR=xu("%Function.prototype.call%"),vR=xu("%Reflect.apply%",!0)||_m.call(fR,dR),hR=Tu(),kj=xu("%Math.max%");Du.exports=function(e){if(typeof e!="function")throw new Mj("a function is required");var t=vR(_m,fR,arguments);return xj(t,1+kj(0,e.length-(arguments.length-1)),!0)};var pR=function(){return vR(_m,dR,arguments)};hR?hR(Du.exports,"apply",{value:pR}):Du.exports.apply=pR});var lo=p((D9,yR)=>{"use strict";var gR=Hn(),mR=Ta(),Nj=mR(gR("String.prototype.indexOf"));yR.exports=function(e,t){var r=gR(e,!!t);return typeof r=="function"&&Nj(e,".prototype.")>-1?mR(r):r}});var _R=p(()=>{"use strict"});var qR=p((k9,zR)=>{"use strict";var Am=typeof Map=="function"&&Map.prototype,Sm=Object.getOwnPropertyDescriptor&&Am?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ku=Am&&Sm&&typeof Sm.get=="function"?Sm.get:null,SR=Am&&Map.prototype.forEach,Om=typeof Set=="function"&&Set.prototype,Cm=Object.getOwnPropertyDescriptor&&Om?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Nu=Om&&Cm&&typeof Cm.get=="function"?Cm.get:null,CR=Om&&Set.prototype.forEach,Lj=typeof WeakMap=="function"&&WeakMap.prototype,Oa=Lj?WeakMap.prototype.has:null,jj=typeof WeakSet=="function"&&WeakSet.prototype,Da=jj?WeakSet.prototype.has:null,zj=typeof WeakRef=="function"&&WeakRef.prototype,bR=zj?WeakRef.prototype.deref:null,qj=Boolean.prototype.valueOf,Fj=Object.prototype.toString,Bj=Function.prototype.toString,Wj=String.prototype.match,Dm=String.prototype.slice,Gr=String.prototype.replace,Hj=String.prototype.toUpperCase,wR=String.prototype.toLowerCase,xR=RegExp.prototype.test,PR=Array.prototype.concat,rr=Array.prototype.join,Uj=Array.prototype.slice,ER=Math.floor,Pm=typeof BigInt=="function"?BigInt.prototype.valueOf:null,bm=Object.getOwnPropertySymbols,Em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,uo=typeof Symbol=="function"&&typeof Symbol.iterator=="object",St=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===uo||!0)?Symbol.toStringTag:null,MR=Object.prototype.propertyIsEnumerable,RR=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(i){return i.__proto__}:null);function IR(i,e){if(i===1/0||i===-1/0||i!==i||i&&i>-1e3&&i<1e3||xR.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof i=="number"){var r=i<0?-ER(-i):ER(i);if(r!==i){var n=String(r),s=Dm.call(e,n.length+1);return Gr.call(n,t,"$&_")+"."+Gr.call(Gr.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Gr.call(e,t,"$&_")}var Rm=_R(),TR=Rm.custom,AR=NR(TR)?TR:null;zR.exports=function i(e,t,r,n){var s=t||{};if($r(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if($r(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=$r(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if($r(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if($r(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return jR(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return a?IR(e,c):c}if(typeof e=="bigint"){var l=String(e)+"n";return a?IR(e,l):l}var u=typeof s.depth>"u"?5:s.depth;if(typeof r>"u"&&(r=0),r>=u&&u>0&&typeof e=="object")return Im(e)?"[Array]":"[Object]";var h=cz(s,r);if(typeof n>"u")n=[];else if(LR(n,e)>=0)return"[Circular]";function d(Le,Et,Rt){if(Et&&(n=Uj.call(n),n.push(Et)),Rt){var li={depth:s.depth};return $r(s,"quoteStyle")&&(li.quoteStyle=s.quoteStyle),i(Le,li,r+1,n)}return i(Le,s,r+1,n)}if(typeof e=="function"&&!OR(e)){var f=Qj(e),g=Mu(e,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(g.length>0?" { "+rr.call(g,", ")+" }":"")}if(NR(e)){var m=uo?Gr.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Em.call(e);return typeof e=="object"&&!uo?Aa(m):m}if(sz(e)){for(var y="<"+wR.call(String(e.nodeName)),b=e.attributes||[],S=0;S<b.length;S++)y+=" "+b[S].name+"="+kR(Vj(b[S].value),"double",s);return y+=">",e.childNodes&&e.childNodes.length&&(y+="..."),y+="</"+wR.call(String(e.nodeName))+">",y}if(Im(e)){if(e.length===0)return"[]";var _=Mu(e,d);return h&&!az(_)?"["+Tm(_,h)+"]":"[ "+rr.call(_,", ")+" ]"}if($j(e)){var P=Mu(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!MR.call(e,"cause")?"{ ["+String(e)+"] "+rr.call(PR.call("[cause]: "+d(e.cause),P),", ")+" }":P.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+rr.call(P,", ")+" }"}if(typeof e=="object"&&o){if(AR&&typeof e[AR]=="function"&&Rm)return Rm(e,{depth:u-r});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(ez(e)){var O=[];return SR&&SR.call(e,function(Le,Et){O.push(d(Et,e,!0)+" => "+d(Le,e))}),DR("Map",ku.call(e),O,h)}if(rz(e)){var x=[];return CR&&CR.call(e,function(Le){x.push(d(Le,e))}),DR("Set",Nu.call(e),x,h)}if(tz(e))return wm("WeakMap");if(nz(e))return wm("WeakSet");if(iz(e))return wm("WeakRef");if(Yj(e))return Aa(d(Number(e)));if(Xj(e))return Aa(d(Pm.call(e)));if(Jj(e))return Aa(qj.call(e));if(Gj(e))return Aa(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof global<"u"&&e===global)return"{ [object globalThis] }";if(!Kj(e)&&!OR(e)){var ie=Mu(e,d),G=RR?RR(e)===Object.prototype:e instanceof Object||e.constructor===Object,ee=e instanceof Object?"":"null prototype",de=!G&&St&&Object(e)===e&&St in e?Dm.call(Yr(e),8,-1):ee?"Object":"",Yt=G||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",Nt=Yt+(de||ee?"["+rr.call(PR.call([],de||[],ee||[]),": ")+"] ":"");return ie.length===0?Nt+"{}":h?Nt+"{"+Tm(ie,h)+"}":Nt+"{ "+rr.call(ie,", ")+" }"}return String(e)};function kR(i,e,t){var r=(t.quoteStyle||e)==="double"?'"':"'";return r+i+r}function Vj(i){return Gr.call(String(i),/"/g,"&quot;")}function Im(i){return Yr(i)==="[object Array]"&&(!St||!(typeof i=="object"&&St in i))}function Kj(i){return Yr(i)==="[object Date]"&&(!St||!(typeof i=="object"&&St in i))}function OR(i){return Yr(i)==="[object RegExp]"&&(!St||!(typeof i=="object"&&St in i))}function $j(i){return Yr(i)==="[object Error]"&&(!St||!(typeof i=="object"&&St in i))}function Gj(i){return Yr(i)==="[object String]"&&(!St||!(typeof i=="object"&&St in i))}function Yj(i){return Yr(i)==="[object Number]"&&(!St||!(typeof i=="object"&&St in i))}function Jj(i){return Yr(i)==="[object Boolean]"&&(!St||!(typeof i=="object"&&St in i))}function NR(i){if(uo)return i&&typeof i=="object"&&i instanceof Symbol;if(typeof i=="symbol")return!0;if(!i||typeof i!="object"||!Em)return!1;try{return Em.call(i),!0}catch{}return!1}function Xj(i){if(!i||typeof i!="object"||!Pm)return!1;try{return Pm.call(i),!0}catch{}return!1}var Zj=Object.prototype.hasOwnProperty||function(i){return i in this};function $r(i,e){return Zj.call(i,e)}function Yr(i){return Fj.call(i)}function Qj(i){if(i.name)return i.name;var e=Wj.call(Bj.call(i),/^function\s*([\w$]+)/);return e?e[1]:null}function LR(i,e){if(i.indexOf)return i.indexOf(e);for(var t=0,r=i.length;t<r;t++)if(i[t]===e)return t;return-1}function ez(i){if(!ku||!i||typeof i!="object")return!1;try{ku.call(i);try{Nu.call(i)}catch{return!0}return i instanceof Map}catch{}return!1}function tz(i){if(!Oa||!i||typeof i!="object")return!1;try{Oa.call(i,Oa);try{Da.call(i,Da)}catch{return!0}return i instanceof WeakMap}catch{}return!1}function iz(i){if(!bR||!i||typeof i!="object")return!1;try{return bR.call(i),!0}catch{}return!1}function rz(i){if(!Nu||!i||typeof i!="object")return!1;try{Nu.call(i);try{ku.call(i)}catch{return!0}return i instanceof Set}catch{}return!1}function nz(i){if(!Da||!i||typeof i!="object")return!1;try{Da.call(i,Da);try{Oa.call(i,Oa)}catch{return!0}return i instanceof WeakSet}catch{}return!1}function sz(i){return!i||typeof i!="object"?!1:typeof HTMLElement<"u"&&i instanceof HTMLElement?!0:typeof i.nodeName=="string"&&typeof i.getAttribute=="function"}function jR(i,e){if(i.length>e.maxStringLength){var t=i.length-e.maxStringLength,r="... "+t+" more character"+(t>1?"s":"");return jR(Dm.call(i,0,e.maxStringLength),e)+r}var n=Gr.call(Gr.call(i,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,oz);return kR(n,"single",e)}function oz(i){var e=i.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+Hj.call(e.toString(16))}function Aa(i){return"Object("+i+")"}function wm(i){return i+" { ? }"}function DR(i,e,t,r){var n=r?Tm(t,r):rr.call(t,", ");return i+" ("+e+") {"+n+"}"}function az(i){for(var e=0;e<i.length;e++)if(LR(i[e],`
`)>=0)return!1;return!0}function cz(i,e){var t;if(i.indent==="	")t="	";else if(typeof i.indent=="number"&&i.indent>0)t=rr.call(Array(i.indent+1)," ");else return null;return{base:t,prev:rr.call(Array(e+1),t)}}function Tm(i,e){if(i.length===0)return"";var t=`
`+e.prev+e.base;return t+rr.call(i,","+t)+`
`+e.prev}function Mu(i,e){var t=Im(i),r=[];if(t){r.length=i.length;for(var n=0;n<i.length;n++)r[n]=$r(i,n)?e(i[n],i):""}var s=typeof bm=="function"?bm(i):[],o;if(uo){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var c in i)$r(i,c)&&(t&&String(Number(c))===c&&c<i.length||uo&&o["$"+c]instanceof Symbol||(xR.call(/[^\w$]/,c)?r.push(e(c,i)+": "+e(i[c],i)):r.push(c+": "+e(i[c],i))));if(typeof bm=="function")for(var l=0;l<s.length;l++)MR.call(i,s[l])&&r.push("["+e(s[l])+"]: "+e(i[s[l]],i));return r}});var WR=p((N9,BR)=>{"use strict";var FR=Hn(),ho=lo(),lz=qR(),uz=ro(),Lu=FR("%WeakMap%",!0),ju=FR("%Map%",!0),hz=ho("WeakMap.prototype.get",!0),pz=ho("WeakMap.prototype.set",!0),dz=ho("WeakMap.prototype.has",!0),fz=ho("Map.prototype.get",!0),vz=ho("Map.prototype.set",!0),gz=ho("Map.prototype.has",!0),xm=function(i,e){for(var t=i,r;(r=t.next)!==null;t=r)if(r.key===e)return t.next=r.next,r.next=i.next,i.next=r,r},mz=function(i,e){var t=xm(i,e);return t&&t.value},yz=function(i,e,t){var r=xm(i,e);r?r.value=t:i.next={key:e,next:i.next,value:t}},_z=function(i,e){return!!xm(i,e)};BR.exports=function(){var e,t,r,n={assert:function(s){if(!n.has(s))throw new uz("Side channel does not contain "+lz(s))},get:function(s){if(Lu&&s&&(typeof s=="object"||typeof s=="function")){if(e)return hz(e,s)}else if(ju){if(t)return fz(t,s)}else if(r)return mz(r,s)},has:function(s){if(Lu&&s&&(typeof s=="object"||typeof s=="function")){if(e)return dz(e,s)}else if(ju){if(t)return gz(t,s)}else if(r)return _z(r,s);return!1},set:function(s,o){Lu&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new Lu),pz(e,s,o)):ju?(t||(t=new ju),vz(t,s,o)):(r||(r={key:{},next:null}),yz(r,s,o))}};return n}});var zu=p((L9,HR)=>{"use strict";var Sz=String.prototype.replace,Cz=/%20/g,Mm={RFC1738:"RFC1738",RFC3986:"RFC3986"};HR.exports={default:Mm.RFC3986,formatters:{RFC1738:function(i){return Sz.call(i,Cz,"+")},RFC3986:function(i){return String(i)}},RFC1738:Mm.RFC1738,RFC3986:Mm.RFC3986}});var Lm=p((j9,VR)=>{"use strict";var bz=zu(),km=Object.prototype.hasOwnProperty,Un=Array.isArray,nr=function(){for(var i=[],e=0;e<256;++e)i.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return i}(),wz=function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(Un(r)){for(var n=[],s=0;s<r.length;++s)typeof r[s]<"u"&&n.push(r[s]);t.obj[t.prop]=n}}},UR=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)typeof e[n]<"u"&&(r[n]=e[n]);return r},Pz=function i(e,t,r){if(!t)return e;if(typeof t!="object"){if(Un(e))e.push(t);else if(e&&typeof e=="object")(r&&(r.plainObjects||r.allowPrototypes)||!km.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var n=e;return Un(e)&&!Un(t)&&(n=UR(e,r)),Un(e)&&Un(t)?(t.forEach(function(s,o){if(km.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=i(a,s,r):e.push(s)}else e[o]=s}),e):Object.keys(t).reduce(function(s,o){var a=t[o];return km.call(s,o)?s[o]=i(s[o],a,r):s[o]=a,s},n)},Ez=function(e,t){return Object.keys(t).reduce(function(r,n){return r[n]=t[n],r},e)},Rz=function(i,e,t){var r=i.replace(/\+/g," ");if(t==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},Nm=1024,Iz=function(e,t,r,n,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),r==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var a="",c=0;c<o.length;c+=Nm){for(var l=o.length>=Nm?o.slice(c,c+Nm):o,u=[],h=0;h<l.length;++h){var d=l.charCodeAt(h);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===bz.RFC1738&&(d===40||d===41)){u[u.length]=l.charAt(h);continue}if(d<128){u[u.length]=nr[d];continue}if(d<2048){u[u.length]=nr[192|d>>6]+nr[128|d&63];continue}if(d<55296||d>=57344){u[u.length]=nr[224|d>>12]+nr[128|d>>6&63]+nr[128|d&63];continue}h+=1,d=65536+((d&1023)<<10|l.charCodeAt(h)&1023),u[u.length]=nr[240|d>>18]+nr[128|d>>12&63]+nr[128|d>>6&63]+nr[128|d&63]}a+=u.join("")}return a},Tz=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var s=t[n],o=s.obj[s.prop],a=Object.keys(o),c=0;c<a.length;++c){var l=a[c],u=o[l];typeof u=="object"&&u!==null&&r.indexOf(u)===-1&&(t.push({obj:o,prop:l}),r.push(u))}return wz(t),e},Az=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},Oz=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},Dz=function(e,t){return[].concat(e,t)},xz=function(e,t){if(Un(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)};VR.exports={arrayToObject:UR,assign:Ez,combine:Dz,compact:Tz,decode:Rz,encode:Iz,isBuffer:Oz,isRegExp:Az,maybeMap:xz,merge:Pz}});var XR=p((z9,JR)=>{"use strict";var $R=WR(),qu=Lm(),xa=zu(),Mz=Object.prototype.hasOwnProperty,GR={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},sr=Array.isArray,kz=Array.prototype.push,YR=function(i,e){kz.apply(i,sr(e)?e:[e])},Nz=Date.prototype.toISOString,KR=xa.default,Ue={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:qu.encode,encodeValuesOnly:!1,format:KR,formatter:xa.formatters[KR],indices:!1,serializeDate:function(e){return Nz.call(e)},skipNulls:!1,strictNullHandling:!1},Lz=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},jm={},jz=function i(e,t,r,n,s,o,a,c,l,u,h,d,f,g,m,y,b,S){for(var _=e,P=S,O=0,x=!1;(P=P.get(jm))!==void 0&&!x;){var ie=P.get(e);if(O+=1,typeof ie<"u"){if(ie===O)throw new RangeError("Cyclic object value");x=!0}typeof P.get(jm)>"u"&&(O=0)}if(typeof u=="function"?_=u(t,_):_ instanceof Date?_=f(_):r==="comma"&&sr(_)&&(_=qu.maybeMap(_,function(te){return te instanceof Date?f(te):te})),_===null){if(o)return l&&!y?l(t,Ue.encoder,b,"key",g):t;_=""}if(Lz(_)||qu.isBuffer(_)){if(l){var G=y?t:l(t,Ue.encoder,b,"key",g);return[m(G)+"="+m(l(_,Ue.encoder,b,"value",g))]}return[m(t)+"="+m(String(_))]}var ee=[];if(typeof _>"u")return ee;var de;if(r==="comma"&&sr(_))y&&l&&(_=qu.maybeMap(_,l)),de=[{value:_.length>0?_.join(",")||null:void 0}];else if(sr(u))de=u;else{var Yt=Object.keys(_);de=h?Yt.sort(h):Yt}var Nt=c?t.replace(/\./g,"%2E"):t,Le=n&&sr(_)&&_.length===1?Nt+"[]":Nt;if(s&&sr(_)&&_.length===0)return Le+"[]";for(var Et=0;Et<de.length;++Et){var Rt=de[Et],li=typeof Rt=="object"&&typeof Rt.value<"u"?Rt.value:_[Rt];if(!(a&&li===null)){var yn=d&&c?Rt.replace(/\./g,"%2E"):Rt,D=sr(_)?typeof r=="function"?r(Le,yn):Le:Le+(d?"."+yn:"["+yn+"]");S.set(e,O);var z=$R();z.set(jm,S),YR(ee,i(li,D,r,n,s,o,a,c,r==="comma"&&y&&sr(_)?null:l,u,h,d,f,g,m,y,b,z))}}return ee},zz=function(e){if(!e)return Ue;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||Ue.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=xa.default;if(typeof e.format<"u"){if(!Mz.call(xa.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=xa.formatters[r],s=Ue.filter;(typeof e.filter=="function"||sr(e.filter))&&(s=e.filter);var o;if(e.arrayFormat in GR?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=Ue.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Ue.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Ue.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Ue.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ue.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Ue.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Ue.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Ue.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Ue.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Ue.encodeValuesOnly,filter:s,format:r,formatter:n,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Ue.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Ue.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ue.strictNullHandling}};JR.exports=function(i,e){var t=i,r=zz(e),n,s;typeof r.filter=="function"?(s=r.filter,t=s("",t)):sr(r.filter)&&(s=r.filter,n=s);var o=[];if(typeof t!="object"||t===null)return"";var a=GR[r.arrayFormat],c=a==="comma"&&r.commaRoundTrip;n||(n=Object.keys(t)),r.sort&&n.sort(r.sort);for(var l=$R(),u=0;u<n.length;++u){var h=n[u];r.skipNulls&&t[h]===null||YR(o,jz(t[h],h,a,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}var d=o.join(r.delimiter),f=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),d.length>0?f+d:""}});var eI=p((q9,QR)=>{"use strict";var po=Lm(),zm=Object.prototype.hasOwnProperty,qz=Array.isArray,Oe={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:po.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},Fz=function(i){return i.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},ZR=function(i,e){return i&&typeof i=="string"&&e.comma&&i.indexOf(",")>-1?i.split(","):i},Bz="utf8=%26%2310003%3B",Wz="utf8=%E2%9C%93",Hz=function(e,t){var r={__proto__:null},n=t.ignoreQueryPrefix?e.replace(/^\?/,""):e;n=n.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=t.parameterLimit===1/0?void 0:t.parameterLimit,o=n.split(t.delimiter,s),a=-1,c,l=t.charset;if(t.charsetSentinel)for(c=0;c<o.length;++c)o[c].indexOf("utf8=")===0&&(o[c]===Wz?l="utf-8":o[c]===Bz&&(l="iso-8859-1"),a=c,c=o.length);for(c=0;c<o.length;++c)if(c!==a){var u=o[c],h=u.indexOf("]="),d=h===-1?u.indexOf("="):h+1,f,g;d===-1?(f=t.decoder(u,Oe.decoder,l,"key"),g=t.strictNullHandling?null:""):(f=t.decoder(u.slice(0,d),Oe.decoder,l,"key"),g=po.maybeMap(ZR(u.slice(d+1),t),function(y){return t.decoder(y,Oe.decoder,l,"value")})),g&&t.interpretNumericEntities&&l==="iso-8859-1"&&(g=Fz(g)),u.indexOf("[]=")>-1&&(g=qz(g)?[g]:g);var m=zm.call(r,f);m&&t.duplicates==="combine"?r[f]=po.combine(r[f],g):(!m||t.duplicates==="last")&&(r[f]=g)}return r},Uz=function(i,e,t,r){for(var n=r?e:ZR(e,t),s=i.length-1;s>=0;--s){var o,a=i[s];if(a==="[]"&&t.parseArrays)o=t.allowEmptyArrays&&(n===""||t.strictNullHandling&&n===null)?[]:[].concat(n);else{o=t.plainObjects?Object.create(null):{};var c=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,l=t.decodeDotInKeys?c.replace(/%2E/g,"."):c,u=parseInt(l,10);!t.parseArrays&&l===""?o={0:n}:!isNaN(u)&&a!==l&&String(u)===l&&u>=0&&t.parseArrays&&u<=t.arrayLimit?(o=[],o[u]=n):l!=="__proto__"&&(o[l]=n)}n=o}return n},Vz=function(e,t,r,n){if(e){var s=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,c=r.depth>0&&o.exec(s),l=c?s.slice(0,c.index):s,u=[];if(l){if(!r.plainObjects&&zm.call(Object.prototype,l)&&!r.allowPrototypes)return;u.push(l)}for(var h=0;r.depth>0&&(c=a.exec(s))!==null&&h<r.depth;){if(h+=1,!r.plainObjects&&zm.call(Object.prototype,c[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(c[1])}if(c){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");u.push("["+s.slice(c.index)+"]")}return Uz(u,t,r,n)}},Kz=function(e){if(!e)return Oe;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?Oe.charset:e.charset,r=typeof e.duplicates>"u"?Oe.duplicates:e.duplicates;if(r!=="combine"&&r!=="first"&&r!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var n=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:Oe.allowDots:!!e.allowDots;return{allowDots:n,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Oe.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Oe.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Oe.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Oe.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Oe.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Oe.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:Oe.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:Oe.decoder,delimiter:typeof e.delimiter=="string"||po.isRegExp(e.delimiter)?e.delimiter:Oe.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Oe.depth,duplicates:r,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Oe.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Oe.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Oe.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:Oe.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Oe.strictNullHandling}};QR.exports=function(i,e){var t=Kz(e);if(i===""||i===null||typeof i>"u")return t.plainObjects?Object.create(null):{};for(var r=typeof i=="string"?Hz(i,t):i,n=t.plainObjects?Object.create(null):{},s=Object.keys(r),o=0;o<s.length;++o){var a=s[o],c=Vz(a,r[a],t,typeof i=="string");n=po.merge(n,c,t)}return t.allowSparse===!0?n:po.compact(n)}});var iI=p((F9,tI)=>{"use strict";var $z=XR(),Gz=eI(),Yz=zu();tI.exports={formats:Yz,parse:Gz,stringify:$z}});var oI=p(vo=>{"use strict";var Jz=wE();function di(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Xz=/^([a-z0-9.+-]+:)/i,Zz=/:[0-9]*$/,Qz=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,eq=["<",">",'"',"`"," ","\r",`
`,"	"],tq=["{","}","|","\\","^","`"].concat(eq),qm=["'"].concat(tq),rI=["%","/","?",";","#"].concat(qm),nI=["/","?","#"],iq=255,sI=/^[+a-z0-9A-Z_-]{0,63}$/,rq=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,nq={javascript:!0,"javascript:":!0},Fm={javascript:!0,"javascript:":!0},fo={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Bm=iI();function Ma(i,e,t){if(i&&typeof i=="object"&&i instanceof di)return i;var r=new di;return r.parse(i,e,t),r}di.prototype.parse=function(i,e,t){if(typeof i!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var r=i.indexOf("?"),n=r!==-1&&r<i.indexOf("#")?"?":"#",s=i.split(n),o=/\\/g;s[0]=s[0].replace(o,"/"),i=s.join(n);var a=i;if(a=a.trim(),!t&&i.split("#").length===1){var c=Qz.exec(a);if(c)return this.path=a,this.href=a,this.pathname=c[1],c[2]?(this.search=c[2],e?this.query=Bm.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var l=Xz.exec(a);if(l){l=l[0];var u=l.toLowerCase();this.protocol=u,a=a.substr(l.length)}if(t||l||a.match(/^\/\/[^@/]+@[^@/]+/)){var h=a.substr(0,2)==="//";h&&!(l&&Fm[l])&&(a=a.substr(2),this.slashes=!0)}if(!Fm[l]&&(h||l&&!fo[l])){for(var d=-1,f=0;f<nI.length;f++){var g=a.indexOf(nI[f]);g!==-1&&(d===-1||g<d)&&(d=g)}var m,y;d===-1?y=a.lastIndexOf("@"):y=a.lastIndexOf("@",d),y!==-1&&(m=a.slice(0,y),a=a.slice(y+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<rI.length;f++){var g=a.indexOf(rI[f]);g!==-1&&(d===-1||g<d)&&(d=g)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var b=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!b)for(var S=this.hostname.split(/\./),f=0,_=S.length;f<_;f++){var P=S[f];if(P&&!P.match(sI)){for(var O="",x=0,ie=P.length;x<ie;x++)P.charCodeAt(x)>127?O+="x":O+=P[x];if(!O.match(sI)){var G=S.slice(0,f),ee=S.slice(f+1),de=P.match(rq);de&&(G.push(de[1]),ee.unshift(de[2])),ee.length&&(a="/"+ee.join(".")+a),this.hostname=G.join(".");break}}}this.hostname.length>iq?this.hostname="":this.hostname=this.hostname.toLowerCase(),b||(this.hostname=Jz.toASCII(this.hostname));var Yt=this.port?":"+this.port:"",Nt=this.hostname||"";this.host=Nt+Yt,this.href+=this.host,b&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!nq[u])for(var f=0,_=qm.length;f<_;f++){var Le=qm[f];if(a.indexOf(Le)!==-1){var Et=encodeURIComponent(Le);Et===Le&&(Et=escape(Le)),a=a.split(Le).join(Et)}}var Rt=a.indexOf("#");Rt!==-1&&(this.hash=a.substr(Rt),a=a.slice(0,Rt));var li=a.indexOf("?");if(li!==-1?(this.search=a.substr(li),this.query=a.substr(li+1),e&&(this.query=Bm.parse(this.query)),a=a.slice(0,li)):e&&(this.search="",this.query={}),a&&(this.pathname=a),fo[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var Yt=this.pathname||"",yn=this.search||"";this.path=Yt+yn}return this.href=this.format(),this};function sq(i){return typeof i=="string"&&(i=Ma(i)),i instanceof di?i.format():di.prototype.format.call(i)}di.prototype.format=function(){var i=this.auth||"";i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":"),i+="@");var e=this.protocol||"",t=this.pathname||"",r=this.hash||"",n=!1,s="";this.host?n=i+this.host:this.hostname&&(n=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=Bm.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||fo[e])&&n!==!1?(n="//"+(n||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):n||(n=""),r&&r.charAt(0)!=="#"&&(r="#"+r),o&&o.charAt(0)!=="?"&&(o="?"+o),t=t.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+n+t+o+r};function oq(i,e){return Ma(i,!1,!0).resolve(e)}di.prototype.resolve=function(i){return this.resolveObject(Ma(i,!1,!0)).format()};function aq(i,e){return i?Ma(i,!1,!0).resolveObject(e):e}di.prototype.resolveObject=function(i){if(typeof i=="string"){var e=new di;e.parse(i,!1,!0),i=e}for(var t=new di,r=Object.keys(this),n=0;n<r.length;n++){var s=r[n];t[s]=this[s]}if(t.hash=i.hash,i.href==="")return t.href=t.format(),t;if(i.slashes&&!i.protocol){for(var o=Object.keys(i),a=0;a<o.length;a++){var c=o[a];c!=="protocol"&&(t[c]=i[c])}return fo[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(i.protocol&&i.protocol!==t.protocol){if(!fo[i.protocol]){for(var l=Object.keys(i),u=0;u<l.length;u++){var h=l[u];t[h]=i[h]}return t.href=t.format(),t}if(t.protocol=i.protocol,!i.host&&!Fm[i.protocol]){for(var _=(i.pathname||"").split("/");_.length&&!(i.host=_.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),t.pathname=_.join("/")}else t.pathname=i.pathname;if(t.search=i.search,t.query=i.query,t.host=i.host||"",t.auth=i.auth,t.hostname=i.hostname||i.host,t.port=i.port,t.pathname||t.search){var d=t.pathname||"",f=t.search||"";t.path=d+f}return t.slashes=t.slashes||i.slashes,t.href=t.format(),t}var g=t.pathname&&t.pathname.charAt(0)==="/",m=i.host||i.pathname&&i.pathname.charAt(0)==="/",y=m||g||t.host&&i.pathname,b=y,S=t.pathname&&t.pathname.split("/")||[],_=i.pathname&&i.pathname.split("/")||[],P=t.protocol&&!fo[t.protocol];if(P&&(t.hostname="",t.port=null,t.host&&(S[0]===""?S[0]=t.host:S.unshift(t.host)),t.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(_[0]===""?_[0]=i.host:_.unshift(i.host)),i.host=null),y=y&&(_[0]===""||S[0]==="")),m)t.host=i.host||i.host===""?i.host:t.host,t.hostname=i.hostname||i.hostname===""?i.hostname:t.hostname,t.search=i.search,t.query=i.query,S=_;else if(_.length)S||(S=[]),S.pop(),S=S.concat(_),t.search=i.search,t.query=i.query;else if(i.search!=null){if(P){t.host=S.shift(),t.hostname=t.host;var O=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;O&&(t.auth=O.shift(),t.hostname=O.shift(),t.host=t.hostname)}return t.search=i.search,t.query=i.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!S.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var x=S.slice(-1)[0],ie=(t.host||i.host||S.length>1)&&(x==="."||x==="..")||x==="",G=0,ee=S.length;ee>=0;ee--)x=S[ee],x==="."?S.splice(ee,1):x===".."?(S.splice(ee,1),G++):G&&(S.splice(ee,1),G--);if(!y&&!b)for(;G--;G)S.unshift("..");y&&S[0]!==""&&(!S[0]||S[0].charAt(0)!=="/")&&S.unshift(""),ie&&S.join("/").substr(-1)!=="/"&&S.push("");var de=S[0]===""||S[0]&&S[0].charAt(0)==="/";if(P){t.hostname=de?"":S.length?S.shift():"",t.host=t.hostname;var O=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;O&&(t.auth=O.shift(),t.hostname=O.shift(),t.host=t.hostname)}return y=y||t.host&&S.length,y&&!de&&S.unshift(""),S.length>0?t.pathname=S.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=i.auth||t.auth,t.slashes=t.slashes||i.slashes,t.href=t.format(),t};di.prototype.parseHost=function(){var i=this.host,e=Zz.exec(i);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),i=i.substr(0,i.length-e.length)),i&&(this.hostname=i)};vo.parse=Ma;vo.resolve=oq;vo.resolveObject=aq;vo.format=sq;vo.Url=di});var Fu=p((W9,aI)=>{"use strict";var cq=wu();aI.exports=function(){return cq()&&!!Symbol.toStringTag}});var uI=p((H9,lI)=>{"use strict";var lq=Fu()(),uq=lo(),Wm=uq("Object.prototype.toString"),Bu=function(e){return lq&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:Wm(e)==="[object Arguments]"},cI=function(e){return Bu(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Wm(e)!=="[object Array]"&&Wm(e.callee)==="[object Function]"},hq=function(){return Bu(arguments)}();Bu.isLegacyArguments=cI;lI.exports=hq?Bu:cI});var dI=p((U9,pI)=>{"use strict";var pq=Object.prototype.toString,dq=Function.prototype.toString,fq=/^\s*(?:function)?\*/,hI=Fu()(),Hm=Object.getPrototypeOf,vq=function(){if(!hI)return!1;try{return Function("return function*() {}")()}catch{}},Um;pI.exports=function(e){if(typeof e!="function")return!1;if(fq.test(dq.call(e)))return!0;if(!hI){var t=pq.call(e);return t==="[object GeneratorFunction]"}if(!Hm)return!1;if(typeof Um>"u"){var r=vq();Um=r?Hm(r):!1}return Hm(e)===Um}});var mI=p((V9,gI)=>{"use strict";var vI=Function.prototype.toString,go=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,Km,Wu;if(typeof go=="function"&&typeof Object.defineProperty=="function")try{Km=Object.defineProperty({},"length",{get:function(){throw Wu}}),Wu={},go(function(){throw 42},null,Km)}catch(i){i!==Wu&&(go=null)}else go=null;var gq=/^\s*class\b/,$m=function(e){try{var t=vI.call(e);return gq.test(t)}catch{return!1}},Vm=function(e){try{return $m(e)?!1:(vI.call(e),!0)}catch{return!1}},Hu=Object.prototype.toString,mq="[object Object]",yq="[object Function]",_q="[object GeneratorFunction]",Sq="[object HTMLAllCollection]",Cq="[object HTML document.all class]",bq="[object HTMLCollection]",wq=typeof Symbol=="function"&&!!Symbol.toStringTag,Pq=!(0 in[,]),Gm=function(){return!1};typeof document=="object"&&(fI=document.all,Hu.call(fI)===Hu.call(document.all)&&(Gm=function(e){if((Pq||!e)&&(typeof e>"u"||typeof e=="object"))try{var t=Hu.call(e);return(t===Sq||t===Cq||t===bq||t===mq)&&e("")==null}catch{}return!1}));var fI;gI.exports=go?function(e){if(Gm(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{go(e,null,Km)}catch(t){if(t!==Wu)return!1}return!$m(e)&&Vm(e)}:function(e){if(Gm(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(wq)return Vm(e);if($m(e))return!1;var t=Hu.call(e);return t!==yq&&t!==_q&&!/^\[object HTML/.test(t)?!1:Vm(e)}});var SI=p((K9,_I)=>{"use strict";var Eq=mI(),Rq=Object.prototype.toString,yI=Object.prototype.hasOwnProperty,Iq=function(e,t,r){for(var n=0,s=e.length;n<s;n++)yI.call(e,n)&&(r==null?t(e[n],n,e):t.call(r,e[n],n,e))},Tq=function(e,t,r){for(var n=0,s=e.length;n<s;n++)r==null?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)},Aq=function(e,t,r){for(var n in e)yI.call(e,n)&&(r==null?t(e[n],n,e):t.call(r,e[n],n,e))},Oq=function(e,t,r){if(!Eq(t))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=r),Rq.call(e)==="[object Array]"?Iq(e,t,n):typeof e=="string"?Tq(e,t,n):Aq(e,t,n)};_I.exports=Oq});var bI=p(($9,CI)=>{"use strict";CI.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]});var PI=p((G9,wI)=>{"use strict";var Ym=bI(),Dq=typeof globalThis>"u"?global:globalThis;wI.exports=function(){for(var e=[],t=0;t<Ym.length;t++)typeof Dq[Ym[t]]=="function"&&(e[e.length]=Ym[t]);return e}});var ey=p((Y9,TI)=>{"use strict";var Vu=SI(),xq=PI(),EI=Ta(),Zm=lo(),Uu=Ou(),Mq=Zm("Object.prototype.toString"),II=Fu()(),RI=typeof globalThis>"u"?global:globalThis,Xm=xq(),Qm=Zm("String.prototype.slice"),Jm=Object.getPrototypeOf,kq=Zm("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},Ku={__proto__:null};II&&Uu&&Jm?Vu(Xm,function(i){var e=new RI[i];if(Symbol.toStringTag in e){var t=Jm(e),r=Uu(t,Symbol.toStringTag);if(!r){var n=Jm(t);r=Uu(n,Symbol.toStringTag)}Ku["$"+i]=EI(r.get)}}):Vu(Xm,function(i){var e=new RI[i],t=e.slice||e.set;t&&(Ku["$"+i]=EI(t))});var Nq=function(e){var t=!1;return Vu(Ku,function(r,n){if(!t)try{"$"+r(e)===n&&(t=Qm(n,1))}catch{}}),t},Lq=function(e){var t=!1;return Vu(Ku,function(r,n){if(!t)try{r(e),t=Qm(n,1)}catch{}}),t};TI.exports=function(e){if(!e||typeof e!="object")return!1;if(!II){var t=Qm(Mq(e),8,-1);return kq(Xm,t)>-1?t:t!=="Object"?!1:Lq(e)}return Uu?Nq(e):null}});var OI=p((J9,AI)=>{"use strict";var jq=ey();AI.exports=function(e){return!!jq(e)}});var UI=p(Y=>{"use strict";var zq=uI(),qq=dI(),Ni=ey(),DI=OI();function mo(i){return i.call.bind(i)}var xI=typeof BigInt<"u",MI=typeof Symbol<"u",fi=mo(Object.prototype.toString),Fq=mo(Number.prototype.valueOf),Bq=mo(String.prototype.valueOf),Wq=mo(Boolean.prototype.valueOf);xI&&(kI=mo(BigInt.prototype.valueOf));var kI;MI&&(NI=mo(Symbol.prototype.valueOf));var NI;function Na(i,e){if(typeof i!="object")return!1;try{return e(i),!0}catch{return!1}}Y.isArgumentsObject=zq;Y.isGeneratorFunction=qq;Y.isTypedArray=DI;function Hq(i){return typeof Promise<"u"&&i instanceof Promise||i!==null&&typeof i=="object"&&typeof i.then=="function"&&typeof i.catch=="function"}Y.isPromise=Hq;function Uq(i){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(i):DI(i)||jI(i)}Y.isArrayBufferView=Uq;function Vq(i){return Ni(i)==="Uint8Array"}Y.isUint8Array=Vq;function Kq(i){return Ni(i)==="Uint8ClampedArray"}Y.isUint8ClampedArray=Kq;function $q(i){return Ni(i)==="Uint16Array"}Y.isUint16Array=$q;function Gq(i){return Ni(i)==="Uint32Array"}Y.isUint32Array=Gq;function Yq(i){return Ni(i)==="Int8Array"}Y.isInt8Array=Yq;function Jq(i){return Ni(i)==="Int16Array"}Y.isInt16Array=Jq;function Xq(i){return Ni(i)==="Int32Array"}Y.isInt32Array=Xq;function Zq(i){return Ni(i)==="Float32Array"}Y.isFloat32Array=Zq;function Qq(i){return Ni(i)==="Float64Array"}Y.isFloat64Array=Qq;function eF(i){return Ni(i)==="BigInt64Array"}Y.isBigInt64Array=eF;function tF(i){return Ni(i)==="BigUint64Array"}Y.isBigUint64Array=tF;function $u(i){return fi(i)==="[object Map]"}$u.working=typeof Map<"u"&&$u(new Map);function iF(i){return typeof Map>"u"?!1:$u.working?$u(i):i instanceof Map}Y.isMap=iF;function Gu(i){return fi(i)==="[object Set]"}Gu.working=typeof Set<"u"&&Gu(new Set);function rF(i){return typeof Set>"u"?!1:Gu.working?Gu(i):i instanceof Set}Y.isSet=rF;function Yu(i){return fi(i)==="[object WeakMap]"}Yu.working=typeof WeakMap<"u"&&Yu(new WeakMap);function nF(i){return typeof WeakMap>"u"?!1:Yu.working?Yu(i):i instanceof WeakMap}Y.isWeakMap=nF;function iy(i){return fi(i)==="[object WeakSet]"}iy.working=typeof WeakSet<"u"&&iy(new WeakSet);function sF(i){return iy(i)}Y.isWeakSet=sF;function Ju(i){return fi(i)==="[object ArrayBuffer]"}Ju.working=typeof ArrayBuffer<"u"&&Ju(new ArrayBuffer);function LI(i){return typeof ArrayBuffer>"u"?!1:Ju.working?Ju(i):i instanceof ArrayBuffer}Y.isArrayBuffer=LI;function Xu(i){return fi(i)==="[object DataView]"}Xu.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Xu(new DataView(new ArrayBuffer(1),0,1));function jI(i){return typeof DataView>"u"?!1:Xu.working?Xu(i):i instanceof DataView}Y.isDataView=jI;var ty=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ka(i){return fi(i)==="[object SharedArrayBuffer]"}function zI(i){return typeof ty>"u"?!1:(typeof ka.working>"u"&&(ka.working=ka(new ty)),ka.working?ka(i):i instanceof ty)}Y.isSharedArrayBuffer=zI;function oF(i){return fi(i)==="[object AsyncFunction]"}Y.isAsyncFunction=oF;function aF(i){return fi(i)==="[object Map Iterator]"}Y.isMapIterator=aF;function cF(i){return fi(i)==="[object Set Iterator]"}Y.isSetIterator=cF;function lF(i){return fi(i)==="[object Generator]"}Y.isGeneratorObject=lF;function uF(i){return fi(i)==="[object WebAssembly.Module]"}Y.isWebAssemblyCompiledModule=uF;function qI(i){return Na(i,Fq)}Y.isNumberObject=qI;function FI(i){return Na(i,Bq)}Y.isStringObject=FI;function BI(i){return Na(i,Wq)}Y.isBooleanObject=BI;function WI(i){return xI&&Na(i,kI)}Y.isBigIntObject=WI;function HI(i){return MI&&Na(i,NI)}Y.isSymbolObject=HI;function hF(i){return qI(i)||FI(i)||BI(i)||WI(i)||HI(i)}Y.isBoxedPrimitive=hF;function pF(i){return typeof Uint8Array<"u"&&(LI(i)||zI(i))}Y.isAnyArrayBuffer=pF;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(i){Object.defineProperty(Y,i,{enumerable:!1,value:function(){throw new Error(i+" is not supported in userland")}})})});var KI=p((Z9,VI)=>{"use strict";VI.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var $I=p((Q9,ry)=>{"use strict";typeof Object.create=="function"?ry.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ry.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}});var $n=p(J=>{"use strict";var GI=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},dF=/%[sdj%]/g;J.format=function(i){if(!nh(i)){for(var e=[],t=0;t<arguments.length;t++)e.push(Jr(arguments[t]));return e.join(" ")}for(var t=1,r=arguments,n=r.length,s=String(i).replace(dF,function(a){if(a==="%%")return"%";if(t>=n)return a;switch(a){case"%s":return String(r[t++]);case"%d":return Number(r[t++]);case"%j":try{return JSON.stringify(r[t++])}catch{return"[Circular]"}default:return a}}),o=r[t];t<n;o=r[++t])rh(o)||!yo(o)?s+=" "+o:s+=" "+Jr(o);return s};J.deprecate=function(i,e){if(typeof process<"u"&&process.noDeprecation===!0)return i;if(typeof process>"u")return function(){return J.deprecate(i,e).apply(this,arguments)};var t=!1;function r(){if(!t){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),t=!0}return i.apply(this,arguments)}return r};var Zu={},YI=/^$/;process.env.NODE_DEBUG&&(Qu=process.env.NODE_DEBUG,Qu=Qu.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),YI=new RegExp("^"+Qu+"$","i"));var Qu;J.debuglog=function(i){if(i=i.toUpperCase(),!Zu[i])if(YI.test(i)){var e=process.pid;Zu[i]=function(){var t=J.format.apply(J,arguments);console.error("%s %d: %s",i,e,t)}}else Zu[i]=function(){};return Zu[i]};function Jr(i,e){var t={seen:[],stylize:vF};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),ay(e)?t.showHidden=e:e&&J._extend(t,e),Kn(t.showHidden)&&(t.showHidden=!1),Kn(t.depth)&&(t.depth=2),Kn(t.colors)&&(t.colors=!1),Kn(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=fF),th(t,i,t.depth)}J.inspect=Jr;Jr.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Jr.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function fF(i,e){var t=Jr.styles[e];return t?"\x1B["+Jr.colors[t][0]+"m"+i+"\x1B["+Jr.colors[t][1]+"m":i}function vF(i,e){return i}function gF(i){var e={};return i.forEach(function(t,r){e[t]=!0}),e}function th(i,e,t){if(i.customInspect&&e&&eh(e.inspect)&&e.inspect!==J.inspect&&!(e.constructor&&e.constructor.prototype===e)){var r=e.inspect(t,i);return nh(r)||(r=th(i,r,t)),r}var n=mF(i,e);if(n)return n;var s=Object.keys(e),o=gF(s);if(i.showHidden&&(s=Object.getOwnPropertyNames(e)),ja(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return ny(e);if(s.length===0){if(eh(e)){var a=e.name?": "+e.name:"";return i.stylize("[Function"+a+"]","special")}if(La(e))return i.stylize(RegExp.prototype.toString.call(e),"regexp");if(ih(e))return i.stylize(Date.prototype.toString.call(e),"date");if(ja(e))return ny(e)}var c="",l=!1,u=["{","}"];if(JI(e)&&(l=!0,u=["[","]"]),eh(e)){var h=e.name?": "+e.name:"";c=" [Function"+h+"]"}if(La(e)&&(c=" "+RegExp.prototype.toString.call(e)),ih(e)&&(c=" "+Date.prototype.toUTCString.call(e)),ja(e)&&(c=" "+ny(e)),s.length===0&&(!l||e.length==0))return u[0]+c+u[1];if(t<0)return La(e)?i.stylize(RegExp.prototype.toString.call(e),"regexp"):i.stylize("[Object]","special");i.seen.push(e);var d;return l?d=yF(i,e,t,o,s):d=s.map(function(f){return oy(i,e,t,o,f,l)}),i.seen.pop(),_F(d,c,u)}function mF(i,e){if(Kn(e))return i.stylize("undefined","undefined");if(nh(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return i.stylize(t,"string")}if(XI(e))return i.stylize(""+e,"number");if(ay(e))return i.stylize(""+e,"boolean");if(rh(e))return i.stylize("null","null")}function ny(i){return"["+Error.prototype.toString.call(i)+"]"}function yF(i,e,t,r,n){for(var s=[],o=0,a=e.length;o<a;++o)ZI(e,String(o))?s.push(oy(i,e,t,r,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(oy(i,e,t,r,c,!0))}),s}function oy(i,e,t,r,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=i.stylize("[Getter/Setter]","special"):a=i.stylize("[Getter]","special"):c.set&&(a=i.stylize("[Setter]","special")),ZI(r,n)||(o="["+n+"]"),a||(i.seen.indexOf(c.value)<0?(rh(t)?a=th(i,c.value,null):a=th(i,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(l){return"  "+l}).join(`
`).slice(2):a=`
`+a.split(`
`).map(function(l){return"   "+l}).join(`
`))):a=i.stylize("[Circular]","special")),Kn(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.slice(1,-1),o=i.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=i.stylize(o,"string"))}return o+": "+a}function _F(i,e,t){var r=0,n=i.reduce(function(s,o){return r++,o.indexOf(`
`)>=0&&r++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+i.join(`,
  `)+" "+t[1]:t[0]+e+" "+i.join(", ")+" "+t[1]}J.types=UI();function JI(i){return Array.isArray(i)}J.isArray=JI;function ay(i){return typeof i=="boolean"}J.isBoolean=ay;function rh(i){return i===null}J.isNull=rh;function SF(i){return i==null}J.isNullOrUndefined=SF;function XI(i){return typeof i=="number"}J.isNumber=XI;function nh(i){return typeof i=="string"}J.isString=nh;function CF(i){return typeof i=="symbol"}J.isSymbol=CF;function Kn(i){return i===void 0}J.isUndefined=Kn;function La(i){return yo(i)&&cy(i)==="[object RegExp]"}J.isRegExp=La;J.types.isRegExp=La;function yo(i){return typeof i=="object"&&i!==null}J.isObject=yo;function ih(i){return yo(i)&&cy(i)==="[object Date]"}J.isDate=ih;J.types.isDate=ih;function ja(i){return yo(i)&&(cy(i)==="[object Error]"||i instanceof Error)}J.isError=ja;J.types.isNativeError=ja;function eh(i){return typeof i=="function"}J.isFunction=eh;function bF(i){return i===null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||typeof i=="symbol"||typeof i>"u"}J.isPrimitive=bF;J.isBuffer=KI();function cy(i){return Object.prototype.toString.call(i)}function sy(i){return i<10?"0"+i.toString(10):i.toString(10)}var wF=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function PF(){var i=new Date,e=[sy(i.getHours()),sy(i.getMinutes()),sy(i.getSeconds())].join(":");return[i.getDate(),wF[i.getMonth()],e].join(" ")}J.log=function(){console.log("%s - %s",PF(),J.format.apply(J,arguments))};J.inherits=$I();J._extend=function(i,e){if(!e||!yo(e))return i;for(var t=Object.keys(e),r=t.length;r--;)i[t[r]]=e[t[r]];return i};function ZI(i,e){return Object.prototype.hasOwnProperty.call(i,e)}var Vn=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;J.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if(Vn&&e[Vn]){var t=e[Vn];if(typeof t!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,Vn,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var r,n,s=new Promise(function(c,l){r=c,n=l}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,l){c?n(c):r(l)});try{e.apply(this,o)}catch(c){n(c)}return s}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Vn&&Object.defineProperty(t,Vn,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,GI(e))};J.promisify.custom=Vn;function EF(i,e){if(!i){var t=new Error("Promise was rejected with a falsy value");t.reason=i,i=t}return e(i)}function RF(i){if(typeof i!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var n=t.pop();if(typeof n!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};i.apply(this,t).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(EF.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(i)),Object.defineProperties(e,GI(i)),e}J.callbackify=RF});var hy=p((tK,iT)=>{"use strict";function Xr(i){"@babel/helpers - typeof";return Xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xr(i)}function QI(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,TF(r.key),r)}}function IF(i,e,t){return e&&QI(i.prototype,e),t&&QI(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function TF(i){var e=AF(i,"string");return Xr(e)==="symbol"?e:String(e)}function AF(i,e){if(Xr(i)!=="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Xr(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function OF(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function DF(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&uy(i,e)}function uy(i,e){return uy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},uy(i,e)}function xF(i){var e=NF();return function(){var r=sh(i),n;if(e){var s=sh(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return MF(this,n)}}function MF(i,e){if(e&&(Xr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kF(i)}function kF(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function NF(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sh(i){return sh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sh(i)}var tT={},_o,ly;function za(i,e,t){t||(t=Error);function r(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){DF(a,s);var o=xF(a);function a(c,l,u){var h;return OF(this,a),h=o.call(this,r(c,l,u)),h.code=i,h}return IF(a)}(t);tT[i]=n}function eT(i,e){if(Array.isArray(i)){var t=i.length;return i=i.map(function(r){return String(r)}),t>2?"one of ".concat(e," ").concat(i.slice(0,t-1).join(", "),", or ")+i[t-1]:t===2?"one of ".concat(e," ").concat(i[0]," or ").concat(i[1]):"of ".concat(e," ").concat(i[0])}else return"of ".concat(e," ").concat(String(i))}function LF(i,e,t){return i.substr(!t||t<0?0:+t,e.length)===e}function jF(i,e,t){return(t===void 0||t>i.length)&&(t=i.length),i.substring(t-e.length,t)===e}function zF(i,e,t){return typeof t!="number"&&(t=0),t+e.length>i.length?!1:i.indexOf(e,t)!==-1}za("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError);za("ERR_INVALID_ARG_TYPE",function(i,e,t){_o===void 0&&(_o=oh()),_o(typeof i=="string","'name' must be a string");var r;typeof e=="string"&&LF(e,"not ")?(r="must not be",e=e.replace(/^not /,"")):r="must be";var n;if(jF(i," argument"))n="The ".concat(i," ").concat(r," ").concat(eT(e,"type"));else{var s=zF(i,".")?"property":"argument";n='The "'.concat(i,'" ').concat(s," ").concat(r," ").concat(eT(e,"type"))}return n+=". Received type ".concat(Xr(t)),n},TypeError);za("ERR_INVALID_ARG_VALUE",function(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";ly===void 0&&(ly=$n());var r=ly.inspect(e);return r.length>128&&(r="".concat(r.slice(0,128),"...")),"The argument '".concat(i,"' ").concat(t,". Received ").concat(r)},TypeError,RangeError);za("ERR_INVALID_RETURN_VALUE",function(i,e,t){var r;return t&&t.constructor&&t.constructor.name?r="instance of ".concat(t.constructor.name):r="type ".concat(Xr(t)),"Expected ".concat(i,' to be returned from the "').concat(e,'"')+" function but got ".concat(r,".")},TypeError);za("ERR_MISSING_ARGS",function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];_o===void 0&&(_o=oh()),_o(e.length>0,"At least one arg needs to be specified");var r="The ",n=e.length;switch(e=e.map(function(s){return'"'.concat(s,'"')}),n){case 1:r+="".concat(e[0]," argument");break;case 2:r+="".concat(e[0]," and ").concat(e[1]," arguments");break;default:r+=e.slice(0,n-1).join(", "),r+=", and ".concat(e[n-1]," arguments");break}return"".concat(r," must be specified")},TypeError);iT.exports.codes=tT});var pT=p((iK,hT)=>{"use strict";function rT(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function nT(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rT(Object(t),!0).forEach(function(r){qF(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):rT(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function qF(i,e,t){return e=cT(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function FF(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function sT(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,cT(r.key),r)}}function BF(i,e,t){return e&&sT(i.prototype,e),t&&sT(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function cT(i){var e=WF(i,"string");return Wt(e)==="symbol"?e:String(e)}function WF(i,e){if(Wt(i)!=="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Wt(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function HF(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Wa(i,e)}function UF(i){var e=uT();return function(){var r=Ha(i),n;if(e){var s=Ha(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return lT(this,n)}}function lT(i,e){if(e&&(Wt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return py(i)}function py(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function dy(i){var e=typeof Map=="function"?new Map:void 0;return dy=function(r){if(r===null||!VF(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(r))return e.get(r);e.set(r,n)}function n(){return ah(r,arguments,Ha(this).constructor)}return n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Wa(n,r)},dy(i)}function ah(i,e,t){return uT()?ah=Reflect.construct.bind():ah=function(n,s,o){var a=[null];a.push.apply(a,s);var c=Function.bind.apply(n,a),l=new c;return o&&Wa(l,o.prototype),l},ah.apply(null,arguments)}function uT(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function VF(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function Wa(i,e){return Wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Wa(i,e)}function Ha(i){return Ha=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ha(i)}function Wt(i){"@babel/helpers - typeof";return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(i)}var KF=$n(),fy=KF.inspect,$F=hy(),GF=$F.codes.ERR_INVALID_ARG_TYPE;function oT(i,e,t){return(t===void 0||t>i.length)&&(t=i.length),i.substring(t-e.length,t)===e}function YF(i,e){if(e=Math.floor(e),i.length==0||e==0)return"";var t=i.length*e;for(e=Math.floor(Math.log(e)/Math.log(2));e;)i+=i,e--;return i+=i.substring(0,t-i.length),i}var Li="",qa="",Fa="",nt="",Gn={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},JF=10;function aT(i){var e=Object.keys(i),t=Object.create(Object.getPrototypeOf(i));return e.forEach(function(r){t[r]=i[r]}),Object.defineProperty(t,"message",{value:i.message}),t}function Ba(i){return fy(i,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function XF(i,e,t){var r="",n="",s=0,o="",a=!1,c=Ba(i),l=c.split(`
`),u=Ba(e).split(`
`),h=0,d="";if(t==="strictEqual"&&Wt(i)==="object"&&Wt(e)==="object"&&i!==null&&e!==null&&(t="strictEqualObject"),l.length===1&&u.length===1&&l[0]!==u[0]){var f=l[0].length+u[0].length;if(f<=JF){if((Wt(i)!=="object"||i===null)&&(Wt(e)!=="object"||e===null)&&(i!==0||e!==0))return"".concat(Gn[t],`

`)+"".concat(l[0]," !== ").concat(u[0],`
`)}else if(t!=="strictEqualObject"){var g=process.stderr&&process.stderr.isTTY?process.stderr.columns:80;if(f<g){for(;l[0][h]===u[0][h];)h++;h>2&&(d=`
  `.concat(YF(" ",h),"^"),h=0)}}}for(var m=l[l.length-1],y=u[u.length-1];m===y&&(h++<2?o=`
  `.concat(m).concat(o):r=m,l.pop(),u.pop(),!(l.length===0||u.length===0));)m=l[l.length-1],y=u[u.length-1];var b=Math.max(l.length,u.length);if(b===0){var S=c.split(`
`);if(S.length>30)for(S[26]="".concat(Li,"...").concat(nt);S.length>27;)S.pop();return"".concat(Gn.notIdentical,`

`).concat(S.join(`
`),`
`)}h>3&&(o=`
`.concat(Li,"...").concat(nt).concat(o),a=!0),r!==""&&(o=`
  `.concat(r).concat(o),r="");var _=0,P=Gn[t]+`
`.concat(qa,"+ actual").concat(nt," ").concat(Fa,"- expected").concat(nt),O=" ".concat(Li,"...").concat(nt," Lines skipped");for(h=0;h<b;h++){var x=h-s;if(l.length<h+1)x>1&&h>2&&(x>4?(n+=`
`.concat(Li,"...").concat(nt),a=!0):x>3&&(n+=`
  `.concat(u[h-2]),_++),n+=`
  `.concat(u[h-1]),_++),s=h,r+=`
`.concat(Fa,"-").concat(nt," ").concat(u[h]),_++;else if(u.length<h+1)x>1&&h>2&&(x>4?(n+=`
`.concat(Li,"...").concat(nt),a=!0):x>3&&(n+=`
  `.concat(l[h-2]),_++),n+=`
  `.concat(l[h-1]),_++),s=h,n+=`
`.concat(qa,"+").concat(nt," ").concat(l[h]),_++;else{var ie=u[h],G=l[h],ee=G!==ie&&(!oT(G,",")||G.slice(0,-1)!==ie);ee&&oT(ie,",")&&ie.slice(0,-1)===G&&(ee=!1,G+=","),ee?(x>1&&h>2&&(x>4?(n+=`
`.concat(Li,"...").concat(nt),a=!0):x>3&&(n+=`
  `.concat(l[h-2]),_++),n+=`
  `.concat(l[h-1]),_++),s=h,n+=`
`.concat(qa,"+").concat(nt," ").concat(G),r+=`
`.concat(Fa,"-").concat(nt," ").concat(ie),_+=2):(n+=r,r="",(x===1||h===0)&&(n+=`
  `.concat(G),_++))}if(_>20&&h<b-2)return"".concat(P).concat(O,`
`).concat(n,`
`).concat(Li,"...").concat(nt).concat(r,`
`)+"".concat(Li,"...").concat(nt)}return"".concat(P).concat(a?O:"",`
`).concat(n).concat(r).concat(o).concat(d)}var ZF=function(i,e){HF(r,i);var t=UF(r);function r(n){var s;if(FF(this,r),Wt(n)!=="object"||n===null)throw new GF("options","Object",n);var o=n.message,a=n.operator,c=n.stackStartFn,l=n.actual,u=n.expected,h=Error.stackTraceLimit;if(Error.stackTraceLimit=0,o!=null)s=t.call(this,String(o));else if(process.stderr&&process.stderr.isTTY&&(process.stderr&&process.stderr.getColorDepth&&process.stderr.getColorDepth()!==1?(Li="\x1B[34m",qa="\x1B[32m",nt="\x1B[39m",Fa="\x1B[31m"):(Li="",qa="",nt="",Fa="")),Wt(l)==="object"&&l!==null&&Wt(u)==="object"&&u!==null&&"stack"in l&&l instanceof Error&&"stack"in u&&u instanceof Error&&(l=aT(l),u=aT(u)),a==="deepStrictEqual"||a==="strictEqual")s=t.call(this,XF(l,u,a));else if(a==="notDeepStrictEqual"||a==="notStrictEqual"){var d=Gn[a],f=Ba(l).split(`
`);if(a==="notStrictEqual"&&Wt(l)==="object"&&l!==null&&(d=Gn.notStrictEqualObject),f.length>30)for(f[26]="".concat(Li,"...").concat(nt);f.length>27;)f.pop();f.length===1?s=t.call(this,"".concat(d," ").concat(f[0])):s=t.call(this,"".concat(d,`

`).concat(f.join(`
`),`
`))}else{var g=Ba(l),m="",y=Gn[a];a==="notDeepEqual"||a==="notEqual"?(g="".concat(Gn[a],`

`).concat(g),g.length>1024&&(g="".concat(g.slice(0,1021),"..."))):(m="".concat(Ba(u)),g.length>512&&(g="".concat(g.slice(0,509),"...")),m.length>512&&(m="".concat(m.slice(0,509),"...")),a==="deepEqual"||a==="equal"?g="".concat(y,`

`).concat(g,`

should equal

`):m=" ".concat(a," ").concat(m)),s=t.call(this,"".concat(g).concat(m))}return Error.stackTraceLimit=h,s.generatedMessage=!o,Object.defineProperty(py(s),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),s.code="ERR_ASSERTION",s.actual=l,s.expected=u,s.operator=a,Error.captureStackTrace&&Error.captureStackTrace(py(s),c),s.stack,s.name="AssertionError",lT(s)}return BF(r,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:e,value:function(s,o){return fy(this,nT(nT({},o),{},{customInspect:!1,depth:0}))}}]),r}(dy(Error),fy.custom);hT.exports=ZF});var vy=p((rK,fT)=>{"use strict";var dT=Object.prototype.toString;fT.exports=function(e){var t=dT.call(e),r=t==="[object Arguments]";return r||(r=t!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&dT.call(e.callee)==="[object Function]"),r}});var wT=p((nK,bT)=>{"use strict";var CT;Object.keys||(Ua=Object.prototype.hasOwnProperty,gy=Object.prototype.toString,vT=vy(),my=Object.prototype.propertyIsEnumerable,gT=!my.call({toString:null},"toString"),mT=my.call(function(){},"prototype"),Va=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],ch=function(i){var e=i.constructor;return e&&e.prototype===i},yT={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},_T=function(){if(typeof window>"u")return!1;for(var i in window)try{if(!yT["$"+i]&&Ua.call(window,i)&&window[i]!==null&&typeof window[i]=="object")try{ch(window[i])}catch{return!0}}catch{return!0}return!1}(),ST=function(i){if(typeof window>"u"||!_T)return ch(i);try{return ch(i)}catch{return!1}},CT=function(e){var t=e!==null&&typeof e=="object",r=gy.call(e)==="[object Function]",n=vT(e),s=t&&gy.call(e)==="[object String]",o=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var a=mT&&r;if(s&&e.length>0&&!Ua.call(e,0))for(var c=0;c<e.length;++c)o.push(String(c));if(n&&e.length>0)for(var l=0;l<e.length;++l)o.push(String(l));else for(var u in e)!(a&&u==="prototype")&&Ua.call(e,u)&&o.push(String(u));if(gT)for(var h=ST(e),d=0;d<Va.length;++d)!(h&&Va[d]==="constructor")&&Ua.call(e,Va[d])&&o.push(Va[d]);return o});var Ua,gy,vT,my,gT,mT,Va,ch,yT,_T,ST;bT.exports=CT});var yy=p((sK,RT)=>{"use strict";var QF=Array.prototype.slice,e2=vy(),PT=Object.keys,lh=PT?function(e){return PT(e)}:wT(),ET=Object.keys;lh.shim=function(){if(Object.keys){var e=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);e||(Object.keys=function(r){return e2(r)?ET(QF.call(r)):ET(r)})}else Object.keys=lh;return Object.keys||lh};RT.exports=lh});var xT=p((oK,DT)=>{"use strict";var t2=yy(),AT=wu()(),OT=lo(),IT=Object,i2=OT("Array.prototype.push"),TT=OT("Object.prototype.propertyIsEnumerable"),r2=AT?Object.getOwnPropertySymbols:null;DT.exports=function(e,t){if(e==null)throw new TypeError("target must be an object");var r=IT(e);if(arguments.length===1)return r;for(var n=1;n<arguments.length;++n){var s=IT(arguments[n]),o=t2(s),a=AT&&(Object.getOwnPropertySymbols||r2);if(a)for(var c=a(s),l=0;l<c.length;++l){var u=c[l];TT(s,u)&&i2(o,u)}for(var h=0;h<o.length;++h){var d=o[h];if(TT(s,d)){var f=s[d];r[d]=f}}}return r}});var kT=p((aK,MT)=>{"use strict";var _y=xT(),n2=function(){if(!Object.assign)return!1;for(var i="abcdefghijklmnopqrst",e=i.split(""),t={},r=0;r<e.length;++r)t[e[r]]=e[r];var n=Object.assign({},t),s="";for(var o in n)s+=o;return i!==s},s2=function(){if(!Object.assign||!Object.preventExtensions)return!1;var i=Object.preventExtensions({1:2});try{Object.assign(i,"xy")}catch{return i[1]==="y"}return!1};MT.exports=function(){return!Object.assign||n2()||s2()?_y:Object.assign}});var Sy=p((cK,LT)=>{"use strict";var NT=function(i){return i!==i};LT.exports=function(e,t){return e===0&&t===0?1/e===1/t:!!(e===t||NT(e)&&NT(t))}});var uh=p((lK,jT)=>{"use strict";var o2=Sy();jT.exports=function(){return typeof Object.is=="function"?Object.is:o2}});var Ka=p((uK,BT)=>{"use strict";var a2=yy(),c2=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",l2=Object.prototype.toString,u2=Array.prototype.concat,zT=gm(),h2=function(i){return typeof i=="function"&&l2.call(i)==="[object Function]"},qT=ym()(),p2=function(i,e,t,r){if(e in i){if(r===!0){if(i[e]===t)return}else if(!h2(r)||!r())return}qT?zT(i,e,t,!0):zT(i,e,t)},FT=function(i,e){var t=arguments.length>2?arguments[2]:{},r=a2(e);c2&&(r=u2.call(r,Object.getOwnPropertySymbols(e)));for(var n=0;n<r.length;n+=1)p2(i,r[n],e[r[n]],t[r[n]])};FT.supportsDescriptors=!!qT;BT.exports=FT});var HT=p((hK,WT)=>{"use strict";var d2=uh(),f2=Ka();WT.exports=function(){var e=d2();return f2(Object,{is:e},{is:function(){return Object.is!==e}}),e}});var $T=p((pK,KT)=>{"use strict";var v2=Ka(),g2=Ta(),m2=Sy(),UT=uh(),y2=HT(),VT=g2(UT(),Object);v2(VT,{getPolyfill:UT,implementation:m2,shim:y2});KT.exports=VT});var Cy=p((dK,GT)=>{"use strict";GT.exports=function(e){return e!==e}});var by=p((fK,YT)=>{"use strict";var _2=Cy();YT.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:_2}});var XT=p((vK,JT)=>{"use strict";var S2=Ka(),C2=by();JT.exports=function(){var e=C2();return S2(Number,{isNaN:e},{isNaN:function(){return Number.isNaN!==e}}),e}});var tA=p((gK,eA)=>{"use strict";var b2=Ta(),w2=Ka(),P2=Cy(),ZT=by(),E2=XT(),QT=b2(ZT(),Number);w2(QT,{getPolyfill:ZT,implementation:P2,shim:E2});eA.exports=QT});var CA=p((mK,SA)=>{"use strict";function iA(i,e){return A2(i)||T2(i,e)||I2(i,e)||R2()}function R2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I2(i,e){if(i){if(typeof i=="string")return rA(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return rA(i,e)}}function rA(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=i[t];return r}function T2(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var r,n,s,o,a=[],c=!0,l=!1;try{if(s=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=s.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(u){l=!0,n=u}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw n}}return a}}function A2(i){if(Array.isArray(i))return i}function vi(i){"@babel/helpers - typeof";return vi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vi(i)}var O2=/a/g.flags!==void 0,mh=function(e){var t=[];return e.forEach(function(r){return t.push(r)}),t},nA=function(e){var t=[];return e.forEach(function(r,n){return t.push([n,r])}),t},vA=Object.is?Object.is:$T(),vh=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},wy=Number.isNaN?Number.isNaN:tA();function Ey(i){return i.call.bind(i)}var Ga=Ey(Object.prototype.hasOwnProperty),gh=Ey(Object.prototype.propertyIsEnumerable),sA=Ey(Object.prototype.toString),Dt=$n().types,D2=Dt.isAnyArrayBuffer,x2=Dt.isArrayBufferView,oA=Dt.isDate,hh=Dt.isMap,aA=Dt.isRegExp,ph=Dt.isSet,M2=Dt.isNativeError,k2=Dt.isBoxedPrimitive,cA=Dt.isNumberObject,lA=Dt.isStringObject,uA=Dt.isBooleanObject,hA=Dt.isBigIntObject,N2=Dt.isSymbolObject,L2=Dt.isFloat32Array,j2=Dt.isFloat64Array;function z2(i){if(i.length===0||i.length>10)return!0;for(var e=0;e<i.length;e++){var t=i.charCodeAt(e);if(t<48||t>57)return!0}return i.length===10&&i>=Math.pow(2,32)}function dh(i){return Object.keys(i).filter(z2).concat(vh(i).filter(Object.prototype.propertyIsEnumerable.bind(i)))}function gA(i,e){if(i===e)return 0;for(var t=i.length,r=e.length,n=0,s=Math.min(t,r);n<s;++n)if(i[n]!==e[n]){t=i[n],r=e[n];break}return t<r?-1:r<t?1:0}var fh=void 0,q2=!0,F2=!1,Py=0,Ry=1,mA=2,yA=3;function B2(i,e){return O2?i.source===e.source&&i.flags===e.flags:RegExp.prototype.toString.call(i)===RegExp.prototype.toString.call(e)}function W2(i,e){if(i.byteLength!==e.byteLength)return!1;for(var t=0;t<i.byteLength;t++)if(i[t]!==e[t])return!1;return!0}function H2(i,e){return i.byteLength!==e.byteLength?!1:gA(new Uint8Array(i.buffer,i.byteOffset,i.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))===0}function U2(i,e){return i.byteLength===e.byteLength&&gA(new Uint8Array(i),new Uint8Array(e))===0}function V2(i,e){return cA(i)?cA(e)&&vA(Number.prototype.valueOf.call(i),Number.prototype.valueOf.call(e)):lA(i)?lA(e)&&String.prototype.valueOf.call(i)===String.prototype.valueOf.call(e):uA(i)?uA(e)&&Boolean.prototype.valueOf.call(i)===Boolean.prototype.valueOf.call(e):hA(i)?hA(e)&&BigInt.prototype.valueOf.call(i)===BigInt.prototype.valueOf.call(e):N2(e)&&Symbol.prototype.valueOf.call(i)===Symbol.prototype.valueOf.call(e)}function gi(i,e,t,r){if(i===e)return i!==0?!0:t?vA(i,e):!0;if(t){if(vi(i)!=="object")return typeof i=="number"&&wy(i)&&wy(e);if(vi(e)!=="object"||i===null||e===null||Object.getPrototypeOf(i)!==Object.getPrototypeOf(e))return!1}else{if(i===null||vi(i)!=="object")return e===null||vi(e)!=="object"?i==e:!1;if(e===null||vi(e)!=="object")return!1}var n=sA(i),s=sA(e);if(n!==s)return!1;if(Array.isArray(i)){if(i.length!==e.length)return!1;var o=dh(i,fh),a=dh(e,fh);return o.length!==a.length?!1:$a(i,e,t,r,Ry,o)}if(n==="[object Object]"&&(!hh(i)&&hh(e)||!ph(i)&&ph(e)))return!1;if(oA(i)){if(!oA(e)||Date.prototype.getTime.call(i)!==Date.prototype.getTime.call(e))return!1}else if(aA(i)){if(!aA(e)||!B2(i,e))return!1}else if(M2(i)||i instanceof Error){if(i.message!==e.message||i.name!==e.name)return!1}else if(x2(i)){if(!t&&(L2(i)||j2(i))){if(!W2(i,e))return!1}else if(!H2(i,e))return!1;var c=dh(i,fh),l=dh(e,fh);return c.length!==l.length?!1:$a(i,e,t,r,Py,c)}else{if(ph(i))return!ph(e)||i.size!==e.size?!1:$a(i,e,t,r,mA);if(hh(i))return!hh(e)||i.size!==e.size?!1:$a(i,e,t,r,yA);if(D2(i)){if(!U2(i,e))return!1}else if(k2(i)&&!V2(i,e))return!1}return $a(i,e,t,r,Py)}function pA(i,e){return e.filter(function(t){return gh(i,t)})}function $a(i,e,t,r,n,s){if(arguments.length===5){s=Object.keys(i);var o=Object.keys(e);if(s.length!==o.length)return!1}for(var a=0;a<s.length;a++)if(!Ga(e,s[a]))return!1;if(t&&arguments.length===5){var c=vh(i);if(c.length!==0){var l=0;for(a=0;a<c.length;a++){var u=c[a];if(gh(i,u)){if(!gh(e,u))return!1;s.push(u),l++}else if(gh(e,u))return!1}var h=vh(e);if(c.length!==h.length&&pA(e,h).length!==l)return!1}else{var d=vh(e);if(d.length!==0&&pA(e,d).length!==0)return!1}}if(s.length===0&&(n===Py||n===Ry&&i.length===0||i.size===0))return!0;if(r===void 0)r={val1:new Map,val2:new Map,position:0};else{var f=r.val1.get(i);if(f!==void 0){var g=r.val2.get(e);if(g!==void 0)return f===g}r.position++}r.val1.set(i,r.position),r.val2.set(e,r.position);var m=J2(i,e,t,s,r,n);return r.val1.delete(i),r.val2.delete(e),m}function dA(i,e,t,r){for(var n=mh(i),s=0;s<n.length;s++){var o=n[s];if(gi(e,o,t,r))return i.delete(o),!0}return!1}function _A(i){switch(vi(i)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":i=+i;case"number":if(wy(i))return!1}return!0}function K2(i,e,t){var r=_A(t);return r??(e.has(r)&&!i.has(r))}function $2(i,e,t,r,n){var s=_A(t);if(s!=null)return s;var o=e.get(s);return o===void 0&&!e.has(s)||!gi(r,o,!1,n)?!1:!i.has(s)&&gi(r,o,!1,n)}function G2(i,e,t,r){for(var n=null,s=mh(i),o=0;o<s.length;o++){var a=s[o];if(vi(a)==="object"&&a!==null)n===null&&(n=new Set),n.add(a);else if(!e.has(a)){if(t||!K2(i,e,a))return!1;n===null&&(n=new Set),n.add(a)}}if(n!==null){for(var c=mh(e),l=0;l<c.length;l++){var u=c[l];if(vi(u)==="object"&&u!==null){if(!dA(n,u,t,r))return!1}else if(!t&&!i.has(u)&&!dA(n,u,t,r))return!1}return n.size===0}return!0}function fA(i,e,t,r,n,s){for(var o=mh(i),a=0;a<o.length;a++){var c=o[a];if(gi(t,c,n,s)&&gi(r,e.get(c),n,s))return i.delete(c),!0}return!1}function Y2(i,e,t,r){for(var n=null,s=nA(i),o=0;o<s.length;o++){var a=iA(s[o],2),c=a[0],l=a[1];if(vi(c)==="object"&&c!==null)n===null&&(n=new Set),n.add(c);else{var u=e.get(c);if(u===void 0&&!e.has(c)||!gi(l,u,t,r)){if(t||!$2(i,e,c,l,r))return!1;n===null&&(n=new Set),n.add(c)}}}if(n!==null){for(var h=nA(e),d=0;d<h.length;d++){var f=iA(h[d],2),g=f[0],m=f[1];if(vi(g)==="object"&&g!==null){if(!fA(n,i,g,m,t,r))return!1}else if(!t&&(!i.has(g)||!gi(i.get(g),m,!1,r))&&!fA(n,i,g,m,!1,r))return!1}return n.size===0}return!0}function J2(i,e,t,r,n,s){var o=0;if(s===mA){if(!G2(i,e,t,n))return!1}else if(s===yA){if(!Y2(i,e,t,n))return!1}else if(s===Ry)for(;o<i.length;o++)if(Ga(i,o)){if(!Ga(e,o)||!gi(i[o],e[o],t,n))return!1}else{if(Ga(e,o))return!1;for(var a=Object.keys(i);o<a.length;o++){var c=a[o];if(!Ga(e,c)||!gi(i[c],e[c],t,n))return!1}return a.length===Object.keys(e).length}for(o=0;o<r.length;o++){var l=r[o];if(!gi(i[l],e[l],t,n))return!1}return!0}function X2(i,e){return gi(i,e,F2)}function Z2(i,e){return gi(i,e,q2)}SA.exports={isDeepEqual:X2,isDeepStrictEqual:Z2}});var oh=p((yK,qA)=>{"use strict";function ji(i){"@babel/helpers - typeof";return ji=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ji(i)}function bA(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,eB(r.key),r)}}function Q2(i,e,t){return e&&bA(i.prototype,e),t&&bA(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function eB(i){var e=tB(i,"string");return ji(e)==="symbol"?e:String(e)}function tB(i,e){if(ji(i)!=="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(ji(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function iB(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}var rB=hy(),Ya=rB.codes,wA=Ya.ERR_AMBIGUOUS_ARGUMENT,So=Ya.ERR_INVALID_ARG_TYPE,nB=Ya.ERR_INVALID_ARG_VALUE,sB=Ya.ERR_INVALID_RETURN_VALUE,Qr=Ya.ERR_MISSING_ARGS,en=pT(),oB=$n(),yh=oB.inspect,IA=$n().types,aB=IA.isPromise,_h=IA.isRegExp,cB=kT()(),TA=uh()(),Sh=lo()("RegExp.prototype.test"),Zr,Ch;function Ja(){var i=CA();Zr=i.isDeepEqual,Ch=i.isDeepStrictEqual}var PA=!1,fe=qA.exports=Iy,bh={};function zi(i){throw i.message instanceof Error?i.message:new en(i)}function AA(i,e,t,r,n){var s=arguments.length,o;if(s===0)o="Failed";else if(s===1)t=i,i=void 0;else{if(PA===!1){PA=!0;var a=process.emitWarning?process.emitWarning:console.warn.bind(console);a("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}s===2&&(r="!=")}if(t instanceof Error)throw t;var c={actual:i,expected:e,operator:r===void 0?"fail":r,stackStartFn:n||AA};t!==void 0&&(c.message=t);var l=new en(c);throw o&&(l.message=o,l.generatedMessage=!0),l}fe.fail=AA;fe.AssertionError=en;function OA(i,e,t,r){if(!t){var n=!1;if(e===0)n=!0,r="No value argument passed to `assert.ok()`";else if(r instanceof Error)throw r;var s=new en({actual:t,expected:!0,message:r,operator:"==",stackStartFn:i});throw s.generatedMessage=n,s}}function Iy(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];OA.apply(void 0,[Iy,e.length].concat(e))}fe.ok=Iy;fe.equal=function i(e,t,r){if(arguments.length<2)throw new Qr("actual","expected");e!=t&&zi({actual:e,expected:t,message:r,operator:"==",stackStartFn:i})};fe.notEqual=function i(e,t,r){if(arguments.length<2)throw new Qr("actual","expected");e==t&&zi({actual:e,expected:t,message:r,operator:"!=",stackStartFn:i})};fe.deepEqual=function i(e,t,r){if(arguments.length<2)throw new Qr("actual","expected");Zr===void 0&&Ja(),Zr(e,t)||zi({actual:e,expected:t,message:r,operator:"deepEqual",stackStartFn:i})};fe.notDeepEqual=function i(e,t,r){if(arguments.length<2)throw new Qr("actual","expected");Zr===void 0&&Ja(),Zr(e,t)&&zi({actual:e,expected:t,message:r,operator:"notDeepEqual",stackStartFn:i})};fe.deepStrictEqual=function i(e,t,r){if(arguments.length<2)throw new Qr("actual","expected");Zr===void 0&&Ja(),Ch(e,t)||zi({actual:e,expected:t,message:r,operator:"deepStrictEqual",stackStartFn:i})};fe.notDeepStrictEqual=DA;function DA(i,e,t){if(arguments.length<2)throw new Qr("actual","expected");Zr===void 0&&Ja(),Ch(i,e)&&zi({actual:i,expected:e,message:t,operator:"notDeepStrictEqual",stackStartFn:DA})}fe.strictEqual=function i(e,t,r){if(arguments.length<2)throw new Qr("actual","expected");TA(e,t)||zi({actual:e,expected:t,message:r,operator:"strictEqual",stackStartFn:i})};fe.notStrictEqual=function i(e,t,r){if(arguments.length<2)throw new Qr("actual","expected");TA(e,t)&&zi({actual:e,expected:t,message:r,operator:"notStrictEqual",stackStartFn:i})};var EA=Q2(function i(e,t,r){var n=this;iB(this,i),t.forEach(function(s){s in e&&(r!==void 0&&typeof r[s]=="string"&&_h(e[s])&&Sh(e[s],r[s])?n[s]=r[s]:n[s]=e[s])})});function lB(i,e,t,r,n,s){if(!(t in i)||!Ch(i[t],e[t])){if(!r){var o=new EA(i,n),a=new EA(e,n,i),c=new en({actual:o,expected:a,operator:"deepStrictEqual",stackStartFn:s});throw c.actual=i,c.expected=e,c.operator=s.name,c}zi({actual:i,expected:e,message:r,operator:s.name,stackStartFn:s})}}function xA(i,e,t,r){if(typeof e!="function"){if(_h(e))return Sh(e,i);if(arguments.length===2)throw new So("expected",["Function","RegExp"],e);if(ji(i)!=="object"||i===null){var n=new en({actual:i,expected:e,message:t,operator:"deepStrictEqual",stackStartFn:r});throw n.operator=r.name,n}var s=Object.keys(e);if(e instanceof Error)s.push("name","message");else if(s.length===0)throw new nB("error",e,"may not be an empty object");return Zr===void 0&&Ja(),s.forEach(function(o){typeof i[o]=="string"&&_h(e[o])&&Sh(e[o],i[o])||lB(i,e,o,t,s,r)}),!0}return e.prototype!==void 0&&i instanceof e?!0:Error.isPrototypeOf(e)?!1:e.call({},i)===!0}function MA(i){if(typeof i!="function")throw new So("fn","Function",i);try{i()}catch(e){return e}return bh}function RA(i){return aB(i)||i!==null&&ji(i)==="object"&&typeof i.then=="function"&&typeof i.catch=="function"}function kA(i){return Promise.resolve().then(function(){var e;if(typeof i=="function"){if(e=i(),!RA(e))throw new sB("instance of Promise","promiseFn",e)}else if(RA(i))e=i;else throw new So("promiseFn",["Function","Promise"],i);return Promise.resolve().then(function(){return e}).then(function(){return bh}).catch(function(t){return t})})}function NA(i,e,t,r){if(typeof t=="string"){if(arguments.length===4)throw new So("error",["Object","Error","Function","RegExp"],t);if(ji(e)==="object"&&e!==null){if(e.message===t)throw new wA("error/message",'The error message "'.concat(e.message,'" is identical to the message.'))}else if(e===t)throw new wA("error/message",'The error "'.concat(e,'" is identical to the message.'));r=t,t=void 0}else if(t!=null&&ji(t)!=="object"&&typeof t!="function")throw new So("error",["Object","Error","Function","RegExp"],t);if(e===bh){var n="";t&&t.name&&(n+=" (".concat(t.name,")")),n+=r?": ".concat(r):".";var s=i.name==="rejects"?"rejection":"exception";zi({actual:void 0,expected:t,operator:i.name,message:"Missing expected ".concat(s).concat(n),stackStartFn:i})}if(t&&!xA(e,t,r,i))throw e}function LA(i,e,t,r){if(e!==bh){if(typeof t=="string"&&(r=t,t=void 0),!t||xA(e,t)){var n=r?": ".concat(r):".",s=i.name==="doesNotReject"?"rejection":"exception";zi({actual:e,expected:t,operator:i.name,message:"Got unwanted ".concat(s).concat(n,`
`)+'Actual message: "'.concat(e&&e.message,'"'),stackStartFn:i})}throw e}}fe.throws=function i(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];NA.apply(void 0,[i,MA(e)].concat(r))};fe.rejects=function i(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return kA(e).then(function(s){return NA.apply(void 0,[i,s].concat(r))})};fe.doesNotThrow=function i(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];LA.apply(void 0,[i,MA(e)].concat(r))};fe.doesNotReject=function i(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return kA(e).then(function(s){return LA.apply(void 0,[i,s].concat(r))})};fe.ifError=function i(e){if(e!=null){var t="ifError got unwanted exception: ";ji(e)==="object"&&typeof e.message=="string"?e.message.length===0&&e.constructor?t+=e.constructor.name:t+=e.message:t+=yh(e);var r=new en({actual:e,expected:null,operator:"ifError",message:t,stackStartFn:i}),n=e.stack;if(typeof n=="string"){var s=n.split(`
`);s.shift();for(var o=r.stack.split(`
`),a=0;a<s.length;a++){var c=o.indexOf(s[a]);if(c!==-1){o=o.slice(0,c);break}}r.stack="".concat(o.join(`
`),`
`).concat(s.join(`
`))}throw r}};function jA(i,e,t,r,n){if(!_h(e))throw new So("regexp","RegExp",e);var s=n==="match";if(typeof i!="string"||Sh(e,i)!==s){if(t instanceof Error)throw t;var o=!t;t=t||(typeof i!="string"?'The "string" argument must be of type string. Received type '+"".concat(ji(i)," (").concat(yh(i),")"):(s?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(yh(e),`. Input:

`).concat(yh(i),`
`));var a=new en({actual:i,expected:e,message:t,operator:n,stackStartFn:r});throw a.generatedMessage=o,a}}fe.match=function i(e,t,r){jA(e,t,r,i,"match")};fe.doesNotMatch=function i(e,t,r){jA(e,t,r,i,"doesNotMatch")};function zA(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];OA.apply(void 0,[zA,e.length].concat(e))}fe.strict=cB(zA,fe,{equal:fe.strictEqual,deepEqual:fe.deepStrictEqual,notEqual:fe.notStrictEqual,notDeepEqual:fe.notDeepStrictEqual});fe.strict.strict=fe.strict});var FA=p(Ty=>{"use strict";Object.defineProperty(Ty,"__esModule",{value:!0});function uB(i){return function(e,t){return new Promise((r,n)=>{i.call(this,e,t,(s,o)=>{s?n(s):r(o)})})}}Ty.default=uB});var WA=p((Oy,BA)=>{"use strict";var hB=Oy&&Oy.__importDefault||function(i){return i&&i.__esModule?i:{default:i}},pB=am(),dB=hB(FA());function fB(i){return!!i&&typeof i.addRequest=="function"}function vB(i){return!!i&&typeof i.addRequest=="function"}function Ay(){let{stack:i}=new Error;return typeof i!="string"?!1:i.split(`
`).some(e=>e.indexOf("(https.js:")!==-1)}function Co(i,e){return new Co.Agent(i,e)}(function(i){class e extends pB.EventEmitter{constructor(r,n){super(),this.promisifiedCallback=void 0;let s=n;typeof r=="function"?this.callback=r:r&&(s=r),this.timeout=null,s&&typeof s.timeout=="number"&&(this.timeout=s.timeout),this.options=s||{},this.maxFreeSockets=1,this.maxSockets=1,this.sockets=[],this.requests=[]}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:Ay()?443:80}set defaultPort(r){this.explicitDefaultPort=r}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:Ay()?"https:":"http:"}set protocol(r){this.explicitProtocol=r}callback(r,n,s){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(r,n){let s=Object.assign({},n);typeof s.secureEndpoint!="boolean"&&(s.secureEndpoint=Ay()),s.host==null&&(s.host="localhost"),s.port==null&&(s.port=s.secureEndpoint?443:80);let o=Object.assign(Object.assign({},this.options),s);o.host&&o.path&&delete o.path,delete o.agent,delete o.hostname,delete o._defaultAgent,delete o.defaultPort,delete o.createConnection,r._last=!0,r.shouldKeepAlive=!1;let a=!1,c=null,l=this.timeout,u=this.freeSocket;function h(m){r._hadError||(r.emit("error",m),r._hadError=!0)}function d(){c=null,a=!0;let m=new Error(`A "socket" was not created for HTTP request before ${l}ms`);m.code="ETIMEOUT",h(m)}function f(m){a||(c!==null&&(clearTimeout(c),c=null),h(m))}function g(m){let y;function b(){u(y,o)}if(a)return;if(c!=null&&(clearTimeout(c),c=null),fB(m)||vB(m)){m.addRequest(r,o);return}if(m){y=m,y.on("free",b),r.onSocket(y);return}let S=new Error(`no Duplex stream was returned to agent-base for \`${r.method} ${r.path}\``);h(S)}if(typeof this.callback!="function"){h(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?this.promisifiedCallback=dB.default(this.callback):this.promisifiedCallback=this.callback),typeof l=="number"&&l>0&&(c=setTimeout(d,l)),"port"in o&&typeof o.port!="number"&&(o.port=Number(o.port));try{Promise.resolve(this.promisifiedCallback(r,o)).then(g,f)}catch(m){Promise.reject(m).catch(f)}}freeSocket(r,n){r.destroy()}destroy(){}}i.Agent=e})(Co||(Co={}));Co.prototype=Co.Agent.prototype;BA.exports=Co});var $A=p((SK,KA)=>{"use strict";var HA=nm(),UA=sm(),gB=oI(),mB=oh(),VA=WA(),yB=$n().inherits,Yn=cm()("https-proxy-agent");KA.exports=Xa;function Xa(i){if(!(this instanceof Xa))return new Xa(i);if(typeof i=="string"&&(i=gB.parse(i)),!i)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");Yn("creating new HttpsProxyAgent instance: %o",i),VA.call(this,i);var e=Object.assign({},i);this.secureProxy=e.protocol?/^https:?$/i.test(e.protocol):!1,e.host=e.hostname||e.host,e.port=+e.port||(this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in e)&&(e.ALPNProtocols=["http 1.1"]),e.host&&e.path&&(delete e.path,delete e.pathname),this.proxy=e}yB(Xa,VA);Xa.prototype.callback=function(e,t,r){var n=this.proxy,s;this.secureProxy?s=UA.connect(n):s=HA.connect(n);var o=[],a=0;function c(){var _=s.read();_?f(_):s.once("readable",c)}function l(){s.removeListener("end",h),s.removeListener("error",d),s.removeListener("close",u),s.removeListener("readable",c)}function u(_){Yn("onclose had error %o",_)}function h(){Yn("onend")}function d(_){l(),r(_)}function f(_){o.push(_),a+=_.length;var P=Buffer.concat(o,a),O=P.toString("ascii");if(!~O.indexOf(`\r
\r
`)){Yn("have not received end of HTTP headers yet..."),c();return}var x=O.substring(0,O.indexOf(`\r
`)),ie=+x.split(" ")[1];if(Yn("got proxy server response: %o",x),ie==200){var G=s;o=P=null,t.secureEndpoint&&(Yn("upgrading proxy-connected socket to TLS connection: %o",t.host),t.socket=s,t.servername=t.servername||t.host,t.host=null,t.hostname=null,t.port=null,G=UA.connect(t)),l(),e.once("socket",_B),r(null,G)}else l(),s.destroy(),s=new HA.Socket,s.readable=!0,o=P,e.once("socket",g),r(null,s)}function g(_){Yn("replaying proxy buffer for failed request"),mB(_.listenerCount("data")>0),_.push(o),o=null}s.on("error",d),s.on("close",u),s.on("end",h),c();var m=t.host+":"+t.port,y="CONNECT "+m+` HTTP/1.1\r
`,b=Object.assign({},n.headers);n.auth&&(b["Proxy-Authorization"]="Basic "+Buffer.from(n.auth).toString("base64"));var S=t.host;SB(t.port,t.secureEndpoint)||(S+=":"+t.port),b.Host=S,b.Connection="close",Object.keys(b).forEach(function(_){y+=_+": "+b[_]+`\r
`}),s.write(y+`\r
`)};function _B(i){i.resume()}function SB(i,e){return!!(!e&&i===80||e&&i===443)}});var YA=p((CK,GA)=>{"use strict";GA.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var xy=p(mi=>{"use strict";var CB=mi&&mi.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),bB=mi&&mi.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),JA=mi&&mi.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.hasOwnProperty.call(i,t)&&CB(e,i,t);return bB(e,i),e},Dy=mi&&mi.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(mi,"__esModule",{value:!0});mi.WebsocketMessageAdapter=void 0;var wB=JA(nm()),PB=JA(sm()),EB=Dy(bE()),RB=Dy($A()),IB=Dy(YA()),TB=_t(),W=M(),wh=class i{constructor(e,t,r,n,s,o){if(!e)throw new W.ArgumentNullError("uri");if(!r)throw new W.ArgumentNullError("messageFormatter");this.proxyInfo=n,this.privConnectionEvents=new W.EventSource,this.privConnectionId=t,this.privMessageFormatter=r,this.privConnectionState=W.ConnectionState.None,this.privUri=e,this.privHeaders=s,this.privEnableCompression=o,this.privHeaders[TB.HeaderNames.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===W.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new W.Deferred,this.privCertificateValidatedDeferral=new W.Deferred,this.privConnectionState=W.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!i.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let e={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve(),e.agent=this.getAgent();let r=new URL(this.privUri).protocol;r?.toLocaleLowerCase()==="wss:"?r="https:":r?.toLocaleLowerCase()==="ws:"&&(r="http:"),e.agent.protocol=r,this.privWebsocketClient=new IB.default(this.privUri,e)}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new W.Queue,this.privDisconnectDeferral=new W.Deferred,this.privSendMessageQueue=new W.Queue,this.processSendQueue().catch(e=>{W.Events.instance.onEvent(new W.BackgroundEvent(e))})}catch(e){return this.privConnectionEstablishDeferral.resolve(new W.ConnectionOpenResponse(500,e)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new W.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=W.ConnectionState.Connected,this.onEvent(new W.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new W.ConnectionOpenResponse(200,""))},e=>{this.privConnectionEstablishDeferral.reject(e)})},this.privWebsocketClient.onerror=e=>{this.onEvent(new W.ConnectionErrorEvent(this.privConnectionId,e.message,e.type)),this.privLastErrorReceived=e.message},this.privWebsocketClient.onclose=e=>{this.privConnectionState===W.ConnectionState.Connecting?(this.privConnectionState=W.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new W.ConnectionOpenResponse(e.code,e.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=W.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new W.ConnectionClosedEvent(this.privConnectionId,e.code,e.reason))),this.onClose(e.code,e.reason).catch(t=>{W.Events.instance.onEvent(new W.BackgroundEvent(t))})},this.privWebsocketClient.onmessage=e=>{let t=new Date().toISOString();if(this.privConnectionState===W.ConnectionState.Connected){let r=new W.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(r.promise),e.data instanceof ArrayBuffer){let n=new W.RawWebsocketMessage(W.MessageType.Binary,e.data);this.privMessageFormatter.toConnectionMessage(n).then(s=>{this.onEvent(new W.ConnectionMessageReceivedEvent(this.privConnectionId,t,s)),r.resolve(s)},s=>{r.reject(`Invalid binary message format. Error: ${s}`)})}else{let n=new W.RawWebsocketMessage(W.MessageType.Text,e.data);this.privMessageFormatter.toConnectionMessage(n).then(s=>{this.onEvent(new W.ConnectionMessageReceivedEvent(this.privConnectionId,t,s)),r.resolve(s)},s=>{r.reject(`Invalid text message format. Error: ${s}`)})}}},this.privConnectionEstablishDeferral.promise}send(e){if(this.privConnectionState!==W.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${W.ConnectionState[this.privConnectionState]} state`);let t=new W.Deferred,r=new W.Deferred;return this.privSendMessageQueue.enqueueFromPromise(r.promise),this.privMessageFormatter.fromConnectionMessage(e).then(n=>{r.resolve({Message:e,RawWebsocketMessage:n,sendStatusDeferral:t})},n=>{r.reject(`Error formatting the message. ${n}`)}),t.promise}read(){return this.privConnectionState!==W.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(e){if(this.privWebsocketClient)this.privConnectionState!==W.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(e){try{if(!e)return Promise.resolve();if(this.onEvent(new W.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),e.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(e.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+e.Message.id+" "+new Error().stack);return Promise.resolve()}catch(t){return Promise.reject(`websocket send error: ${t}`)}}onClose(e,t){return v(this,null,function*(){let r=`Connection closed. ${e}: ${t}`;this.privConnectionState=W.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),yield this.privReceivingMessageQueue.drainAndDispose(()=>{},r),yield this.privSendMessageQueue.drainAndDispose(n=>{n.sendStatusDeferral.reject(r)},r)})}processSendQueue(){return v(this,null,function*(){for(;;){let t=yield this.privSendMessageQueue.dequeue();if(!t)return;try{yield this.sendRawMessage(t),t.sendStatusDeferral.resolve()}catch(r){t.sendStatusDeferral.reject(r)}}})}onEvent(e){this.privConnectionEvents.onEvent(e),W.Events.instance.onEvent(e)}getAgent(){let e=new EB.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(e.proxyInfo=this.proxyInfo),e}static GetProxyAgent(e){let t={host:e.HostName,port:e.Port};return e.UserName?t.headers={"Proxy-Authentication":"Basic "+new Buffer(`${e.UserName}:${e.Password===void 0?"":e.Password}`).toString("base64")}:t.headers={},t.headers.requestOCSP="true",new RB.default(t)}createConnection(e,t){let r;if(t=ra(se({},t),{requestOCSP:!0,servername:t.host}),this.proxyInfo){let s=i.GetProxyAgent(this.proxyInfo);r=new Promise((o,a)=>{s.callback(e,t,(c,l)=>{c?a(c):o(l)})})}else t.secureEndpoint?r=Promise.resolve(PB.connect(t)):r=Promise.resolve(wB.connect(t));return r}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};mi.WebsocketMessageAdapter=wh;wh.forceNpmWebSocket=!1});var XA=p(Ph=>{"use strict";Object.defineProperty(Ph,"__esModule",{value:!0});Ph.WebsocketConnection=void 0;var My=M(),AB=xy(),ky=class{constructor(e,t,r,n,s,o=!1,a){if(this.privIsDisposed=!1,!e)throw new My.ArgumentNullError("uri");if(!n)throw new My.ArgumentNullError("messageFormatter");this.privMessageFormatter=n;let c="",l=0;if(t){for(let u in t)if(u){c+=l===0&&e.indexOf("?")===-1?"?":"&";let h=encodeURIComponent(u);c+=h;let d=t[u];d&&(d=encodeURIComponent(d),c+=`=${d}`),l++}}if(r){for(let u in r)if(u){c+=l===0&&e.indexOf("?")===-1?"?":"&";let h=encodeURIComponent(r[u]);c+=`${u}=${h}`,l++}}this.privUri=e+c,this.privId=a||My.createNoDashGuid(),this.privConnectionMessageAdapter=new AB.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,s,r,o)}dispose(){return v(this,null,function*(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&(yield this.privConnectionMessageAdapter.close())})}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(e){return this.privConnectionMessageAdapter.send(e)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};Ph.WebsocketConnection=ky});var ZA=p(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});Eh.ReplayableAudioNode=void 0;var Ny=class{constructor(e,t){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=e,this.privBytesPerSecond=t}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){let e=this.privReplayOffset-this.privBufferStartOffset,t=Math.round(e*this.privBytesPerSecond*1e-7);t%2!==0&&t++;let r=0;for(;r<this.privBuffers.length&&t>=this.privBuffers[r].chunk.buffer.byteLength;)t-=this.privBuffers[r++].chunk.buffer.byteLength;if(r<this.privBuffers.length){let n=this.privBuffers[r].chunk.buffer.slice(t);return this.privReplayOffset+=n.byteLength/this.privBytesPerSecond*1e7,r===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:n,isEnd:!1,timeReceived:this.privBuffers[r].chunk.timeReceived})}}return this.privAudioNode.read().then(e=>(e&&e.buffer&&(this.privBuffers.push(new Ly(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=e;let t=e-this.privBufferStartOffset,r=Math.round(t*this.privBytesPerSecond*1e-7),n=0;for(;n<this.privBuffers.length&&r>=this.privBuffers[n].chunk.buffer.byteLength;)r-=this.privBuffers[n++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-r/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(n)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(let t of this.privBuffers){let r=t.byteOffset/this.privBytesPerSecond*1e7,n=r+t.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=r&&e<=n)return t.chunk.timeReceived}return 0}};Eh.ReplayableAudioNode=Ny;var Ly=class{constructor(e,t,r){this.chunk=e,this.serial=t,this.byteOffset=r}}});var qy=p(or=>{"use strict";var OB=or&&or.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),DB=or&&or.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),xB=or&&or.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.hasOwnProperty.call(i,t)&&OB(e,i,t);return DB(e,i),e};Object.defineProperty(or,"__esModule",{value:!0});or.AudioFileWriter=void 0;var Za=xB(Zg()),jy=j(),zy=class{constructor(e){jy.Contracts.throwIfNullOrUndefined(Za.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=Za.openSync(e,"w")}set format(e){jy.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let t=0;this.privAudioFormat.hasHeader&&(t=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=Za.createWriteStream("",{fd:this.privFd,start:t,autoClose:!1}))}write(e){jy.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),Za.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),Za.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};or.AudioFileWriter=zy});var Fy=p(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.PullAudioInputStreamImpl=yi.PullAudioInputStream=yi.PushAudioInputStreamImpl=yi.PushAudioInputStream=yi.AudioInputStream=void 0;var Rh=T(),st=M(),QA=Hr(),MB=w(),kB=Kr(),Qa=class{constructor(){}static createPushStream(e){return ec.create(e)}static createPullStream(e,t){return tc.create(e,t)}};yi.AudioInputStream=Qa;var ec=class extends Qa{static create(e){return new Ih(e)}};yi.PushAudioInputStream=ec;var Ih=class extends ec{constructor(e){super(),e===void 0?this.privFormat=kB.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=e,this.privEvents=new st.EventSource,this.privId=QA.createNoDashGuid(),this.privStream=new st.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new st.AudioSourceInitializingEvent(this.privId)),this.onEvent(new st.AudioSourceReadyEvent(this.privId))}attach(e){return v(this,null,function*(){this.onEvent(new st.AudioStreamNodeAttachingEvent(this.privId,e)),yield this.turnOn();let t=this.privStream;return this.onEvent(new st.AudioStreamNodeAttachedEvent(this.privId,e)),{detach:()=>v(this,null,function*(){return this.onEvent(new st.AudioStreamNodeDetachedEvent(this.privId,e)),this.turnOff()}),id:()=>e,read:()=>t.read()}})}detach(e){this.onEvent(new st.AudioStreamNodeDetachedEvent(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:Rh.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:Rh.type.Stream})}onEvent(e){this.privEvents.onEvent(e),st.Events.instance.onEvent(e)}toBuffer(e){let t=Buffer.alloc(e.byteLength),r=new Uint8Array(e);for(let n=0;n<t.length;++n)t[n]=r[n];return t}};yi.PushAudioInputStreamImpl=Ih;var tc=class extends Qa{constructor(){super()}static create(e,t){return new Th(e,t)}};yi.PullAudioInputStream=tc;var Th=class extends tc{constructor(e,t){super(),t===void 0?this.privFormat=MB.AudioStreamFormat.getDefaultInputFormat():this.privFormat=t,this.privEvents=new st.EventSource,this.privId=QA.createNoDashGuid(),this.privCallback=e,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new st.AudioSourceInitializingEvent(this.privId)),this.onEvent(new st.AudioSourceReadyEvent(this.privId))}attach(e){return v(this,null,function*(){return this.onEvent(new st.AudioStreamNodeAttachingEvent(this.privId,e)),yield this.turnOn(),this.onEvent(new st.AudioStreamNodeAttachedEvent(this.privId,e)),{detach:()=>(this.privCallback.close(),this.onEvent(new st.AudioStreamNodeDetachedEvent(this.privId,e)),this.turnOff()),id:()=>e,read:()=>{let t=0,r;for(;t<this.privBufferSize;){let n=new ArrayBuffer(this.privBufferSize-t),s=this.privCallback.read(n);if(r===void 0?r=n:new Int8Array(r).set(new Int8Array(n),t),s===0)break;t+=s}return Promise.resolve({buffer:r.slice(0,t),isEnd:this.privIsClosed||t===0,timeReceived:Date.now()})}}})}detach(e){this.onEvent(new st.AudioStreamNodeDetachedEvent(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:Rh.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:Rh.type.Stream})}onEvent(e){this.privEvents.onEvent(e),st.Events.instance.onEvent(e)}};yi.PullAudioInputStreamImpl=Th});var By=p(ic=>{"use strict";Object.defineProperty(ic,"__esModule",{value:!0});ic.SpeechSynthesisOutputFormat=void 0;var NB;(function(i){i[i.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",i[i.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",i[i.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",i[i.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",i[i.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",i[i.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",i[i.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",i[i.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",i[i.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",i[i.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",i[i.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",i[i.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",i[i.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",i[i.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",i[i.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",i[i.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",i[i.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",i[i.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",i[i.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",i[i.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",i[i.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",i[i.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",i[i.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",i[i.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",i[i.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",i[i.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",i[i.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",i[i.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",i[i.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",i[i.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",i[i.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",i[i.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",i[i.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",i[i.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",i[i.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",i[i.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",i[i.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",i[i.AmrWb16000Hz=37]="AmrWb16000Hz",i[i.G72216Khz64Kbps=38]="G72216Khz64Kbps"})(NB=ic.SpeechSynthesisOutputFormat||(ic.SpeechSynthesisOutputFormat={}))});var bo=p(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});Oh.AudioOutputFormatImpl=void 0;var $=By(),U=Kr(),Ah=class i extends U.AudioStreamFormatImpl{constructor(e,t,r,n,s,o,a,c,l){super(r,o,t,e),this.formatTag=e,this.avgBytesPerSec=n,this.blockAlign=s,this.priAudioFormatString=a,this.priRequestAudioFormatString=c,this.priHasHeader=l}static fromSpeechSynthesisOutputFormat(e){return e===void 0?i.getDefaultOutputFormat():i.fromSpeechSynthesisOutputFormatString(i.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new i(U.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new i(U.AudioFormatTag.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new i(U.AudioFormatTag.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new i(U.AudioFormatTag.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new i(U.AudioFormatTag.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new i(U.AudioFormatTag.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new i(U.AudioFormatTag.MP3,1,24e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new i(U.AudioFormatTag.MP3,1,24e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new i(U.AudioFormatTag.MP3,1,24e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new i(U.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new i(U.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new i(U.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,e,e,!1);case"ogg-24khz-16bit-mono-opus":return new i(U.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,e,e,!1);case"raw-48khz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new i(U.AudioFormatTag.MP3,1,48e3,12288,2,16,e,e,!1);case"audio-48khz-192kbitrate-mono-mp3":return new i(U.AudioFormatTag.MP3,1,48e3,24576,2,16,e,e,!1);case"ogg-48khz-16bit-mono-opus":return new i(U.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,e,e,!1);case"webm-16khz-16bit-mono-opus":return new i(U.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,e,e,!1);case"webm-24khz-16bit-mono-opus":return new i(U.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,e,e,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new i(U.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new i(U.AudioFormatTag.OPUS,1,16e3,4e3,2,16,e,e,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new i(U.AudioFormatTag.OPUS,1,24e3,6e3,2,16,e,e,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new i(U.AudioFormatTag.OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-24khz-16bit-mono-flac":return new i(U.AudioFormatTag.FLAC,1,24e3,24e3,2,16,e,e,!1);case"audio-48khz-16bit-mono-flac":return new i(U.AudioFormatTag.FLAC,1,48e3,3e4,2,16,e,e,!1);case"raw-24khz-16bit-mono-truesilk":return new i(U.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,e,e,!1);case"raw-8khz-8bit-mono-alaw":return new i(U.AudioFormatTag.ALaw,1,8e3,8e3,1,8,e,e,!1);case"riff-8khz-8bit-mono-alaw":return new i(U.AudioFormatTag.ALaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,22050,44100,2,16,e,e,!1);case"riff-22050hz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,22050,44100,2,16,e,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,44100,88200,2,16,e,e,!1);case"riff-44100hz-16bit-mono-pcm":return new i(U.AudioFormatTag.PCM,1,44100,88200,2,16,e,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new i(U.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,e,e,!1);case"g722-16khz-64kbps":return new i(U.AudioFormatTag.G722,1,16e3,8e3,2,16,e,e,!1);case"riff-16khz-16bit-mono-pcm":default:return new i(U.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return i.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){if(this.priHasHeader){let t=new DataView(this.privHeader);t.setUint32(4,e+this.privHeader.byteLength-8,!0),t.setUint32(40,e,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(e){if(!this.hasHeader)return e;this.updateHeader(e.byteLength);let t=new Uint8Array(e.byteLength+this.header.byteLength);return t.set(new Uint8Array(this.header),0),t.set(new Uint8Array(e),this.header.byteLength),t.buffer}};Oh.AudioOutputFormatImpl=Ah;Ah.SpeechSynthesisOutputFormatToString={[$.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[$.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[$.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[$.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[$.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[$.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[$.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[$.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[$.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[$.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[$.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[$.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[$.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[$.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[$.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[$.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[$.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[$.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[$.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[$.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[$.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[$.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[$.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[$.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[$.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[$.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[$.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[$.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"}});var Jn=p(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.PushAudioOutputStreamImpl=_i.PushAudioOutputStream=_i.PullAudioOutputStreamImpl=_i.PullAudioOutputStream=_i.AudioOutputStream=void 0;var Wy=M(),LB=j(),jB=bo(),rc=class{constructor(){}static createPullStream(){return nc.create()}};_i.AudioOutputStream=rc;var nc=class extends rc{static create(){return new Dh}};_i.PullAudioOutputStream=nc;var Dh=class extends nc{constructor(){super(),this.privId=Wy.createNoDashGuid(),this.privStream=new Wy.Stream}set format(e){e==null&&(this.privFormat=jB.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}read(e){return v(this,null,function*(){let t=new Int8Array(e),r=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>e.byteLength)return t.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),Promise.resolve(e.byteLength);t.set(this.privLastChunkView),r=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;r<e.byteLength&&!this.privStream.isReadEnded;){let n=yield this.privStream.read();if(n!==void 0&&!n.isEnd){let s;n.buffer.byteLength>e.byteLength-r?(s=n.buffer.slice(0,e.byteLength-r),this.privLastChunkView=new Int8Array(n.buffer.slice(e.byteLength-r))):s=n.buffer,t.set(new Int8Array(s),r),r+=s.byteLength}else this.privStream.readEnded()}return r})}write(e){LB.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}};_i.PullAudioOutputStreamImpl=Dh;var xh=class extends rc{constructor(){super()}static create(e){return new Mh(e)}};_i.PushAudioOutputStream=xh;var Mh=class extends xh{constructor(e){super(),this.privId=Wy.createNoDashGuid(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}};_i.PushAudioOutputStreamImpl=Mh});var Hy=p(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.AudioOutputConfigImpl=tn.AudioConfigImpl=tn.AudioConfig=void 0;var Xn=Ve(),zB=j(),Zn=w(),qB=qy(),FB=Fy(),BB=Jn(),sc=class i{static fromDefaultMicrophoneInput(){let e=new Xn.PcmRecorder(!0);return new wr(new Xn.MicAudioSource(e))}static fromMicrophoneInput(e){let t=new Xn.PcmRecorder(!0);return new wr(new Xn.MicAudioSource(t,e))}static fromWavFileInput(e,t="unnamedBuffer.wav"){return new wr(new Xn.FileAudioSource(e,t))}static fromStreamInput(e){if(e instanceof Zn.PullAudioInputStreamCallback)return new wr(new FB.PullAudioInputStreamImpl(e));if(e instanceof Zn.AudioInputStream)return new wr(e);if(typeof MediaStream<"u"&&e instanceof MediaStream){let t=new Xn.PcmRecorder(!1);return new wr(new Xn.MicAudioSource(t,null,null,e))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new Pr(new Zn.SpeakerAudioDestination)}static fromSpeakerOutput(e){if(e===void 0)return i.fromDefaultSpeakerOutput();if(e instanceof Zn.SpeakerAudioDestination)return new Pr(e);throw new Error("Not Supported Type")}static fromAudioFileOutput(e){return new Pr(new qB.AudioFileWriter(e))}static fromStreamOutput(e){if(e instanceof Zn.PushAudioOutputStreamCallback)return new Pr(new BB.PushAudioOutputStreamImpl(e));if(e instanceof Zn.PushAudioOutputStream)return new Pr(e);if(e instanceof Zn.PullAudioOutputStream)return new Pr(e);throw new Error("Not Supported Type")}};tn.AudioConfig=sc;var wr=class extends sc{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(e,t){this.privSource.turnOff().then(()=>{e&&e()},r=>{t&&t(r)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.privSource.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,t){if(zB.Contracts.throwIfNull(t,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(e,t);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(e,t){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}};tn.AudioConfigImpl=wr;var Pr=class extends sc{constructor(e){super(),this.privDestination=e}set format(e){this.privDestination.format=e}write(e){this.privDestination.write(e)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}};tn.AudioOutputConfigImpl=Pr});var eO=p(oc=>{"use strict";Object.defineProperty(oc,"__esModule",{value:!0});oc.CancellationReason=void 0;var WB;(function(i){i[i.Error=0]="Error",i[i.EndOfStream=1]="EndOfStream"})(WB=oc.CancellationReason||(oc.CancellationReason={}))});var tO=p(kh=>{"use strict";Object.defineProperty(kh,"__esModule",{value:!0});kh.PullAudioInputStreamCallback=void 0;var Uy=class{};kh.PullAudioInputStreamCallback=Uy});var iO=p(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});Nh.PushAudioOutputStreamCallback=void 0;var Vy=class{};Nh.PushAudioOutputStreamCallback=Vy});var nO=p(Lh=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});Lh.KeywordRecognitionModel=void 0;var rO=j(),Ky=class{constructor(){this.privDisposed=!1}static fromFile(e){throw rO.Contracts.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")}static fromStream(e){throw rO.Contracts.throwIfNull(e,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};Lh.KeywordRecognitionModel=Ky});var sO=p(jh=>{"use strict";Object.defineProperty(jh,"__esModule",{value:!0});jh.SessionEventArgs=void 0;var $y=class{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}};jh.SessionEventArgs=$y});var oO=p(zh=>{"use strict";Object.defineProperty(zh,"__esModule",{value:!0});zh.RecognitionEventArgs=void 0;var HB=w(),Gy=class extends HB.SessionEventArgs{constructor(e,t){super(t),this.privOffset=e}get offset(){return this.privOffset}};zh.RecognitionEventArgs=Gy});var aO=p(ac=>{"use strict";Object.defineProperty(ac,"__esModule",{value:!0});ac.OutputFormat=void 0;var UB;(function(i){i[i.Simple=0]="Simple",i[i.Detailed=1]="Detailed"})(UB=ac.OutputFormat||(ac.OutputFormat={}))});var cO=p(qh=>{"use strict";Object.defineProperty(qh,"__esModule",{value:!0});qh.IntentRecognitionEventArgs=void 0;var VB=w(),Yy=class extends VB.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};qh.IntentRecognitionEventArgs=Yy});var lO=p(Fh=>{"use strict";Object.defineProperty(Fh,"__esModule",{value:!0});Fh.RecognitionResult=void 0;var Jy=class{constructor(e,t,r,n,s,o,a,c,l,u){this.privResultId=e,this.privReason=t,this.privText=r,this.privDuration=n,this.privOffset=s,this.privLanguage=o,this.privLanguageDetectionConfidence=a,this.privErrorDetails=c,this.privJson=l,this.privProperties=u}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};Fh.RecognitionResult=Jy});var uO=p(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});Bh.SpeechRecognitionResult=void 0;var KB=w(),Xy=class extends KB.RecognitionResult{constructor(e,t,r,n,s,o,a,c,l,u,h){super(e,t,r,n,s,o,a,l,u,h),this.privSpeakerId=c}get speakerId(){return this.privSpeakerId}};Bh.SpeechRecognitionResult=Xy});var hO=p(Wh=>{"use strict";Object.defineProperty(Wh,"__esModule",{value:!0});Wh.IntentRecognitionResult=void 0;var $B=w(),Zy=class extends $B.SpeechRecognitionResult{constructor(e,t,r,n,s,o,a,c,l,u,h){super(t,r,n,s,o,a,c,void 0,l,u,h),this.privIntentId=e}get intentId(){return this.privIntentId}};Wh.IntentRecognitionResult=Zy});var pO=p(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.LanguageUnderstandingModelImpl=Eo.LanguageUnderstandingModel=void 0;var wo=j(),Hh=class{constructor(){}static fromEndpoint(e){wo.Contracts.throwIfNull(e,"uri"),wo.Contracts.throwIfNullOrWhitespace(e.hostname,"uri");let t=new Po,r=e.host.indexOf(".");if(r===-1)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,r);let n=e.pathname.lastIndexOf("/")+1;if(n===-1)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(n),t.subscriptionKey=e.searchParams.get("subscription-key"),t.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return t}static fromAppId(e){wo.Contracts.throwIfNullOrWhitespace(e,"appId");let t=new Po;return t.appId=e,t}static fromSubscription(e,t,r){wo.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),wo.Contracts.throwIfNullOrWhitespace(t,"appId"),wo.Contracts.throwIfNullOrWhitespace(r,"region");let n=new Po;return n.appId=t,n.region=r,n.subscriptionKey=e,n}};Eo.LanguageUnderstandingModel=Hh;var Po=class extends Hh{};Eo.LanguageUnderstandingModelImpl=Po});var fO=p(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.MeetingTranscriptionEventArgs=rn.ConversationTranscriptionEventArgs=rn.SpeechRecognitionEventArgs=void 0;var dO=w(),Uh=class extends dO.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};rn.SpeechRecognitionEventArgs=Uh;var Qy=class extends dO.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};rn.ConversationTranscriptionEventArgs=Qy;var e_=class extends Uh{};rn.MeetingTranscriptionEventArgs=e_});var Ro=p(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});Vh.CancellationEventArgsBase=void 0;var GB=w(),t_=class extends GB.RecognitionEventArgs{constructor(e,t,r,n,s){super(n,s),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};Vh.CancellationEventArgsBase=t_});var vO=p(Kh=>{"use strict";Object.defineProperty(Kh,"__esModule",{value:!0});Kh.SpeechRecognitionCanceledEventArgs=void 0;var YB=Ro(),i_=class extends YB.CancellationEventArgsBase{};Kh.SpeechRecognitionCanceledEventArgs=i_});var gO=p($h=>{"use strict";Object.defineProperty($h,"__esModule",{value:!0});$h.TranslationRecognitionEventArgs=void 0;var JB=w(),r_=class extends JB.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};$h.TranslationRecognitionEventArgs=r_});var mO=p(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});Gh.TranslationSynthesisEventArgs=void 0;var XB=w(),n_=class extends XB.SessionEventArgs{constructor(e,t){super(t),this.privResult=e}get result(){return this.privResult}};Gh.TranslationSynthesisEventArgs=n_});var o_=p(Yh=>{"use strict";Object.defineProperty(Yh,"__esModule",{value:!0});Yh.TranslationRecognitionResult=void 0;var ZB=w(),s_=class i extends ZB.SpeechRecognitionResult{constructor(e,t,r,n,s,o,a,c,l,u,h){super(t,r,n,s,o,a,c,void 0,l,u,h),this.privTranslations=e}static fromSpeechRecognitionResult(e){return new i(void 0,e.resultId,e.reason,e.text,e.duration,e.offset,e.language,e.languageDetectionConfidence,e.errorDetails,e.json,e.properties)}get translations(){return this.privTranslations}};Yh.TranslationRecognitionResult=s_});var yO=p(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.TranslationSynthesisResult=void 0;var a_=class{constructor(e,t){this.privReason=e,this.privAudio=t}get audio(){return this.privAudio}get reason(){return this.privReason}};Jh.TranslationSynthesisResult=a_});var _O=p(cc=>{"use strict";Object.defineProperty(cc,"__esModule",{value:!0});cc.ResultReason=void 0;var QB;(function(i){i[i.NoMatch=0]="NoMatch",i[i.Canceled=1]="Canceled",i[i.RecognizingSpeech=2]="RecognizingSpeech",i[i.RecognizedSpeech=3]="RecognizedSpeech",i[i.RecognizedKeyword=4]="RecognizedKeyword",i[i.RecognizingIntent=5]="RecognizingIntent",i[i.RecognizedIntent=6]="RecognizedIntent",i[i.TranslatingSpeech=7]="TranslatingSpeech",i[i.TranslatedSpeech=8]="TranslatedSpeech",i[i.SynthesizingAudio=9]="SynthesizingAudio",i[i.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",i[i.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",i[i.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",i[i.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",i[i.RecognizedSpeakers=14]="RecognizedSpeakers",i[i.RecognizedSpeaker=15]="RecognizedSpeaker",i[i.ResetVoiceProfile=16]="ResetVoiceProfile",i[i.DeletedVoiceProfile=17]="DeletedVoiceProfile",i[i.VoicesListRetrieved=18]="VoicesListRetrieved",i[i.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",i[i.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",i[i.TranslatedInstantMessage=21]="TranslatedInstantMessage",i[i.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"})(QB=cc.ResultReason||(cc.ResultReason={}))});var SO=p(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.SpeechConfigImpl=Io.SpeechConfig=void 0;var lc=T(),Qn=j(),B=w(),Xh=class{constructor(){}static fromSubscription(e,t){Qn.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),Qn.Contracts.throwIfNullOrWhitespace(t,"region");let r=new es;return r.setProperty(B.PropertyId.SpeechServiceConnection_Region,t),r.setProperty(B.PropertyId.SpeechServiceConnection_IntentRegion,t),r.setProperty(B.PropertyId.SpeechServiceConnection_Key,e),r}static fromEndpoint(e,t){Qn.Contracts.throwIfNull(e,"endpoint");let r=new es;return r.setProperty(B.PropertyId.SpeechServiceConnection_Endpoint,e.href),t!==void 0&&r.setProperty(B.PropertyId.SpeechServiceConnection_Key,t),r}static fromHost(e,t){Qn.Contracts.throwIfNull(e,"hostName");let r=new es;return r.setProperty(B.PropertyId.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(e.port===""?"":":"+e.port)),t!==void 0&&r.setProperty(B.PropertyId.SpeechServiceConnection_Key,t),r}static fromAuthorizationToken(e,t){Qn.Contracts.throwIfNull(e,"authorizationToken"),Qn.Contracts.throwIfNullOrWhitespace(t,"region");let r=new es;return r.setProperty(B.PropertyId.SpeechServiceConnection_Region,t),r.setProperty(B.PropertyId.SpeechServiceConnection_IntentRegion,t),r.authorizationToken=e,r}close(){}};Io.SpeechConfig=Xh;var es=class i extends Xh{constructor(){super(),this.privProperties=new B.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=B.OutputFormat.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(B.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(B.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(B.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(B.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(B.PropertyId.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(B.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(B.PropertyId.SpeechServiceConnection_RecoLanguage,e)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(B.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(e){this.privProperties.setProperty(B.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e)}get outputFormat(){return B.OutputFormat[this.privProperties.getProperty(lc.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privProperties.setProperty(lc.OutputFormatPropertyName,B.OutputFormat[e])}get endpointId(){return this.privProperties.getProperty(B.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(B.PropertyId.SpeechServiceConnection_EndpointId,e)}setProperty(e,t){Qn.Contracts.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)}getProperty(e,t){return this.privProperties.getProperty(e,t)}setProxy(e,t,r,n){this.setProperty(B.PropertyId[B.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(B.PropertyId[B.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(B.PropertyId[B.PropertyId.SpeechServiceConnection_ProxyUserName],r),this.setProperty(B.PropertyId[B.PropertyId.SpeechServiceConnection_ProxyPassword],n)}setServiceProperty(e,t){let r=JSON.parse(this.privProperties.getProperty(lc.ServicePropertiesPropertyName,"{}"));r[e]=t,this.privProperties.setProperty(lc.ServicePropertiesPropertyName,JSON.stringify(r))}setProfanity(e){this.privProperties.setProperty(B.PropertyId.SpeechServiceResponse_ProfanityOption,B.ProfanityOption[e])}enableAudioLogging(){this.privProperties.setProperty(B.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(B.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(lc.ForceDictationPropertyName,"true")}clone(){let e=new i;return e.privProperties=this.privProperties.clone(),e}get speechSynthesisLanguage(){return this.privProperties.getProperty(B.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privProperties.setProperty(B.PropertyId.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(B.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privProperties.setProperty(B.PropertyId.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return B.SpeechSynthesisOutputFormat[this.privProperties.getProperty(B.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privProperties.setProperty(B.PropertyId.SpeechServiceConnection_SynthOutputFormat,B.SpeechSynthesisOutputFormat[e])}};Io.SpeechConfigImpl=es});var CO=p(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.SpeechTranslationConfigImpl=To.SpeechTranslationConfig=void 0;var uc=T(),qi=j(),N=w(),Zh=class extends N.SpeechConfig{constructor(){super()}static fromSubscription(e,t){qi.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),qi.Contracts.throwIfNullOrWhitespace(t,"region");let r=new ts;return r.properties.setProperty(N.PropertyId.SpeechServiceConnection_Key,e),r.properties.setProperty(N.PropertyId.SpeechServiceConnection_Region,t),r}static fromAuthorizationToken(e,t){qi.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),qi.Contracts.throwIfNullOrWhitespace(t,"region");let r=new ts;return r.properties.setProperty(N.PropertyId.SpeechServiceAuthorization_Token,e),r.properties.setProperty(N.PropertyId.SpeechServiceConnection_Region,t),r}static fromHost(e,t){qi.Contracts.throwIfNull(e,"hostName");let r=new ts;return r.setProperty(N.PropertyId.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(e.port===""?"":":"+e.port)),t!==void 0&&r.setProperty(N.PropertyId.SpeechServiceConnection_Key,t),r}static fromEndpoint(e,t){qi.Contracts.throwIfNull(e,"endpoint"),qi.Contracts.throwIfNull(t,"subscriptionKey");let r=new ts;return r.properties.setProperty(N.PropertyId.SpeechServiceConnection_Endpoint,e.href),r.properties.setProperty(N.PropertyId.SpeechServiceConnection_Key,t),r}};To.SpeechTranslationConfig=Zh;var ts=class extends Zh{constructor(){super(),this.privSpeechProperties=new N.PropertyCollection,this.outputFormat=N.OutputFormat.Simple}set authorizationToken(e){qi.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceAuthorization_Token,e)}set speechRecognitionLanguage(e){qi.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceConnection_RecoLanguage,e)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return N.OutputFormat[this.privSpeechProperties.getProperty(uc.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privSpeechProperties.setProperty(uc.OutputFormatPropertyName,N.OutputFormat[e])}get endpointId(){return this.privSpeechProperties.getProperty(N.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceConnection_EndpointId,e)}addTargetLanguage(e){qi.Contracts.throwIfNullOrWhitespace(e,"value");let t=this.targetLanguages;t.includes(e)||(t.push(e),this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(N.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(N.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(e){qi.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceConnection_TranslationVoice,e)}get region(){return this.privSpeechProperties.getProperty(N.PropertyId.SpeechServiceConnection_Region)}setProxy(e,t,r,n){this.setProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_ProxyUserName],r),this.setProperty(N.PropertyId[N.PropertyId.SpeechServiceConnection_ProxyPassword],n)}getProperty(e,t){return this.privSpeechProperties.getProperty(e,t)}setProperty(e,t){this.privSpeechProperties.setProperty(e,t)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(e,t){let r=JSON.parse(this.privSpeechProperties.getProperty(uc.ServicePropertiesPropertyName,"{}"));r[e]=t,this.privSpeechProperties.setProperty(uc.ServicePropertiesPropertyName,JSON.stringify(r))}setProfanity(e){this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceResponse_ProfanityOption,N.ProfanityOption[e])}enableAudioLogging(){this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(uc.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(N.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(N.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return N.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(N.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privSpeechProperties.setProperty(N.PropertyId.SpeechServiceConnection_SynthOutputFormat,N.SpeechSynthesisOutputFormat[e])}};To.SpeechTranslationConfigImpl=ts});var l_=p(Qh=>{"use strict";Object.defineProperty(Qh,"__esModule",{value:!0});Qh.PropertyCollection=void 0;var bO=w(),c_=class i{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,t){let r;typeof e=="string"?r=e:r=bO.PropertyId[e];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===r)return this.privValues[n];if(t!==void 0)return String(t)}setProperty(e,t){let r;typeof e=="string"?r=e:r=bO.PropertyId[e];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===r){this.privValues[n]=t;return}this.privKeys.push(r),this.privValues.push(t)}clone(){let e=new i;for(let t=0;t<this.privKeys.length;t++)e.privKeys.push(this.privKeys[t]),e.privValues.push(this.privValues[t]);return e}mergeTo(e){this.privKeys.forEach(t=>{if(e.getProperty(t,void 0)===void 0){let r=this.getProperty(t);e.setProperty(t,r)}})}get keys(){return this.privKeys}};Qh.PropertyCollection=c_});var ep=p(hc=>{"use strict";Object.defineProperty(hc,"__esModule",{value:!0});hc.PropertyId=void 0;var e3;(function(i){i[i.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",i[i.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",i[i.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",i[i.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",i[i.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",i[i.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",i[i.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",i[i.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",i[i.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",i[i.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",i[i.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",i[i.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",i[i.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",i[i.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",i[i.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",i[i.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",i[i.Speech_SessionId=16]="Speech_SessionId",i[i.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",i[i.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",i[i.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",i[i.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",i[i.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",i[i.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",i[i.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",i[i.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",i[i.CancellationDetails_Reason=25]="CancellationDetails_Reason",i[i.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",i[i.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",i[i.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",i[i.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",i[i.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",i[i.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",i[i.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",i[i.SpeechServiceConnection_EnableAudioLogging=33]="SpeechServiceConnection_EnableAudioLogging",i[i.SpeechServiceConnection_LanguageIdMode=34]="SpeechServiceConnection_LanguageIdMode",i[i.SpeechServiceConnection_RecognitionEndpointVersion=35]="SpeechServiceConnection_RecognitionEndpointVersion",i[i.SpeechServiceConnection_SpeakerIdMode=36]="SpeechServiceConnection_SpeakerIdMode",i[i.SpeechServiceResponse_ProfanityOption=37]="SpeechServiceResponse_ProfanityOption",i[i.SpeechServiceResponse_PostProcessingOption=38]="SpeechServiceResponse_PostProcessingOption",i[i.SpeechServiceResponse_RequestWordLevelTimestamps=39]="SpeechServiceResponse_RequestWordLevelTimestamps",i[i.SpeechServiceResponse_StablePartialResultThreshold=40]="SpeechServiceResponse_StablePartialResultThreshold",i[i.SpeechServiceResponse_OutputFormatOption=41]="SpeechServiceResponse_OutputFormatOption",i[i.SpeechServiceResponse_TranslationRequestStablePartialResult=42]="SpeechServiceResponse_TranslationRequestStablePartialResult",i[i.SpeechServiceResponse_RequestWordBoundary=43]="SpeechServiceResponse_RequestWordBoundary",i[i.SpeechServiceResponse_RequestPunctuationBoundary=44]="SpeechServiceResponse_RequestPunctuationBoundary",i[i.SpeechServiceResponse_RequestSentenceBoundary=45]="SpeechServiceResponse_RequestSentenceBoundary",i[i.Conversation_ApplicationId=46]="Conversation_ApplicationId",i[i.Conversation_DialogType=47]="Conversation_DialogType",i[i.Conversation_Initial_Silence_Timeout=48]="Conversation_Initial_Silence_Timeout",i[i.Conversation_From_Id=49]="Conversation_From_Id",i[i.Conversation_Conversation_Id=50]="Conversation_Conversation_Id",i[i.Conversation_Custom_Voice_Deployment_Ids=51]="Conversation_Custom_Voice_Deployment_Ids",i[i.Conversation_Speech_Activity_Template=52]="Conversation_Speech_Activity_Template",i[i.Conversation_Request_Bot_Status_Messages=53]="Conversation_Request_Bot_Status_Messages",i[i.Conversation_Agent_Connection_Id=54]="Conversation_Agent_Connection_Id",i[i.SpeechServiceConnection_Host=55]="SpeechServiceConnection_Host",i[i.ConversationTranslator_Host=56]="ConversationTranslator_Host",i[i.ConversationTranslator_Name=57]="ConversationTranslator_Name",i[i.ConversationTranslator_CorrelationId=58]="ConversationTranslator_CorrelationId",i[i.ConversationTranslator_Token=59]="ConversationTranslator_Token",i[i.PronunciationAssessment_ReferenceText=60]="PronunciationAssessment_ReferenceText",i[i.PronunciationAssessment_GradingSystem=61]="PronunciationAssessment_GradingSystem",i[i.PronunciationAssessment_Granularity=62]="PronunciationAssessment_Granularity",i[i.PronunciationAssessment_EnableMiscue=63]="PronunciationAssessment_EnableMiscue",i[i.PronunciationAssessment_Json=64]="PronunciationAssessment_Json",i[i.PronunciationAssessment_Params=65]="PronunciationAssessment_Params",i[i.SpeakerRecognition_Api_Version=66]="SpeakerRecognition_Api_Version",i[i.WebWorkerLoadType=67]="WebWorkerLoadType",i[i.TalkingAvatarService_WebRTC_SDP=68]="TalkingAvatarService_WebRTC_SDP"})(e3=hc.PropertyId||(hc.PropertyId={}))});var PO=p(rp=>{"use strict";Object.defineProperty(rp,"__esModule",{value:!0});rp.Recognizer=void 0;var is=T(),wO=M(),tp=j(),ip=w(),u_=class i{constructor(e,t,r){this.audioConfig=e!==void 0?e:ip.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=r,this.implCommonRecognizerSetup()}close(e,t){tp.Contracts.throwIfDisposed(this.privDisposed),wO.marshalPromiseToCallbacks(this.dispose(!0),e,t)}get internalData(){return this.privReco}dispose(e){return v(this,null,function*(){this.privDisposed||(this.privDisposed=!0,e&&this.privReco&&(yield this.privReco.audioSource.turnOff(),yield this.privReco.dispose()))})}static get telemetryEnabled(){return is.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(e){is.ServiceRecognizerBase.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e=typeof window<"u"?"Browser":"Node",t="unknown",r="unknown";typeof navigator<"u"&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);let n=this.createRecognizerConfig(new is.SpeechServiceConfig(new is.Context(new is.OS(e,t,r))));this.privReco=this.createServiceRecognizer(i.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,n)}recognizeOnceAsyncImpl(e){return v(this,null,function*(){tp.Contracts.throwIfDisposed(this.privDisposed);let t=new wO.Deferred;yield this.implRecognizerStop(),yield this.privReco.recognize(e,t.resolve,t.reject);let r=yield t.promise;return yield this.implRecognizerStop(),r})}startContinuousRecognitionAsyncImpl(e){return v(this,null,function*(){tp.Contracts.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop(),yield this.privReco.recognize(e,void 0,void 0)})}stopContinuousRecognitionAsyncImpl(){return v(this,null,function*(){tp.Contracts.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop()})}implRecognizerStop(){return v(this,null,function*(){this.privReco&&(yield this.privReco.stopRecognizing())})}static getAuthFromProperties(e){let t=e.getProperty(ip.PropertyId.SpeechServiceConnection_Key,void 0);return t&&t!==""?new is.CognitiveSubscriptionKeyAuthentication(t):new is.CognitiveTokenAuthentication(()=>{let n=e.getProperty(ip.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(n)},()=>{let n=e.getProperty(ip.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(n)})}};rp.Recognizer=u_});var EO=p(sp=>{"use strict";Object.defineProperty(sp,"__esModule",{value:!0});sp.SpeechRecognizer=void 0;var Ao=T(),np=M(),nn=j(),Ht=w(),h_=class i extends Ht.Recognizer{constructor(e,t){let r=e;nn.Contracts.throwIfNull(r,"speechConfig"),nn.Contracts.throwIfNullOrWhitespace(r.properties.getProperty(Ht.PropertyId.SpeechServiceConnection_RecoLanguage),Ht.PropertyId[Ht.PropertyId.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new Ao.SpeechConnectionFactory),this.privDisposedRecognizer=!1}static FromConfig(e,t,r){let n=e;return t.properties.mergeTo(n.properties),new i(e,r)}get endpointId(){return nn.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ht.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(Ht.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){nn.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Ht.PropertyId.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return nn.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ht.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return nn.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ao.OutputFormatPropertyName,Ht.OutputFormat[Ht.OutputFormat.Simple])===Ht.OutputFormat[Ht.OutputFormat.Simple]?Ht.OutputFormat.Simple:Ht.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(e,t){np.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(Ao.RecognitionMode.Interactive),e,t)}startContinuousRecognitionAsync(e,t){np.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(Ao.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){np.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,r){nn.Contracts.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e){e&&e()}close(e,t){nn.Contracts.throwIfDisposed(this.privDisposedRecognizer),np.marshalPromiseToCallbacks(this.dispose(!0),e,t)}dispose(e){return v(this,null,function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield je(i.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new Ao.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new Ao.SpeechServiceRecognizer(e,t,s,n,this)}};sp.SpeechRecognizer=h_});var RO=p(ap=>{"use strict";Object.defineProperty(ap,"__esModule",{value:!0});ap.IntentRecognizer=void 0;var rs=T(),op=M(),Ct=j(),Er=w(),p_=class i extends Er.Recognizer{constructor(e,t){Ct.Contracts.throwIfNullOrUndefined(e,"speechConfig");let r=e;Ct.Contracts.throwIfNullOrUndefined(r,"speechConfig"),super(t,r.properties,new rs.IntentConnectionFactory),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=r.properties,Ct.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(Er.PropertyId.SpeechServiceConnection_RecoLanguage),Er.PropertyId[Er.PropertyId.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return Ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(Er.PropertyId.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(Er.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Er.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){if(Ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){let r=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",r.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(r.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}op.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(rs.RecognitionMode.Interactive),e,t)}startContinuousRecognitionAsync(e,t){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){let r=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",r.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(r.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}op.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(rs.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){op.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,r){Ct.Contracts.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){if(e)try{e()}catch(r){t&&t(r)}}addIntent(e,t){Ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Ct.Contracts.throwIfNullOrWhitespace(t,"intentId"),Ct.Contracts.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])}addIntentWithLanguageModel(e,t,r){Ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Ct.Contracts.throwIfNullOrWhitespace(e,"intentId"),Ct.Contracts.throwIfNull(t,"model");let n=t;Ct.Contracts.throwIfNullOrWhitespace(n.appId,"model.appId"),this.privAddedLmIntents[e]=new rs.AddedLmIntent(n,r)}addAllIntents(e,t){Ct.Contracts.throwIfNull(e,"model");let r=e;Ct.Contracts.throwIfNullOrWhitespace(r.appId,"model.appId"),this.privUmbrellaIntent=new rs.AddedLmIntent(r,t)}close(e,t){Ct.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),op.marshalPromiseToCallbacks(this.dispose(!0),e,t)}createRecognizerConfig(e){return new rs.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new rs.IntentServiceRecognizer(e,t,s,n,this)}dispose(e){return v(this,null,function*(){this.privDisposedIntentRecognizer||e&&(this.privDisposedIntentRecognizer=!0,yield je(i.prototype,this,"dispose").call(this,e))})}buildSpeechContext(){let e,t,r,n=[];this.privUmbrellaIntent!==void 0&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,r=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(let s of Object.keys(this.privAddedLmIntents)){let o=this.privAddedLmIntents[s];if(e===void 0)e=o.modelImpl.appId;else if(e!==o.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(t===void 0)t=o.modelImpl.region;else if(t!==o.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(r===void 0)r=o.modelImpl.subscriptionKey;else if(r!==o.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");let a="luis/"+e+"-PRODUCTION#"+s;n.push(a)}return{Intent:{id:e,key:r===void 0?this.privProperties.getProperty(Er.PropertyId[Er.PropertyId.SpeechServiceConnection_Key]):r,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?n:["luis/"+e+"-PRODUCTION"]}}};ap.IntentRecognizer=p_});var IO=p(pc=>{"use strict";Object.defineProperty(pc,"__esModule",{value:!0});pc.VoiceProfileType=void 0;var t3;(function(i){i[i.TextIndependentIdentification=0]="TextIndependentIdentification",i[i.TextDependentVerification=1]="TextDependentVerification",i[i.TextIndependentVerification=2]="TextIndependentVerification"})(t3=pc.VoiceProfileType||(pc.VoiceProfileType={}))});var v_=p(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.ConnectionMessageImpl=Oo.ConnectionMessage=void 0;var TO=_t(),AO=M(),i3=l_(),r3=ep(),d_=class{};Oo.ConnectionMessage=d_;var f_=class{constructor(e){this.privConnectionMessage=e,this.privProperties=new i3.PropertyCollection,this.privConnectionMessage.headers[TO.HeaderNames.ConnectionId]&&this.privProperties.setProperty(r3.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[TO.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(t=>{this.privProperties.setProperty(t,this.privConnectionMessage.headers[t])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(e=>e.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===AO.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===AO.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}};Oo.ConnectionMessageImpl=f_});var __=p(cp=>{"use strict";Object.defineProperty(cp,"__esModule",{value:!0});cp.Connection=void 0;var g_=T(),m_=M(),OO=v_(),n3=j(),dc=w(),y_=class i{static fromRecognizer(e){let t=e.internalData,r=new i;return r.privInternalData=t,r.setupEvents(),r}static fromSynthesizer(e){let t=e.internalData,r=new i;return r.privInternalData=t,r.setupEvents(),r}openConnection(e,t){m_.marshalPromiseToCallbacks(this.privInternalData.connect(),e,t)}closeConnection(e,t){if(this.privInternalData instanceof g_.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");m_.marshalPromiseToCallbacks(this.privInternalData.disconnect(),e,t)}setMessageProperty(e,t,r){if(n3.Contracts.throwIfNullOrWhitespace(t,"propertyName"),this.privInternalData instanceof g_.ServiceRecognizerBase){if(e.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(t,r)}else if(this.privInternalData instanceof g_.SynthesisAdapterBase){if(e.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(t,r)}}sendMessageAsync(e,t,r,n){m_.marshalPromiseToCallbacks(this.privInternalData.sendNetworkMessage(e,t),r,n)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(e=>{e.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new dc.ConnectionEventArgs(e.connectionId)):e.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new dc.ConnectionEventArgs(e.connectionId)):e.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new dc.ConnectionMessageEventArgs(new OO.ConnectionMessageImpl(e.message))):e.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new dc.ConnectionMessageEventArgs(new OO.ConnectionMessageImpl(e.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(e=>{this.receivedServiceMessage&&this.receivedServiceMessage(new dc.ServiceEventArgs(e.jsonString,e.name))})}};cp.Connection=y_});var DO=p(up=>{"use strict";Object.defineProperty(up,"__esModule",{value:!0});up.TranslationRecognizer=void 0;var fc=T(),lp=M(),s3=__(),Fi=j(),Re=w(),S_=class i extends Re.Recognizer{constructor(e,t,r){let n=e;Fi.Contracts.throwIfNull(n,"speechConfig"),super(t,n.properties,r||new fc.TranslationConnectionFactory),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&Fi.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_TranslationVoice),Re.PropertyId[Re.PropertyId.SpeechServiceConnection_TranslationVoice]),Fi.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_TranslationToLanguages),Re.PropertyId[Re.PropertyId.SpeechServiceConnection_TranslationToLanguages]),Fi.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_RecoLanguage),Re.PropertyId[Re.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(e,t,r){let n=e;return t.properties.mergeTo(n.properties),new i(e,r)}get speechRecognitionLanguage(){return Fi.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return Fi.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return Fi.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(Re.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Re.PropertyId.SpeechServiceAuthorization_Token,e)}recognizeOnceAsync(e,t){Fi.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),lp.marshalPromiseToCallbacks(this.recognizeOnceAsyncImpl(fc.RecognitionMode.Interactive),e,t)}startContinuousRecognitionAsync(e,t){lp.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(fc.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){lp.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}removeTargetLanguage(e){if(Fi.Contracts.throwIfNullOrUndefined(e,"language to be removed"),this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){let t=this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),r=t.indexOf(e);r>-1&&(t.splice(r,1),this.properties.setProperty(Re.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")),this.updateLanguages(t))}}addTargetLanguage(e){Fi.Contracts.throwIfNullOrUndefined(e,"language to be added");let t=[];this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(t=this.properties.getProperty(Re.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),t.includes(e)||(t.push(e),this.properties.setProperty(Re.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")))):(this.properties.setProperty(Re.PropertyId.SpeechServiceConnection_TranslationToLanguages,e),t=[e]),this.updateLanguages(t)}close(e,t){Fi.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),lp.marshalPromiseToCallbacks(this.dispose(!0),e,t)}onConnection(){}dispose(e){return v(this,null,function*(){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,e&&(yield this.implRecognizerStop(),yield je(i.prototype,this,"dispose").call(this,e)))})}createRecognizerConfig(e){return new fc.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new fc.TranslationServiceRecognizer(e,t,s,n,this)}updateLanguages(e){let t=s3.Connection.fromRecognizer(this);t&&(t.setMessageProperty("speech.context","translationcontext",{to:e}),t.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:e})))}};up.TranslationRecognizer=S_});var xO=p(hp=>{"use strict";Object.defineProperty(hp,"__esModule",{value:!0});hp.Translations=void 0;var o3=w(),C_=class{constructor(){this.privMap=new o3.PropertyCollection}get languages(){return this.privMap.keys}get(e,t){return this.privMap.getProperty(e,t)}set(e,t){this.privMap.setProperty(e,t)}};hp.Translations=C_});var MO=p(vc=>{"use strict";Object.defineProperty(vc,"__esModule",{value:!0});vc.NoMatchReason=void 0;var a3;(function(i){i[i.NotRecognized=0]="NotRecognized",i[i.InitialSilenceTimeout=1]="InitialSilenceTimeout",i[i.InitialBabbleTimeout=2]="InitialBabbleTimeout"})(a3=vc.NoMatchReason||(vc.NoMatchReason={}))});var kO=p(dp=>{"use strict";Object.defineProperty(dp,"__esModule",{value:!0});dp.NoMatchDetails=void 0;var b_=T(),pp=w(),w_=class i{constructor(e){this.privReason=e}static fromResult(e){let t=b_.SimpleSpeechPhrase.fromJSON(e.json),r=pp.NoMatchReason.NotRecognized;switch(t.RecognitionStatus){case b_.RecognitionStatus.BabbleTimeout:r=pp.NoMatchReason.InitialBabbleTimeout;break;case b_.RecognitionStatus.InitialSilenceTimeout:r=pp.NoMatchReason.InitialSilenceTimeout;break;default:r=pp.NoMatchReason.NotRecognized;break}return new i(r)}get reason(){return this.privReason}};dp.NoMatchDetails=w_});var NO=p(fp=>{"use strict";Object.defineProperty(fp,"__esModule",{value:!0});fp.TranslationRecognitionCanceledEventArgs=void 0;var P_=class{constructor(e,t,r,n,s){this.privCancelReason=t,this.privErrorDetails=r,this.privResult=s,this.privSessionId=e,this.privErrorCode=n}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};fp.TranslationRecognitionCanceledEventArgs=P_});var LO=p(vp=>{"use strict";Object.defineProperty(vp,"__esModule",{value:!0});vp.IntentRecognitionCanceledEventArgs=void 0;var c3=w(),E_=class extends c3.IntentRecognitionEventArgs{constructor(e,t,r,n,s,o){super(n,s,o),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};vp.IntentRecognitionCanceledEventArgs=E_});var I_=p(gp=>{"use strict";Object.defineProperty(gp,"__esModule",{value:!0});gp.CancellationDetailsBase=void 0;var R_=class{constructor(e,t,r){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};gp.CancellationDetailsBase=R_});var jO=p(yp=>{"use strict";Object.defineProperty(yp,"__esModule",{value:!0});yp.CancellationDetails=void 0;var mp=T(),l3=I_(),Do=w(),T_=class i extends l3.CancellationDetailsBase{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=Do.CancellationReason.Error,r=Do.CancellationErrorCode.NoError;if(e instanceof Do.RecognitionResult&&e.json){let n=mp.SimpleSpeechPhrase.fromJSON(e.json);t=mp.EnumTranslation.implTranslateCancelResult(n.RecognitionStatus)}return e.properties&&(r=Do.CancellationErrorCode[e.properties.getProperty(mp.CancellationErrorCodePropertyName,Do.CancellationErrorCode[Do.CancellationErrorCode.NoError])]),new i(t,e.errorDetails||mp.EnumTranslation.implTranslateErrorDetails(r),r)}};yp.CancellationDetails=T_});var zO=p(gc=>{"use strict";Object.defineProperty(gc,"__esModule",{value:!0});gc.CancellationErrorCode=void 0;var u3;(function(i){i[i.NoError=0]="NoError",i[i.AuthenticationFailure=1]="AuthenticationFailure",i[i.BadRequestParameters=2]="BadRequestParameters",i[i.TooManyRequests=3]="TooManyRequests",i[i.ConnectionFailure=4]="ConnectionFailure",i[i.ServiceTimeout=5]="ServiceTimeout",i[i.ServiceError=6]="ServiceError",i[i.RuntimeError=7]="RuntimeError",i[i.Forbidden=8]="Forbidden"})(u3=gc.CancellationErrorCode||(gc.CancellationErrorCode={}))});var qO=p(_p=>{"use strict";Object.defineProperty(_p,"__esModule",{value:!0});_p.ConnectionEventArgs=void 0;var h3=w(),A_=class extends h3.SessionEventArgs{};_p.ConnectionEventArgs=A_});var FO=p(Sp=>{"use strict";Object.defineProperty(Sp,"__esModule",{value:!0});Sp.ServiceEventArgs=void 0;var p3=w(),O_=class extends p3.SessionEventArgs{constructor(e,t,r){super(r),this.privJsonResult=e,this.privEventName=t}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};Sp.ServiceEventArgs=O_});var BO=p(Cp=>{"use strict";Object.defineProperty(Cp,"__esModule",{value:!0});Cp.PhraseListGrammar=void 0;var D_=class i{constructor(e){this.privGrammerBuilder=e.dynamicGrammar}static fromRecognizer(e){let t=e.internalData;return new i(t)}addPhrase(e){this.privGrammerBuilder.addPhrase(e)}addPhrases(e){this.privGrammerBuilder.addPhrase(e)}clear(){this.privGrammerBuilder.clearPhrases()}};Cp.PhraseListGrammar=D_});var wp=p(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.DialogServiceConfigImpl=xo.DialogServiceConfig=void 0;var d3=j(),mc=w(),bp=class{constructor(){}set applicationId(e){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};xo.DialogServiceConfig=bp;var x_=class extends bp{constructor(){super(),this.privSpeechConfig=new mc.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(e){d3.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(e){this.privSpeechConfig.outputFormat=e}setProperty(e,t){this.privSpeechConfig.setProperty(e,t)}getProperty(e,t){return this.privSpeechConfig.getProperty(e)}setProxy(e,t,r,n){this.setProperty(mc.PropertyId.SpeechServiceConnection_ProxyHostName,e),this.setProperty(mc.PropertyId.SpeechServiceConnection_ProxyPort,`${t}`),r&&this.setProperty(mc.PropertyId.SpeechServiceConnection_ProxyUserName,r),n&&this.setProperty(mc.PropertyId.SpeechServiceConnection_ProxyPassword,n)}setServiceProperty(e,t,r){this.privSpeechConfig.setServiceProperty(e,t)}close(){}};xo.DialogServiceConfigImpl=x_});var WO=p(Pp=>{"use strict";Object.defineProperty(Pp,"__esModule",{value:!0});Pp.BotFrameworkConfig=void 0;var ns=j(),Rr=wp(),Ut=w(),M_=class extends Rr.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(e,t,r){ns.Contracts.throwIfNullOrWhitespace(e,"subscription"),ns.Contracts.throwIfNullOrWhitespace(t,"region");let n=new Rr.DialogServiceConfigImpl;return n.setProperty(Ut.PropertyId.Conversation_DialogType,Rr.DialogServiceConfig.DialogTypes.BotFramework),n.setProperty(Ut.PropertyId.SpeechServiceConnection_Key,e),n.setProperty(Ut.PropertyId.SpeechServiceConnection_Region,t),r&&n.setProperty(Ut.PropertyId.Conversation_ApplicationId,r),n}static fromAuthorizationToken(e,t,r){ns.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),ns.Contracts.throwIfNullOrWhitespace(t,"region");let n=new Rr.DialogServiceConfigImpl;return n.setProperty(Ut.PropertyId.Conversation_DialogType,Rr.DialogServiceConfig.DialogTypes.BotFramework),n.setProperty(Ut.PropertyId.SpeechServiceAuthorization_Token,e),n.setProperty(Ut.PropertyId.SpeechServiceConnection_Region,t),r&&n.setProperty(Ut.PropertyId.Conversation_ApplicationId,r),n}static fromHost(e,t,r){ns.Contracts.throwIfNullOrUndefined(e,"host");let n=e instanceof URL?e:new URL(`wss://${e}.convai.speech.azure.us`);ns.Contracts.throwIfNullOrUndefined(n,"resolvedHost");let s=new Rr.DialogServiceConfigImpl;return s.setProperty(Ut.PropertyId.Conversation_DialogType,Rr.DialogServiceConfig.DialogTypes.BotFramework),s.setProperty(Ut.PropertyId.SpeechServiceConnection_Host,n.toString()),t!==void 0&&s.setProperty(Ut.PropertyId.SpeechServiceConnection_Key,t),s}static fromEndpoint(e,t){ns.Contracts.throwIfNull(e,"endpoint");let r=new Rr.DialogServiceConfigImpl;return r.setProperty(Ut.PropertyId.Conversation_DialogType,Rr.DialogServiceConfig.DialogTypes.BotFramework),r.setProperty(Ut.PropertyId.SpeechServiceConnection_Endpoint,e.toString()),t!==void 0&&r.setProperty(Ut.PropertyId.SpeechServiceConnection_Key,t),r}};Pp.BotFrameworkConfig=M_});var HO=p(Ep=>{"use strict";Object.defineProperty(Ep,"__esModule",{value:!0});Ep.CustomCommandsConfig=void 0;var ss=j(),yc=wp(),ar=w(),k_=class extends yc.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(e,t,r){ss.Contracts.throwIfNullOrWhitespace(e,"applicationId"),ss.Contracts.throwIfNullOrWhitespace(t,"subscription"),ss.Contracts.throwIfNullOrWhitespace(r,"region");let n=new yc.DialogServiceConfigImpl;return n.setProperty(ar.PropertyId.Conversation_DialogType,yc.DialogServiceConfig.DialogTypes.CustomCommands),n.setProperty(ar.PropertyId.Conversation_ApplicationId,e),n.setProperty(ar.PropertyId.SpeechServiceConnection_Key,t),n.setProperty(ar.PropertyId.SpeechServiceConnection_Region,r),n}static fromAuthorizationToken(e,t,r){ss.Contracts.throwIfNullOrWhitespace(e,"applicationId"),ss.Contracts.throwIfNullOrWhitespace(t,"authorizationToken"),ss.Contracts.throwIfNullOrWhitespace(r,"region");let n=new yc.DialogServiceConfigImpl;return n.setProperty(ar.PropertyId.Conversation_DialogType,yc.DialogServiceConfig.DialogTypes.CustomCommands),n.setProperty(ar.PropertyId.Conversation_ApplicationId,e),n.setProperty(ar.PropertyId.SpeechServiceAuthorization_Token,t),n.setProperty(ar.PropertyId.SpeechServiceConnection_Region,r),n}set applicationId(e){ss.Contracts.throwIfNullOrWhitespace(e,"value"),this.setProperty(ar.PropertyId.Conversation_ApplicationId,e)}get applicationId(){return this.getProperty(ar.PropertyId.Conversation_ApplicationId)}};Ep.CustomCommandsConfig=k_});var Ir=p(Rp=>{"use strict";Object.defineProperty(Rp,"__esModule",{value:!0});Rp.QueryParameterNames=void 0;var Se=class{};Rp.QueryParameterNames=Se;Se.BotId="botid";Se.CustomSpeechDeploymentId="cid";Se.CustomVoiceDeploymentId="deploymentId";Se.EnableAudioLogging="storeAudio";Se.EnableLanguageId="lidEnabled";Se.EnableWordLevelTimestamps="wordLevelTimestamps";Se.EndSilenceTimeoutMs="endSilenceTimeoutMs";Se.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs";Se.Format="format";Se.InitialSilenceTimeoutMs="initialSilenceTimeoutMs";Se.Language="language";Se.Profanity="profanity";Se.RequestBotStatusMessages="enableBotMessageStatus";Se.StableIntermediateThreshold="stableIntermediateThreshold";Se.StableTranslation="stableTranslation";Se.TestHooks="testhooks";Se.Postprocessing="postprocessing";Se.CtsMeetingId="meetingId";Se.CtsDeviceId="deviceId";Se.CtsIsParticipant="isParticipant";Se.EnableAvatar="enableTalkingAvatar"});var Si=p(Ip=>{"use strict";Object.defineProperty(Ip,"__esModule",{value:!0});Ip.ConnectionFactoryBase=void 0;var f3=T(),sn=w(),on=Ir(),N_=class{static getHostSuffix(e){if(e){if(e.toLowerCase().startsWith("china"))return".azure.cn";if(e.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(e,t,r){new Map([[sn.PropertyId.Speech_SegmentationSilenceTimeoutMs,on.QueryParameterNames.SegmentationSilenceTimeoutMs],[sn.PropertyId.SpeechServiceConnection_EnableAudioLogging,on.QueryParameterNames.EnableAudioLogging],[sn.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,on.QueryParameterNames.EndSilenceTimeoutMs],[sn.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,on.QueryParameterNames.InitialSilenceTimeoutMs],[sn.PropertyId.SpeechServiceResponse_PostProcessingOption,on.QueryParameterNames.Postprocessing],[sn.PropertyId.SpeechServiceResponse_ProfanityOption,on.QueryParameterNames.Profanity],[sn.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,on.QueryParameterNames.EnableWordLevelTimestamps],[sn.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,on.QueryParameterNames.StableIntermediateThreshold]]).forEach((o,a)=>{this.setUrlParameter(a,o,e,t,r)});let s=JSON.parse(e.parameters.getProperty(f3.ServicePropertiesPropertyName,"{}"));Object.keys(s).forEach(o=>{t[o]=s[o]})}setUrlParameter(e,t,r,n,s){let o=r.parameters.getProperty(e,void 0);o&&(!s||s.search(t)===-1)&&(n[t]=o.toLocaleLowerCase())}};Ip.ConnectionFactoryBase=N_});var $O=p(Ap=>{"use strict";Object.defineProperty(Ap,"__esModule",{value:!0});Ap.DialogConnectionFactory=void 0;var UO=Ve(),v3=T(),ni=w(),VO=Si(),g3=T(),KO=_t(),Tp=Ir(),_c=class i extends VO.ConnectionFactoryBase{create(e,t,r){let n=e.parameters.getProperty(ni.PropertyId.Conversation_ApplicationId,""),s=e.parameters.getProperty(ni.PropertyId.Conversation_DialogType),o=e.parameters.getProperty(ni.PropertyId.SpeechServiceConnection_Region),a=e.parameters.getProperty(ni.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),c=e.parameters.getProperty(ni.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),l={};l[KO.HeaderNames.ConnectionId]=r,l[Tp.QueryParameterNames.Format]=e.parameters.getProperty(v3.OutputFormatPropertyName,ni.OutputFormat[ni.OutputFormat.Simple]).toLowerCase(),l[Tp.QueryParameterNames.Language]=a,l[Tp.QueryParameterNames.RequestBotStatusMessages]=c,n&&(l[Tp.QueryParameterNames.BotId]=n,s===ni.DialogServiceConfig.DialogTypes.CustomCommands&&(l[KO.HeaderNames.CustomCommandsAppId]=n));let u=s===ni.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",h=s===ni.DialogServiceConfig.DialogTypes.CustomCommands?"v1":s===ni.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",d={};t.token!=null&&t.token!==""&&(d[t.headerName]=t.token);let f=e.parameters.getProperty(ni.PropertyId.SpeechServiceConnection_Endpoint,"");if(!f){let m=VO.ConnectionFactoryBase.getHostSuffix(o),y=e.parameters.getProperty(ni.PropertyId.SpeechServiceConnection_Host,`wss://${o}.${i.BaseUrl}${m}`);f=`${y.endsWith("/")?y:y+"/"}${u}${i.ApiKey}/${h}`}this.setCommonUrlParams(e,l,f);let g=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new UO.WebsocketConnection(f,l,d,new g3.WebsocketMessageFormatter,UO.ProxyInfo.fromRecognizerConfig(e),g,r)}};Ap.DialogConnectionFactory=_c;_c.ApiKey="api";_c.BaseUrl="convai.speech"});var GO=p(Dp=>{"use strict";Object.defineProperty(Dp,"__esModule",{value:!0});Dp.DialogServiceConnector=void 0;var m3=$O(),L_=T(),Mo=M(),Op=j(),y3=w(),an=ep(),j_=class i extends y3.Recognizer{constructor(e,t){let r=e;Op.Contracts.throwIfNull(e,"dialogConfig"),super(t,r.properties,new m3.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=r.properties.clone();let n=this.buildAgentConfig();this.privReco.agentConfig.set(n)}connect(e,t){Mo.marshalPromiseToCallbacks(this.privReco.connect(),e,t)}disconnect(e,t){Mo.marshalPromiseToCallbacks(this.privReco.disconnect(),e,t)}get authorizationToken(){return this.properties.getProperty(an.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){Op.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(an.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(an.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(e){this.properties.setProperty(an.PropertyId.Conversation_Speech_Activity_Template,e)}listenOnceAsync(e,t){if(this.isTurnComplete){Op.Contracts.throwIfDisposed(this.privIsDisposed);let n=v(this,null,function*(){yield this.privReco.connect(),yield this.implRecognizerStop(),this.isTurnComplete=!1;let s=new Mo.Deferred;yield this.privReco.recognize(L_.RecognitionMode.Conversation,s.resolve,s.reject);let o=yield s.promise;return yield this.implRecognizerStop(),o});n.catch(()=>{this.dispose(!0).catch(()=>{})}),Mo.marshalPromiseToCallbacks(n.finally(()=>{this.isTurnComplete=!0}),e,t)}}sendActivityAsync(e,t,r){Mo.marshalPromiseToCallbacks(this.privReco.sendMessage(e),t,r)}close(e,t){Op.Contracts.throwIfDisposed(this.privIsDisposed),Mo.marshalPromiseToCallbacks(this.dispose(!0),e,t)}dispose(e){return v(this,null,function*(){this.privIsDisposed||e&&(this.privIsDisposed=!0,yield this.implRecognizerStop(),yield je(i.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new L_.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new L_.DialogServiceAdapter(e,t,s,n,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(an.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(an.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(an.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(an.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};Dp.DialogServiceConnector=j_});var YO=p(xp=>{"use strict";Object.defineProperty(xp,"__esModule",{value:!0});xp.ActivityReceivedEventArgs=void 0;var z_=class{constructor(e,t){this.privActivity=e,this.privAudioStream=t}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};xp.ActivityReceivedEventArgs=z_});var JO=p(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});Mp.TurnStatusResponsePayload=void 0;var q_=class i{constructor(e){this.privMessageStatusResponse=JSON.parse(e)}static fromJSON(e){return new i(e)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}};Mp.TurnStatusResponsePayload=q_});var XO=p(kp=>{"use strict";Object.defineProperty(kp,"__esModule",{value:!0});kp.TurnStatusReceivedEventArgs=void 0;var _3=JO(),F_=class{constructor(e){this.privTurnStatus=_3.TurnStatusResponsePayload.fromJSON(e)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};kp.TurnStatusReceivedEventArgs=F_});var ZO=p(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.ServicePropertyChannel=void 0;var S3;(function(i){i[i.UriQueryParameter=0]="UriQueryParameter"})(S3=Sc.ServicePropertyChannel||(Sc.ServicePropertyChannel={}))});var QO=p(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.ProfanityOption=void 0;var C3;(function(i){i[i.Masked=0]="Masked",i[i.Removed=1]="Removed",i[i.Raw=2]="Raw"})(C3=Cc.ProfanityOption||(Cc.ProfanityOption={}))});var eD=p(Np=>{"use strict";Object.defineProperty(Np,"__esModule",{value:!0});Np.BaseAudioPlayer=void 0;var b3=ki(),w3=w(),P3=Kr(),B_=class{constructor(e){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,e===void 0&&(e=w3.AudioStreamFormat.getDefaultInputFormat()),this.init(e)}playAudioSample(e,t,r){try{this.ensureInitializedContext();let n=this.formatAudioData(e),s=new Float32Array(this.samples.length+n.length);s.set(this.samples,0),s.set(n,this.samples.length),this.samples=s,t&&t()}catch(n){r&&r(n)}}stopAudio(e,t){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{e&&e()},r=>{t&&t(r)}),this.audioContext=null)}init(e){this.audioFormat=e,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();let e=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},e)}}createAudioContext(){this.audioContext=P3.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(e){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(e),128);case 16:return this.formatArrayBuffer(new Int16Array(e),32768);case 32:return this.formatArrayBuffer(new Int32Array(e),2147483648);default:throw new b3.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(e,t){let r=new Float32Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]/t;return r}updateAudioBuffer(){if(this.samples.length===0)return;let e=this.audioFormat.channels,t=this.audioContext.createBufferSource(),r=this.samples.length/e,n=this.audioContext.createBuffer(e,r,this.audioFormat.samplesPerSec);for(let s=0;s<e;s++){let o=s,a=n.getChannelData(s);for(let c=0;c<this.samples.length;c++,o+=e)a[c]=this.samples[o]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),t.buffer=n,t.connect(this.gainNode),t.start(this.startTime),this.startTime+=n.duration,this.samples=new Float32Array}playAudio(e){return v(this,null,function*(){this.audioContext===null&&this.createAudioContext();let t=this.audioContext.createBufferSource(),r=this.audioContext.destination;yield this.audioContext.decodeAudioData(e,n=>{t.buffer=n,t.connect(r),t.start(0)})})}};Np.BaseAudioPlayer=B_});var tD=p(Lp=>{"use strict";Object.defineProperty(Lp,"__esModule",{value:!0});Lp.ConnectionMessageEventArgs=void 0;var W_=class{constructor(e){this.privConnectionMessage=e}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};Lp.ConnectionMessageEventArgs=W_});var iD=p(jp=>{"use strict";Object.defineProperty(jp,"__esModule",{value:!0});jp.VoiceProfile=void 0;var H_=class{constructor(e,t){this.privId=e,this.privProfileType=t}get profileId(){return this.privId}get profileType(){return this.privProfileType}};jp.VoiceProfile=H_});var nD=p(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.VoiceProfileEnrollmentCancellationDetails=ko.VoiceProfileEnrollmentResult=void 0;var rD=T(),ot=w(),U_=class i{constructor(e,t,r){this.privReason=e,this.privProperties=new ot.PropertyCollection,this.privReason!==ot.ResultReason.Canceled?t&&(this.privDetails=JSON.parse(t),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=ot.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=r,this.privProperties.setProperty(rD.CancellationErrorCodePropertyName,ot.CancellationErrorCode[ot.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(e){let t=[];for(let r of e.value){let n=r.enrollmentStatus.toLowerCase()==="enrolling"?ot.ResultReason.EnrollingVoiceProfile:r.enrollmentStatus.toLowerCase()==="enrolled"?ot.ResultReason.EnrolledVoiceProfile:ot.ResultReason.Canceled,s=new i(n,null,null);s.privDetails=this.getIdentificationDetails(r),t.push(s)}return t}static FromVerificationProfileList(e){let t=[];for(let r of e.value){let n=r.enrollmentStatus.toLowerCase()==="enrolling"?ot.ResultReason.EnrollingVoiceProfile:r.enrollmentStatus.toLowerCase()==="enrolled"?ot.ResultReason.EnrolledVoiceProfile:ot.ResultReason.Canceled,s=new i(n,null,null);s.privDetails=this.getVerificationDetails(r),t.push(s)}return t}static getIdentificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount||0,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.identificationProfileId,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.verificationProfileId,remainingEnrollmentsCount:e.remainingEnrollments||e.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}};ko.VoiceProfileEnrollmentResult=U_;var V_=class i extends ot.CancellationDetailsBase{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=ot.CancellationReason.Error,r=ot.CancellationErrorCode.NoError;return e.properties&&(r=ot.CancellationErrorCode[e.properties.getProperty(rD.CancellationErrorCodePropertyName,ot.CancellationErrorCode[ot.CancellationErrorCode.NoError])]),new i(t,e.errorDetails,r)}};ko.VoiceProfileEnrollmentCancellationDetails=V_});var oD=p(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.VoiceProfileCancellationDetails=No.VoiceProfileResult=void 0;var sD=T(),E3=j(),cr=w(),K_=class{constructor(e,t){this.privReason=e,this.privProperties=new cr.PropertyCollection,e===cr.ResultReason.Canceled&&(E3.Contracts.throwIfNullOrUndefined(t,"statusText"),this.privErrorDetails=t,this.privProperties.setProperty(sD.CancellationErrorCodePropertyName,cr.CancellationErrorCode[cr.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}};No.VoiceProfileResult=K_;var $_=class i extends cr.CancellationDetailsBase{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=cr.CancellationReason.Error,r=cr.CancellationErrorCode.NoError;return e.properties&&(r=cr.CancellationErrorCode[e.properties.getProperty(sD.CancellationErrorCodePropertyName,cr.CancellationErrorCode[cr.CancellationErrorCode.NoError])]),new i(t,e.errorDetails,r)}};No.VoiceProfileCancellationDetails=$_});var aD=p(zp=>{"use strict";Object.defineProperty(zp,"__esModule",{value:!0});zp.VoiceProfilePhraseResult=void 0;var R3=j(),I3=w(),G_=class extends I3.VoiceProfileResult{constructor(e,t,r,n){super(e,t),this.privPhrases=[],R3.Contracts.throwIfNullOrUndefined(n,"phrase array"),this.privType=r,n&&n[0]&&(this.privPhrases=n)}get phrases(){return this.privPhrases}get type(){return this.privType}};zp.VoiceProfilePhraseResult=G_});var cD=p(Fp=>{"use strict";Object.defineProperty(Fp,"__esModule",{value:!0});Fp.VoiceProfileClient=void 0;var Y_=T(),T3=Hy(),qp=j(),os=w(),J_=class i extends os.Recognizer{constructor(e){qp.Contracts.throwIfNullOrUndefined(e,"speechConfig");let t=e;qp.Contracts.throwIfNull(t,"speechConfig"),super(T3.AudioConfig.fromStreamInput(os.AudioInputStream.createPushStream()),t.properties,new Y_.VoiceProfileConnectionFactory),this.privProperties=t.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(os.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){qp.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(os.PropertyId.SpeechServiceAuthorization_Token,e)}createProfileAsync(e,t){return v(this,null,function*(){let r=yield this.privVoiceAdapter.createProfile(e,t);return new os.VoiceProfile(r[0],e)})}retrieveEnrollmentResultAsync(e){return v(this,null,function*(){return this.privVoiceAdapter.retrieveEnrollmentResult(e)})}getAllProfilesAsync(e){return v(this,null,function*(){return this.privVoiceAdapter.getAllProfiles(e)})}getActivationPhrasesAsync(e,t){return v(this,null,function*(){return this.privVoiceAdapter.getActivationPhrases(e,t)})}enrollProfileAsync(e,t){return v(this,null,function*(){let r=t;return qp.Contracts.throwIfNullOrUndefined(r,"audioConfig"),this.audioConfig=t,this.privVoiceAdapter.SpeakerAudioSource=r,this.privVoiceAdapter.enrollProfile(e)})}deleteProfileAsync(e){return v(this,null,function*(){return this.privVoiceAdapter.deleteProfile(e)})}resetProfileAsync(e){return v(this,null,function*(){return this.privVoiceAdapter.resetProfile(e)})}close(){return v(this,null,function*(){yield this.dispose(!0)})}createServiceRecognizer(e,t,r,n){let s=r;return new Y_.VoiceServiceRecognizer(e,t,s,n,this)}dispose(e){return v(this,null,function*(){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,e&&(yield je(i.prototype,this,"dispose").call(this,e)))})}createRecognizerConfig(e){return new Y_.RecognizerConfig(e,this.properties)}getResult(e,t){return new os.VoiceProfileResult(e.ok?t:os.ResultReason.Canceled,e.statusText)}};Fp.VoiceProfileClient=J_});var lD=p(Bp=>{"use strict";Object.defineProperty(Bp,"__esModule",{value:!0});Bp.SpeakerRecognizer=void 0;var X_=T(),as=j(),Z_=w(),Q_=class i extends Z_.Recognizer{constructor(e,t){as.Contracts.throwIfNullOrUndefined(e,"speechConfig");let r=e;as.Contracts.throwIfNullOrUndefined(r,"speechConfig"),super(t,r.properties,new X_.SpeakerRecognitionConnectionFactory),this.privAudioConfigImpl=t,as.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=r.properties}get authorizationToken(){return this.properties.getProperty(Z_.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){as.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Z_.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e){return v(this,null,function*(){return as.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(e)})}close(){return v(this,null,function*(){as.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.dispose(!0)})}recognizeSpeakerOnceAsyncImpl(e){return v(this,null,function*(){as.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.implRecognizerStop();let t=yield this.privReco.recognizeSpeaker(e);return yield this.implRecognizerStop(),t})}implRecognizerStop(){return v(this,null,function*(){this.privReco&&(yield this.privReco.stopRecognizing())})}createRecognizerConfig(e){return new X_.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new X_.SpeakerServiceRecognizer(e,t,s,n,this)}dispose(e){return v(this,null,function*(){this.privDisposedSpeakerRecognizer||e&&(this.privDisposedSpeakerRecognizer=!0,yield je(i.prototype,this,"dispose").call(this,e))})}};Bp.SpeakerRecognizer=Q_});var uD=p(Wp=>{"use strict";Object.defineProperty(Wp,"__esModule",{value:!0});Wp.SpeakerIdentificationModel=void 0;var A3=j(),O3=w(),eS=class i{constructor(e){if(this.privVoiceProfiles=[],this.privProfileIds=[],A3.Contracts.throwIfNullOrUndefined(e,"VoiceProfiles"),e.length===0)throw new Error("Empty Voice Profiles array");for(let t of e){if(t.profileType!==O3.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+t.profileId);this.privVoiceProfiles.push(t),this.privProfileIds.push(t.profileId)}}static fromProfiles(e){return new i(e)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}};Wp.SpeakerIdentificationModel=eS});var pD=p(Hp=>{"use strict";Object.defineProperty(Hp,"__esModule",{value:!0});Hp.SpeakerVerificationModel=void 0;var D3=j(),hD=w(),tS=class i{constructor(e){if(D3.Contracts.throwIfNullOrUndefined(e,"VoiceProfile"),e.profileType===hD.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=e}static fromProfile(e){return new i(e)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===hD.VoiceProfileType.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}};Hp.SpeakerVerificationModel=tS});var iS=p(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.LanguageIdMode=void 0;var x3;(function(i){i[i.AtStart=0]="AtStart",i[i.Continuous=1]="Continuous"})(x3=bc.LanguageIdMode||(bc.LanguageIdMode={}))});var fD=p(Up=>{"use strict";Object.defineProperty(Up,"__esModule",{value:!0});Up.AutoDetectSourceLanguageConfig=void 0;var M3=T(),k3=j(),lr=w(),dD=iS(),rS=class i{constructor(){this.privProperties=new lr.PropertyCollection,this.privProperties.setProperty(lr.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=dD.LanguageIdMode.AtStart}static fromOpenRange(){let e=new i;return e.properties.setProperty(lr.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,M3.AutoDetectSourceLanguagesOpenRangeOptionName),e}static fromLanguages(e){k3.Contracts.throwIfArrayEmptyOrWhitespace(e,"languages");let t=new i;return t.properties.setProperty(lr.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e.join()),t}static fromSourceLanguageConfigs(e){if(e.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");let t=new i,r=[];return e.forEach(n=>{if(r.push(n.language),n.endpointId!==void 0&&n.endpointId!==""){let s=n.language+lr.PropertyId.SpeechServiceConnection_EndpointId.toString();t.properties.setProperty(s,n.endpointId)}}),t.properties.setProperty(lr.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,r.join()),t}get properties(){return this.privProperties}set mode(e){e===dD.LanguageIdMode.Continuous?(this.privProperties.setProperty(lr.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(lr.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(lr.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(lr.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=e}};Up.AutoDetectSourceLanguageConfig=rS});var gD=p(Vp=>{"use strict";Object.defineProperty(Vp,"__esModule",{value:!0});Vp.AutoDetectSourceLanguageResult=void 0;var vD=j(),nS=class i{constructor(e,t){vD.Contracts.throwIfNullOrUndefined(e,"language"),vD.Contracts.throwIfNullOrUndefined(t,"languageDetectionConfidence"),this.privLanguage=e,this.privLanguageDetectionConfidence=t}static fromResult(e){return new i(e.language,e.languageDetectionConfidence)}static fromConversationTranscriptionResult(e){return new i(e.language,e.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};Vp.AutoDetectSourceLanguageResult=nS});var mD=p(Kp=>{"use strict";Object.defineProperty(Kp,"__esModule",{value:!0});Kp.SourceLanguageConfig=void 0;var N3=j(),sS=class i{constructor(e,t){N3.Contracts.throwIfNullOrUndefined(e,"language"),this.privLanguage=e,this.privEndpointId=t}static fromLanguage(e,t){return new i(e,t)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};Kp.SourceLanguageConfig=sS});var _D=p(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.SpeakerRecognitionCancellationDetails=Tr.SpeakerRecognitionResult=Tr.SpeakerRecognitionResultType=void 0;var yD=T(),Vt=w(),$p;(function(i){i[i.Verify=0]="Verify",i[i.Identify=1]="Identify"})($p=Tr.SpeakerRecognitionResultType||(Tr.SpeakerRecognitionResultType={}));var oS=class{constructor(e,t=Vt.ResultReason.RecognizedSpeaker,r=Vt.CancellationErrorCode.NoError,n=""){this.privProperties=new Vt.PropertyCollection;let s=e.scenario==="TextIndependentIdentification"?$p.Identify:$p.Verify;this.privReason=t,this.privReason!==Vt.ResultReason.Canceled?s===$p.Identify?(this.privProfileId=e.identificationResult.identifiedProfile.profileId,this.privScore=e.identificationResult.identifiedProfile.score,this.privReason=Vt.ResultReason.RecognizedSpeakers):(this.privScore=e.verificationResult.score,e.verificationResult.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=Vt.ResultReason.NoMatch),e.verificationResult.profileId!==void 0&&e.verificationResult.profileId!==""&&(this.privProfileId=e.verificationResult.profileId)):(this.privErrorDetails=n,this.privProperties.setProperty(yD.CancellationErrorCodePropertyName,Vt.CancellationErrorCode[r])),this.privProperties.setProperty(Vt.PropertyId.SpeechServiceResponse_JsonResult,JSON.stringify(e))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}};Tr.SpeakerRecognitionResult=oS;var aS=class i extends Vt.CancellationDetailsBase{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=Vt.CancellationReason.Error,r=Vt.CancellationErrorCode.NoError;return e.properties&&(r=Vt.CancellationErrorCode[e.properties.getProperty(yD.CancellationErrorCodePropertyName,Vt.CancellationErrorCode[Vt.CancellationErrorCode.NoError])]),new i(t,e.errorDetails,r)}};Tr.SpeakerRecognitionCancellationDetails=aS});var cS=p(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.ConversationImpl=Lo.Conversation=void 0;var ae=T(),wc=M(),R=j(),oe=w(),Gp=class{constructor(){}static createConversationAsync(e,t,r,n){R.Contracts.throwIfNullOrUndefined(e,ae.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),R.Contracts.throwIfNullOrUndefined(e.region,ae.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!e.subscriptionKey&&!e.getProperty(oe.PropertyId[oe.PropertyId.SpeechServiceAuthorization_Token])&&R.Contracts.throwIfNullOrUndefined(e.subscriptionKey,ae.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let s,o,a;return typeof t=="string"?(s=new Pc(e,t),wc.marshalPromiseToCallbacks(v(this,null,function*(){}),r,n)):(s=new Pc(e),o=t,a=r,s.createConversationAsync(()=>{o&&o()},c=>{a&&a(c)})),s}};Lo.Conversation=Gp;var Pc=class extends Gp{constructor(e,t){if(super(),this.privErrors=ae.ConversationConnectionConfig.restErrors,this.onConnected=s=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,s)}catch{}},this.onDisconnected=s=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,s)}catch{}finally{this.close(!1)}},this.onCanceled=(s,o)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,o)}catch{}},this.onParticipantUpdateCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.id);if(a!==void 0){switch(o.key){case ae.ConversationTranslatorCommandTypes.changeNickname:a.displayName=o.value;break;case ae.ConversationTranslatorCommandTypes.setUseTTS:a.isUsingTts=o.value;break;case ae.ConversationTranslatorCommandTypes.setProfanityFiltering:a.profanity=o.value;break;case ae.ConversationTranslatorCommandTypes.setMute:a.isMuted=o.value;break;case ae.ConversationTranslatorCommandTypes.setTranslateToLanguages:a.translateToLanguages=o.value;break}this.privParticipants.addOrUpdateParticipant(a),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new oe.ConversationParticipantsChangedEventArgs(oe.ParticipantChangedReason.Updated,[this.toParticipant(a)],o.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(s,o)=>{try{this.privParticipants.participants.forEach(a=>a.isMuted=a.isHost?!1:o.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new oe.ConversationParticipantsChangedEventArgs(oe.ParticipantChangedReason.Updated,this.toParticipants(!1),o.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(s,o)=>{try{let a=this.privParticipants.addOrUpdateParticipant(o.participant);a!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new oe.ConversationParticipantsChangedEventArgs(oe.ParticipantChangedReason.JoinedConversation,[this.toParticipant(a)],o.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.participant.id);a!==void 0&&(this.privParticipants.deleteParticipant(o.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new oe.ConversationParticipantsChangedEventArgs(oe.ParticipantChangedReason.LeftConversation,[this.toParticipant(a)],o.sessionId)))}catch{}},this.onTranslationReceived=(s,o)=>{try{switch(o.command){case ae.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new oe.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case ae.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new oe.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case ae.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new oe.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break}}catch{}},this.onParticipantsListReceived=(s,o)=>{try{if(o.sessionToken!==void 0&&o.sessionToken!==null&&(this.privRoom.token=o.sessionToken),this.privParticipants.participants=[...o.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new oe.ConversationParticipantsChangedEventArgs(oe.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),o.sessionId)),this.me.isHost){let a=this.privConversationTranslator?.properties.getProperty(oe.PropertyId.ConversationTranslator_Name);a!==void 0&&a.length>0&&a!==this.me.displayName&&this.changeNicknameAsync(a)}}catch{}},this.onConversationExpiration=(s,o)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,o)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new oe.PropertyCollection,this.privManager=new ae.ConversationManager,e.getProperty(oe.PropertyId[oe.PropertyId.SpeechServiceConnection_RecoLanguage])||e.setProperty(oe.PropertyId[oe.PropertyId.SpeechServiceConnection_RecoLanguage],ae.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=e.getProperty(oe.PropertyId[oe.PropertyId.SpeechServiceConnection_RecoLanguage]),t)this.privConversationId=t;else{e.targetLanguages.length===0&&e.addTargetLanguage(this.privLanguage),e.getProperty(oe.PropertyId[oe.PropertyId.SpeechServiceResponse_ProfanityOption])||e.setProfanity(oe.ProfanityOption.Masked);let o=e.getProperty(oe.PropertyId[oe.PropertyId.ConversationTranslator_Name]);o==null&&(o="Host"),R.Contracts.throwIfNullOrTooLong(o,"nickname",50),R.Contracts.throwIfNullOrTooShort(o,"nickname",2),e.setProperty(oe.PropertyId[oe.PropertyId.ConversationTranslator_Name],o)}this.privConfig=e;let n=e;R.Contracts.throwIfNull(n,"speechConfig"),this.privProperties=n.properties.clone(),this.privIsConnected=!1,this.privParticipants=new ae.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){let e=this.conversationId,t=this.participants.map(s=>({id:s.id,preferredLanguage:s.preferredLanguage,voice:s.voice})),r={};for(let s of ae.ConversationConnectionConfig.transcriptionEventKeys){let o=this.properties.getProperty(s,"");o!==""&&(r[s]=o)}return{id:e,participants:t,conversationProperties:r}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(e){R.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}set conversationTranslator(e){this.privConversationTranslator=e}onToken(e){this.privConversationTranslator.onToken(e)}createConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,r=>{r||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=r,this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}startConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=ae.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}addParticipantAsync(e,t,r){R.Contracts.throwIfNullOrUndefined(e,"Participant"),wc.marshalPromiseToCallbacks(this.addParticipantImplAsync(e),t,r)}joinConversationAsync(e,t,r,n,s){try{R.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),R.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),R.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,o=>{R.Contracts.throwIfNullOrUndefined(o,this.privErrors.permissionDeniedConnect),this.privRoom=o,this.privConfig.authorizationToken=o.cognitiveSpeechAuthToken,n&&n(o.cognitiveSpeechAuthToken)},o=>{this.handleError(o,s)})}catch(o){this.handleError(o,s)}}deleteConversationAsync(e,t){wc.marshalPromiseToCallbacks(this.deleteConversationImplAsync(),e,t)}deleteConversationImplAsync(){return v(this,null,function*(){R.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),R.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),yield this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()})}endConversationAsync(e,t){wc.marshalPromiseToCallbacks(this.endConversationImplAsync(),e,t)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(e,t){try{R.Contracts.throwIfDisposed(this.privIsDisposed),R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}muteAllParticipantsAsync(e,t){try{R.Contracts.throwIfDisposed(this.privIsDisposed),R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}muteParticipantAsync(e,t,r){try{R.Contracts.throwIfDisposed(this.privIsDisposed),R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),()=>{this.handleCallback(t,r)},s=>{this.handleError(s,r)})}catch(n){this.handleError(n,r)}}removeParticipantAsync(e,t,r){try{if(R.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))wc.marshalPromiseToCallbacks(this.removeParticipantImplAsync(e),t,r);else{R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),r);let n="";typeof e=="string"?n=e:e.hasOwnProperty("id")?n=e.id:e.hasOwnProperty("userId")&&(n=e.userId),R.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(o=>o.id===n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(n),()=>{this.handleCallback(t,r)},o=>{this.handleError(o,r)})}}catch(n){this.handleError(n,r)}}unlockConversationAsync(e,t){try{R.Contracts.throwIfDisposed(this.privIsDisposed),R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}unmuteAllParticipantsAsync(e,t){try{R.Contracts.throwIfDisposed(this.privIsDisposed),R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}unmuteParticipantAsync(e,t,r){try{R.Contracts.throwIfDisposed(this.privIsDisposed),R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),()=>{this.handleCallback(t,r)},s=>{this.handleError(s,r)})}catch(n){this.handleError(n,r)}}sendTextMessageAsync(e,t,r){try{R.Contracts.throwIfDisposed(this.privIsDisposed),R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}setTranslatedLanguagesAsync(e,t,r){try{R.Contracts.throwIfDisposed(this.privIsDisposed),R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}changeNicknameAsync(e,t,r){try{R.Contracts.throwIfDisposed(this.privIsDisposed),R.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),R.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),R.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}connectTranscriberRecognizer(e){return v(this,null,function*(){this.privTranscriberRecognizer&&(yield this.privTranscriberRecognizer.close()),yield e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.conversation=this})}getKeepAlive(){let e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:ae.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(e){if(this.privParticipants.addOrUpdateParticipant(e)!==void 0&&this.privTranscriberRecognizer){let r=this.conversationInfo;return r.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(r,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);let t=this.conversationInfo;return t.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(t,"leave")}close(e){return v(this,null,function*(){try{this.privIsConnected=!1,yield this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(t){throw t}e&&this.dispose()})}handleCallback(e,t){if(e){try{e()}catch(r){t&&t(r)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){let r=e;t(r.name+": "+r.message)}else t(e)}toParticipants(e){let t=this.privParticipants.participants.map(r=>this.toParticipant(r));return e?t:t.filter(r=>r.isHost===!1)}toParticipant(e){return new oe.Participant(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return R.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),R.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:ae.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:ae.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMuteCommand(e,t){return R.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),R.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:ae.ConversationTranslatorCommandTypes.setMute,participantId:e,roomid:this.privRoom.roomId,type:ae.ConversationTranslatorMessageTypes.participantCommand,value:t})}getLockCommand(e){return R.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),R.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:ae.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:ae.ConversationTranslatorMessageTypes.participantCommand,value:e})}getEjectCommand(e){return R.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),R.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:ae.ConversationTranslatorCommandTypes.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:ae.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(e){return R.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),R.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:ae.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:ae.ConversationTranslatorMessageTypes.participantCommand,value:e})}getChangeNicknameCommand(e){return R.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),R.Contracts.throwIfNullOrWhitespace(e,"nickname"),R.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:ae.ConversationTranslatorCommandTypes.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:ae.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMessageCommand(e){return R.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),R.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),R.Contracts.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:ae.ConversationTranslatorMessageTypes.instantMessage})}};Lo.ConversationImpl=Pc});var SD=p(Yp=>{"use strict";Object.defineProperty(Yp,"__esModule",{value:!0});Yp.ConversationCommon=void 0;var lS=class{constructor(e){this.privAudioConfig=e}handleCallback(e,t){if(e){try{e()}catch(r){t&&t(r)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){let r=e;t(r.name+": "+r.message)}else t(e)}};Yp.ConversationCommon=lS});var CD=p(Jp=>{"use strict";Object.defineProperty(Jp,"__esModule",{value:!0});Jp.ConversationExpirationEventArgs=void 0;var L3=w(),uS=class extends L3.SessionEventArgs{constructor(e,t){super(t),this.privExpirationTime=e}get expirationTime(){return this.privExpirationTime}};Jp.ConversationExpirationEventArgs=uS});var bD=p(Xp=>{"use strict";Object.defineProperty(Xp,"__esModule",{value:!0});Xp.ConversationParticipantsChangedEventArgs=void 0;var j3=w(),hS=class extends j3.SessionEventArgs{constructor(e,t,r){super(r),this.privReason=e,this.privParticipant=t}get reason(){return this.privReason}get participants(){return this.privParticipant}};Xp.ConversationParticipantsChangedEventArgs=hS});var wD=p(Zp=>{"use strict";Object.defineProperty(Zp,"__esModule",{value:!0});Zp.ConversationTranslationCanceledEventArgs=void 0;var z3=Ro(),pS=class extends z3.CancellationEventArgsBase{};Zp.ConversationTranslationCanceledEventArgs=pS});var PD=p(Qp=>{"use strict";Object.defineProperty(Qp,"__esModule",{value:!0});Qp.ConversationTranslationEventArgs=void 0;var q3=w(),dS=class extends q3.RecognitionEventArgs{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}};Qp.ConversationTranslationEventArgs=dS});var ED=p(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});ed.ConversationTranslationResult=void 0;var F3=o_(),fS=class extends F3.TranslationRecognitionResult{constructor(e,t,r,n,s,o,a,c,l,u,h){super(t,n,s,o,a,c,void 0,void 0,l,u,h),this.privId=e,this.privOrigLang=r}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};ed.ConversationTranslationResult=fS});var gS=p(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});td.StringUtils=void 0;var vS=class{static formatString(e,t){if(!e)return"";if(!t)return e;let r="",n="",s=c=>{r+=c},o=c=>{n+=c},a=s;for(let c=0;c<e.length;c++){let l=e[c],u=c+1<e.length?e[c+1]:"";switch(l){case"{":u==="{"?(a("{"),c++):a=o;break;case"}":u==="}"?(a("}"),c++):(t.hasOwnProperty(n)&&(r+=t[n]),a=s,n="");break;default:a(l);break}}return r}};td.StringUtils=vS});var TD=p(nd=>{"use strict";Object.defineProperty(nd,"__esModule",{value:!0});nd.ConversationTranslatorConnectionFactory=void 0;var mS=Ve(),RD=gS(),B3=j(),id=w(),W3=_t(),Ci=Ir(),ID=Si(),yS=T(),rd=class i extends ID.ConnectionFactoryBase{constructor(e){super(),B3.Contracts.throwIfNullOrUndefined(e,"convGetter"),this.privConvGetter=e}create(e,t,r){let n=e.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",s=this.privConvGetter().room,o=s.cognitiveSpeechRegion||e.parameters.getProperty(id.PropertyId.SpeechServiceConnection_Region,""),a={hostSuffix:ID.ConnectionFactoryBase.getHostSuffix(o),path:i.CTS_VIRT_MIC_PATH,region:encodeURIComponent(o)};a[Ci.QueryParameterNames.Language]=encodeURIComponent(e.parameters.getProperty(id.PropertyId.SpeechServiceConnection_RecoLanguage,"")),a[Ci.QueryParameterNames.CtsMeetingId]=encodeURIComponent(s.roomId),a[Ci.QueryParameterNames.CtsDeviceId]=encodeURIComponent(s.participantId),a[Ci.QueryParameterNames.CtsIsParticipant]=s.isHost?"":"&"+Ci.QueryParameterNames.CtsIsParticipant;let c="",l={},u={};if(n){c=e.parameters.getProperty(id.PropertyId.SpeechServiceConnection_Endpoint),c||(c="wss://"+e.parameters.getProperty(id.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),c=RD.StringUtils.formatString(c,a);let d=new URL(c);d.searchParams.forEach((g,m)=>{l[m]=g}),new yS.TranscriberConnectionFactory().setQueryParams(l,e,c),l[Ci.QueryParameterNames.CtsMeetingId]=a[Ci.QueryParameterNames.CtsMeetingId],l[Ci.QueryParameterNames.CtsDeviceId]=a[Ci.QueryParameterNames.CtsDeviceId],s.isHost||(l[Ci.QueryParameterNames.CtsIsParticipant]=""),Ci.QueryParameterNames.Format in l||(l[Ci.QueryParameterNames.Format]="simple"),d.searchParams.forEach((g,m)=>{d.searchParams.set(m,l[m]),delete l[m]}),c=d.toString()}else{let d=new yS.TranslationConnectionFactory;c=d.getEndpointUrl(e,!0),c=RD.StringUtils.formatString(c,a),d.setQueryParams(l,e,c)}u[W3.HeaderNames.ConnectionId]=r,u[mS.RestConfigBase.configParams.token]=s.token,t.token&&(u[t.headerName]=t.token);let h=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return new mS.WebsocketConnection(c,l,u,new yS.WebsocketMessageFormatter,mS.ProxyInfo.fromRecognizerConfig(e),h,r)}};nd.ConversationTranslatorConnectionFactory=rd;rd.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio"});var OD=p(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.ConversationTranslator=cs.SpeechState=void 0;var Ec=T(),H3=TD(),sd=M(),Bi=j(),ye=w(),U3=cS(),AD=od(),Wi;(function(i){i[i.Inactive=0]="Inactive",i[i.Connecting=1]="Connecting",i[i.Connected=2]="Connected"})(Wi=cs.SpeechState||(cs.SpeechState={}));var _S=class extends ye.TranslationRecognizer{constructor(e,t,r,n){super(e,t,new H3.ConversationTranslatorConnectionFactory(n)),this.privSpeechState=Wi.Inactive,r&&(this.privTranslator=r,this.sessionStarted=()=>{this.privSpeechState=Wi.Connected},this.sessionStopped=()=>{this.privSpeechState=Wi.Inactive},this.recognizing=(s,o)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,o)},this.recognized=(s,o)=>v(this,null,function*(){o.result?.errorDetails?(yield this.cancelSpeech(),this.fireCancelEvent(o.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,o)}),this.canceled=()=>v(this,null,function*(){if(this.privSpeechState!==Wi.Inactive)try{yield this.cancelSpeech()}catch{this.privSpeechState=Wi.Inactive}}))}get state(){return this.privSpeechState}set state(e){this.privSpeechState=e}set authentication(e){this.privReco.authentication=e}onConnection(){this.privSpeechState=Wi.Connected}onCancelSpeech(){return v(this,null,function*(){this.privSpeechState=Wi.Inactive,yield this.cancelSpeech()})}fireCancelEvent(e){try{if(this.privTranslator.canceled){let t=new AD.ConversationTranslationCanceledEventArgs(ye.CancellationReason.Error,e,ye.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,t)}}catch{}}cancelSpeech(){return v(this,null,function*(){try{this.stopContinuousRecognitionAsync(),yield this.privReco?.disconnect(),this.privSpeechState=Wi.Inactive}catch{}})}},SS=class extends AD.ConversationCommon{constructor(e){super(e),this.privErrors=Ec.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new ye.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){return this.privConversation?.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===Wi.Connected||this.privCTRecognizer.state===Wi.Connecting||this.privConversation.isMutedByHost)}onToken(e){this.privCTRecognizer.authentication=e}setServiceProperty(e,t){let r=JSON.parse(this.privProperties.getProperty(Ec.ServicePropertiesPropertyName,"{}"));r[e]=t,this.privProperties.setProperty(Ec.ServicePropertiesPropertyName,JSON.stringify(r))}joinConversationAsync(e,t,r,n,s){try{if(typeof e=="string"){Bi.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),Bi.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s);let o=r;(o==null||o==="")&&(o=Ec.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=ye.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(ye.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(o),this.privSpeechTranslationConfig.setProperty(ye.PropertyId[ye.PropertyId.SpeechServiceConnection_RecoLanguage],o),this.privSpeechTranslationConfig.setProperty(ye.PropertyId[ye.PropertyId.ConversationTranslator_Name],t);let a=[ye.PropertyId.SpeechServiceConnection_Host,ye.PropertyId.ConversationTranslator_Host,ye.PropertyId.SpeechServiceConnection_Endpoint,ye.PropertyId.SpeechServiceConnection_ProxyHostName,ye.PropertyId.SpeechServiceConnection_ProxyPassword,ye.PropertyId.SpeechServiceConnection_ProxyPort,ye.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(let l of a){let u=this.privProperties.getProperty(l);if(u){let h=typeof l=="string"?l:ye.PropertyId[l];this.privSpeechTranslationConfig.setProperty(h,u)}}let c=JSON.parse(this.privProperties.getProperty(Ec.ServicePropertiesPropertyName,"{}"));for(let l of Object.keys(c))this.privSpeechTranslationConfig.setServiceProperty(l,c[l],ye.ServicePropertyChannel.UriQueryParameter);this.privConversation=new U3.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(e,t,o,l=>{l||this.handleError(new Error(this.privErrors.permissionDeniedConnect),s),this.privSpeechTranslationConfig.authorizationToken=l,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync(()=>{this.handleCallback(n,s)},u=>{this.handleError(u,s)})},l=>{this.handleError(l,s)})}else typeof e=="object"?(Bi.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),Bi.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(ye.PropertyId.ConversationTranslator_Name,t),this.privConversation=e,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,Bi.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),Bi.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=e.config,this.handleCallback(r,n)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),n)}catch(o){this.handleError(o,typeof r=="string"?s:n)}}leaveConversationAsync(e,t){sd.marshalPromiseToCallbacks(v(this,null,function*(){yield this.cancelSpeech(),yield this.privConversation.endConversationImplAsync(),yield this.privConversation.deleteConversationImplAsync(),this.dispose()}),e,t)}sendTextMessageAsync(e,t,r){try{Bi.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),Bi.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}",e)),this.privConversation.sendTextMessageAsync(e,t,r)}catch(n){this.handleError(n,r)}}startTranscribingAsync(e,t){sd.marshalPromiseToCallbacks(v(this,null,function*(){try{Bi.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),Bi.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&(yield this.connectTranslatorRecognizer()),Bi.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),t),yield this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(r){throw this.privIsSpeaking=!1,yield this.cancelSpeech(),r}}),e,t)}stopTranscribingAsync(e,t){sd.marshalPromiseToCallbacks(v(this,null,function*(){try{if(!this.privIsSpeaking){yield this.cancelSpeech();return}this.privIsSpeaking=!1,yield new Promise((r,n)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(r,n)})}catch{yield this.cancelSpeech()}}),e,t)}isDisposed(){return this.privIsDisposed}dispose(e,t,r){sd.marshalPromiseToCallbacks(v(this,null,function*(){this.isDisposed&&!this.privIsSpeaking||(yield this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)}),t,r)}cancelSpeech(){return v(this,null,function*(){try{this.privIsSpeaking=!1,yield this.privCTRecognizer?.onCancelSpeech(),this.privCTRecognizer=void 0}catch{}})}connectTranslatorRecognizer(){return v(this,null,function*(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=ye.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(ye.PropertyId[ye.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(ye.PropertyId[ye.PropertyId.SpeechServiceConnection_Key],"");let e=()=>this.privConversation;this.privCTRecognizer=new _S(this.privSpeechTranslationConfig,this.privAudioConfig,this,e)}catch(e){throw yield this.cancelSpeech(),e}})}startContinuousRecognition(){return new Promise((e,t)=>{this.privCTRecognizer.startContinuousRecognitionAsync(e,t)})}};cs.ConversationTranslator=SS});var DD=p(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});ad.ConversationTranscriber=void 0;var Rc=T(),CS=M(),ls=j(),xt=w(),bS=class i extends xt.Recognizer{constructor(e,t){let r=e;ls.Contracts.throwIfNull(r,"speechConfig"),ls.Contracts.throwIfNullOrWhitespace(r.properties.getProperty(xt.PropertyId.SpeechServiceConnection_RecoLanguage),xt.PropertyId[xt.PropertyId.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new Rc.ConversationTranscriberConnectionFactory),this.privProperties.setProperty(xt.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(e,t,r){let n=e;return t.properties.mergeTo(n.properties),new i(e,r)}get endpointId(){return ls.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(xt.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(xt.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){ls.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(xt.PropertyId.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return ls.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(xt.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return ls.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Rc.OutputFormatPropertyName,xt.OutputFormat[xt.OutputFormat.Simple])===xt.OutputFormat[xt.OutputFormat.Simple]?xt.OutputFormat.Simple:xt.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(e,t){CS.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(Rc.RecognitionMode.Conversation),e,t)}stopTranscribingAsync(e,t){CS.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}close(e,t){ls.Contracts.throwIfDisposed(this.privDisposedRecognizer),CS.marshalPromiseToCallbacks(this.dispose(!0),e,t)}dispose(e){return v(this,null,function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield je(i.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new Rc.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return n.isSpeakerDiarizationEnabled=!0,new Rc.ConversationTranscriptionServiceRecognizer(e,t,s,n,this)}};ad.ConversationTranscriber=bS});var xD=p(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.Participant=jo.User=void 0;var V3=w(),wS=class{constructor(e){this.privUserId=e}get userId(){return this.privUserId}};jo.User=wS;var PS=class i{constructor(e,t,r,n,s,o,a,c){this.privId=e,this.privAvatar=t,this.privDisplayName=r,this.privIsHost=n,this.privIsMuted=s,this.privIsUsingTts=o,this.privPreferredLanguage=a,this.privVoice=c,this.privProperties=new V3.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(e,t,r){return new i(e,"",e,!1,!1,!1,t,r)}};jo.Participant=PS});var MD=p(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.ParticipantChangedReason=void 0;var K3;(function(i){i[i.JoinedConversation=0]="JoinedConversation",i[i.LeftConversation=1]="LeftConversation",i[i.Updated=2]="Updated"})(K3=Ic.ParticipantChangedReason||(Ic.ParticipantChangedReason={}))});var kD=p(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.MeetingImpl=zo.Meeting=void 0;var le=T(),Tc=M(),I=j(),Ce=w(),cd=class{constructor(){}static createMeetingAsync(e,t,r,n){if(I.Contracts.throwIfNullOrUndefined(e,le.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),I.Contracts.throwIfNullOrUndefined(e.region,le.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),I.Contracts.throwIfNull(t,"meetingId"),t.length===0)throw new Error("meetingId cannot be empty");!e.subscriptionKey&&!e.getProperty(Ce.PropertyId[Ce.PropertyId.SpeechServiceAuthorization_Token])&&I.Contracts.throwIfNullOrUndefined(e.subscriptionKey,le.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let s=new ld(e,t);return Tc.marshalPromiseToCallbacks(v(this,null,function*(){}),r,n),s}};zo.Meeting=cd;var ld=class extends cd{constructor(e,t){super(),this.privErrors=le.ConversationConnectionConfig.restErrors,this.onConnected=s=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,s)}catch{}},this.onDisconnected=s=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,s)}catch{}finally{this.close(!1)}},this.onCanceled=(s,o)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,o)}catch{}},this.onParticipantUpdateCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.id);if(a!==void 0){switch(o.key){case le.ConversationTranslatorCommandTypes.changeNickname:a.displayName=o.value;break;case le.ConversationTranslatorCommandTypes.setUseTTS:a.isUsingTts=o.value;break;case le.ConversationTranslatorCommandTypes.setProfanityFiltering:a.profanity=o.value;break;case le.ConversationTranslatorCommandTypes.setMute:a.isMuted=o.value;break;case le.ConversationTranslatorCommandTypes.setTranslateToLanguages:a.translateToLanguages=o.value;break}this.privParticipants.addOrUpdateParticipant(a),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Ce.ConversationParticipantsChangedEventArgs(Ce.ParticipantChangedReason.Updated,[this.toParticipant(a)],o.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(s,o)=>{try{this.privParticipants.participants.forEach(a=>a.isMuted=a.isHost?!1:o.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Ce.ConversationParticipantsChangedEventArgs(Ce.ParticipantChangedReason.Updated,this.toParticipants(!1),o.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(s,o)=>{try{let a=this.privParticipants.addOrUpdateParticipant(o.participant);a!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Ce.ConversationParticipantsChangedEventArgs(Ce.ParticipantChangedReason.JoinedConversation,[this.toParticipant(a)],o.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(s,o)=>{try{let a=this.privParticipants.getParticipant(o.participant.id);a!==void 0&&(this.privParticipants.deleteParticipant(o.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Ce.ConversationParticipantsChangedEventArgs(Ce.ParticipantChangedReason.LeftConversation,[this.toParticipant(a)],o.sessionId)))}catch{}},this.onTranslationReceived=(s,o)=>{try{switch(o.command){case le.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new Ce.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case le.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new Ce.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break;case le.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new Ce.ConversationTranslationEventArgs(o.payload,void 0,o.sessionId));break}}catch{}},this.onParticipantsListReceived=(s,o)=>{try{if(o.sessionToken!==void 0&&o.sessionToken!==null&&(this.privRoom.token=o.sessionToken),this.privParticipants.participants=[...o.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Ce.ConversationParticipantsChangedEventArgs(Ce.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),o.sessionId)),this.me.isHost){let a=this.privConversationTranslator?.properties.getProperty(Ce.PropertyId.ConversationTranslator_Name);a!==void 0&&a.length>0&&a!==this.me.displayName&&this.changeNicknameAsync(a)}}catch{}},this.onConversationExpiration=(s,o)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,o)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new Ce.PropertyCollection,this.privManager=new le.ConversationManager,e.getProperty(Ce.PropertyId[Ce.PropertyId.SpeechServiceConnection_RecoLanguage])||e.setProperty(Ce.PropertyId[Ce.PropertyId.SpeechServiceConnection_RecoLanguage],le.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=e.getProperty(Ce.PropertyId[Ce.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=t,this.privConfig=e;let n=e;I.Contracts.throwIfNull(n,"speechConfig"),this.privProperties=n.properties.clone(),this.privIsConnected=!1,this.privParticipants=new le.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){let e=this.meetingId,t=this.participants.map(s=>({id:s.id,preferredLanguage:s.preferredLanguage,voice:s.voice})),r={};for(let s of le.ConversationConnectionConfig.transcriptionEventKeys){let o=this.properties.getProperty(s,"");o!==""&&(r[s]=o)}return{id:e,participants:t,meetingProperties:r}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(e){I.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}createMeetingAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,r=>{r||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=r,this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}startMeetingAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}addParticipantAsync(e,t,r){I.Contracts.throwIfNullOrUndefined(e,"Participant"),Tc.marshalPromiseToCallbacks(this.addParticipantImplAsync(e),t,r)}joinMeetingAsync(e,t,r,n,s){try{I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),I.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),I.Contracts.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,o=>{I.Contracts.throwIfNullOrUndefined(o,this.privErrors.permissionDeniedConnect),this.privRoom=o,this.privConfig.authorizationToken=o.cognitiveSpeechAuthToken,n&&n(o.cognitiveSpeechAuthToken)},o=>{this.handleError(o,s)})}catch(o){this.handleError(o,s)}}deleteMeetingAsync(e,t){Tc.marshalPromiseToCallbacks(this.deleteMeetingImplAsync(),e,t)}deleteMeetingImplAsync(){return v(this,null,function*(){I.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),I.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),yield this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()})}endMeetingAsync(e,t){Tc.marshalPromiseToCallbacks(this.endMeetingImplAsync(),e,t)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(e,t){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}muteAllParticipantsAsync(e,t){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}muteParticipantAsync(e,t,r){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),()=>{this.handleCallback(t,r)},s=>{this.handleError(s,r)})}catch(n){this.handleError(n,r)}}removeParticipantAsync(e,t,r){try{if(I.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))Tc.marshalPromiseToCallbacks(this.removeParticipantImplAsync(e),t,r);else{I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),r);let n="";typeof e=="string"?n=e:e.hasOwnProperty("id")?n=e.id:e.hasOwnProperty("userId")&&(n=e.userId),I.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(o=>o.id===n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(n),()=>{this.handleCallback(t,r)},o=>{this.handleError(o,r)})}}catch(n){this.handleError(n,r)}}unlockMeetingAsync(e,t){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}unmuteAllParticipantsAsync(e,t){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(e,t)},r=>{this.handleError(r,t)})}catch(r){this.handleError(r,t)}}unmuteParticipantAsync(e,t,r){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),!this.me.isHost&&this.me.id!==e&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),this.privParticipants.getParticipantIndex(e)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),()=>{this.handleCallback(t,r)},s=>{this.handleError(s,r)})}catch(n){this.handleError(n,r)}}sendTextMessageAsync(e,t,r){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}setTranslatedLanguagesAsync(e,t,r){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}changeNicknameAsync(e,t,r){try{I.Contracts.throwIfDisposed(this.privIsDisposed),I.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),I.Contracts.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),I.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),()=>{this.handleCallback(t,r)},n=>{this.handleError(n,r)})}catch(n){this.handleError(n,r)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}connectTranscriberRecognizer(e){return v(this,null,function*(){this.privTranscriberRecognizer&&(yield this.privTranscriberRecognizer.close()),yield e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.meeting=this})}getKeepAlive(){let e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:le.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(e){if(this.privParticipants.addOrUpdateParticipant(e)!==void 0&&this.privTranscriberRecognizer){let r=this.meetingInfo;return r.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(r,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);let t=this.meetingInfo;return t.participants=[e],this.privTranscriberRecognizer.pushMeetingEvent(t,"leave")}close(e){return v(this,null,function*(){try{this.privIsConnected=!1,yield this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(t){throw t}e&&this.dispose()})}handleCallback(e,t){if(e){try{e()}catch(r){t&&t(r)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){let r=e;t(r.name+": "+r.message)}else t(e)}toParticipants(e){let t=this.privParticipants.participants.map(r=>this.toParticipant(r));return e?t:t.filter(r=>r.isHost===!1)}toParticipant(e){return new Ce.Participant(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:le.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:le.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMuteCommand(e,t){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),I.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:le.ConversationTranslatorCommandTypes.setMute,participantId:e,roomid:this.privRoom.roomId,type:le.ConversationTranslatorMessageTypes.participantCommand,value:t})}getLockCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:le.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:le.ConversationTranslatorMessageTypes.participantCommand,value:e})}getEjectCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:le.ConversationTranslatorCommandTypes.ejectParticipant,participantId:e,roomid:this.privRoom.roomId,type:le.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:le.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:le.ConversationTranslatorMessageTypes.participantCommand,value:e})}getChangeNicknameCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(e,"nickname"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:le.ConversationTranslatorCommandTypes.changeNickname,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:le.ConversationTranslatorMessageTypes.participantCommand,value:e})}getMessageCommand(e){return I.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),I.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),I.Contracts.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:le.ConversationTranslatorMessageTypes.instantMessage})}};zo.MeetingImpl=ld});var ND=p(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});ud.MeetingTranscriptionCanceledEventArgs=void 0;var $3=Ro(),ES=class extends $3.CancellationEventArgsBase{};ud.MeetingTranscriptionCanceledEventArgs=ES});var LD=p(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});hd.MeetingTranscriber=void 0;var G3=T(),RS=M(),Ac=j(),Oc=w(),Y3=od(),IS=class{constructor(e){this.privAudioConfig=e,this.privProperties=new Oc.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return Ac.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Oc.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return Oc.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(Oc.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){Ac.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Oc.PropertyId.SpeechServiceAuthorization_Token,e)}joinMeetingAsync(e,t,r){let n=e;Ac.Contracts.throwIfNullOrUndefined(Y3.MeetingImpl,"Meeting"),this.privRecognizer=new G3.TranscriberRecognizer(e.config,this.privAudioConfig),Ac.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),RS.marshalPromiseToCallbacks(n.connectTranscriberRecognizer(this.privRecognizer),t,r)}startTranscribingAsync(e,t){this.privRecognizer.startContinuousRecognitionAsync(e,t)}stopTranscribingAsync(e,t){this.privRecognizer.stopContinuousRecognitionAsync(e,t)}leaveMeetingAsync(e,t){this.privRecognizer.disconnectCallbacks(),RS.marshalPromiseToCallbacks(v(this,null,function*(){}),e,t)}close(e,t){Ac.Contracts.throwIfDisposed(this.privDisposedRecognizer),RS.marshalPromiseToCallbacks(this.dispose(!0),e,t)}dispose(e){return v(this,null,function*(){this.privDisposedRecognizer||(this.privRecognizer&&(yield this.privRecognizer.close(),this.privRecognizer=void 0),e&&(this.privDisposedRecognizer=!0))})}};hd.MeetingTranscriber=IS});var jD=p(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});pd.ConversationTranscriptionResult=void 0;var J3=w(),TS=class extends J3.RecognitionResult{constructor(e,t,r,n,s,o,a,c,l,u,h){super(e,t,r,n,s,o,a,l,u,h),this.privSpeakerId=c}get speakerId(){return this.privSpeakerId}};pd.ConversationTranscriptionResult=TS});var od=p(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});var zD=cS();Object.defineProperty(Fe,"Conversation",{enumerable:!0,get:function(){return zD.Conversation}});Object.defineProperty(Fe,"ConversationImpl",{enumerable:!0,get:function(){return zD.ConversationImpl}});var X3=SD();Object.defineProperty(Fe,"ConversationCommon",{enumerable:!0,get:function(){return X3.ConversationCommon}});var Z3=CD();Object.defineProperty(Fe,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return Z3.ConversationExpirationEventArgs}});var Q3=bD();Object.defineProperty(Fe,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return Q3.ConversationParticipantsChangedEventArgs}});var e6=wD();Object.defineProperty(Fe,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return e6.ConversationTranslationCanceledEventArgs}});var t6=PD();Object.defineProperty(Fe,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return t6.ConversationTranslationEventArgs}});var i6=ED();Object.defineProperty(Fe,"ConversationTranslationResult",{enumerable:!0,get:function(){return i6.ConversationTranslationResult}});var r6=OD();Object.defineProperty(Fe,"ConversationTranslator",{enumerable:!0,get:function(){return r6.ConversationTranslator}});var n6=DD();Object.defineProperty(Fe,"ConversationTranscriber",{enumerable:!0,get:function(){return n6.ConversationTranscriber}});var qD=xD();Object.defineProperty(Fe,"Participant",{enumerable:!0,get:function(){return qD.Participant}});Object.defineProperty(Fe,"User",{enumerable:!0,get:function(){return qD.User}});var s6=MD();Object.defineProperty(Fe,"ParticipantChangedReason",{enumerable:!0,get:function(){return s6.ParticipantChangedReason}});var FD=kD();Object.defineProperty(Fe,"Meeting",{enumerable:!0,get:function(){return FD.Meeting}});Object.defineProperty(Fe,"MeetingImpl",{enumerable:!0,get:function(){return FD.MeetingImpl}});var o6=ND();Object.defineProperty(Fe,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return o6.MeetingTranscriptionCanceledEventArgs}});var a6=LD();Object.defineProperty(Fe,"MeetingTranscriber",{enumerable:!0,get:function(){return a6.MeetingTranscriber}});var c6=jD();Object.defineProperty(Fe,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return c6.ConversationTranscriptionResult}})});var dd=p(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.SynthesisRequest=qo.Synthesizer=void 0;var us=T(),l6=M(),BD=j(),cn=w(),AS=class i{constructor(e){let t=e;BD.Contracts.throwIfNull(t,"speechConfig"),this.privProperties=t.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new l6.Queue}get authorizationToken(){return this.properties.getProperty(cn.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){BD.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(cn.PropertyId.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(cn.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===us.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(e){let t={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"},r=this.properties.getProperty(cn.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),n=this.properties.getProperty(cn.PropertyId.SpeechServiceConnection_SynthVoice,""),s=i.XMLEncode(e);return this.autoDetectSourceLanguage?r="en-US":n=n||t[r],n&&(s=`<voice name='${n}'>${s}</voice>`),s=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${r}'>${s}</speak>`,s}dispose(e){return v(this,null,function*(){this.privDisposed||(e&&this.privAdapter&&(yield this.privAdapter.dispose()),this.privDisposed=!0)})}adapterSpeak(){return v(this,null,function*(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;let e=yield this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(e.text,e.isSSML,e.requestId,e.cb,e.err,e.dataStream)}})}createSynthesizerConfig(e){return new us.SynthesizerConfig(e,this.privProperties)}implCommonSynthesizeSetup(){let e=typeof window<"u"?"Browser":"Node",t="unknown",r="unknown";typeof navigator<"u"&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);let n=this.createSynthesizerConfig(new us.SpeechServiceConfig(new us.Context(new us.OS(e,t,r)))),s=this.privProperties.getProperty(cn.PropertyId.SpeechServiceConnection_Key,void 0),o=s&&s!==""?new us.CognitiveSubscriptionKeyAuthentication(s):new us.CognitiveTokenAuthentication(()=>{let a=this.privProperties.getProperty(cn.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(a)},()=>{let a=this.privProperties.getProperty(cn.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(a)});this.privAdapter=this.createSynthesisAdapter(o,this.privConnectionFactory,n),this.privRestAdapter=this.createRestSynthesisAdapter(o,n)}static XMLEncode(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};qo.Synthesizer=AS;var OS=class{constructor(e,t,r,n,s,o){this.requestId=e,this.text=t,this.isSSML=r,this.cb=n,this.err=s,this.dataStream=o}};qo.SynthesisRequest=OS});var HD=p(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});fd.SpeechSynthesizer=void 0;var DS=T(),xS=M(),u6=qy(),h6=bo(),p6=Jn(),WD=j(),ln=w(),d6=dd(),MS=class i extends ln.Synthesizer{constructor(e,t){super(e),t!==null&&(t===void 0?this.audioConfig=typeof window>"u"?void 0:ln.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=t),this.privConnectionFactory=new DS.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(e,t,r){let n=e;return t.properties.mergeTo(n.properties),new i(e,r)}speakTextAsync(e,t,r,n){this.speakImpl(e,!1,t,r,n)}speakSsmlAsync(e,t,r,n){this.speakImpl(e,!0,t,r,n)}getVoicesAsync(e=""){return v(this,null,function*(){return this.getVoices(e)})}close(e,t){WD.Contracts.throwIfDisposed(this.privDisposed),xS.marshalPromiseToCallbacks(this.dispose(!0),e,t)}get internalData(){return this.privAdapter}createSynthesisAdapter(e,t,r){return new DS.SpeechSynthesisAdapter(e,t,r,this,this.audioConfig)}createRestSynthesisAdapter(e,t){return new DS.SynthesisRestAdapter(t,e)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=h6.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(ln.SpeechSynthesisOutputFormat[this.properties.getProperty(ln.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(e,t,r,n,s){try{WD.Contracts.throwIfDisposed(this.privDisposed);let o=xS.createNoDashGuid(),a;s instanceof ln.PushAudioOutputStreamCallback?a=new p6.PushAudioOutputStreamImpl(s):s instanceof ln.PullAudioOutputStream?a=s:s!==void 0?a=new u6.AudioFileWriter(s):a=void 0,this.synthesisRequestQueue.enqueue(new d6.SynthesisRequest(o,e,t,c=>{if(this.privSynthesizing=!1,r)try{r(c)}catch(l){n&&n(l)}r=void 0,this.adapterSpeak().catch(()=>{})},c=>{n&&n(c)},a)),this.adapterSpeak().catch(()=>{})}catch(o){if(n)if(o instanceof Error){let a=o;n(a.name+": "+a.message)}else n(o);this.dispose(!0).catch(()=>{})}}getVoices(e){return v(this,null,function*(){let t=xS.createNoDashGuid(),r=yield this.privRestAdapter.getVoicesList(t);if(r.ok&&Array.isArray(r.json)){let n=r.json;return e&&e.length>0&&(n=n.filter(s=>!!s.Locale&&s.Locale.toLowerCase()===e.toLowerCase())),new ln.SynthesisVoicesResult(t,n,void 0)}else return new ln.SynthesisVoicesResult(t,void 0,`Error: ${r.status}: ${r.statusText}`)})}};fd.SpeechSynthesizer=MS});var UD=p(vd=>{"use strict";Object.defineProperty(vd,"__esModule",{value:!0});vd.SynthesisResult=void 0;var kS=class{constructor(e,t,r,n){this.privResultId=e,this.privReason=t,this.privErrorDetails=r,this.privProperties=n}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};vd.SynthesisResult=kS});var VD=p(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});gd.SpeechSynthesisResult=void 0;var f6=w(),NS=class extends f6.SynthesisResult{constructor(e,t,r,n,s,o){super(e,t,n,s),this.privAudioData=r,this.privAudioDuration=o}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};gd.SpeechSynthesisResult=NS});var KD=p(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});md.SpeechSynthesisEventArgs=void 0;var LS=class{constructor(e){this.privResult=e}get result(){return this.privResult}};md.SpeechSynthesisEventArgs=LS});var $D=p(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});yd.SpeechSynthesisWordBoundaryEventArgs=void 0;var jS=class{constructor(e,t,r,n,s,o){this.privAudioOffset=e,this.privDuration=t,this.privText=r,this.privWordLength=n,this.privTextOffset=s,this.privBoundaryType=o}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};yd.SpeechSynthesisWordBoundaryEventArgs=jS});var GD=p(_d=>{"use strict";Object.defineProperty(_d,"__esModule",{value:!0});_d.SpeechSynthesisBookmarkEventArgs=void 0;var zS=class{constructor(e,t){this.privAudioOffset=e,this.privText=t}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};_d.SpeechSynthesisBookmarkEventArgs=zS});var YD=p(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});Sd.SpeechSynthesisVisemeEventArgs=void 0;var qS=class{constructor(e,t,r){this.privAudioOffset=e,this.privVisemeId=t,this.privAnimation=r}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};Sd.SpeechSynthesisVisemeEventArgs=qS});var JD=p(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.SpeechSynthesisBoundaryType=void 0;var v6;(function(i){i.Word="WordBoundary",i.Punctuation="PunctuationBoundary",i.Sentence="SentenceBoundary"})(v6=Dc.SpeechSynthesisBoundaryType||(Dc.SpeechSynthesisBoundaryType={}))});var XD=p(Cd=>{"use strict";Object.defineProperty(Cd,"__esModule",{value:!0});Cd.SynthesisVoicesResult=void 0;var Fo=w(),FS=class extends Fo.SynthesisResult{constructor(e,t,r){if(Array.isArray(t)){super(e,Fo.ResultReason.VoicesListRetrieved,void 0,new Fo.PropertyCollection),this.privVoices=[];for(let n of t)this.privVoices.push(new Fo.VoiceInfo(n))}else super(e,Fo.ResultReason.Canceled,r||"Error information unavailable",new Fo.PropertyCollection)}get voices(){return this.privVoices}};Cd.SynthesisVoicesResult=FS});var ZD=p(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.VoiceInfo=ur.SynthesisVoiceType=ur.SynthesisVoiceGender=void 0;var Hi;(function(i){i[i.Unknown=0]="Unknown",i[i.Female=1]="Female",i[i.Male=2]="Male",i[i.Neutral=3]="Neutral"})(Hi=ur.SynthesisVoiceGender||(ur.SynthesisVoiceGender={}));var BS;(function(i){i[i.OnlineNeural=1]="OnlineNeural",i[i.OnlineStandard=2]="OnlineStandard",i[i.OfflineNeural=3]="OfflineNeural",i[i.OfflineStandard=4]="OfflineStandard"})(BS=ur.SynthesisVoiceType||(ur.SynthesisVoiceType={}));var g6={[Hi[Hi.Neutral]]:Hi.Neutral,[Hi[Hi.Male]]:Hi.Male,[Hi[Hi.Female]]:Hi.Female},WS=class{constructor(e){if(this.privStyleList=[],e){if(this.privName=e.Name,this.privLocale=e.Locale,this.privShortName=e.ShortName,this.privLocaleName=e.LocaleName,this.privDisplayName=e.DisplayName,this.privLocalName=e.LocalName,this.privVoiceType=e.VoiceType.endsWith("Standard")?BS.OnlineStandard:BS.OnlineNeural,this.privGender=g6[e.Gender]||Hi.Unknown,e.StyleList&&Array.isArray(e.StyleList))for(let t of e.StyleList)this.privStyleList.push(t);this.privSampleRateHertz=e.SampleRateHertz,this.privStatus=e.Status,e.ExtendedPropertyMap&&(this.privExtendedPropertyMap=e.ExtendedPropertyMap),this.privWordsPerMinute=e.WordsPerMinute,Array.isArray(e.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...e.SecondaryLocaleList]),Array.isArray(e.RolePlayList)&&(this.privRolePlayList=[...e.RolePlayList])}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}};ur.VoiceInfo=WS});var e1=p(bd=>{"use strict";Object.defineProperty(bd,"__esModule",{value:!0});bd.SpeakerAudioDestination=void 0;var hs=M(),m6=Jn(),Kt=Kr(),y6=60*30,QD={[Kt.AudioFormatTag.PCM]:"audio/wav",[Kt.AudioFormatTag.MuLaw]:"audio/x-wav",[Kt.AudioFormatTag.MP3]:"audio/mpeg",[Kt.AudioFormatTag.OGG_OPUS]:"audio/ogg",[Kt.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[Kt.AudioFormatTag.ALaw]:"audio/x-wav",[Kt.AudioFormatTag.FLAC]:"audio/flac",[Kt.AudioFormatTag.AMR_WB]:"audio/amr-wb",[Kt.AudioFormatTag.G722]:"audio/G722"},HS=class{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||hs.createNoDashGuid(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,t,r){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then(()=>{t&&t()},n=>{r&&r(n)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,t){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{e&&e()},r=>{t&&t(r)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===Kt.AudioFormatTag.PCM||this.privFormat.formatTag===Kt.AudioFormatTag.MuLaw||this.privFormat.formatTag===Kt.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let r=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(r).then(()=>{r=this.privFormat.addHeader(r);let n=new Blob([r],{type:QD[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(n),this.notifyPlayback().then(()=>{e&&e()},s=>{t&&t(s)})},n=>{t&&t(n)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=e;let t=QD[this.privFormat.formatTag];t===void 0?console.warn(`Unknown mimeType for format ${Kt.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(t)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=y6,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(t),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(r=>{hs.Events.instance.onEvent(new hs.BackgroundEvent(r))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(r=>{hs.Events.instance.onEvent(new hs.BackgroundEvent(r))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(r=>{hs.Events.instance.onEvent(new hs.BackgroundEvent(r))})):(console.warn(`Format ${Kt.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new m6.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){return this.privAudio?.volume??-1}set volume(e){this.privAudio&&(this.privAudio.volume=e)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,t){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{e&&e()},r=>{t&&t(r)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}updateSourceBuffer(){return v(this,null,function*(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;let e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch{this.privAudioBuffer.unshift(e),console.log("buffer filled, pausing addition of binaries until space is made");return}yield this.notifyPlayback()}else this.canEndStream()&&(yield this.handleSourceBufferUpdateEnd())})}handleSourceBufferUpdateEnd(){return v(this,null,function*(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),yield this.notifyPlayback())})}notifyPlayback(){return v(this,null,function*(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||(yield this.privAudio.play()))})}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};bd.SpeakerAudioDestination=HS});var t1=p(wd=>{"use strict";Object.defineProperty(wd,"__esModule",{value:!0});wd.ConversationTranscriptionCanceledEventArgs=void 0;var _6=Ro(),US=class extends _6.CancellationEventArgsBase{};wd.ConversationTranscriptionCanceledEventArgs=US});var i1=p(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});Pd.MeetingTranscriptionCanceledEventArgs=void 0;var S6=Ro(),VS=class extends S6.CancellationEventArgsBase{};Pd.MeetingTranscriptionCanceledEventArgs=VS});var r1=p(xc=>{"use strict";Object.defineProperty(xc,"__esModule",{value:!0});xc.PronunciationAssessmentGradingSystem=void 0;var C6;(function(i){i[i.FivePoint=1]="FivePoint",i[i.HundredMark=2]="HundredMark"})(C6=xc.PronunciationAssessmentGradingSystem||(xc.PronunciationAssessmentGradingSystem={}))});var n1=p(Mc=>{"use strict";Object.defineProperty(Mc,"__esModule",{value:!0});Mc.PronunciationAssessmentGranularity=void 0;var b6;(function(i){i[i.Phoneme=1]="Phoneme",i[i.Word=2]="Word",i[i.FullText=3]="FullText"})(b6=Mc.PronunciationAssessmentGranularity||(Mc.PronunciationAssessmentGranularity={}))});var s1=p(Rd=>{"use strict";Object.defineProperty(Rd,"__esModule",{value:!0});Rd.PronunciationAssessmentConfig=void 0;var Ed=j(),Ie=w(),KS=class i{constructor(e,t=Ie.PronunciationAssessmentGradingSystem.FivePoint,r=Ie.PronunciationAssessmentGranularity.Phoneme,n=!1){Ed.Contracts.throwIfNullOrUndefined(e,"referenceText"),this.privProperties=new Ie.PropertyCollection,this.privProperties.setProperty(Ie.PropertyId.PronunciationAssessment_ReferenceText,e),this.privProperties.setProperty(Ie.PropertyId.PronunciationAssessment_GradingSystem,Ie.PronunciationAssessmentGradingSystem[t]),this.privProperties.setProperty(Ie.PropertyId.PronunciationAssessment_Granularity,Ie.PronunciationAssessmentGranularity[r]),this.privProperties.setProperty(Ie.PropertyId.PronunciationAssessment_EnableMiscue,String(n))}static fromJSON(e){Ed.Contracts.throwIfNullOrUndefined(e,"json");let t=new i("");return t.privProperties=new Ie.PropertyCollection,t.properties.setProperty(Ie.PropertyId.PronunciationAssessment_Json,e),t}toJSON(){return this.updateJson(),this.privProperties.getProperty(Ie.PropertyId.PronunciationAssessment_Params)}applyTo(e){this.updateJson();let t=e.internalData;t.expectContentAssessmentResponse=!!this.privContentAssessmentTopic,t.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(Ie.PropertyId.PronunciationAssessment_Params),this.privContentAssessmentTopic,t.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(Ie.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(e){Ed.Contracts.throwIfNullOrWhitespace(e,"referenceText"),this.properties.setProperty(Ie.PropertyId.PronunciationAssessment_ReferenceText,e)}set phonemeAlphabet(e){Ed.Contracts.throwIfNullOrWhitespace(e,"phonemeAlphabet"),this.privPhonemeAlphabet=e}set enableMiscue(e){let t=e?"true":"false";this.properties.setProperty(Ie.PropertyId.PronunciationAssessment_EnableMiscue,t)}get enableMiscue(){return this.properties.getProperty(Ie.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(e){this.privNBestPhonemeCount=e}set enableProsodyAssessment(e){this.privEnableProsodyAssessment=e}enableContentAssessmentWithTopic(e){this.privContentAssessmentTopic=e}get properties(){return this.privProperties}updateJson(){let e=this.privProperties.getProperty(Ie.PropertyId.PronunciationAssessment_Json,"{}"),t=JSON.parse(e),r=this.privProperties.getProperty(Ie.PropertyId.PronunciationAssessment_ReferenceText);r&&(t.referenceText=r);let n=this.privProperties.getProperty(Ie.PropertyId.PronunciationAssessment_GradingSystem);n&&(t.gradingSystem=n);let s=this.privProperties.getProperty(Ie.PropertyId.PronunciationAssessment_Granularity);s&&(t.granularity=s),this.privPhonemeAlphabet&&(t.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(t.nbestPhonemeCount=this.privNBestPhonemeCount),t.enableProsodyAssessment=this.privEnableProsodyAssessment,t.dimension="Comprehensive",this.privProperties.getProperty(Ie.PropertyId.PronunciationAssessment_EnableMiscue)&&(t.enableMiscue=this.enableMiscue),this.privProperties.setProperty(Ie.PropertyId.PronunciationAssessment_Params,JSON.stringify(t))}};Rd.PronunciationAssessmentConfig=KS});var o1=p(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.PronunciationAssessmentResult=Bo.ContentAssessmentResult=void 0;var $S=j(),w6=w(),Id=class{constructor(e){this.privPronJson=e}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}};Bo.ContentAssessmentResult=Id;var GS=class i{constructor(e){let t=JSON.parse(e);$S.Contracts.throwIfNullOrUndefined(t.NBest[0],"NBest"),this.privPronJson=t.NBest[0]}static fromResult(e){$S.Contracts.throwIfNullOrUndefined(e,"result");let t=e.properties.getProperty(w6.PropertyId.SpeechServiceResponse_JsonResult);return $S.Contracts.throwIfNullOrUndefined(t,"json"),new i(t)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment?.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment?.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment?.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment?.FluencyScore}get prosodyScore(){return this.detailResult.PronunciationAssessment?.ProsodyScore}get contentAssessmentResult(){if(this.detailResult.ContentAssessment!==void 0)return new Id(this.detailResult)}};Bo.PronunciationAssessmentResult=GS});var a1=p(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});Td.AvatarConfig=void 0;var P6=j(),E6=w(),YS=class{constructor(e,t,r){this.privCustomized=!1,P6.Contracts.throwIfNullOrWhitespace(e,"character"),this.character=e,this.style=t,r===void 0&&(r=new E6.AvatarVideoFormat),this.videoFormat=r}get customized(){return this.privCustomized}set customized(e){this.privCustomized=e}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(e){this.privBackgroundColor=e}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(e){this.privBackgroundImage=e}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(e){this.privRemoteIceServers=e}};Td.AvatarConfig=YS});var c1=p(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.AvatarEventArgs=ps.AvatarEventTypes=void 0;var R6;(function(i){i.SwitchedToSpeaking="SwitchedToSpeaking",i.SwitchedToIdle="SwitchedToIdle",i.SessionClosed="SessionClosed"})(R6=ps.AvatarEventTypes||(ps.AvatarEventTypes={}));var JS=class{constructor(e,t){this.privOffset=e,this.privDescription=t}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}};ps.AvatarEventArgs=JS});var ZS=p(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});Od.SpeechSynthesisConnectionFactory=void 0;var l1=Ve(),kc=w(),I6=Si(),T6=T(),A6=_t(),Ad=Ir(),XS=class{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1"}create(e,t,r){let n=e.parameters.getProperty(kc.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(kc.PropertyId.SpeechServiceConnection_Region,void 0),o=I6.ConnectionFactoryBase.getHostSuffix(s),a=e.parameters.getProperty(kc.PropertyId.SpeechServiceConnection_EndpointId,void 0),c=a===void 0?"tts":"voice",l=e.parameters.getProperty(kc.PropertyId.SpeechServiceConnection_Host,"wss://"+s+"."+c+".speech"+o),u={},h={};t.token!==void 0&&t.token!==""&&(h[t.headerName]=t.token),h[A6.HeaderNames.ConnectionId]=r,a!==void 0&&a!==""&&(!n||n.search(Ad.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(u[Ad.QueryParameterNames.CustomVoiceDeploymentId]=a),e.avatarEnabled&&(!n||n.search(Ad.QueryParameterNames.EnableAvatar)===-1)&&(u[Ad.QueryParameterNames.EnableAvatar]="true"),n||(n=l+this.synthesisUri),e.parameters.setProperty(kc.PropertyId.SpeechServiceConnection_Url,n);let d=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new l1.WebsocketConnection(n,u,h,new T6.WebsocketMessageFormatter,l1.ProxyInfo.fromParameters(e.parameters),d,r)}};Od.SpeechSynthesisConnectionFactory=XS});var u1=p(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});xd.AvatarSynthesizer=void 0;var O6=ZS(),D6=T(),ke=M(),x6=bo(),Ar=w(),Dd=j(),M6=dd(),QS=class extends Ar.Synthesizer{constructor(e,t){super(e),Dd.Contracts.throwIfNullOrUndefined(t,"avatarConfig"),this.privConnectionFactory=new O6.SpeechSynthesisConnectionFactory,this.privAvatarConfig=t,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=x6.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(Ar.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}startAvatarAsync(e){return v(this,null,function*(){Dd.Contracts.throwIfNullOrUndefined(e,"peerConnection"),this.privIceServers=e.getConfiguration().iceServers,Dd.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");let t=new ke.Deferred;e.onicegatheringstatechange=()=>{ke.Events.instance.onEvent(new ke.PlatformEvent("peer connection: ice gathering state: "+e.iceGatheringState,ke.EventType.Debug)),e.iceGatheringState==="complete"&&(ke.Events.instance.onEvent(new ke.PlatformEvent("peer connection: ice gathering complete.",ke.EventType.Info)),t.resolve())},e.onicecandidate=a=>{a.candidate?ke.Events.instance.onEvent(new ke.PlatformEvent("peer connection: ice candidate: "+a.candidate.candidate,ke.EventType.Debug)):(ke.Events.instance.onEvent(new ke.PlatformEvent("peer connection: ice candidate: complete",ke.EventType.Debug)),t.resolve())},setTimeout(()=>{e.iceGatheringState!=="complete"&&(ke.Events.instance.onEvent(new ke.PlatformEvent("peer connection: ice gathering timeout.",ke.EventType.Warning)),t.resolve())},2e3);let r=yield e.createOffer();yield e.setLocalDescription(r),yield t.promise,ke.Events.instance.onEvent(new ke.PlatformEvent("peer connection: got local SDP.",ke.EventType.Info)),this.privProperties.setProperty(Ar.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(e.localDescription));let n=yield this.speak("",!1);if(n.reason!==Ar.ResultReason.SynthesizingAudioCompleted)return new Ar.SynthesisResult(n.resultId,n.reason,n.errorDetails,n.properties);let s=atob(n.properties.getProperty(Ar.PropertyId.TalkingAvatarService_WebRTC_SDP)),o=new RTCSessionDescription(JSON.parse(s));return yield e.setRemoteDescription(o),new Ar.SynthesisResult(n.resultId,n.reason,void 0,n.properties)})}speakTextAsync(e){return v(this,null,function*(){let t=yield this.speak(e,!1);return new Ar.SynthesisResult(t.resultId,t.reason,t.errorDetails,t.properties)})}speakSsmlAsync(e){return v(this,null,function*(){let t=yield this.speak(e,!0);return new Ar.SynthesisResult(t.resultId,t.reason,t.errorDetails,t.properties)})}stopSpeakingAsync(){return v(this,null,function*(){for(;this.synthesisRequestQueue.length()>0;)(yield this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()})}stopAvatarAsync(){return v(this,null,function*(){return Dd.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)})}close(){return v(this,null,function*(){if(!this.privDisposed)return this.dispose(!0)})}get iceServers(){return this.privIceServers}createSynthesisAdapter(e,t,r){return new D6.AvatarSynthesisAdapter(e,t,r,this,this.privAvatarConfig)}createRestSynthesisAdapter(e,t){}createSynthesizerConfig(e){let t=super.createSynthesizerConfig(e);return t.avatarEnabled=!0,t}speak(e,t){return v(this,null,function*(){let r=ke.createNoDashGuid(),n=new ke.Deferred;return this.synthesisRequestQueue.enqueue(new M6.SynthesisRequest(r,e,t,s=>{n.resolve(s),this.privSynthesizing=!1,this.adapterSpeak()},s=>{n.reject(s),this.privSynthesizing=!1})),this.adapterSpeak(),n.promise})}};xd.AvatarSynthesizer=QS});var h1=p(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.AvatarVideoFormat=Wo.Coordinate=void 0;var eC=class{constructor(e,t){this.x=e,this.y=t}};Wo.Coordinate=eC;var tC=class{constructor(e="H264",t=2e6,r=1920,n=1080){this.codec=e,this.bitrate=t,this.width=r,this.height=n}setCropRange(e,t){this.cropRange={bottomRight:t,topLeft:e}}};Wo.AvatarVideoFormat=tC});var p1=p(Md=>{"use strict";Object.defineProperty(Md,"__esModule",{value:!0});Md.AvatarWebRTCConnectionResult=void 0;var k6=w(),iC=class extends k6.SynthesisResult{constructor(e,t,r,n,s){super(t,r,n,s),this.privSDPAnswer=e}get SDPAnswer(){return this.privSDPAnswer}};Md.AvatarWebRTCConnectionResult=iC});var d1=p(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});Nd.Diagnostics=void 0;var N6=Ve(),L6=M(),kd=class{static SetLoggingLevel(e){this.privListener=new N6.ConsoleLoggingListener(e),L6.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(e){if(typeof window>"u")this.privListener&&(this.privListener.logPath=e);else throw new Error("File system logging not available in browser.")}static set onLogOutput(e){this.privListener&&(this.privListener.logCallback=e)}};Nd.Diagnostics=kd;kd.privListener=void 0});var w=p(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});var j6=Hy();Object.defineProperty(C,"AudioConfig",{enumerable:!0,get:function(){return j6.AudioConfig}});var f1=Kr();Object.defineProperty(C,"AudioStreamFormat",{enumerable:!0,get:function(){return f1.AudioStreamFormat}});Object.defineProperty(C,"AudioFormatTag",{enumerable:!0,get:function(){return f1.AudioFormatTag}});var rC=Fy();Object.defineProperty(C,"AudioInputStream",{enumerable:!0,get:function(){return rC.AudioInputStream}});Object.defineProperty(C,"PullAudioInputStream",{enumerable:!0,get:function(){return rC.PullAudioInputStream}});Object.defineProperty(C,"PushAudioInputStream",{enumerable:!0,get:function(){return rC.PushAudioInputStream}});var nC=Jn();Object.defineProperty(C,"AudioOutputStream",{enumerable:!0,get:function(){return nC.AudioOutputStream}});Object.defineProperty(C,"PullAudioOutputStream",{enumerable:!0,get:function(){return nC.PullAudioOutputStream}});Object.defineProperty(C,"PushAudioOutputStream",{enumerable:!0,get:function(){return nC.PushAudioOutputStream}});var z6=eO();Object.defineProperty(C,"CancellationReason",{enumerable:!0,get:function(){return z6.CancellationReason}});var q6=tO();Object.defineProperty(C,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return q6.PullAudioInputStreamCallback}});var F6=iO();Object.defineProperty(C,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return F6.PushAudioOutputStreamCallback}});var B6=nO();Object.defineProperty(C,"KeywordRecognitionModel",{enumerable:!0,get:function(){return B6.KeywordRecognitionModel}});var W6=sO();Object.defineProperty(C,"SessionEventArgs",{enumerable:!0,get:function(){return W6.SessionEventArgs}});var H6=oO();Object.defineProperty(C,"RecognitionEventArgs",{enumerable:!0,get:function(){return H6.RecognitionEventArgs}});var U6=aO();Object.defineProperty(C,"OutputFormat",{enumerable:!0,get:function(){return U6.OutputFormat}});var V6=cO();Object.defineProperty(C,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return V6.IntentRecognitionEventArgs}});var K6=lO();Object.defineProperty(C,"RecognitionResult",{enumerable:!0,get:function(){return K6.RecognitionResult}});var $6=uO();Object.defineProperty(C,"SpeechRecognitionResult",{enumerable:!0,get:function(){return $6.SpeechRecognitionResult}});var G6=hO();Object.defineProperty(C,"IntentRecognitionResult",{enumerable:!0,get:function(){return G6.IntentRecognitionResult}});var Y6=pO();Object.defineProperty(C,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return Y6.LanguageUnderstandingModel}});var sC=fO();Object.defineProperty(C,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return sC.SpeechRecognitionEventArgs}});Object.defineProperty(C,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return sC.ConversationTranscriptionEventArgs}});Object.defineProperty(C,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return sC.MeetingTranscriptionEventArgs}});var J6=vO();Object.defineProperty(C,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return J6.SpeechRecognitionCanceledEventArgs}});var X6=gO();Object.defineProperty(C,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return X6.TranslationRecognitionEventArgs}});var Z6=mO();Object.defineProperty(C,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return Z6.TranslationSynthesisEventArgs}});var Q6=o_();Object.defineProperty(C,"TranslationRecognitionResult",{enumerable:!0,get:function(){return Q6.TranslationRecognitionResult}});var e4=yO();Object.defineProperty(C,"TranslationSynthesisResult",{enumerable:!0,get:function(){return e4.TranslationSynthesisResult}});var t4=_O();Object.defineProperty(C,"ResultReason",{enumerable:!0,get:function(){return t4.ResultReason}});var v1=SO();Object.defineProperty(C,"SpeechConfig",{enumerable:!0,get:function(){return v1.SpeechConfig}});Object.defineProperty(C,"SpeechConfigImpl",{enumerable:!0,get:function(){return v1.SpeechConfigImpl}});var g1=CO();Object.defineProperty(C,"SpeechTranslationConfig",{enumerable:!0,get:function(){return g1.SpeechTranslationConfig}});Object.defineProperty(C,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return g1.SpeechTranslationConfigImpl}});var i4=l_();Object.defineProperty(C,"PropertyCollection",{enumerable:!0,get:function(){return i4.PropertyCollection}});var r4=ep();Object.defineProperty(C,"PropertyId",{enumerable:!0,get:function(){return r4.PropertyId}});var n4=PO();Object.defineProperty(C,"Recognizer",{enumerable:!0,get:function(){return n4.Recognizer}});var s4=EO();Object.defineProperty(C,"SpeechRecognizer",{enumerable:!0,get:function(){return s4.SpeechRecognizer}});var o4=RO();Object.defineProperty(C,"IntentRecognizer",{enumerable:!0,get:function(){return o4.IntentRecognizer}});var a4=IO();Object.defineProperty(C,"VoiceProfileType",{enumerable:!0,get:function(){return a4.VoiceProfileType}});var c4=DO();Object.defineProperty(C,"TranslationRecognizer",{enumerable:!0,get:function(){return c4.TranslationRecognizer}});var l4=xO();Object.defineProperty(C,"Translations",{enumerable:!0,get:function(){return l4.Translations}});var u4=MO();Object.defineProperty(C,"NoMatchReason",{enumerable:!0,get:function(){return u4.NoMatchReason}});var h4=kO();Object.defineProperty(C,"NoMatchDetails",{enumerable:!0,get:function(){return h4.NoMatchDetails}});var p4=NO();Object.defineProperty(C,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return p4.TranslationRecognitionCanceledEventArgs}});var d4=LO();Object.defineProperty(C,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return d4.IntentRecognitionCanceledEventArgs}});var f4=I_();Object.defineProperty(C,"CancellationDetailsBase",{enumerable:!0,get:function(){return f4.CancellationDetailsBase}});var v4=jO();Object.defineProperty(C,"CancellationDetails",{enumerable:!0,get:function(){return v4.CancellationDetails}});var g4=zO();Object.defineProperty(C,"CancellationErrorCode",{enumerable:!0,get:function(){return g4.CancellationErrorCode}});var m4=qO();Object.defineProperty(C,"ConnectionEventArgs",{enumerable:!0,get:function(){return m4.ConnectionEventArgs}});var y4=FO();Object.defineProperty(C,"ServiceEventArgs",{enumerable:!0,get:function(){return y4.ServiceEventArgs}});var _4=__();Object.defineProperty(C,"Connection",{enumerable:!0,get:function(){return _4.Connection}});var S4=BO();Object.defineProperty(C,"PhraseListGrammar",{enumerable:!0,get:function(){return S4.PhraseListGrammar}});var C4=wp();Object.defineProperty(C,"DialogServiceConfig",{enumerable:!0,get:function(){return C4.DialogServiceConfig}});var b4=WO();Object.defineProperty(C,"BotFrameworkConfig",{enumerable:!0,get:function(){return b4.BotFrameworkConfig}});var w4=HO();Object.defineProperty(C,"CustomCommandsConfig",{enumerable:!0,get:function(){return w4.CustomCommandsConfig}});var P4=GO();Object.defineProperty(C,"DialogServiceConnector",{enumerable:!0,get:function(){return P4.DialogServiceConnector}});var E4=YO();Object.defineProperty(C,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return E4.ActivityReceivedEventArgs}});var R4=XO();Object.defineProperty(C,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return R4.TurnStatusReceivedEventArgs}});var I4=ZO();Object.defineProperty(C,"ServicePropertyChannel",{enumerable:!0,get:function(){return I4.ServicePropertyChannel}});var T4=QO();Object.defineProperty(C,"ProfanityOption",{enumerable:!0,get:function(){return T4.ProfanityOption}});var A4=eD();Object.defineProperty(C,"BaseAudioPlayer",{enumerable:!0,get:function(){return A4.BaseAudioPlayer}});var O4=tD();Object.defineProperty(C,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return O4.ConnectionMessageEventArgs}});var D4=v_();Object.defineProperty(C,"ConnectionMessage",{enumerable:!0,get:function(){return D4.ConnectionMessage}});var x4=iD();Object.defineProperty(C,"VoiceProfile",{enumerable:!0,get:function(){return x4.VoiceProfile}});var m1=nD();Object.defineProperty(C,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return m1.VoiceProfileEnrollmentResult}});Object.defineProperty(C,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return m1.VoiceProfileEnrollmentCancellationDetails}});var y1=oD();Object.defineProperty(C,"VoiceProfileResult",{enumerable:!0,get:function(){return y1.VoiceProfileResult}});Object.defineProperty(C,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return y1.VoiceProfileCancellationDetails}});var M4=aD();Object.defineProperty(C,"VoiceProfilePhraseResult",{enumerable:!0,get:function(){return M4.VoiceProfilePhraseResult}});var k4=cD();Object.defineProperty(C,"VoiceProfileClient",{enumerable:!0,get:function(){return k4.VoiceProfileClient}});var N4=lD();Object.defineProperty(C,"SpeakerRecognizer",{enumerable:!0,get:function(){return N4.SpeakerRecognizer}});var L4=uD();Object.defineProperty(C,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return L4.SpeakerIdentificationModel}});var j4=pD();Object.defineProperty(C,"SpeakerVerificationModel",{enumerable:!0,get:function(){return j4.SpeakerVerificationModel}});var z4=fD();Object.defineProperty(C,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return z4.AutoDetectSourceLanguageConfig}});var q4=gD();Object.defineProperty(C,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return q4.AutoDetectSourceLanguageResult}});var F4=mD();Object.defineProperty(C,"SourceLanguageConfig",{enumerable:!0,get:function(){return F4.SourceLanguageConfig}});var oC=_D();Object.defineProperty(C,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return oC.SpeakerRecognitionResult}});Object.defineProperty(C,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return oC.SpeakerRecognitionResultType}});Object.defineProperty(C,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return oC.SpeakerRecognitionCancellationDetails}});var $t=od();Object.defineProperty(C,"Conversation",{enumerable:!0,get:function(){return $t.Conversation}});Object.defineProperty(C,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return $t.ConversationExpirationEventArgs}});Object.defineProperty(C,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return $t.ConversationParticipantsChangedEventArgs}});Object.defineProperty(C,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return $t.ConversationTranslationCanceledEventArgs}});Object.defineProperty(C,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return $t.ConversationTranslationEventArgs}});Object.defineProperty(C,"ConversationTranslationResult",{enumerable:!0,get:function(){return $t.ConversationTranslationResult}});Object.defineProperty(C,"ConversationTranslator",{enumerable:!0,get:function(){return $t.ConversationTranslator}});Object.defineProperty(C,"ConversationTranscriber",{enumerable:!0,get:function(){return $t.ConversationTranscriber}});Object.defineProperty(C,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return $t.ConversationTranscriptionResult}});Object.defineProperty(C,"Meeting",{enumerable:!0,get:function(){return $t.Meeting}});Object.defineProperty(C,"MeetingTranscriber",{enumerable:!0,get:function(){return $t.MeetingTranscriber}});Object.defineProperty(C,"Participant",{enumerable:!0,get:function(){return $t.Participant}});Object.defineProperty(C,"ParticipantChangedReason",{enumerable:!0,get:function(){return $t.ParticipantChangedReason}});Object.defineProperty(C,"User",{enumerable:!0,get:function(){return $t.User}});var B4=dd();Object.defineProperty(C,"Synthesizer",{enumerable:!0,get:function(){return B4.Synthesizer}});var W4=By();Object.defineProperty(C,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return W4.SpeechSynthesisOutputFormat}});var H4=HD();Object.defineProperty(C,"SpeechSynthesizer",{enumerable:!0,get:function(){return H4.SpeechSynthesizer}});var U4=UD();Object.defineProperty(C,"SynthesisResult",{enumerable:!0,get:function(){return U4.SynthesisResult}});var V4=VD();Object.defineProperty(C,"SpeechSynthesisResult",{enumerable:!0,get:function(){return V4.SpeechSynthesisResult}});var K4=KD();Object.defineProperty(C,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return K4.SpeechSynthesisEventArgs}});var $4=$D();Object.defineProperty(C,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return $4.SpeechSynthesisWordBoundaryEventArgs}});var G4=GD();Object.defineProperty(C,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return G4.SpeechSynthesisBookmarkEventArgs}});var Y4=YD();Object.defineProperty(C,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return Y4.SpeechSynthesisVisemeEventArgs}});var J4=JD();Object.defineProperty(C,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return J4.SpeechSynthesisBoundaryType}});var X4=XD();Object.defineProperty(C,"SynthesisVoicesResult",{enumerable:!0,get:function(){return X4.SynthesisVoicesResult}});var Z4=ZD();Object.defineProperty(C,"VoiceInfo",{enumerable:!0,get:function(){return Z4.VoiceInfo}});var Q4=e1();Object.defineProperty(C,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Q4.SpeakerAudioDestination}});var eW=t1();Object.defineProperty(C,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return eW.ConversationTranscriptionCanceledEventArgs}});var tW=i1();Object.defineProperty(C,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return tW.MeetingTranscriptionCanceledEventArgs}});var iW=r1();Object.defineProperty(C,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return iW.PronunciationAssessmentGradingSystem}});var rW=n1();Object.defineProperty(C,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return rW.PronunciationAssessmentGranularity}});var nW=s1();Object.defineProperty(C,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return nW.PronunciationAssessmentConfig}});var sW=o1();Object.defineProperty(C,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return sW.PronunciationAssessmentResult}});var oW=iS();Object.defineProperty(C,"LanguageIdMode",{enumerable:!0,get:function(){return oW.LanguageIdMode}});var aW=a1();Object.defineProperty(C,"AvatarConfig",{enumerable:!0,get:function(){return aW.AvatarConfig}});var cW=c1();Object.defineProperty(C,"AvatarEventArgs",{enumerable:!0,get:function(){return cW.AvatarEventArgs}});var lW=u1();Object.defineProperty(C,"AvatarSynthesizer",{enumerable:!0,get:function(){return lW.AvatarSynthesizer}});var _1=h1();Object.defineProperty(C,"AvatarVideoFormat",{enumerable:!0,get:function(){return _1.AvatarVideoFormat}});Object.defineProperty(C,"Coordinate",{enumerable:!0,get:function(){return _1.Coordinate}});var uW=p1();Object.defineProperty(C,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return uW.AvatarWebRTCConnectionResult}});var hW=d1();Object.defineProperty(C,"Diagnostics",{enumerable:!0,get:function(){return hW.Diagnostics}});var pW=Qg();Object.defineProperty(C,"LogLevel",{enumerable:!0,get:function(){return pW.LogLevel}})});var S1=p(jd=>{"use strict";Object.defineProperty(jd,"__esModule",{value:!0});jd.ProxyInfo=void 0;var Ld=w(),aC=class i{constructor(e,t,r,n){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=r,this.privProxyPassword=n}static fromParameters(e){return new i(e.getProperty(Ld.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(e.getProperty(Ld.PropertyId.SpeechServiceConnection_ProxyPort),10),e.getProperty(Ld.PropertyId.SpeechServiceConnection_ProxyUserName),e.getProperty(Ld.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(e){return this.fromParameters(e.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};jd.ProxyInfo=aC});var b1=p((n7,C1)=>{"use strict";var dW=new Set(["json","buffer","string"]);C1.exports=i=>(...e)=>{let t=new Set,r,n,s,o="";return e.forEach(a=>{if(typeof a=="string")if(a.toUpperCase()===a)if(r){let c=`Can't set method to ${a}, already set to ${r}.`;throw new Error(c)}else r=a;else if(a.startsWith("http:")||a.startsWith("https:"))o=a;else if(dW.has(a))n=a;else throw new Error(`Unknown encoding, ${a}`);else if(typeof a=="number")t.add(a);else if(typeof a=="object")if(Array.isArray(a)||a instanceof Set)a.forEach(c=>t.add(c));else{if(s)throw new Error("Cannot set headers twice.");s=a}else throw new Error(`Unknown type: ${typeof a}`)}),r||(r="GET"),t.size===0&&t.add(200),i(t,r,n,s,o)}});var E1=p((w1,P1)=>{"use strict";var fW=b1(),cC=class i extends Error{constructor(e,...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,i),this.name="StatusError",this.message=e.statusMessage,this.statusCode=e.status,this.res=e,this.json=e.json.bind(e),this.text=e.text.bind(e),this.arrayBuffer=e.arrayBuffer.bind(e);let r;Object.defineProperty(this,"responseBody",{get:()=>(r||(r=this.arrayBuffer()),r)}),this.headers={};for(let[s,o]of e.headers.entries())this.headers[s.toLowerCase()]=o}},vW=(i,e,t,r,n)=>(c,l,...u)=>v(w1,[c,l,...u],function*(s,o,a={}){s=n+(s||"");let h=new URL(s);if(r||(r={}),h.username&&(r.Authorization="Basic "+btoa(h.username+":"+h.password),h=new URL(h.protocol+"//"+h.host+h.pathname+h.search)),h.protocol!=="https:"&&h.protocol!=="http:")throw new Error(`Unknown protocol, ${h.protocol}`);if(o&&!(o instanceof ArrayBuffer||ArrayBuffer.isView(o)||typeof o=="string"))if(typeof o=="object")o=JSON.stringify(o),r["Content-Type"]="application/json";else throw new Error("Unknown body type.");a=new Headers(se(se({},r||{}),a));let d=yield fetch(h,{method:e,headers:a,body:o});if(d.statusCode=d.status,!i.has(d.status))throw new cC(d);return t==="json"?d.json():t==="buffer"?d.arrayBuffer():t==="string"?d.text():d});P1.exports=fW(vW)});var I1=p(Or=>{"use strict";var gW=Or&&Or.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Or,"__esModule",{value:!0});Or.RestMessageAdapter=Or.RestRequestType=void 0;var mW=gW(E1()),R1=M(),zd;(function(i){i.Get="GET",i.Post="POST",i.Delete="DELETE",i.File="file"})(zd=Or.RestRequestType||(Or.RestRequestType={}));var lC=class{constructor(e){if(!e)throw new R1.ArgumentNullError("configParams");this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}static extractHeaderValue(e,t){let r="";try{let n=t.trim().split(/[\r\n]+/),s={};n.forEach(o=>{let a=o.split(": "),c=a.shift().toLowerCase(),l=a.join(": ");s[c]=l}),r=s[e.toLowerCase()]}catch{}return r}set options(e){this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}setHeaders(e,t){this.privHeaders[e]=t}request(e,t,r={},n=null){let s=new R1.Deferred,o=e===zd.File?"POST":e,a=(l,u={})=>{let h=l;return{data:JSON.stringify(u),headers:JSON.stringify(l.headers),json:u,ok:l.statusCode>=200&&l.statusCode<300,status:l.statusCode,statusText:u.error?u.error.message:h.statusText?h.statusText:h.statusMessage}},c=l=>{let u=mW.default(t,o,this.privHeaders,200,201,202,204,400,401,402,403,404),h=this.queryParams(r)===""?"":`?${this.queryParams(r)}`;u(h,l).then(d=>v(this,null,function*(){if(e===zd.Delete||d.statusCode===204)s.resolve(a(d));else try{let f=yield d.json();s.resolve(a(d,f))}catch{s.resolve(a(d))}})).catch(d=>{s.reject(d)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),e===zd.Post&&n&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),c(n),s.promise}queryParams(e={}){return Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&")}};Or.RestMessageAdapter=lC});var uC=p(qd=>{"use strict";Object.defineProperty(qd,"__esModule",{value:!0});qd.RestConfigBase=void 0;var Ho=class i{static get requestOptions(){return i.privDefaultRequestOptions}static get configParams(){return i.privDefaultParams}static get restErrors(){return i.privRestErrors}};qd.RestConfigBase=Ho;Ho.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4};Ho.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."};Ho.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"}});var Ve=p(at=>{"use strict";var yW=at&&at.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),Ui=at&&at.__exportStar||function(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&yW(e,i,t)};Object.defineProperty(at,"__esModule",{value:!0});Ui(J0(),at);Ui(Z0(),at);Ui(tE(),at);Ui(rE(),at);Ui(nE(),at);Ui(XA(),at);Ui(xy(),at);Ui(ZA(),at);Ui(S1(),at);Ui(I1(),at);Ui(uC(),at)});var O1=p(Fd=>{"use strict";Object.defineProperty(Fd,"__esModule",{value:!0});Fd.IntentConnectionFactory=void 0;var T1=Ve(),Nc=w(),A1=Si(),_W=T(),SW=_t(),hC=class extends A1.ConnectionFactoryBase{create(e,t,r){let n=e.parameters.getProperty(Nc.PropertyId.SpeechServiceConnection_Endpoint);if(!n){let c=e.parameters.getProperty(Nc.PropertyId.SpeechServiceConnection_IntentRegion),l=A1.ConnectionFactoryBase.getHostSuffix(c);n=e.parameters.getProperty(Nc.PropertyId.SpeechServiceConnection_Host,"wss://"+c+".sr.speech"+l)+"/speech/recognition/interactive/cognitiveservices/v1"}let s={format:"simple",language:e.parameters.getProperty(Nc.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,s,n);let o={};t.token!==void 0&&t.token!==""&&(o[t.headerName]=t.token),o[SW.HeaderNames.ConnectionId]=r,e.parameters.setProperty(Nc.PropertyId.SpeechServiceConnection_Url,n);let a=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new T1.WebsocketConnection(n,s,o,new _W.WebsocketMessageFormatter,T1.ProxyInfo.fromRecognizerConfig(e),a,r)}getSpeechRegionFromIntentRegion(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}}};Fd.IntentConnectionFactory=hC});var k1=p(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.VoiceProfileConnectionFactory=Uo.SpeakerRecognitionConnectionFactory=void 0;var D1=Ve(),ds=w(),x1=Si(),CW=T(),M1=_t(),Bd=class extends x1.ConnectionFactoryBase{create(e,t,r,n){let s=e.parameters.getProperty(ds.PropertyId.SpeechServiceConnection_Endpoint);if(!s){let l=e.parameters.getProperty(ds.PropertyId.SpeechServiceConnection_Region),u=x1.ConnectionFactoryBase.getHostSuffix(l),h=e.parameters.getProperty(ds.PropertyId.SpeechServiceConnection_Host,`wss://${l}.spr-frontend.speech${u}`),d=e.parameters.getProperty(ds.PropertyId.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");s=`${h}/speaker/ws/${this.scenarioToPath(d)}/${r}`}let o={format:"simple",language:e.parameters.getProperty(ds.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,o,s);let a={};t.token!==void 0&&t.token!==""&&(a[t.headerName]=t.token),a[M1.HeaderNames.ConnectionId]=n,a[M1.HeaderNames.SpIDAuthKey]=e.parameters.getProperty(ds.PropertyId.SpeechServiceConnection_Key),e.parameters.setProperty(ds.PropertyId.SpeechServiceConnection_Url,s);let c=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new D1.WebsocketConnection(s,o,a,new CW.WebsocketMessageFormatter,D1.ProxyInfo.fromRecognizerConfig(e),c,n)}scenarioToPath(e){switch(e){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}},pC=class extends Bd{create(e,t,r){return super.create(e,t,"recognition",r)}};Uo.SpeakerRecognitionConnectionFactory=pC;var dC=class extends Bd{create(e,t,r){return super.create(e,t,"profile",r)}};Uo.VoiceProfileConnectionFactory=dC});var Hd=p(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.RecognitionEndedEvent=ct.RecognitionCompletionStatus=ct.RecognitionStartedEvent=ct.ConnectingToServiceEvent=ct.ListeningStartedEvent=ct.RecognitionTriggeredEvent=ct.SpeechRecognitionEvent=void 0;var Wd=M(),un=class extends Wd.PlatformEvent{constructor(e,t,r,n=Wd.EventType.Info){super(e,n),this.privRequestId=t,this.privSessionId=r}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}};ct.SpeechRecognitionEvent=un;var fC=class extends un{constructor(e,t,r,n){super("RecognitionTriggeredEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}};ct.RecognitionTriggeredEvent=fC;var vC=class extends un{constructor(e,t,r,n){super("ListeningStartedEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}};ct.ListeningStartedEvent=vC;var gC=class extends un{constructor(e,t,r){super("ConnectingToServiceEvent",e,r),this.privAuthFetchEventid=t}get authFetchEventid(){return this.privAuthFetchEventid}};ct.ConnectingToServiceEvent=gC;var mC=class extends un{constructor(e,t,r,n,s){super("RecognitionStartedEvent",e,s),this.privAudioSourceId=t,this.privAudioNodeId=r,this.privAuthFetchEventId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}};ct.RecognitionStartedEvent=mC;var N1;(function(i){i[i.Success=0]="Success",i[i.AudioSourceError=1]="AudioSourceError",i[i.AudioSourceTimeout=2]="AudioSourceTimeout",i[i.AuthTokenFetchError=3]="AuthTokenFetchError",i[i.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",i[i.UnAuthorized=5]="UnAuthorized",i[i.ConnectTimeout=6]="ConnectTimeout",i[i.ConnectError=7]="ConnectError",i[i.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",i[i.UnknownError=9]="UnknownError"})(N1=ct.RecognitionCompletionStatus||(ct.RecognitionCompletionStatus={}));var yC=class extends un{constructor(e,t,r,n,s,o,a,c){super("RecognitionEndedEvent",e,s,a===N1.Success?Wd.EventType.Info:Wd.EventType.Error),this.privAudioSourceId=t,this.privAudioNodeId=r,this.privAuthFetchEventId=n,this.privStatus=a,this.privError=c,this.privServiceTag=o}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}};ct.RecognitionEndedEvent=yC});var fs=p(Ud=>{"use strict";Object.defineProperty(Ud,"__esModule",{value:!0});Ud.SpeechConnectionMessage=void 0;var _C=M(),Dr=_t(),SC=class i extends _C.ConnectionMessage{constructor(e,t,r,n,s,o,a,c){if(!t)throw new _C.ArgumentNullError("path");if(!r)throw new _C.ArgumentNullError("requestId");let l={};if(l[Dr.HeaderNames.Path]=t,l[Dr.HeaderNames.RequestId]=r,l[Dr.HeaderNames.RequestTimestamp]=new Date().toISOString(),n&&(l[Dr.HeaderNames.ContentType]=n),o&&(l[Dr.HeaderNames.RequestStreamId]=o),a)for(let u in a)u&&(l[u]=a[u]);c?super(e,s,l,c):super(e,s,l),this.privPath=t,this.privRequestId=r,this.privContentType=n,this.privStreamId=o,this.privAdditionalHeaders=a}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(e){let t=null,r=null,n=null,s=null,o={};if(e.headers)for(let a in e.headers)a&&(a.toLowerCase()===Dr.HeaderNames.Path.toLowerCase()?t=e.headers[a]:a.toLowerCase()===Dr.HeaderNames.RequestId.toLowerCase()?r=e.headers[a]:a.toLowerCase()===Dr.HeaderNames.ContentType.toLowerCase()?n=e.headers[a]:a.toLowerCase()===Dr.HeaderNames.RequestStreamId.toLowerCase()?s=e.headers[a]:o[a]=e.headers[a]);return new i(e.messageType,t,r,n,e.body,s,o,e.id)}};Ud.SpeechConnectionMessage=SC});var L1=p(Kd=>{"use strict";Object.defineProperty(Kd,"__esModule",{value:!0});Kd.ServiceRecognizerBase=void 0;var bW=Ve(),Ne=M(),pe=w(),hr=T(),hn=fs(),Vd=class i{constructor(e,t,r,n,s){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!e)throw new Ne.ArgumentNullError("authentication");if(!t)throw new Ne.ArgumentNullError("connectionFactory");if(!r)throw new Ne.ArgumentNullError("audioSource");if(!n)throw new Ne.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=n.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=t,this.privAudioSource=r,this.privRecognizerConfig=n,this.privIsDisposed=!1,this.privRecognizer=s,this.privRequestSession=new hr.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new Ne.EventSource,this.privServiceEvents=new Ne.EventSource,this.privDynamicGrammar=new hr.DynamicGrammarBuilder,this.privSpeechContext=new hr.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new hr.AgentConfig,this.privRecognizerConfig.parameters.getProperty(pe.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=Ne.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(a=>{if(a.name==="ConnectionClosedEvent"){let c=a;(c.statusCode===1003||c.statusCode===1007||c.statusCode===1002||c.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(pe.CancellationReason.Error,c.statusCode===1007?pe.CancellationErrorCode.BadRequestParameters:pe.CancellationErrorCode.ConnectionFailure,`${c.reason} websocket error code: ${c.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=Ne.createNoDashGuid()),this.setLanguageIdJson(),this.setOutputDetailLevelJson()}setTranslationJson(){let e=this.privRecognizerConfig.parameters.getProperty(pe.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(e!==void 0){let t=e.split(","),r=this.privRecognizerConfig.parameters.getProperty(pe.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),n=r!==void 0?"Synthesize":"None";if(this.privSpeechContext.setSection("translation",{onSuccess:{action:n},output:{interimResults:{mode:"Always"}},targetLanguages:t}),r!==void 0){let s={};for(let o of t)s[o]=r;this.privSpeechContext.setSection("synthesis",{defaultVoices:s})}}}setSpeechSegmentationTimeoutJson(){let e=this.privRecognizerConfig.parameters.getProperty(pe.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0);if(e!==void 0){let t=this.recognitionMode===hr.RecognitionMode.Conversation?"CONVERSATION":this.recognitionMode===hr.RecognitionMode.Dictation?"DICTATION":"INTERACTIVE",r=parseInt(e,10),n=this.privSpeechContext.getSection("phraseDetection");n.mode=t,n[t]={segmentation:{mode:"Custom",segmentationSilenceTimeoutMs:r}},this.privSpeechContext.setSection("phraseDetection",n)}}setLanguageIdJson(){let e=this.privSpeechContext.getSection("phraseDetection");if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){let r=this.privRecognizerConfig.autoDetectSourceLanguages.split(","),n;this.privRecognizerConfig.languageIdMode==="Continuous"?n="DetectContinuous":n="DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:r,mode:n,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});let s=this.privRecognizerConfig.sourceLanguageModels;s!==void 0&&(e.customModels=s,e.onInterim={action:"None"},e.onSuccess={action:"None"})}this.privRecognizerConfig.parameters.getProperty(pe.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&(e.onInterim={action:"Translate"},e.onSuccess={action:"Translate"},this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"None"},phraseResults:{resultType:"None"}})),this.privSpeechContext.setSection("phraseDetection",e)}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(pe.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(hr.OutputFormatPropertyName,pe.OutputFormat[pe.OutputFormat.Simple]).toLowerCase()===pe.OutputFormat[pe.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(pe.PropertyId.ConversationTranslator_Token,e)}set voiceProfileType(e){this.privRecognizerConfig.parameters.setProperty(pe.PropertyId.SpeechServiceConnection_SpeakerIdMode,e)}set authentication(e){this.privAuthentication=e}isDisposed(){return this.privIsDisposed}dispose(e){return v(this,null,function*(){if(this.privIsDisposed=!0,this.privConnectionConfigurationPromise!==void 0)try{yield(yield this.privConnectionConfigurationPromise).dispose(e)}catch{return}})}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(e,t,r){return v(this,null,function*(){if(this.recognizeOverride!==void 0){yield this.recognizeOverride(e,t,r);return}this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=e,this.setSpeechSegmentationTimeoutJson(),this.setTranslationJson(),this.privSuccessCallback=t,this.privErrorCallback=r,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);let n=this.connectImpl(),s;try{let c=yield this.audioSource.attach(this.privRequestSession.audioNodeId),l=yield this.audioSource.format,u=yield this.audioSource.deviceInfo;this.privIsLiveAudio=u.type&&u.type===hr.type.Microphones,s=new bW.ReplayableAudioNode(c,l.avgBytesPerSec),yield this.privRequestSession.onAudioSourceAttachCompleted(s,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:u}}catch(c){throw yield this.privRequestSession.onStopRecognizing(),c}try{yield n}catch(c){yield this.cancelRecognitionLocal(pe.CancellationReason.Error,pe.CancellationErrorCode.ConnectionFailure,c);return}let o=new pe.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,o),this.receiveMessage(),this.sendAudio(s).catch(c=>v(this,null,function*(){yield this.cancelRecognitionLocal(pe.CancellationReason.Error,pe.CancellationErrorCode.RuntimeError,c)}))})}stopRecognizing(){return v(this,null,function*(){if(this.privRequestSession.isRecognizing)try{yield this.audioSource.turnOff(),yield this.sendFinalAudio(),yield this.privRequestSession.onStopRecognizing(),yield this.privRequestSession.turnCompletionPromise}finally{yield this.privRequestSession.dispose()}})}connect(){return v(this,null,function*(){return yield this.connectImpl(),Promise.resolve()})}connectAsync(e,t){this.connectImpl().then(()=>{try{e&&e()}catch(r){t&&t(r)}},r=>{try{t&&t(r)}catch{}})}disconnect(){return v(this,null,function*(){if(yield this.cancelRecognitionLocal(pe.CancellationReason.Error,pe.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&(yield this.disconnectOverride()),this.privConnectionPromise!==void 0)try{yield(yield this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0})}sendMessage(e){}sendNetworkMessage(e,t){return v(this,null,function*(){let r=typeof t=="string"?Ne.MessageType.Text:Ne.MessageType.Binary,n=typeof t=="string"?"application/json":"";return(yield this.fetchConnection()).send(new hn.SpeechConnectionMessage(r,e,this.privRequestSession.requestId,n,t))})}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(e){this.privExpectContentAssessmentResponse=e}sendTelemetryData(){return v(this,null,function*(){let e=this.privRequestSession.getTelemetry();if(i.telemetryDataEnabled!==!0||this.privIsDisposed||e===null)return;if(i.telemetryData)try{i.telemetryData(e)}catch{}yield(yield this.fetchConnection()).send(new hn.SpeechConnectionMessage(Ne.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",e))})}cancelRecognitionLocal(e,t,r){return v(this,null,function*(){this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,r))})}receiveMessage(){return v(this,null,function*(){try{if(this.privIsDisposed)return;let e=yield this.fetchConnection(),t=yield e.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!t)return this.receiveMessage();this.privServiceHasSentMessage=!0;let r=hn.SpeechConnectionMessage.fromConnectionMessage(t);if(r.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(r.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":let n=hr.SpeechDetected.fromJSON(r.textBody),s=new pe.RecognitionEventArgs(n.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,s);break;case"speech.enddetected":let o;r.textBody.length>0?o=r.textBody:o="{ Offset: 0 }";let a=hr.SpeechDetected.fromJSON(o),c=new pe.RecognitionEventArgs(a.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,c);break;case"turn.end":yield this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,yield this.cancelRecognitionLocal(pe.CancellationReason.EndOfStream,pe.CancellationErrorCode.NoError,void 0));let l=new pe.SessionEventArgs(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,l);return}else e=yield this.fetchConnection(),yield this.sendPrePayloadJSON(e);break;default:(yield this.processTypeSpecificMessages(r))||this.privServiceEvents&&this.serviceEvents.onEvent(new Ne.ServiceEvent(r.path.toLowerCase(),r.textBody))}return this.receiveMessage()}catch{return null}})}updateSpeakerDiarizationAudioOffset(){let t=this.privRequestSession.recognitionBytesSent/this.privAverageBytesPerMs;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(t)}sendSpeechContext(e,t){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();let r=this.speechContext.toJSON();if(t&&this.privRequestSession.onSpeechContext(),r)return e.send(new hn.SpeechConnectionMessage(Ne.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",r))}noOp(){}sendPrePayloadJSON(e,t=!0){return v(this,null,function*(){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(e);yield this.sendSpeechContext(e,t),yield this.sendWaveHeader(e)})}sendWaveHeader(e){return v(this,null,function*(){let t=yield this.audioSource.format;return e.send(new hn.SpeechConnectionMessage(Ne.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",t.header))})}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(e=>e.state()===Ne.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(e,t,r){if(t.onSpeechContext(),i.telemetryDataEnabled!==!0){let s={context:{system:JSON.parse(r).context.system}};r=JSON.stringify(s)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){let n=JSON.parse(r);n.context.DisableReferenceChannel="True",n.context.MicSpec="1_0_0",r=JSON.stringify(n)}if(r)return e.send(new hn.SpeechConnectionMessage(Ne.MessageType.Text,"speech.config",t.requestId,"application/json",r))}fetchConnection(){return v(this,null,function*(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(e=>e.state()===Ne.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)})}sendAudio(e){return v(this,null,function*(){let t=yield this.audioSource.format;this.privAverageBytesPerMs=t.avgBytesPerSec/1e3;let r=Date.now(),n=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),s=t.avgBytesPerSec/1e3*parseInt(n,10),o=this.privRequestSession.recogNumber,a=()=>v(this,null,function*(){if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o){let c=yield this.fetchConnection(),l=yield e.read();if(this.privRequestSession.isSpeechEnded)return;let u,h;if(!l||l.isEnd?(u=null,h=0):(u=l.buffer,this.privRequestSession.onAudioSent(u.byteLength),s>=this.privRequestSession.bytesSent?h=0:h=Math.max(0,r-Date.now())),h!==0&&(yield this.delay(h)),u!==null&&(r=Date.now()+u.byteLength*1e3/(t.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o)if(c.send(new hn.SpeechConnectionMessage(Ne.MessageType.Binary,"audio",this.privRequestSession.requestId,null,u)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),l?.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return a()}});return a()})}retryableConnect(){return v(this,null,function*(){let e=!1;this.privAuthFetchEventId=Ne.createNoDashGuid();let t=this.privRequestSession.sessionId;this.privConnectionId=t!==void 0?t:Ne.createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let r=0,n="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){let o=yield e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);yield this.privRequestSession.onAuthCompleted(!1);let a=this.privConnectionFactory.create(this.privRecognizerConfig,o,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(a.events),a.events.attach(l=>{this.connectionEvents.onEvent(l)});let c=yield a.open();if(c.statusCode===200)return yield this.privRequestSession.onConnectionEstablishCompleted(c.statusCode),Promise.resolve(a);c.statusCode===1006&&(e=!0),r=c.statusCode,n=c.reason,this.privRequestSession.onRetryConnection()}return yield this.privRequestSession.onConnectionEstablishCompleted(r,n),Promise.reject(`Unable to contact server. StatusCode: ${r}, ${this.privRecognizerConfig.parameters.getProperty(pe.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${n}`)})}delay(e){return new Promise(t=>this.privSetTimeout(t,e))}writeBufferToConsole(e){let t="Buffer Size: ";if(e===null)t+="null";else{let r=new Uint8Array(e);t+=`${e.byteLength}\r
`;for(let n=0;n<e.byteLength;n++)t+=r[n].toString(16).padStart(2,"0")+" ",(n+1)%16===0&&(console.info(t),t="")}console.info(t)}sendFinalAudio(){return v(this,null,function*(){yield(yield this.fetchConnection()).send(new hn.SpeechConnectionMessage(Ne.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))})}configureConnection(){return v(this,null,function*(){let e=yield this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendPrePayloadJSON(e,!1),e)})}};Kd.ServiceRecognizerBase=Vd;Vd.telemetryDataEnabled=!0});var j1=p($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});$d.ConversationServiceRecognizer=void 0;var bi=w(),pr=T(),CC=class extends pr.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.handleSpeechPhraseMessage=o=>v(this,null,function*(){return this.handleSpeechPhrase(o)}),this.handleSpeechHypothesisMessage=o=>this.handleSpeechHypothesis(o)}processTypeSpecificMessages(e){}handleRecognizedCallback(e,t,r){}handleRecognizingCallback(e,t,r){}processSpeechMessages(e){return v(this,null,function*(){let t=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(e.textBody),t=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&(yield this.handleSpeechPhraseMessage(e.textBody)),t=!0;break;default:break}return t})}cancelRecognition(e,t,r,n,s){}handleSpeechPhrase(e){return v(this,null,function*(){let t=pr.SimpleSpeechPhrase.fromJSON(e),r=pr.EnumTranslation.implTranslateRecognitionResult(t.RecognitionStatus),n,s=new bi.PropertyCollection;s.setProperty(bi.PropertyId.SpeechServiceResponse_JsonResult,e);let o=t.Offset+this.privRequestSession.currentTurnAudioOffset,a=o;if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+t.Offset+t.Duration),bi.ResultReason.Canceled===r){let c=pr.EnumTranslation.implTranslateCancelResult(t.RecognitionStatus),l=pr.EnumTranslation.implTranslateCancelErrorCode(t.RecognitionStatus);yield this.cancelRecognitionLocal(c,l,pr.EnumTranslation.implTranslateErrorDetails(l))}else if(!(this.privRequestSession.isSpeechEnded&&r===bi.ResultReason.NoMatch&&t.RecognitionStatus!==pr.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(pr.OutputFormatPropertyName)===bi.OutputFormat[bi.OutputFormat.Simple])n=new bi.SpeechRecognitionResult(this.privRequestSession.requestId,r,t.DisplayText,t.Duration,o,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,s);else{let c=pr.DetailedSpeechPhrase.fromJSON(e),l=c.Offset+this.privRequestSession.currentTurnAudioOffset,u=c.getJsonWithCorrectedOffsets(l);n=new bi.SpeechRecognitionResult(this.privRequestSession.requestId,r,c.Text,c.Duration,l,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,u,s),a=n.offset}this.handleRecognizedCallback(n,a,this.privRequestSession.sessionId)}})}handleSpeechHypothesis(e){let t=pr.SpeechHypothesis.fromJSON(e),r=t.Offset+this.privRequestSession.currentTurnAudioOffset,n=new bi.PropertyCollection;n.setProperty(bi.PropertyId.SpeechServiceResponse_JsonResult,e);let s=new bi.SpeechRecognitionResult(this.privRequestSession.requestId,bi.ResultReason.RecognizingSpeech,t.Text,t.Duration,r,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,n);this.privRequestSession.onHypothesis(r),this.handleRecognizingCallback(s,t.Duration,this.privRequestSession.sessionId)}};$d.ConversationServiceRecognizer=CC});var q1=p(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.RecognizerConfig=dr.SpeechResultFormat=dr.RecognitionMode=void 0;var Gd=w(),z1=T(),Yd;(function(i){i[i.Interactive=0]="Interactive",i[i.Conversation=1]="Conversation",i[i.Dictation=2]="Dictation"})(Yd=dr.RecognitionMode||(dr.RecognitionMode={}));var wW;(function(i){i[i.Simple=0]="Simple",i[i.Detailed=1]="Detailed"})(wW=dr.SpeechResultFormat||(dr.SpeechResultFormat={}));var bC=class{constructor(e,t){this.privSpeechServiceConfig=e||new z1.SpeechServiceConfig(new z1.Context(null)),this.privParameters=t,this.privMaxRetryCount=parseInt(t.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=t.getProperty(Gd.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===Yd.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=Yd[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==Yd.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(Gd.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(Gd.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){let e=[],t=!1;if(this.autoDetectSourceLanguages!==void 0)for(let r of this.autoDetectSourceLanguages.split(",")){let n=r+Gd.PropertyId.SpeechServiceConnection_EndpointId.toString(),s=this.parameters.getProperty(n,void 0);s!==void 0?(e.push({language:r,endpoint:s}),t=!0):e.push({language:r,endpoint:""})}return t?e:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(e){this.privEnableSpeakerId=e}};dr.RecognizerConfig=bC});var B1=p(F1=>{"use strict";Object.defineProperty(F1,"__esModule",{value:!0})});var H1=p(Jd=>{"use strict";Object.defineProperty(Jd,"__esModule",{value:!0});Jd.WebsocketMessageFormatter=void 0;var wi=M(),W1=`\r
`,wC=class{toConnectionMessage(e){let t=new wi.Deferred;try{if(e.messageType===wi.MessageType.Text){let r=e.textContent,n={},s=null;if(r){let o=r.split(`\r
\r
`);o&&o.length>0&&(n=this.parseHeaders(o[0]),o.length>1&&(s=o[1]))}t.resolve(new wi.ConnectionMessage(e.messageType,s,n,e.id))}else if(e.messageType===wi.MessageType.Binary){let r=e.binaryContent,n={},s=null;if(!r||r.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");let o=new DataView(r),a=o.getInt16(0);if(r.byteLength<a+2)throw new Error("Invalid binary message format. Header content missing.");let c="";for(let l=0;l<a;l++)c+=String.fromCharCode(o.getInt8(l+2));n=this.parseHeaders(c),r.byteLength>a+2&&(s=r.slice(2+a)),t.resolve(new wi.ConnectionMessage(e.messageType,s,n,e.id))}}catch(r){t.reject(`Error formatting the message. Error: ${r}`)}return t.promise}fromConnectionMessage(e){let t=new wi.Deferred;try{if(e.messageType===wi.MessageType.Text){let r=`${this.makeHeaders(e)}${W1}${e.textBody?e.textBody:""}`;t.resolve(new wi.RawWebsocketMessage(wi.MessageType.Text,r,e.id))}else if(e.messageType===wi.MessageType.Binary){let r=this.makeHeaders(e),n=e.binaryBody,s=this.stringToArrayBuffer(r),o=new Int8Array(s),a=o.byteLength,c=new Int8Array(2+a+(n?n.byteLength:0));if(c[0]=a>>8&255,c[1]=a&255,c.set(o,2),n){let u=new Int8Array(n);c.set(u,2+a)}let l=c.buffer;t.resolve(new wi.RawWebsocketMessage(wi.MessageType.Binary,l,e.id))}}catch(r){t.reject(`Error formatting the message. ${r}`)}return t.promise}makeHeaders(e){let t="";if(e.headers)for(let r in e.headers)r&&(t+=`${r}: ${e.headers[r]}${W1}`);return t}parseHeaders(e){let t={};if(e){let r=e.match(/[^\r\n]+/g);if(t){for(let n of r)if(n){let s=n.indexOf(":"),o=s>0?n.substr(0,s).trim().toLowerCase():n,a=s>0&&n.length>s+1?n.substr(s+1).trim():"";t[o]=a}}}return t}stringToArrayBuffer(e){let t=new ArrayBuffer(e.length),r=new DataView(t);for(let n=0;n<e.length;n++)r.setUint8(n,e.charCodeAt(n));return t}};Jd.WebsocketMessageFormatter=wC});var $1=p(Xd=>{"use strict";Object.defineProperty(Xd,"__esModule",{value:!0});Xd.SpeechConnectionFactory=void 0;var U1=Ve(),V1=T(),pn=w(),K1=Si(),PC=T(),PW=_t(),vs=Ir(),EC=class extends K1.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(e,t,r){let n=e.parameters.getProperty(pn.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(pn.PropertyId.SpeechServiceConnection_Region,void 0),o=K1.ConnectionFactoryBase.getHostSuffix(s),a=e.parameters.getProperty(pn.PropertyId.SpeechServiceConnection_Host,"wss://"+s+".stt.speech"+o),c={},l=e.parameters.getProperty(pn.PropertyId.SpeechServiceConnection_EndpointId,void 0),u=e.parameters.getProperty(pn.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(l?(!n||n.search(vs.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(c[vs.QueryParameterNames.CustomSpeechDeploymentId]=l):u&&(!n||n.search(vs.QueryParameterNames.Language)===-1)&&(c[vs.QueryParameterNames.Language]=u),(!n||n.search(vs.QueryParameterNames.Format)===-1)&&(c[vs.QueryParameterNames.Format]=e.parameters.getProperty(V1.OutputFormatPropertyName,pn.OutputFormat[pn.OutputFormat.Simple]).toLowerCase()),e.autoDetectSourceLanguages!==void 0&&(c[vs.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(e,c,n),!n)switch(e.recognitionMode){case PC.RecognitionMode.Conversation:e.parameters.getProperty(V1.ForceDictationPropertyName,"false")==="true"?n=a+this.dictationRelativeUri:e.recognitionEndpointVersion!==void 0&&parseInt(e.recognitionEndpointVersion,10)>1?n=`${a}${this.universalUri}${e.recognitionEndpointVersion}`:n=a+this.conversationRelativeUri;break;case PC.RecognitionMode.Dictation:n=a+this.dictationRelativeUri;break;default:e.recognitionEndpointVersion!==void 0&&parseInt(e.recognitionEndpointVersion,10)>1?n=`${a}${this.universalUri}${e.recognitionEndpointVersion}`:n=a+this.interactiveRelativeUri;break}let h={};t.token!==void 0&&t.token!==""&&(h[t.headerName]=t.token),h[PW.HeaderNames.ConnectionId]=r;let d=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",f=new U1.WebsocketConnection(n,c,h,new PC.WebsocketMessageFormatter,U1.ProxyInfo.fromRecognizerConfig(e),d,r),g=f.uri;return e.parameters.setProperty(pn.PropertyId.SpeechServiceConnection_Url,g),f}};Xd.SpeechConnectionFactory=EC});var J1=p(Zd=>{"use strict";Object.defineProperty(Zd,"__esModule",{value:!0});Zd.ConversationTranscriberConnectionFactory=void 0;var G1=Ve(),si=w(),EW=T(),Y1=Si(),RW=T(),IW=_t(),Pi=Ir(),RC=class extends Y1.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/speech/universal/v2"}create(e,t,r){let n=e.parameters.getProperty(si.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(si.PropertyId.SpeechServiceConnection_Region,void 0),o=Y1.ConnectionFactoryBase.getHostSuffix(s),a=e.parameters.getProperty(si.PropertyId.SpeechServiceConnection_Host,"wss://"+s+".stt.speech"+o),c={},l=e.parameters.getProperty(si.PropertyId.SpeechServiceConnection_EndpointId,void 0),u=e.parameters.getProperty(si.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);l?(!n||n.search(Pi.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(c[Pi.QueryParameterNames.CustomSpeechDeploymentId]=l):u&&(!n||n.search(Pi.QueryParameterNames.Language)===-1)&&(c[Pi.QueryParameterNames.Language]=u),e.autoDetectSourceLanguages!==void 0&&(c[Pi.QueryParameterNames.EnableLanguageId]="true"),this.setV2UrlParams(e,c,n),n||(n=`${a}${this.universalUri}`);let h={};t.token!==void 0&&t.token!==""&&(h[t.headerName]=t.token),h[IW.HeaderNames.ConnectionId]=r;let d=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",f=new G1.WebsocketConnection(n,c,h,new RW.WebsocketMessageFormatter,G1.ProxyInfo.fromRecognizerConfig(e),d,r),g=f.uri;return e.parameters.setProperty(si.PropertyId.SpeechServiceConnection_Url,g),f}setV2UrlParams(e,t,r){new Map([[si.PropertyId.Speech_SegmentationSilenceTimeoutMs,Pi.QueryParameterNames.SegmentationSilenceTimeoutMs],[si.PropertyId.SpeechServiceConnection_EnableAudioLogging,Pi.QueryParameterNames.EnableAudioLogging],[si.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,Pi.QueryParameterNames.EndSilenceTimeoutMs],[si.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,Pi.QueryParameterNames.InitialSilenceTimeoutMs],[si.PropertyId.SpeechServiceResponse_PostProcessingOption,Pi.QueryParameterNames.Postprocessing],[si.PropertyId.SpeechServiceResponse_ProfanityOption,Pi.QueryParameterNames.Profanity],[si.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,Pi.QueryParameterNames.StableIntermediateThreshold]]).forEach((o,a)=>{this.setUrlParameter(a,o,e,t,r)});let s=JSON.parse(e.parameters.getProperty(EW.ServicePropertiesPropertyName,"{}"));Object.keys(s).forEach(o=>{t[o]=s[o]})}};Zd.ConversationTranscriberConnectionFactory=RC});var ex=p(Qd=>{"use strict";Object.defineProperty(Qd,"__esModule",{value:!0});Qd.TranscriberConnectionFactory=void 0;var X1=Ve(),oi=w(),Z1=Si(),Q1=T(),TW=_t(),Lc=Ir(),IC=class extends Z1.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(e,t,r){let n=e.parameters.getProperty(oi.PropertyId.SpeechServiceConnection_Endpoint,void 0),s=e.parameters.getProperty(oi.PropertyId.SpeechServiceConnection_Region,"centralus"),o=Z1.ConnectionFactoryBase.getHostSuffix(s),a="wss://transcribe."+s+".cts.speech"+o+this.multiaudioRelativeUri,c=e.parameters.getProperty(oi.PropertyId.SpeechServiceConnection_Host,a),l={};this.setQueryParams(l,e,n),n||(n=c);let u={};t.token!==void 0&&t.token!==""&&(u[t.headerName]=t.token),u[TW.HeaderNames.ConnectionId]=r,e.parameters.setProperty(oi.PropertyId.SpeechServiceConnection_Url,n);let h=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new X1.WebsocketConnection(n,l,u,new Q1.WebsocketMessageFormatter,X1.ProxyInfo.fromRecognizerConfig(e),h,r)}setQueryParams(e,t,r){let n=t.parameters.getProperty(oi.PropertyId.SpeechServiceConnection_EndpointId,void 0),s=t.parameters.getProperty(oi.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);n&&!(Lc.QueryParameterNames.CustomSpeechDeploymentId in e)&&(e[Lc.QueryParameterNames.CustomSpeechDeploymentId]=n),s&&!(Lc.QueryParameterNames.Language in e)&&(e[Lc.QueryParameterNames.Language]=s);let o=t.parameters.getProperty(oi.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",a=t.parameters.getProperty(Q1.OutputFormatPropertyName,oi.OutputFormat[oi.OutputFormat.Simple])!==oi.OutputFormat[oi.OutputFormat.Simple];(o||a)&&(e[Lc.QueryParameterNames.Format]=oi.OutputFormat[oi.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(t,e,r)}};Qd.TranscriberConnectionFactory=IC});var nx=p(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});ef.TranslationConnectionFactory=void 0;var tx=Ve(),AW=gS(),xr=w(),ix=Si(),TC=T(),OW=_t(),rx=Ir(),AC=class extends ix.ConnectionFactoryBase{create(e,t,r){let n=this.getEndpointUrl(e),s={};e.autoDetectSourceLanguages!==void 0&&(s[rx.QueryParameterNames.EnableLanguageId]="true"),this.setQueryParams(s,e,n);let o={};t.token!==void 0&&t.token!==""&&(o[t.headerName]=t.token),o[OW.HeaderNames.ConnectionId]=r,e.parameters.setProperty(xr.PropertyId.SpeechServiceConnection_Url,n);let a=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new tx.WebsocketConnection(n,s,o,new TC.WebsocketMessageFormatter,tx.ProxyInfo.fromRecognizerConfig(e),a,r)}getEndpointUrl(e,t){let r=e.parameters.getProperty(xr.PropertyId.SpeechServiceConnection_Region),n=ix.ConnectionFactoryBase.getHostSuffix(r),s=e.parameters.getProperty(xr.PropertyId.SpeechServiceConnection_Endpoint,void 0);return s||(e.autoDetectSourceLanguages!==void 0?s=e.parameters.getProperty(xr.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+n)+"/speech/universal/v2":s=e.parameters.getProperty(xr.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+n)+"/speech/translation/cognitiveservices/v1"),t===!0?s:AW.StringUtils.formatString(s,{region:r})}setQueryParams(e,t,r){e.from=t.parameters.getProperty(xr.PropertyId.SpeechServiceConnection_RecoLanguage),e.to=t.parameters.getProperty(xr.PropertyId.SpeechServiceConnection_TranslationToLanguages),e.scenario=t.recognitionMode===TC.RecognitionMode.Interactive?"interactive":t.recognitionMode===TC.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(t,e,r),this.setUrlParameter(xr.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,rx.QueryParameterNames.StableTranslation,t,e,r);let n=t.parameters.getProperty(xr.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);n!==void 0&&(e.voice=n,e.features="texttospeech")}};ef.TranslationConnectionFactory=AC});var sx=p(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});tf.EnumTranslation=void 0;var $e=w(),Be=T(),OC=class{static implTranslateRecognitionResult(e,t=!1){let r=$e.ResultReason.Canceled;switch(e){case Be.RecognitionStatus.Success:r=$e.ResultReason.RecognizedSpeech;break;case Be.RecognitionStatus.EndOfDictation:r=t?$e.ResultReason.RecognizedSpeech:$e.ResultReason.NoMatch;break;case Be.RecognitionStatus.NoMatch:case Be.RecognitionStatus.InitialSilenceTimeout:case Be.RecognitionStatus.BabbleTimeout:r=$e.ResultReason.NoMatch;break;case Be.RecognitionStatus.Error:case Be.RecognitionStatus.BadRequest:case Be.RecognitionStatus.Forbidden:default:r=$e.ResultReason.Canceled;break}return r}static implTranslateCancelResult(e){let t=$e.CancellationReason.EndOfStream;switch(e){case Be.RecognitionStatus.Success:case Be.RecognitionStatus.EndOfDictation:case Be.RecognitionStatus.NoMatch:t=$e.CancellationReason.EndOfStream;break;case Be.RecognitionStatus.InitialSilenceTimeout:case Be.RecognitionStatus.BabbleTimeout:case Be.RecognitionStatus.Error:case Be.RecognitionStatus.BadRequest:case Be.RecognitionStatus.Forbidden:default:t=$e.CancellationReason.Error;break}return t}static implTranslateCancelErrorCode(e){let t=$e.CancellationErrorCode.NoError;switch(e){case Be.RecognitionStatus.Error:t=$e.CancellationErrorCode.ServiceError;break;case Be.RecognitionStatus.TooManyRequests:t=$e.CancellationErrorCode.TooManyRequests;break;case Be.RecognitionStatus.BadRequest:t=$e.CancellationErrorCode.BadRequestParameters;break;case Be.RecognitionStatus.Forbidden:t=$e.CancellationErrorCode.Forbidden;break;default:t=$e.CancellationErrorCode.NoError;break}return t}static implTranslateErrorDetails(e){let t="The speech service encountered an internal error and could not continue.";switch(e){case $e.CancellationErrorCode.Forbidden:t="The recognizer is using a free subscription that ran out of quota.";break;case $e.CancellationErrorCode.BadRequestParameters:t="Invalid parameter or unsupported audio format in the request.";break;case $e.CancellationErrorCode.TooManyRequests:t="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break;default:break}return t}};tf.EnumTranslation=OC});var ox=p(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.RecognitionStatus=dn.SynthesisStatus=void 0;var DW;(function(i){i[i.Success=0]="Success",i[i.SynthesisEnd=1]="SynthesisEnd",i[i.Error=2]="Error"})(DW=dn.SynthesisStatus||(dn.SynthesisStatus={}));var xW;(function(i){i[i.Success=0]="Success",i[i.NoMatch=1]="NoMatch",i[i.InitialSilenceTimeout=2]="InitialSilenceTimeout",i[i.BabbleTimeout=3]="BabbleTimeout",i[i.Error=4]="Error",i[i.EndOfDictation=5]="EndOfDictation",i[i.TooManyRequests=6]="TooManyRequests",i[i.BadRequest=7]="BadRequest",i[i.Forbidden=8]="Forbidden"})(xW=dn.RecognitionStatus||(dn.RecognitionStatus={}))});var cx=p(rf=>{"use strict";Object.defineProperty(rf,"__esModule",{value:!0});rf.TranslationSynthesisEnd=void 0;var ax=T(),DC=class i{constructor(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=ax.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=ax.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(e){return new i(e)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};rf.TranslationSynthesisEnd=DC});var lx=p(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.TranslationHypothesis=void 0;var MW=j(),kW=iu(),xC=class i{constructor(e){this.privTranslationHypothesis=e,this.privTranslationHypothesis.Translation.TranslationStatus=kW.TranslationStatus[this.privTranslationHypothesis.Translation.TranslationStatus]}static fromJSON(e){return new i(JSON.parse(e))}static fromTranslationResponse(e){MW.Contracts.throwIfNullOrUndefined(e,"translationHypothesis");let t=e.SpeechHypothesis;return e.SpeechHypothesis=void 0,t.Translation=e,new i(t)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){return this.privTranslationHypothesis.PrimaryLanguage?.Language}};nf.TranslationHypothesis=xC});var ux=p(sf=>{"use strict";Object.defineProperty(sf,"__esModule",{value:!0});sf.TranslationPhrase=void 0;var NW=j(),LW=T(),jW=iu(),MC=class i{constructor(e){this.privTranslationPhrase=e,this.privTranslationPhrase.RecognitionStatus=LW.RecognitionStatus[this.privTranslationPhrase.RecognitionStatus],this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=jW.TranslationStatus[this.privTranslationPhrase.Translation.TranslationStatus])}static fromJSON(e){return new i(JSON.parse(e))}static fromTranslationResponse(e){NW.Contracts.throwIfNullOrUndefined(e,"translationResponse");let t=e.SpeechPhrase;return e.SpeechPhrase=void 0,t.Translation=e,t.Text=t.DisplayText,new i(t)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){return this.privTranslationPhrase.PrimaryLanguage?.Language}get Confidence(){return this.privTranslationPhrase.PrimaryLanguage?.Confidence}get Translation(){return this.privTranslationPhrase.Translation}};sf.TranslationPhrase=MC});var px=p(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});of.TranslationServiceRecognizer=void 0;var hx=M(),ce=w(),bt=T(),kC=class extends bt.ConversationServiceRecognizer{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privTranslationRecognizer=s,this.connectionEvents.attach(o=>{o.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}processTypeSpecificMessages(e){return v(this,null,function*(){let t=new ce.PropertyCollection,r=yield this.processSpeechMessages(e);if(r)return!0;let n=o=>v(this,null,function*(){if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+o.Offset+o.Duration),o.RecognitionStatus===bt.RecognitionStatus.Success){let a=this.fireEventForResult(o,t);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,a)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(a.result)}catch(c){this.privErrorCallback&&this.privErrorCallback(c)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{let a=bt.EnumTranslation.implTranslateRecognitionResult(o.RecognitionStatus),c=new ce.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,a,o.Text,o.Duration,this.privRequestSession.currentTurnAudioOffset+o.Offset,o.Language,o.Confidence,void 0,e.textBody,t);if(a===ce.ResultReason.Canceled){let l=bt.EnumTranslation.implTranslateCancelResult(o.RecognitionStatus),u=bt.EnumTranslation.implTranslateCancelErrorCode(o.RecognitionStatus);yield this.cancelRecognitionLocal(l,u,bt.EnumTranslation.implTranslateErrorDetails(u))}else{if(!(this.privRequestSession.isSpeechEnded&&a===ce.ResultReason.NoMatch&&o.RecognitionStatus!==bt.RecognitionStatus.InitialSilenceTimeout)){let l=new ce.TranslationRecognitionEventArgs(c,c.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,l)}catch{}}if(this.privSuccessCallback){try{this.privSuccessCallback(c)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}r=!0}}),s=(o,a)=>{let c=this.fireEventForResult(o,a);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+c.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,c)}catch{}r=!0};switch(e.messageType===hx.MessageType.Text&&t.setProperty(ce.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":s(bt.TranslationHypothesis.fromJSON(e.textBody),t);break;case"translation.response":let o=JSON.parse(e.textBody);if(o.SpeechPhrase)yield n(bt.TranslationPhrase.fromTranslationResponse(o));else{let c=JSON.parse(e.textBody);c.SpeechHypothesis&&s(bt.TranslationHypothesis.fromTranslationResponse(c),t)}break;case"translation.phrase":yield n(bt.TranslationPhrase.fromJSON(e.textBody));break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId),r=!0;break;case"audio.end":case"translation.synthesis.end":let a=bt.TranslationSynthesisEnd.fromJSON(e.textBody);switch(a.SynthesisStatus){case bt.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){let c=new ce.TranslationSynthesisResult(ce.ResultReason.Canceled,void 0),l=new ce.TranslationSynthesisEventArgs(c,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,l)}catch{}}if(this.privTranslationRecognizer.canceled){let c=new ce.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,ce.CancellationReason.Error,a.FailureReason,ce.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,c)}catch{}}break;case bt.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break;default:break}r=!0;break;default:break}return r})}cancelRecognition(e,t,r,n,s){let o=new ce.PropertyCollection;if(o.setProperty(bt.CancellationErrorCodePropertyName,ce.CancellationErrorCode[n]),this.privTranslationRecognizer.canceled){let a=new ce.TranslationRecognitionCanceledEventArgs(e,r,s,n,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new ce.TranslationRecognitionResult(void 0,t,ce.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(e,t,r){try{let n=new ce.TranslationRecognitionEventArgs(ce.TranslationRecognitionResult.fromSpeechRecognitionResult(e),t,r);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,n)}catch{}}handleRecognizedCallback(e,t,r){try{let n=new ce.TranslationRecognitionEventArgs(ce.TranslationRecognitionResult.fromSpeechRecognitionResult(e),t,r);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,n)}catch{}}fireEventForResult(e,t){let r;if(e.Translation.Translations!==void 0){r=new ce.Translations;for(let u of e.Translation.Translations)r.set(u.Language,u.Text||u.DisplayText)}let n,s;e instanceof bt.TranslationPhrase?(e.Translation&&e.Translation.TranslationStatus===hx.TranslationStatus.Success?n=ce.ResultReason.TranslatedSpeech:n=ce.ResultReason.RecognizedSpeech,s=e.Confidence):n=ce.ResultReason.TranslatingSpeech;let o=e.Language,a=e.Offset+this.privRequestSession.currentTurnAudioOffset,c=new ce.TranslationRecognitionResult(r,this.privRequestSession.requestId,n,e.Text,e.Duration,a,o,s,e.Translation.FailureReason,JSON.stringify(e),t);return new ce.TranslationRecognitionEventArgs(c,a,this.privRequestSession.sessionId)}sendSynthesisAudio(e,t){let r=e===void 0?ce.ResultReason.SynthesizingAudioCompleted:ce.ResultReason.SynthesizingAudio,n=new ce.TranslationSynthesisResult(r,e),s=new ce.TranslationSynthesisEventArgs(n,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,s)}catch{}}};of.TranslationServiceRecognizer=kC});var dx=p(af=>{"use strict";Object.defineProperty(af,"__esModule",{value:!0});af.SpeechDetected=void 0;var NC=class i{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new i(e)}get Offset(){return this.privSpeechStartDetected.Offset}};af.SpeechDetected=NC});var fx=p(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});cf.SpeechHypothesis=void 0;var LC=class i{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new i(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};cf.SpeechHypothesis=LC});var vx=p(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.SpeechKeyword=void 0;var jC=class i{constructor(e){this.privSpeechKeyword=JSON.parse(e)}static fromJSON(e){return new i(e)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}};lf.SpeechKeyword=jC});var gx=p(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});uf.SpeechServiceRecognizer=void 0;var lt=w(),Ei=T(),zC=class extends Ei.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privSpeechRecognizer=s}processTypeSpecificMessages(e){return v(this,null,function*(){let t,r=new lt.PropertyCollection;r.setProperty(lt.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);let n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":let s=Ei.SpeechHypothesis.fromJSON(e.textBody),o=s.Offset+this.privRequestSession.currentTurnAudioOffset;t=new lt.SpeechRecognitionResult(this.privRequestSession.requestId,lt.ResultReason.RecognizingSpeech,s.Text,s.Duration,o,s.Language,s.LanguageDetectionConfidence,void 0,void 0,e.textBody,r),this.privRequestSession.onHypothesis(o);let a=new lt.SpeechRecognitionEventArgs(t,s.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,a)}catch{}n=!0;break;case"speech.phrase":let c=Ei.SimpleSpeechPhrase.fromJSON(e.textBody),l=Ei.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+c.Offset+c.Duration),lt.ResultReason.Canceled===l){let u=Ei.EnumTranslation.implTranslateCancelResult(c.RecognitionStatus),h=Ei.EnumTranslation.implTranslateCancelErrorCode(c.RecognitionStatus);yield this.cancelRecognitionLocal(u,h,Ei.EnumTranslation.implTranslateErrorDetails(h))}else{if(!(this.privRequestSession.isSpeechEnded&&l===lt.ResultReason.NoMatch&&c.RecognitionStatus!==Ei.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(Ei.OutputFormatPropertyName)===lt.OutputFormat[lt.OutputFormat.Simple])t=new lt.SpeechRecognitionResult(this.privRequestSession.requestId,l,c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,void 0,void 0,e.textBody,r);else{let h=Ei.DetailedSpeechPhrase.fromJSON(e.textBody),d=h.Offset+this.privRequestSession.currentTurnAudioOffset,f=h.getJsonWithCorrectedOffsets(d);t=new lt.SpeechRecognitionResult(this.privRequestSession.requestId,l,h.RecognitionStatus===Ei.RecognitionStatus.Success?h.NBest[0].Display:void 0,h.Duration,d,h.Language,h.LanguageDetectionConfidence,void 0,void 0,f,r)}let u=new lt.SpeechRecognitionEventArgs(t,t.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,u)}catch{}}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(u){this.privErrorCallback&&this.privErrorCallback(u)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}n=!0;break;default:break}return n})}cancelRecognition(e,t,r,n,s){let o=new lt.PropertyCollection;if(o.setProperty(Ei.CancellationErrorCodePropertyName,lt.CancellationErrorCode[n]),this.privSpeechRecognizer.canceled){let a=new lt.SpeechRecognitionCanceledEventArgs(r,s,n,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new lt.SpeechRecognitionResult(t,lt.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}};uf.SpeechServiceRecognizer=zC});var mx=p(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});hf.ConversationTranscriptionServiceRecognizer=void 0;var Mt=w(),Ri=T(),qC=class extends Ri.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privConversationTranscriber=s,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){let e=this.privSpeechContext.getSection("phraseDetection");e.mode="Conversation";let t={};t.mode="Anonymous",t.audioSessionId=this.privDiarizationSessionId,t.audioOffsetMs=0,e.speakerDiarization=t,this.privSpeechContext.setSection("phraseDetection",e)}}processTypeSpecificMessages(e){return v(this,null,function*(){let t,r=new Mt.PropertyCollection;r.setProperty(Mt.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);let n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":let s=Ri.SpeechHypothesis.fromJSON(e.textBody),o=s.Offset+this.privRequestSession.currentTurnAudioOffset;t=new Mt.ConversationTranscriptionResult(this.privRequestSession.requestId,Mt.ResultReason.RecognizingSpeech,s.Text,s.Duration,o,s.Language,s.LanguageDetectionConfidence,void 0,void 0,e.textBody,r),this.privRequestSession.onHypothesis(o);let a=new Mt.ConversationTranscriptionEventArgs(t,s.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,a)}catch{}n=!0;break;case"speech.phrase":let c=Ri.SimpleSpeechPhrase.fromJSON(e.textBody),l=Ri.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+c.Offset+c.Duration),Mt.ResultReason.Canceled===l){let u=Ri.EnumTranslation.implTranslateCancelResult(c.RecognitionStatus),h=Ri.EnumTranslation.implTranslateCancelErrorCode(c.RecognitionStatus);yield this.cancelRecognitionLocal(u,h,Ri.EnumTranslation.implTranslateErrorDetails(h))}else if(!(this.privRequestSession.isSpeechEnded&&l===Mt.ResultReason.NoMatch&&c.RecognitionStatus!==Ri.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(Ri.OutputFormatPropertyName)===Mt.OutputFormat[Mt.OutputFormat.Simple])t=new Mt.ConversationTranscriptionResult(this.privRequestSession.requestId,l,c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,e.textBody,r);else{let h=Ri.DetailedSpeechPhrase.fromJSON(e.textBody),d=h.Offset+this.privRequestSession.currentTurnAudioOffset,f=h.getJsonWithCorrectedOffsets(d);t=new Mt.ConversationTranscriptionResult(this.privRequestSession.requestId,l,h.RecognitionStatus===Ri.RecognitionStatus.Success?h.NBest[0].Display:void 0,h.Duration,d,h.Language,h.LanguageDetectionConfidence,c.SpeakerId,void 0,f,r)}let u=new Mt.ConversationTranscriptionEventArgs(t,t.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,u)}catch{}}n=!0;break;default:break}return n})}cancelRecognition(e,t,r,n,s){if(new Mt.PropertyCollection().setProperty(Ri.CancellationErrorCodePropertyName,Mt.CancellationErrorCode[n]),this.privConversationTranscriber.canceled){let a=new Mt.ConversationTranscriptionCanceledEventArgs(r,s,n,void 0,e);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,a)}catch{}}}};hf.ConversationTranscriptionServiceRecognizer=qC});var _x=p(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});pf.TranscriptionServiceRecognizer=void 0;var zW=M(),Mr=w(),yx=T(),qW=fs(),FC=class extends yx.ConversationServiceRecognizer{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privTranscriberRecognizer=s,this.sendPrePayloadJSONOverride=o=>this.sendTranscriptionStartJSON(o),this.privRecognizerConfig.parameters.getProperty(Mr.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}sendSpeechEventAsync(e,t){return v(this,null,function*(){if(this.privRequestSession.isRecognizing){let r=yield this.fetchConnection();yield this.sendSpeechEvent(r,this.createSpeechEventPayload(e,t))}})}sendMeetingSpeechEventAsync(e,t){return v(this,null,function*(){if(this.privRequestSession.isRecognizing){let r=yield this.fetchConnection();yield this.sendSpeechEvent(r,this.createMeetingSpeechEventPayload(e,t))}})}processTypeSpecificMessages(e){return this.processSpeechMessages(e)}handleRecognizedCallback(e,t,r){try{let n=new Mr.SpeechRecognitionEventArgs(e,t,r);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,n),this.privSuccessCallback){try{this.privSuccessCallback(e)}catch(s){this.privErrorCallback&&this.privErrorCallback(s)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(e,t,r){try{let n=new Mr.SpeechRecognitionEventArgs(e,t,r);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,n)}catch{}}cancelRecognition(e,t,r,n,s){let o=new Mr.PropertyCollection;if(o.setProperty(yx.CancellationErrorCodePropertyName,Mr.CancellationErrorCode[n]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){let a=new Mr.MeetingTranscriptionCanceledEventArgs(r,s,n,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,a)}catch{}}}else if(this.privTranscriberRecognizer.canceled){let a=new Mr.ConversationTranscriptionCanceledEventArgs(r,s,n,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new Mr.SpeechRecognitionResult(t,Mr.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}sendTranscriptionStartJSON(e){return v(this,null,function*(){if(yield this.sendSpeechContext(e,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){let t=this.privTranscriberRecognizer.getMeetingInfo(),r=this.createMeetingSpeechEventPayload(t,"start");yield this.sendSpeechEvent(e,r)}else{let t=this.privTranscriberRecognizer.getConversationInfo(),r=this.createSpeechEventPayload(t,"start");yield this.sendSpeechEvent(e,r)}yield this.sendWaveHeader(e)})}sendSpeechEvent(e,t){let r=JSON.stringify(t);if(r)return e.send(new qW.SpeechConnectionMessage(zW.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",r))}createSpeechEventPayload(e,t){let r={id:"meeting",name:t,meeting:e.conversationProperties};return r.meeting.id=e.id,r.meeting.attendees=e.participants,r}createMeetingSpeechEventPayload(e,t){let r={id:"meeting",name:t,meeting:e.meetingProperties};return r.meeting.id=e.id,r.meeting.attendees=e.participants,r}};pf.TranscriptionServiceRecognizer=FC});var Sx=p(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});df.DetailedSpeechPhrase=void 0;var FW=T(),BC=class i{constructor(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=FW.RecognitionStatus[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new i(e)}getJsonWithCorrectedOffsets(e){if(this.privDetailedSpeechPhrase.NBest){let t;for(let r of this.privDetailedSpeechPhrase.NBest)if(r.Words&&r.Words[0]){t=r.Words[0].Offset;break}if(t&&t<e){let r=e-t;for(let n of this.privDetailedSpeechPhrase.NBest){if(n.Words)for(let s of n.Words)s.Offset+=r;if(n.DisplayWords)for(let s of n.DisplayWords)s.Offset+=r}}}return JSON.stringify(this.privDetailedSpeechPhrase)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}};df.DetailedSpeechPhrase=BC});var Cx=p(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0});ff.SimpleSpeechPhrase=void 0;var BW=T(),WC=class i{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=BW.RecognitionStatus[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new i(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}};ff.SimpleSpeechPhrase=WC});var bx=p(vf=>{"use strict";Object.defineProperty(vf,"__esModule",{value:!0});vf.AddedLmIntent=void 0;var HC=class{constructor(e,t){this.modelImpl=e,this.intentName=t}};vf.AddedLmIntent=HC});var Px=p(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.IntentServiceRecognizer=void 0;var wx=M(),We=w(),Vo=T(),UC=class extends Vo.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privIntentRecognizer=s,this.privIntentDataSent=!1}setIntents(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0}processTypeSpecificMessages(e){let t,r,n=!1,s=new We.PropertyCollection;switch(e.messageType===wx.MessageType.Text&&s.setProperty(We.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":let a=Vo.SpeechHypothesis.fromJSON(e.textBody);if(t=new We.IntentRecognitionResult(void 0,this.privRequestSession.requestId,We.ResultReason.RecognizingIntent,a.Text,a.Duration,a.Offset+this.privRequestSession.currentTurnAudioOffset,a.Language,a.LanguageDetectionConfidence,void 0,e.textBody,s),this.privRequestSession.onHypothesis(t.offset),r=new We.IntentRecognitionEventArgs(t,a.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,r)}catch{}n=!0;break;case"speech.phrase":let c=Vo.SimpleSpeechPhrase.fromJSON(e.textBody);t=new We.IntentRecognitionResult(void 0,this.privRequestSession.requestId,Vo.EnumTranslation.implTranslateRecognitionResult(c.RecognitionStatus),c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,c.Language,c.LanguageDetectionConfidence,void 0,e.textBody,s),r=new We.IntentRecognitionEventArgs(t,t.offset,this.privRequestSession.sessionId);let l=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};this.privIntentDataSent===!1||We.ResultReason.NoMatch===r.result.reason?(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),l()):this.privPendingIntentArgs=r,n=!0;break;case"response":if(r=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,r===void 0){if(e.textBody==="")return;r=new We.IntentRecognitionEventArgs(new We.IntentRecognitionResult,0,this.privRequestSession.sessionId)}let u=Vo.IntentResponse.fromJSON(e.textBody);if(u!==null&&u.topScoringIntent&&u.topScoringIntent.intent){let h=this.privAddedLmIntents[u.topScoringIntent.intent];if(this.privUmbrellaIntent!==void 0&&(h=this.privUmbrellaIntent),h){let d=h===void 0||h.intentName===void 0?u.topScoringIntent.intent:h.intentName,f=r.result.reason;d!==void 0&&(f=We.ResultReason.RecognizedIntent);let g=r.result.properties!==void 0?r.result.properties:new We.PropertyCollection;g.setProperty(We.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),r=new We.IntentRecognitionEventArgs(new We.IntentRecognitionResult(d,r.result.resultId,f,r.result.text,r.result.duration,r.result.offset,void 0,void 0,r.result.errorDetails,r.result.json,g),r.offset,r.sessionId)}}if(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(r.result)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}n=!0;break;default:break}let o=new wx.Deferred;return o.resolve(n),o.promise}cancelRecognition(e,t,r,n,s){let o=new We.PropertyCollection;if(o.setProperty(Vo.CancellationErrorCodePropertyName,We.CancellationErrorCode[n]),this.privIntentRecognizer.canceled){let a=new We.IntentRecognitionCanceledEventArgs(r,s,n,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,a)}catch{}}if(this.privSuccessCallback){let a=new We.IntentRecognitionResult(void 0,t,We.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(a),this.privSuccessCallback=void 0}catch{}}}};gf.IntentServiceRecognizer=UC});var Ex=p(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});mf.IntentResponse=void 0;var VC=class i{constructor(e){e===""?this.privIntentResponse={}:this.privIntentResponse=JSON.parse(e)}static fromJSON(e){return new i(e)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}};mf.IntentResponse=VC});var Ix=p(Rx=>{"use strict";Object.defineProperty(Rx,"__esModule",{value:!0})});var Ax=p(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});yf.ServiceTelemetryListener=void 0;var kr=M(),Tx=Hd(),KC=class{constructor(e,t,r){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=r,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}onEvent(e){this.privIsDisposed||(e instanceof Tx.RecognitionTriggeredEvent&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof kr.AudioStreamNodeAttachingEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof kr.AudioStreamNodeAttachedEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof kr.AudioSourceErrorEvent&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof kr.AudioStreamNodeErrorEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof kr.AudioStreamNodeDetachedEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof Tx.ConnectingToServiceEvent&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof kr.ConnectionStartEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof kr.ConnectionEstablishedEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof kr.ConnectionEstablishErrorEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof kr.ConnectionMessageReceivedEvent&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path&&(this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array),this.privReceivedMessages[e.message.headers.path].length<50&&this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)))}getTelemetry(){let e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});let t={Metrics:e,ReceivedMessages:this.privReceivedMessages},r=JSON.stringify(t);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],r}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}}};yf.ServiceTelemetryListener=KC});var Ox=p(Sf=>{"use strict";Object.defineProperty(Sf,"__esModule",{value:!0});Sf.RequestSession=void 0;var Ko=M(),_f=Hd(),WW=Ax(),$C=class{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=e,this.privRequestId=Ko.createNoDashGuid(),this.privAudioNodeId=Ko.createNoDashGuid(),this.privTurnDeferral=new Ko.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new WW.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new _f.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onAudioSourceAttachCompleted(e,t){return v(this,null,function*(){this.privAudioNode=e,this.privIsAudioNodeDetached=!1,t?yield this.onComplete():this.onEvent(new _f.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))})}onPreConnectionStart(e,t){this.privAuthFetchEventId=e,this.privSessionId=t,this.onEvent(new _f.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}onAuthCompleted(e){return v(this,null,function*(){e&&(yield this.onComplete())})}onConnectionEstablishCompleted(e,t){return v(this,null,function*(){if(e===200){this.onEvent(new _f.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else e===403&&(yield this.onComplete())})}onServiceTurnEndResponse(e){return v(this,null,function*(){this.privTurnDeferral.resolve(),!e||this.isSpeechEnded?(yield this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())})}onSpeechContext(){this.privRequestId=Ko.createNoDashGuid()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new Ko.Deferred}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e),this.privConnectionAttempts=0}onAudioSent(e){this.privBytesSent+=e,this.privRecognitionBytesSent+=e}onRetryConnection(){this.privConnectionAttempts++}dispose(){return v(this,null,function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(let e of this.privDetachables)yield e.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}})}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}onStopRecognizing(){return v(this,null,function*(){yield this.onComplete()})}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(e){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),Ko.Events.instance.onEvent(e)}onComplete(){return v(this,null,function*(){this.privIsRecognizing&&(this.privIsRecognizing=!1,yield this.detachAudioNode())})}detachAudioNode(){return v(this,null,function*(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&(yield this.privAudioNode.detach()))})}};Sf.RequestSession=$C});var Dx=p(Cf=>{"use strict";Object.defineProperty(Cf,"__esModule",{value:!0});Cf.SpeechContext=void 0;var GC=class{constructor(e){this.privContext={},this.privDynamicGrammar=e}getSection(e){return this.privContext[e]||{}}setSection(e,t){this.privContext[e]=t}setPronunciationAssessmentParams(e,t,r=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(e),r&&(this.privContext.phraseDetection.mode="Conversation"),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),this.privContext.phraseOutput.detailed.options.indexOf("SNR")===-1&&this.privContext.phraseOutput.detailed.options.push("SNR"),t&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:t},this.privContext.phraseOutput.detailed.options.push("ContentAssessment"))}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed"}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")===-1&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}setSpeakerDiarizationAudioOffsetMs(e){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=e}toJSON(){let e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)}};Cf.SpeechContext=GC});var xx=p(bf=>{"use strict";Object.defineProperty(bf,"__esModule",{value:!0});bf.DynamicGrammarBuilder=void 0;var YC=class{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;let e={};if(e.ReferenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){let t=[];this.privPhrases.forEach(r=>{t.push({Text:r})}),e.Groups=[{Type:"Generic",Items:t}]}return e}};bf.DynamicGrammarBuilder=YC});var kx=p(Mx=>{"use strict";Object.defineProperty(Mx,"__esModule",{value:!0})});var XC=p(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.MessageDataStreamType=gs.ActivityPayloadResponse=void 0;var JC=class i{constructor(e){this.privActivityResponse=JSON.parse(e)}static fromJSON(e){return new i(e)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}};gs.ActivityPayloadResponse=JC;var HW;(function(i){i[i.None=0]="None",i[i.TextToSpeechAudio=1]="TextToSpeechAudio"})(HW=gs.MessageDataStreamType||(gs.MessageDataStreamType={}))});var Nx=p(wf=>{"use strict";Object.defineProperty(wf,"__esModule",{value:!0});wf.DialogServiceTurnState=void 0;var UW=bo(),VW=Jn(),KW=XC(),ZC=class{constructor(e,t){this.privRequestId=t,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e,t){return e.messageDataStreamType===KW.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=VW.AudioOutputStream.createPullStream(),this.privAudioStream.format=t!==void 0?t:UW.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};wf.DialogServiceTurnState=ZC});var jx=p(Pf=>{"use strict";Object.defineProperty(Pf,"__esModule",{value:!0});Pf.DialogServiceTurnStateManager=void 0;var Lx=ki(),$W=Nx(),QC=class{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new Lx.InvalidOperationError("Service error: There is already a turn with id:"+e);let t=new $W.DialogServiceTurnState(this,e);return this.privTurnMap.set(e,t),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new Lx.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+e);let t=this.privTurnMap.get(e);return t.complete(),this.privTurnMap.delete(e),t}};Pf.DialogServiceTurnStateManager=QC});var zx=p(Rf=>{"use strict";Object.defineProperty(Rf,"__esModule",{value:!0});Rf.DialogServiceAdapter=void 0;var GW=Ve(),YW=mg(),wt=M(),JW=bo(),Q=w(),XW=jx(),fr=T(),ZW=XC(),Ef=fs(),eb=class extends fr.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privEvents=new wt.EventSource,this.privDialogServiceConnector=s,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new XW.DialogServiceTurnStateManager,this.recognizeOverride=(o,a,c)=>this.listenOnce(o,a,c),this.postConnectImplOverride=o=>this.dialogConnectImpl(o),this.configConnectionOverride=o=>this.configConnection(o),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=r,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(o=>{o.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}sendMessage(e){return v(this,null,function*(){let t=wt.createGuid(),r=wt.createNoDashGuid(),n={context:{interactionId:t},messagePayload:JSON.parse(e),version:.5},s=JSON.stringify(n);yield(yield this.fetchConnection()).send(new Ef.SpeechConnectionMessage(wt.MessageType.Text,"agent",r,"application/json",s))})}privDisconnect(){return v(this,null,function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Q.CancellationReason.Error,Q.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1})}processTypeSpecificMessages(e){let t=new Q.PropertyCollection;e.messageType===wt.MessageType.Text&&t.setProperty(Q.PropertyId.SpeechServiceResponse_JsonResult,e.textBody);let r,n;switch(e.path.toLowerCase()){case"speech.phrase":let o=fr.SimpleSpeechPhrase.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+o.Offset+o.Duration),o.RecognitionStatus!==fr.RecognitionStatus.TooManyRequests&&o.RecognitionStatus!==fr.RecognitionStatus.Error){let d=this.fireEventForResult(o,t);if(this.privLastResult=d.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,d)}catch{}}n=!0;break;case"speech.hypothesis":let a=fr.SpeechHypothesis.fromJSON(e.textBody),c=a.Offset+this.privRequestSession.currentTurnAudioOffset;r=new Q.SpeechRecognitionResult(this.privRequestSession.requestId,Q.ResultReason.RecognizingSpeech,a.Text,a.Duration,c,a.Language,a.LanguageDetectionConfidence,void 0,void 0,e.textBody,t),this.privRequestSession.onHypothesis(c);let l=new Q.SpeechRecognitionEventArgs(r,a.Duration,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,l)}catch{}n=!0;break;case"speech.keyword":let u=fr.SpeechKeyword.fromJSON(e.textBody);r=new Q.SpeechRecognitionResult(this.privRequestSession.requestId,u.Status==="Accepted"?Q.ResultReason.RecognizedKeyword:Q.ResultReason.NoMatch,u.Text,u.Duration,u.Offset,void 0,void 0,void 0,void 0,e.textBody,t),u.Status!=="Accepted"&&(this.privLastResult=r);let h=new Q.SpeechRecognitionEventArgs(r,r.duration,r.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,h)}catch{}n=!0;break;case"audio":{let d=e.requestId.toUpperCase(),f=this.privTurnStateManager.GetTurn(d);try{e.binaryBody?f.audioStream.write(e.binaryBody):f.endAudioStream()}catch{}}n=!0;break;case"response":this.handleResponseMessage(e),n=!0;break;default:break}let s=new wt.Deferred;return s.resolve(n),s.promise}cancelRecognition(e,t,r,n,s){return v(this,null,function*(){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing()),this.privDialogServiceConnector.canceled){let o=new Q.PropertyCollection;o.setProperty(fr.CancellationErrorCodePropertyName,Q.CancellationErrorCode[n]);let a=new Q.SpeechRecognitionCanceledEventArgs(r,s,n,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,a)}catch{}if(this.privSuccessCallback){let c=new Q.SpeechRecognitionResult(void 0,Q.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,o);try{this.privSuccessCallback(c),this.privSuccessCallback=void 0}catch{}}}})}listenOnce(e,t,r){return v(this,null,function*(){this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=r,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(Q.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);let n=this.connectImpl(),s=this.sendPreAudioMessages(),o=yield this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),a=yield this.privDialogAudioSource.format,c=yield this.privDialogAudioSource.deviceInfo,l=new GW.ReplayableAudioNode(o,a.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(l,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:c};try{yield n,yield s}catch(d){return yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Q.CancellationReason.Error,Q.CancellationErrorCode.ConnectionFailure,d),Promise.resolve()}let u=new Q.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,u),this.sendAudio(l).then(()=>{},d=>v(this,null,function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Q.CancellationReason.Error,Q.CancellationErrorCode.RuntimeError,d)}))})}dialogConnectImpl(e){return this.privConnectionLoop=this.startMessageLoop(),e}receiveDialogMessageOverride(){let e=new wt.Deferred,t=()=>v(this,null,function*(){try{let r=this.isDisposed(),n=!this.isDisposed()&&this.terminateMessageLoop;if(r||n){e.resolve(void 0);return}let o=yield(yield this.fetchConnection()).read();if(!o)return t();let a=Ef.SpeechConnectionMessage.fromConnectionMessage(o);switch(a.path.toLowerCase()){case"turn.start":{let g=a.requestId.toUpperCase(),m=this.privRequestSession.requestId.toUpperCase();g!==m?this.privTurnStateManager.StartTurn(g):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":let l=fr.SpeechDetected.fromJSON(a.textBody),u=new Q.RecognitionEventArgs(l.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,u);break;case"speech.enddetected":let h;a.textBody.length>0?h=a.textBody:h="{ Offset: 0 }";let d=fr.SpeechDetected.fromJSON(h);this.privRequestSession.onServiceRecognized(d.Offset+this.privRequestSession.currentTurnAudioOffset);let f=new Q.RecognitionEventArgs(d.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,f);break;case"turn.end":{let g=a.requestId.toUpperCase(),m=this.privRequestSession.requestId.toUpperCase();if(g!==m)this.privTurnStateManager.CompleteTurn(g);else{let y=new Q.SessionEventArgs(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,y),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(b){this.privErrorCallback&&this.privErrorCallback(b)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{(yield this.processTypeSpecificMessages(a))||this.serviceEvents&&this.serviceEvents.onEvent(new wt.ServiceEvent(a.path.toLowerCase(),a.textBody))}catch{}}return t()}catch{this.terminateMessageLoop=!0,e.resolve()}});return t().catch(r=>{wt.Events.instance.onEvent(new wt.BackgroundEvent(r))}),e.promise}startMessageLoop(){return v(this,null,function*(){this.terminateMessageLoop=!1;try{yield this.receiveDialogMessageOverride()}catch(e){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,Q.CancellationReason.Error,Q.CancellationErrorCode.RuntimeError,e)}return Promise.resolve()})}configConnection(e){return v(this,null,function*(){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendAgentConfig(e),e)})}sendPreAudioMessages(){return v(this,null,function*(){let e=yield this.fetchConnection();this.addKeywordContextData(),yield this.sendSpeechContext(e,!0),yield this.sendAgentContext(e),yield this.sendWaveHeader(e)})}sendAgentConfig(e){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(Q.PropertyId.Conversation_DialogType)===Q.DialogServiceConfig.DialogTypes.CustomCommands){let r=this.agentConfig.get();r.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(Q.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(r)}this.onEvent(new YW.SendingAgentContextMessageEvent(this.agentConfig));let t=this.agentConfig.toJsonString();return this.agentConfigSent=!0,e.send(new Ef.SpeechConnectionMessage(wt.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",t))}}sendAgentContext(e){let t=wt.createGuid(),r=this.privDialogServiceConnector.properties.getProperty(Q.PropertyId.Conversation_Speech_Activity_Template),s=JSON.stringify({channelData:"",context:{interactionId:t},messagePayload:typeof r===void 0?void 0:r,version:.5});return e.send(new Ef.SpeechConnectionMessage(wt.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",s))}fireEventForResult(e,t){let r=fr.EnumTranslation.implTranslateRecognitionResult(e.RecognitionStatus),n=e.Offset+this.privRequestSession.currentTurnAudioOffset,s=new Q.SpeechRecognitionResult(this.privRequestSession.requestId,r,e.DisplayText,e.Duration,n,e.Language,e.LanguageDetectionConfidence,void 0,void 0,JSON.stringify(e),t);return new Q.SpeechRecognitionEventArgs(s,n,this.privRequestSession.sessionId)}handleResponseMessage(e){let t=JSON.parse(e.textBody);switch(t.messageType.toLowerCase()){case"message":let r=e.requestId.toUpperCase(),n=ZW.ActivityPayloadResponse.fromJSON(e.textBody),s=this.privTurnStateManager.GetTurn(r);if(n.conversationId){let c=this.agentConfig.get();c.botInfo.conversationId=n.conversationId,this.agentConfig.set(c)}let o=s.processActivityPayload(n,JW.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(Q.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),a=new Q.ActivityReceivedEventArgs(n.messagePayload,o);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,a)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new Q.TurnStatusReceivedEventArgs(e.textBody))}catch{}break;default:wt.Events.instance.onEvent(new wt.BackgroundEvent(`Unexpected response of type ${t.messageType}. Ignoring.`));break}}onEvent(e){this.privEvents.onEvent(e),wt.Events.instance.onEvent(e)}addKeywordContextData(){let e=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(e===void 0)return;let t=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),r=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),n=e.split(";"),s=t===void 0?[]:t.split(";"),o=r===void 0?[]:r.split(";"),a=[];for(let c=0;c<n.length;c++){let l={};l.text=n[c],c<s.length&&(l.offset=Number(s[c])),c<o.length&&(l.duration=Number(o[c])),a.push(l)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:a,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}};Rf.DialogServiceAdapter=eb});var qx=p(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});If.AgentConfig=void 0;var tb=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}};If.AgentConfig=tb});var Af=p(Tf=>{"use strict";Object.defineProperty(Tf,"__esModule",{value:!0});Tf.ConversationConnectionConfig=void 0;var QW=uC(),vr=class i extends QW.RestConfigBase{static get host(){return i.privHost}static get apiVersion(){return i.privApiVersion}static get clientAppId(){return i.privClientAppId}static get defaultLanguageCode(){return i.privDefaultLanguageCode}static get restPath(){return i.privRestPath}static get webSocketPath(){return i.privWebSocketPath}static get transcriptionEventKeys(){return i.privTranscriptionEventKeys}};Tf.ConversationConnectionConfig=vr;vr.privHost="dev.microsofttranslator.com";vr.privRestPath="/capito/room";vr.privApiVersion="2.0";vr.privDefaultLanguageCode="en-US";vr.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15";vr.privWebSocketPath="/capito/translate";vr.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"]});var Fx=p(Df=>{"use strict";Object.defineProperty(Df,"__esModule",{value:!0});Df.ConversationManager=void 0;var Of=Ve(),fn=j(),Nr=w(),ms=Af(),ib=class{constructor(){this.privRequestParams=ms.ConversationConnectionConfig.configParams,this.privErrors=ms.ConversationConnectionConfig.restErrors,this.privHost=ms.ConversationConnectionConfig.host,this.privApiVersion=ms.ConversationConnectionConfig.apiVersion,this.privRestPath=ms.ConversationConnectionConfig.restPath,this.privRestAdapter=new Of.RestMessageAdapter({})}createOrJoin(e,t,r,n){try{fn.Contracts.throwIfNullOrUndefined(e,"args");let s=e.getProperty(Nr.PropertyId.SpeechServiceConnection_RecoLanguage,ms.ConversationConnectionConfig.defaultLanguageCode),o=e.getProperty(Nr.PropertyId.ConversationTranslator_Name,"conversation_host"),a=e.getProperty(Nr.PropertyId.ConversationTranslator_Host,this.privHost),c=e.getProperty(Nr.PropertyId.ConversationTranslator_CorrelationId),l=e.getProperty(Nr.PropertyId.SpeechServiceConnection_Key),u=e.getProperty(Nr.PropertyId.SpeechServiceConnection_Region),h=e.getProperty(Nr.PropertyId.SpeechServiceAuthorization_Token);fn.Contracts.throwIfNullOrWhitespace(s,"languageCode"),fn.Contracts.throwIfNullOrWhitespace(o,"nickname"),fn.Contracts.throwIfNullOrWhitespace(a,"endpointHost");let d={};d[this.privRequestParams.apiVersion]=this.privApiVersion,d[this.privRequestParams.languageCode]=s,d[this.privRequestParams.nickname]=o;let f={};c&&(f[this.privRequestParams.correlationId]=c),f[this.privRequestParams.clientAppId]=ms.ConversationConnectionConfig.clientAppId,t!==void 0?d[this.privRequestParams.roomId]=t:(fn.Contracts.throwIfNullOrUndefined(u,this.privErrors.authInvalidSubscriptionRegion),f[this.privRequestParams.subscriptionRegion]=u,l?f[this.privRequestParams.subscriptionKey]=l:h?f[this.privRequestParams.authorization]=`Bearer ${h}`:fn.Contracts.throwIfNullOrUndefined(l,this.privErrors.authInvalidSubscriptionKey));let g={};g.headers=f,this.privRestAdapter.options=g;let m=`https://${a}${this.privRestPath}`;this.privRestAdapter.request(Of.RestRequestType.Post,m,d,null).then(y=>{let b=Of.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,y.headers);if(!y.ok){if(n){let _=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",y.status.toString()),P;try{P=JSON.parse(y.data),_+=` [${P.error.code}: ${P.error.message}]`}catch{_+=` [${y.data}]`}b&&(_+=` ${b}`),n(_)}return}let S=JSON.parse(y.data);if(S&&(S.requestId=b),r){try{r(S)}catch(_){n&&n(_)}r=void 0}}).catch(()=>{})}catch(s){if(n)if(s instanceof Error){let o=s;n(o.name+": "+o.message)}else n(s)}}leave(e,t){return new Promise((r,n)=>{try{fn.Contracts.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","config")),fn.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","token"));let s=e.getProperty(Nr.PropertyId.ConversationTranslator_Host,this.privHost),o=e.getProperty(Nr.PropertyId.ConversationTranslator_CorrelationId),a={};a[this.privRequestParams.apiVersion]=this.privApiVersion,a[this.privRequestParams.sessionToken]=t;let c={};o&&(c[this.privRequestParams.correlationId]=o);let l={};l.headers=c,this.privRestAdapter.options=l;let u=`https://${s}${this.privRestPath}`;this.privRestAdapter.request(Of.RestRequestType.Delete,u,a,null).then(h=>{h.ok,r()}).catch(()=>{})}catch(s){if(s instanceof Error){let o=s;n(o.name+": "+o.message)}else n(s)}})}};Df.ConversationManager=ib});var nb=p(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});xf.ConversationConnectionMessage=void 0;var eH=M(),rb=class extends eH.ConnectionMessage{constructor(e,t,r,n){super(e,t,r,n);let s=JSON.parse(this.textBody);s.type!==void 0&&(this.privConversationMessageType=s.type)}get conversationMessageType(){return this.privConversationMessageType}};xf.ConversationConnectionMessage=rb});var Wx=p(Mf=>{"use strict";Object.defineProperty(Mf,"__esModule",{value:!0});Mf.ConversationWebsocketMessageFormatter=void 0;var ys=M(),Bx=nb(),sb=class{toConnectionMessage(e){let t=new ys.Deferred;try{if(e.messageType===ys.MessageType.Text){let r=new Bx.ConversationConnectionMessage(e.messageType,e.textContent,{},e.id);t.resolve(r)}else e.messageType===ys.MessageType.Binary&&t.resolve(new Bx.ConversationConnectionMessage(e.messageType,e.binaryContent,void 0,e.id))}catch(r){t.reject(`Error formatting the message. Error: ${r}`)}return t.promise}fromConnectionMessage(e){let t=new ys.Deferred;try{if(e.messageType===ys.MessageType.Text){let r=`${e.textBody?e.textBody:""}`;t.resolve(new ys.RawWebsocketMessage(ys.MessageType.Text,r,e.id))}}catch(r){t.reject(`Error formatting the message. ${r}`)}return t.promise}};Mf.ConversationWebsocketMessageFormatter=sb});var Ux=p(kf=>{"use strict";Object.defineProperty(kf,"__esModule",{value:!0});kf.ConversationConnectionFactory=void 0;var Hx=Ve(),tH=M(),iH=j(),ob=w(),rH=Si(),$o=Af(),nH=Wx(),ab=class extends rH.ConnectionFactoryBase{create(e,t,r){let n=e.parameters.getProperty(ob.PropertyId.ConversationTranslator_Host,$o.ConversationConnectionConfig.host),s=e.parameters.getProperty(ob.PropertyId.ConversationTranslator_CorrelationId,tH.createGuid()),o=`wss://${n}${$o.ConversationConnectionConfig.webSocketPath}`,a=e.parameters.getProperty(ob.PropertyId.ConversationTranslator_Token,void 0);iH.Contracts.throwIfNullOrUndefined(a,"token");let c={};c[$o.ConversationConnectionConfig.configParams.apiVersion]=$o.ConversationConnectionConfig.apiVersion,c[$o.ConversationConnectionConfig.configParams.token]=a,c[$o.ConversationConnectionConfig.configParams.correlationId]=s;let l=e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new Hx.WebsocketConnection(o,c,{},new nH.ConversationWebsocketMessageFormatter,Hx.ProxyInfo.fromRecognizerConfig(e),l,r)}};kf.ConversationConnectionFactory=ab});var Vx=p(Nf=>{"use strict";Object.defineProperty(Nf,"__esModule",{value:!0});Nf.ConversationRequestSession=void 0;var cb=M(),lb=class{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=e,this.privRequestId=cb.createNoDashGuid(),this.privRequestCompletionDeferral=new cb.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(e,t){this.privSessionId=t}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){e!==200&&e===403&&this.onComplete()}onServiceTurnEndResponse(e){e?this.privRequestId=cb.createNoDashGuid():this.onComplete()}dispose(){return v(this,null,function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(let e of this.privDetachables)yield e.detach()}})}onComplete(){}};Nf.ConversationRequestSession=lb});var gb=p(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.ConversationReceivedTranslationEventArgs=Gt.ParticipantsListEventArgs=Gt.ParticipantAttributeEventArgs=Gt.ParticipantEventArgs=Gt.LockRoomEventArgs=Gt.MuteAllEventArgs=void 0;var jc=w(),ub=class extends jc.SessionEventArgs{constructor(e,t){super(t),this.privIsMuted=e}get isMuted(){return this.privIsMuted}};Gt.MuteAllEventArgs=ub;var hb=class extends jc.SessionEventArgs{constructor(e,t){super(t),this.privIsLocked=e}get isMuted(){return this.privIsLocked}};Gt.LockRoomEventArgs=hb;var pb=class extends jc.SessionEventArgs{constructor(e,t){super(t),this.privParticipant=e}get participant(){return this.privParticipant}};Gt.ParticipantEventArgs=pb;var db=class extends jc.SessionEventArgs{constructor(e,t,r,n){super(n),this.privKey=t,this.privValue=r,this.privParticipantId=e}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}};Gt.ParticipantAttributeEventArgs=db;var fb=class extends jc.SessionEventArgs{constructor(e,t,r,n,s,o,a,c,l){super(l),this.privRoomId=e,this.privSessionToken=t,this.privTranslateTo=r,this.privProfanityFilter=n,this.privRoomProfanityFilter=s,this.privIsRoomLocked=o,this.privIsRoomLocked=a,this.privParticipants=c}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}};Gt.ParticipantsListEventArgs=fb;var vb=class{constructor(e,t,r){this.privPayload=t,this.privCommand=e,this.privSessionId=r}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}};Gt.ConversationReceivedTranslationEventArgs=vb});var yb=p(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.ConversationTranslatorCommandTypes=vn.ConversationTranslatorMessageTypes=vn.InternalParticipants=void 0;var mb=class{constructor(e=[],t){this.participants=e,this.meId=t}addOrUpdateParticipant(e){if(e===void 0)return;let t=this.getParticipantIndex(e.id);return t>-1?this.participants.splice(t,1,e):this.participants.push(e),this.getParticipant(e.id)}getParticipantIndex(e){return this.participants.findIndex(t=>t.id===e)}getParticipant(e){return this.participants.find(t=>t.id===e)}deleteParticipant(e){this.participants=this.participants.filter(t=>t.id!==e)}get host(){return this.participants.find(e=>e.isHost===!0)}get me(){return this.getParticipant(this.meId)}};vn.InternalParticipants=mb;vn.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"};vn.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"}});var Kx=p(Lf=>{"use strict";Object.defineProperty(Lf,"__esModule",{value:!0});Lf.CommandResponsePayload=void 0;var sH=i=>JSON.parse(i),_b=class i{constructor(e){this.privCommandResponse=sH(e)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(e){return new i(e)}};Lf.CommandResponsePayload=_b});var $x=p(Go=>{"use strict";Object.defineProperty(Go,"__esModule",{value:!0});Go.ParticipantPayloadResponse=Go.ParticipantsListPayloadResponse=void 0;var oH=i=>JSON.parse(i),aH=i=>JSON.parse(i),Sb=class i{constructor(e){this.privParticipantsPayloadResponse=oH(e)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(e){return new i(e)}};Go.ParticipantsListPayloadResponse=Sb;var Cb=class i{constructor(e){this.privParticipantPayloadResponse=aH(e)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(e){return new i(e)}};Go.ParticipantPayloadResponse=Cb});var Gx=p(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.TextResponsePayload=Yo.SpeechResponsePayload=void 0;var cH=i=>JSON.parse(i),lH=i=>JSON.parse(i),bb=class i{constructor(e){this.privSpeechResponse=cH(e)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(e){return new i(e)}};Yo.SpeechResponsePayload=bb;var wb=class i{constructor(e){this.privTextResponse=lH(e)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(e){return new i(e)}};Yo.TextResponsePayload=wb});var Xx=p(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});var uH=Kx();Object.defineProperty(_s,"CommandResponsePayload",{enumerable:!0,get:function(){return uH.CommandResponsePayload}});var Yx=$x();Object.defineProperty(_s,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return Yx.ParticipantsListPayloadResponse}});Object.defineProperty(_s,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return Yx.ParticipantPayloadResponse}});var Jx=Gx();Object.defineProperty(_s,"SpeechResponsePayload",{enumerable:!0,get:function(){return Jx.SpeechResponsePayload}});Object.defineProperty(_s,"TextResponsePayload",{enumerable:!0,get:function(){return Jx.TextResponsePayload}})});var eM=p(jf=>{"use strict";Object.defineProperty(jf,"__esModule",{value:!0});jf.ConversationServiceAdapter=void 0;var zc=M(),Vi=w(),Zx=T(),Qx=nb(),hH=Vx(),ai=gb(),gn=yb(),qc=Xx(),Pb=class i extends Zx.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=s,this.privConversationAuthentication=e,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=o=>this.conversationConnectImpl(o),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new hH.ConversationRequestSession(zc.createNoDashGuid()),this.privConversationConnectionFactory=t,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}dispose(e){return v(this,null,function*(){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&(yield(yield this.privConnectionConfigPromise).dispose(e)),yield je(i.prototype,this,"dispose").call(this,e)})}sendMessage(e){return v(this,null,function*(){return(yield this.fetchConnection()).send(new Qx.ConversationConnectionMessage(zc.MessageType.Text,e))})}sendMessageAsync(e){return v(this,null,function*(){yield(yield this.fetchConnection()).send(new Qx.ConversationConnectionMessage(zc.MessageType.Text,e))})}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,Vi.CancellationReason.Error,Vi.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}processTypeSpecificMessages(){return v(this,null,function*(){return!0})}cancelRecognition(e,t,r,n,s){this.terminateMessageLoop=!0;let o=new Vi.ConversationTranslationCanceledEventArgs(r,s,n,void 0,e);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,o)}catch{}}conversationConnectImpl(e){return v(this,null,function*(){return this.privConnectionLoop=this.startMessageLoop(),e})}receiveConversationMessageOverride(){return v(this,null,function*(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();let e=new zc.Deferred;try{let r=yield(yield this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return e.resolve(),Promise.resolve();if(!r)return this.receiveConversationMessageOverride();let n=this.privConversationRequestSession.sessionId,s=r.conversationMessageType.toLowerCase(),o=!1;try{switch(s){case"info":case"participant_command":case"command":let a=qc.CommandResponsePayload.fromJSON(r.textBody);switch(a.command.toLowerCase()){case"participantlist":let f=qc.ParticipantsListPayloadResponse.fromJSON(r.textBody),g=f.participants.map(P=>({avatar:P.avatar,displayName:P.nickname,id:P.participantId,isHost:P.ishost,isMuted:P.ismuted,isUsingTts:P.usetts,preferredLanguage:P.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new ai.ParticipantsListEventArgs(f.roomid,f.token,f.translateTo,f.profanityFilter,f.roomProfanityFilter,f.roomLocked,f.muteAll,g,n));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new ai.ParticipantAttributeEventArgs(a.participantId,gn.ConversationTranslatorCommandTypes.setTranslateToLanguages,a.value,n));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new ai.ParticipantAttributeEventArgs(a.participantId,gn.ConversationTranslatorCommandTypes.setProfanityFiltering,a.value,n));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new ai.ParticipantAttributeEventArgs(a.participantId,gn.ConversationTranslatorCommandTypes.setMute,a.value,n));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new ai.MuteAllEventArgs(a.value,n));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new Vi.ConversationExpirationEventArgs(a.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new ai.ParticipantAttributeEventArgs(a.participantId,gn.ConversationTranslatorCommandTypes.setUseTTS,a.value,n));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new ai.LockRoomEventArgs(a.value,n));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new ai.ParticipantAttributeEventArgs(a.participantId,gn.ConversationTranslatorCommandTypes.changeNickname,a.value,n));break;case"joinsession":let m=qc.ParticipantPayloadResponse.fromJSON(r.textBody),y={avatar:m.avatar,displayName:m.nickname,id:m.participantId,isHost:m.ishost,isMuted:m.ismuted,isUsingTts:m.usetts,preferredLanguage:m.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new ai.ParticipantEventArgs(y,n));break;case"leavesession":let b={id:a.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new ai.ParticipantEventArgs(b,n));break;case"disconnectsession":let S={id:a.participantId};break;case"token":let _=new Zx.CognitiveTokenAuthentication(()=>{let P=a.token;return Promise.resolve(P)},()=>{let P=a.token;return Promise.resolve(P)});this.authentication=_,this.privConversationServiceConnector.onToken(_);break;default:break}break;case"partial":case"final":let c=qc.SpeechResponsePayload.fromJSON(r.textBody),l=s==="final"?Vi.ResultReason.TranslatedParticipantSpeech:Vi.ResultReason.TranslatingParticipantSpeech,u=new Vi.ConversationTranslationResult(c.participantId,this.getTranslations(c.translations),c.language,c.id,l,c.recognition,void 0,void 0,r.textBody,void 0);c.isFinal?((u.text!==void 0&&u.text.length>0||c.id===this.privLastPartialUtteranceId)&&(o=!0),o&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new ai.ConversationReceivedTranslationEventArgs(gn.ConversationTranslatorMessageTypes.final,u,n))):u.text!==void 0&&(this.privLastPartialUtteranceId=c.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new ai.ConversationReceivedTranslationEventArgs(gn.ConversationTranslatorMessageTypes.partial,u,n)));break;case"translated_message":let h=qc.TextResponsePayload.fromJSON(r.textBody),d=new Vi.ConversationTranslationResult(h.participantId,this.getTranslations(h.translations),h.language,void 0,void 0,h.originalText,void 0,void 0,void 0,r.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new ai.ConversationReceivedTranslationEventArgs(gn.ConversationTranslatorMessageTypes.instantMessage,d,n));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return e.promise})}startMessageLoop(){return v(this,null,function*(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;let e=this.receiveConversationMessageOverride();try{return yield e}catch(t){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",Vi.CancellationReason.Error,Vi.CancellationErrorCode.RuntimeError,t),null}})}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(e=>e.state()===zc.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(e=>e),this.privConnectionConfigPromise)}getTranslations(e){let t;if(e!==void 0){t=new Vi.Translations;for(let r of e)t.set(r.lang,r.translation)}return t}};jf.ConversationServiceAdapter=Pb});var tM=p(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.ConversationTranslatorRecognizer=Zo.ConversationRecognizerFactory=void 0;var pH=T(),Jo=M(),Xo=j(),Eb=w(),dH=Ux(),fH=eM(),Rb=class{static fromConfig(e,t,r){return new zf(e,t,r)}};Zo.ConversationRecognizerFactory=Rb;var zf=class i extends Eb.Recognizer{constructor(e,t,r){let n=t;Xo.Contracts.throwIfNull(n,"speechConfig");let s=e;Xo.Contracts.throwIfNull(s,"conversationImpl"),super(r,n.properties,new dH.ConversationConnectionFactory),this.privConversation=s,this.privIsDisposed=!1,this.privProperties=n.properties.clone(),this.privConnection=Eb.Connection.fromRecognizer(this),this.privProperties.getProperty(Eb.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=Jo.Timeout.setTimeout,this.privClearTimeout=Jo.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(e){this.privConnection.connected=e}set disconnected(e){this.privConnection.disconnected=e}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(e,t,r){try{Xo.Contracts.throwIfDisposed(this.privIsDisposed),Xo.Contracts.throwIfNullOrWhitespace(e,"token"),this.privReco.conversationTranslatorToken=e,this.resetConversationTimeout(),this.privReco.connectAsync(t,r)}catch(n){if(r)if(n instanceof Error){let s=n;r(s.name+": "+s.message)}else r(n)}}disconnect(e,t){try{Xo.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{e&&e()},r=>{t&&t(r)})}catch(r){if(t)if(r instanceof Error){let n=r;t(n.name+": "+n.message)}else t(r);this.dispose(!0).catch(n=>{Jo.Events.instance.onEvent(new Jo.BackgroundEvent(n))})}}sendRequest(e,t,r){try{Xo.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(e,t,r)}catch(n){if(r)if(n instanceof Error){let s=n;r(s.name+": "+s.message)}else r(n);this.dispose(!0).catch(s=>{Jo.Events.instance.onEvent(new Jo.BackgroundEvent(s))})}}onToken(e){this.privConversation.onToken(e)}close(){return v(this,null,function*(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,yield this.dispose(!0))})}dispose(e){return v(this,null,function*(){this.privIsDisposed||e&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),yield je(i.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new pH.RecognizerConfig(e,this.privProperties)}createServiceRecognizer(e,t,r,n){let s=r;return new fH.ConversationServiceAdapter(e,t,s,n,this)}sendMessage(e,t,r){let n=this.privReco;((o,a,c)=>{o!==void 0?o.then(()=>{try{a&&a()}catch(l){c&&c(`'Unhandled error on promise callback: ${l}'`)}},l=>{try{c&&c(l)}catch{}}):c&&c("Null promise")})(n.sendMessageAsync(e),t,r),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};Zo.ConversationTranslatorRecognizer=zf});var rM=p(Ff=>{"use strict";Object.defineProperty(Ff,"__esModule",{value:!0});Ff.TranscriberRecognizer=void 0;var iM=M(),Ki=j(),Qo=w(),qf=T(),Ib=class i extends Qo.Recognizer{constructor(e,t){let r=e;Ki.Contracts.throwIfNull(r,"speechTranslationConfig");let n=t;Ki.Contracts.throwIfNull(n,"audioConfigImpl"),Ki.Contracts.throwIfNullOrWhitespace(r.speechRecognitionLanguage,Qo.PropertyId[Qo.PropertyId.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new qf.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return Ki.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Qo.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(Qo.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(e){Ki.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Qo.PropertyId.SpeechServiceAuthorization_Token,e)}set conversation(e){Ki.Contracts.throwIfNullOrUndefined(e,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=e}getConversationInfo(){return Ki.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(e){Ki.Contracts.throwIfNullOrUndefined(e,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=e}getMeetingInfo(){return Ki.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(e,t){iM.marshalPromiseToCallbacks(this.startContinuousRecognitionAsyncImpl(qf.RecognitionMode.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){iM.marshalPromiseToCallbacks(this.stopContinuousRecognitionAsyncImpl(),e,t)}close(){return v(this,null,function*(){this.privDisposedRecognizer||(yield this.dispose(!0))})}pushConversationEvent(e,t){return v(this,null,function*(){let r=this.privReco;Ki.Contracts.throwIfNullOrUndefined(r,"serviceRecognizer"),yield r.sendSpeechEventAsync(e,t)})}pushMeetingEvent(e,t){return v(this,null,function*(){let r=this.privReco;Ki.Contracts.throwIfNullOrUndefined(r,"serviceRecognizer"),yield r.sendMeetingSpeechEventAsync(e,t)})}enforceAudioGating(){return v(this,null,function*(){let r=(yield this.audioConfig.format).channels;if(r===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(r!==8)throw new Error(`Unsupported audio configuration: Detected ${r}-channel audio`)})}connectMeetingCallbacks(e){this.isMeetingRecognizer=!0,this.canceled=(t,r)=>{e.canceled&&e.canceled(e,r)},this.recognizing=(t,r)=>{e.transcribing&&e.transcribing(e,r)},this.recognized=(t,r)=>{e.transcribed&&e.transcribed(e,r)},this.sessionStarted=(t,r)=>{e.sessionStarted&&e.sessionStarted(e,r)},this.sessionStopped=(t,r)=>{e.sessionStopped&&e.sessionStopped(e,r)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}dispose(e){return v(this,null,function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield je(i.prototype,this,"dispose").call(this,e))})}createRecognizerConfig(e){return new qf.RecognizerConfig(e,this.properties)}createServiceRecognizer(e,t,r,n){let s=r;return new qf.TranscriptionServiceRecognizer(e,t,s,n,this)}};Ff.TranscriberRecognizer=Ib});var nM=p(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});var vH=Fx();Object.defineProperty(kt,"ConversationManager",{enumerable:!0,get:function(){return vH.ConversationManager}});var gH=Af();Object.defineProperty(kt,"ConversationConnectionConfig",{enumerable:!0,get:function(){return gH.ConversationConnectionConfig}});var mH=tM();Object.defineProperty(kt,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return mH.ConversationRecognizerFactory}});var yH=rM();Object.defineProperty(kt,"TranscriberRecognizer",{enumerable:!0,get:function(){return yH.TranscriberRecognizer}});var ea=gb();Object.defineProperty(kt,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return ea.ConversationReceivedTranslationEventArgs}});Object.defineProperty(kt,"LockRoomEventArgs",{enumerable:!0,get:function(){return ea.LockRoomEventArgs}});Object.defineProperty(kt,"MuteAllEventArgs",{enumerable:!0,get:function(){return ea.MuteAllEventArgs}});Object.defineProperty(kt,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return ea.ParticipantAttributeEventArgs}});Object.defineProperty(kt,"ParticipantEventArgs",{enumerable:!0,get:function(){return ea.ParticipantEventArgs}});Object.defineProperty(kt,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return ea.ParticipantsListEventArgs}});var Tb=yb();Object.defineProperty(kt,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return Tb.ConversationTranslatorCommandTypes}});Object.defineProperty(kt,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return Tb.ConversationTranslatorMessageTypes}});Object.defineProperty(kt,"InternalParticipants",{enumerable:!0,get:function(){return Tb.InternalParticipants}})});var Ob=p(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.SynthesisAudioMetadata=Ss.MetadataType=void 0;var _H;(function(i){i.WordBoundary="WordBoundary",i.Bookmark="Bookmark",i.Viseme="Viseme",i.SentenceBoundary="SentenceBoundary",i.SessionEnd="SessionEnd",i.AvatarSignal="TalkingAvatarSignal"})(_H=Ss.MetadataType||(Ss.MetadataType={}));var Ab=class i{constructor(e){this.privSynthesisAudioMetadata=JSON.parse(e)}static fromJSON(e){return new i(e)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}};Ss.SynthesisAudioMetadata=Ab});var oM=p(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.SynthesisStartedEvent=gr.ConnectingToSynthesisServiceEvent=gr.SynthesisTriggeredEvent=gr.SpeechSynthesisEvent=void 0;var sM=M(),ta=class extends sM.PlatformEvent{constructor(e,t,r=sM.EventType.Info){super(e,r),this.privRequestId=t}get requestId(){return this.privRequestId}};gr.SpeechSynthesisEvent=ta;var Db=class extends ta{constructor(e,t,r){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=t,this.privTurnAudioDestinationId=r}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}};gr.SynthesisTriggeredEvent=Db;var xb=class extends ta{constructor(e,t){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}};gr.ConnectingToSynthesisServiceEvent=xb;var Mb=class extends ta{constructor(e,t){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}};gr.SynthesisStartedEvent=Mb});var aM=p(Hf=>{"use strict";Object.defineProperty(Hf,"__esModule",{value:!0});Hf.SynthesisTurn=void 0;var Bf=M(),SH=Jn(),Wf=w(),CH=Ob(),kb=oM(),Nb=class i{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=Bf.createNoDashGuid(),this.privTurnDeferral=new Bf.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){let e=new Wf.PropertyCollection;return e.setProperty(Wf.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),e}}getAllReceivedAudio(){return v(this,null,function*(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(yield this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null})}getAllReceivedAudioWithHeader(){return v(this,null,function*(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){let e=yield this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(e),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()})}startNewSynthesis(e,t,r,n){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=t,this.privIsSSML=r,this.privAudioOutputStream=new SH.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",n!==void 0&&(this.privTurnAudioDestination=n,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new kb.SynthesisTriggeredEvent(this.requestId,void 0,n===void 0?void 0:n.id()))}onPreConnectionStart(e){this.privAuthFetchEventId=e,this.onEvent(new kb.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){if(e===200){this.onEvent(new kb.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else e===403&&this.onComplete()}onServiceResponseMessage(e){let t=JSON.parse(e);this.streamId=t.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(e){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new Bf.Deferred;let t=JSON.parse(e);t.webrtc&&(this.privWebRTCSDP=t.webrtc.connectionString)}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(e))}onTextBoundaryEvent(e){this.updateTextOffset(e.Data.text.Text,e.Type)}onVisemeMetadataReceived(e){e.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=e.Data.AnimationChunk)}onSessionEnd(e){this.privAudioDuration=e.Data.Offset}constructSynthesisResult(){return v(this,null,function*(){let e=yield this.getAllReceivedAudioWithHeader();return new Wf.SpeechSynthesisResult(this.requestId,Wf.ResultReason.SynthesizingAudioCompleted,e,void 0,this.extraProperties,this.audioDuration)})}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){let e=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",e}onEvent(e){Bf.Events.instance.onEvent(e)}static isXmlTag(e){return e.length>=2&&e[0]==="<"&&e[e.length-1]===">"}updateTextOffset(e,t){t===CH.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!i.isXmlTag(e)&&this.updateTextOffset(e,t))):(this.privSentenceOffset=this.privRawText.indexOf(e,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!i.isXmlTag(e)&&this.updateTextOffset(e,t)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}readAllAudioFromStream(){return v(this,null,function*(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{yield this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}})}withinXmlTag(e){return this.privRawText.indexOf("<",e+1)>this.privRawText.indexOf(">",e+1)}};Hf.SynthesisTurn=Nb});var cM=p(Vf=>{"use strict";Object.defineProperty(Vf,"__esModule",{value:!0});Vf.SynthesisAdapterBase=void 0;var Pt=M(),ci=w(),Ii=T(),ia=fs(),Uf=class{constructor(e,t,r,n){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!e)throw new Pt.ArgumentNullError("authentication");if(!t)throw new Pt.ArgumentNullError("connectionFactory");if(!r)throw new Pt.ArgumentNullError("synthesizerConfig");this.privAuthentication=e,this.privConnectionFactory=t,this.privSynthesizerConfig=r,this.privIsDisposed=!1,this.privSessionAudioDestination=n,this.privSynthesisTurn=new Ii.SynthesisTurn,this.privConnectionEvents=new Pt.EventSource,this.privServiceEvents=new Pt.EventSource,this.privSynthesisContext=new Ii.SynthesisContext,this.privAgentConfig=new Ii.AgentConfig,this.connectionEvents.attach(s=>{if(s.name==="ConnectionClosedEvent"){let o=s;o.statusCode!==1e3&&this.cancelSynthesisLocal(ci.CancellationReason.Error,o.statusCode===1007?ci.CancellationErrorCode.BadRequestParameters:ci.CancellationErrorCode.ConnectionFailure,`${o.reason} websocket error code: ${o.statusCode}`)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=e),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=e)}isDisposed(){return this.privIsDisposed}dispose(e){return v(this,null,function*(){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&(yield(yield this.privConnectionConfigurationPromise).dispose(e))})}connect(){return v(this,null,function*(){yield this.connectImpl()})}sendNetworkMessage(e,t){return v(this,null,function*(){let r=typeof t=="string"?Pt.MessageType.Text:Pt.MessageType.Binary,n=typeof t=="string"?"application/json":"";return(yield this.fetchConnection()).send(new ia.SpeechConnectionMessage(r,e,this.privSynthesisTurn.requestId,n,t))})}Speak(e,t,r,n,s,o){return v(this,null,function*(){let a;if(t?a=e:a=this.privSynthesizer.buildSsml(e),this.speakOverride!==void 0)return this.speakOverride(a,r,n,s);this.privSuccessCallback=n,this.privErrorCallback=s,this.privSynthesisTurn.startNewSynthesis(r,e,t,o);try{yield this.connectImpl();let c=yield this.fetchConnection();yield this.sendSynthesisContext(c),yield this.sendSsmlMessage(c,a,r),this.onSynthesisStarted(r),this.receiveMessage()}catch(c){return this.cancelSynthesisLocal(ci.CancellationReason.Error,ci.CancellationErrorCode.ConnectionFailure,c),Promise.reject(c)}})}stopSpeaking(){return v(this,null,function*(){return yield this.connectImpl(),(yield this.fetchConnection()).send(new ia.SpeechConnectionMessage(Pt.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))})}cancelSynthesis(e,t,r,n){let s=new ci.PropertyCollection;s.setProperty(Ii.CancellationErrorCodePropertyName,ci.CancellationErrorCode[r]);let o=new ci.SpeechSynthesisResult(e,ci.ResultReason.Canceled,void 0,n,s);if(this.onSynthesisCancelled(o),this.privSuccessCallback)try{this.privSuccessCallback(o)}catch{}}cancelSynthesisLocal(e,t,r){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,t,r))}processTypeSpecificMessages(e){return!0}receiveMessage(){return v(this,null,function*(){try{let t=yield(yield this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!t)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;let r=ia.SpeechConnectionMessage.fromConnectionMessage(t);if(r.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(r.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(r.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(r.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===r.streamId.toLowerCase()&&r.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(r.binaryBody),this.onSynthesizing(r.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(r.binaryBody));break;case"audio.metadata":let n=Ii.SynthesisAudioMetadata.fromJSON(r.textBody).Metadata;for(let o of n)switch(o.Type){case Ii.MetadataType.WordBoundary:case Ii.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(o);let a=new ci.SpeechSynthesisWordBoundaryEventArgs(o.Data.Offset,o.Data.Duration,o.Data.text.Text,o.Data.text.Length,o.Type===Ii.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,o.Data.text.BoundaryType);this.onWordBoundary(a);break;case Ii.MetadataType.Bookmark:let c=new ci.SpeechSynthesisBookmarkEventArgs(o.Data.Offset,o.Data.Bookmark);this.onBookmarkReached(c);break;case Ii.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(o),o.Data.IsLastAnimation){let l=new ci.SpeechSynthesisVisemeEventArgs(o.Data.Offset,o.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(l)}break;case Ii.MetadataType.AvatarSignal:this.onAvatarEvent(o);break;case Ii.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(o);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let s;try{s=yield this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(s)}catch(o){this.privErrorCallback&&this.privErrorCallback(o)}this.onSynthesisCompleted(s);break;default:this.processTypeSpecificMessages(r)||this.privServiceEvents&&this.serviceEvents.onEvent(new Pt.ServiceEvent(r.path.toLowerCase(),r.textBody))}return this.receiveMessage()}catch{}})}sendSynthesisContext(e){this.setSynthesisContextSynthesisSection();let t=this.synthesisContext.toJSON();if(t)return e.send(new ia.SpeechConnectionMessage(Pt.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",t))}setSpeechConfigSynthesisSection(){}connectImpl(e=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(r=>r.state()===Pt.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=Pt.createNoDashGuid(),this.privConnectionId=Pt.createNoDashGuid(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);let t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.then(r=>v(this,null,function*(){this.privSynthesisTurn.onAuthCompleted(!1);let n=this.privConnectionFactory.create(this.privSynthesizerConfig,r,this.privConnectionId);n.events.attach(o=>{this.connectionEvents.onEvent(o)});let s=yield n.open();return s.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(s.statusCode),Promise.resolve(n)):s.statusCode===403&&!e?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(s.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${s.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(ci.PropertyId.SpeechServiceConnection_Url)} Reason: ${s.reason}`))}),r=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(r)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(e,t){if(t)return e.send(new ia.SpeechConnectionMessage(Pt.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",t))}sendSsmlMessage(e,t,r){return e.send(new ia.SpeechConnectionMessage(Pt.MessageType.Text,"ssml",r,"application/ssml+xml",t))}fetchConnection(){return v(this,null,function*(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(e=>e.state()===Pt.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)})}configureConnection(){return v(this,null,function*(){let e=yield this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(e):(this.setSpeechConfigSynthesisSection(),yield this.sendSpeechServiceConfig(e,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),e)})}onAvatarEvent(e){}onSynthesisStarted(e){}onSynthesizing(e){}onSynthesisCancelled(e){}onSynthesisCompleted(e){}onWordBoundary(e){}onVisemeReceived(e){}onBookmarkReached(e){}};Vf.SynthesisAdapterBase=Uf;Uf.telemetryDataEnabled=!0});var uM=p(Kf=>{"use strict";Object.defineProperty(Kf,"__esModule",{value:!0});Kf.AvatarSynthesisAdapter=void 0;var lM=w(),bH=T(),Lb=class extends bH.SynthesisAdapterBase{constructor(e,t,r,n,s){super(e,t,r,void 0),this.privAvatarSynthesizer=n,this.privSynthesizer=n,this.privAvatarConfig=s}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:this.privAvatarConfig.videoFormat?.bitrate,codec:this.privAvatarConfig.videoFormat?.codec,crop:{bottomRight:{x:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.y},topLeft:{x:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.y}},resolution:{height:this.privAvatarConfig.videoFormat?.height,width:this.privAvatarConfig.videoFormat?.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(lM.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:this.privAvatarConfig.backgroundImage?.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style}}}onAvatarEvent(e){if(this.privAvatarSynthesizer.avatarEventReceived){let t=new lM.AvatarEventArgs(e.Data.Offset,e.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,t)}catch{}}}};Kf.AvatarSynthesisAdapter=Lb});var hM=p($f=>{"use strict";Object.defineProperty($f,"__esModule",{value:!0});$f.SpeechSynthesisAdapter=void 0;var mn=w(),wH=T(),jb=class extends wH.SynthesisAdapterBase{constructor(e,t,r,n,s){super(e,t,r,s),this.privSpeechSynthesizer=n,this.privSynthesizer=n}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(e){let t=new mn.SpeechSynthesisEventArgs(new mn.SpeechSynthesisResult(e,mn.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,t)}onSynthesizing(e){if(this.privSpeechSynthesizer.synthesizing)try{let t=this.privSynthesisTurn.audioOutputFormat.addHeader(e),r=new mn.SpeechSynthesisEventArgs(new mn.SpeechSynthesisResult(this.privSynthesisTurn.requestId,mn.ResultReason.SynthesizingAudio,t));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,r)}catch{}}onSynthesisCancelled(e){if(this.privSpeechSynthesizer.SynthesisCanceled){let t=new mn.SpeechSynthesisEventArgs(e);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,t)}catch{}}}onSynthesisCompleted(e){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new mn.SpeechSynthesisEventArgs(e))}catch{}}onWordBoundary(e){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,e)}catch{}}onVisemeReceived(e){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,e)}catch{}}onBookmarkReached(e){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,e)}catch{}}};$f.SpeechSynthesisAdapter=jb});var pM=p(Gf=>{"use strict";Object.defineProperty(Gf,"__esModule",{value:!0});Gf.SynthesisRestAdapter=void 0;var zb=Ve(),qb=w(),PH=Si(),EH=_t(),Fb=class{constructor(e,t){let r=e.parameters.getProperty(qb.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!r){let s=e.parameters.getProperty(qb.PropertyId.SpeechServiceConnection_Region,"westus"),o=PH.ConnectionFactoryBase.getHostSuffix(s);r=e.parameters.getProperty(qb.PropertyId.SpeechServiceConnection_Host,`https://${s}.tts.speech${o}`)}this.privUri=`${r}/cognitiveservices/voices/list`;let n=zb.RestConfigBase.requestOptions;this.privRestAdapter=new zb.RestMessageAdapter(n),this.privAuthentication=t}getVoicesList(e){return this.privRestAdapter.setHeaders(EH.HeaderNames.ConnectionId,e),this.privAuthentication.fetch(e).then(t=>(this.privRestAdapter.setHeaders(t.headerName,t.token),this.privRestAdapter.request(zb.RestRequestType.Get,this.privUri)))}};Gf.SynthesisRestAdapter=Fb});var vM=p(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.SynthesizerConfig=Cs.SynthesisServiceType=void 0;var dM=T(),fM;(function(i){i[i.Standard=0]="Standard",i[i.Custom=1]="Custom"})(fM=Cs.SynthesisServiceType||(Cs.SynthesisServiceType={}));var Bb=class{constructor(e,t){this.privSynthesisServiceType=fM.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=e||new dM.SpeechServiceConfig(new dM.Context(null)),this.privParameters=t}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(e){this.privSynthesisServiceType=e}set synthesisVideoSection(e){this.privSpeechServiceConfig.Context.synthesis={video:e}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}};Cs.SynthesizerConfig=Bb});var gM=p(Yf=>{"use strict";Object.defineProperty(Yf,"__esModule",{value:!0});Yf.SynthesisContext=void 0;var Wb=w(),Hb=class{constructor(){this.privContext={}}setSection(e,t){this.privContext[e]=t}set audioOutputFormat(e){this.privAudioOutputFormat=e}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(e){let t=this.buildSynthesisContext(e);this.setSection("synthesis",t)}buildSynthesisContext(e){return{audio:{metadataOptions:{bookmarkEnabled:!!e?.bookmarkReached,punctuationBoundaryEnabled:e?.properties.getProperty(Wb.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!e?.wordBoundary),sentenceBoundaryEnabled:e?.properties.getProperty(Wb.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!e?.visemeReceived,wordBoundaryEnabled:e?.properties.getProperty(Wb.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!e?.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:e?.autoDetectSourceLanguage}}}};Yf.SynthesisContext=Hb});var mM=p(Jf=>{"use strict";Object.defineProperty(Jf,"__esModule",{value:!0});Jf.SpeakerRecognitionConfig=void 0;var RH=T(),Ub=class{constructor(e,t){this.privContext=e||new RH.Context(null),this.privParameters=t}get parameters(){return this.privParameters}get Context(){return this.privContext}};Jf.SpeakerRecognitionConfig=Ub});var _M=p(Zf=>{"use strict";Object.defineProperty(Zf,"__esModule",{value:!0});Zf.SpeakerServiceRecognizer=void 0;var IH=Ve(),Xf=M(),ut=w(),yM=T(),TH=fs(),Vb=class extends yM.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privSpeakerRecognizer=s,this.privSpeakerAudioSource=r,this.recognizeSpeaker=o=>this.recognizeSpeakerOnce(o),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(e){let t=!1,r=new ut.PropertyCollection;switch(e.messageType===Xf.MessageType.Text&&r.setProperty(ut.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.response":let s=JSON.parse(e.textBody),o;s.status.statusCode.toLowerCase()!=="success"?o=new ut.SpeakerRecognitionResult(s,ut.ResultReason.Canceled,ut.CancellationErrorCode.ServiceError,s.status.reason):o=new ut.SpeakerRecognitionResult(s,ut.ResultReason.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(o),t=!0;break;default:break}let n=new Xf.Deferred;return n.resolve(t),n.promise}cancelRecognition(e,t,r,n,s){if(new ut.PropertyCollection().setProperty(yM.CancellationErrorCodePropertyName,ut.CancellationErrorCode[n]),this.privResultDeferral){let a=new ut.SpeakerRecognitionResult({scenario:this.privSpeakerModel.scenario,status:{statusCode:s,reason:s}},ut.ResultReason.Canceled,n,s);try{this.privResultDeferral.resolve(a)}catch(c){this.privResultDeferral.reject(c)}}}recognizeSpeakerOnce(e){return v(this,null,function*(){this.privSpeakerModel=e,this.voiceProfileType=e.scenario,this.privResultDeferral||(this.privResultDeferral=new Xf.Deferred),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(ut.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);let t=this.connectImpl(),r=this.sendPreAudioMessages(this.extractSpeakerContext(e)),n=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),s=yield this.privSpeakerAudioSource.format,o=yield this.privSpeakerAudioSource.deviceInfo,a=new IH.ReplayableAudioNode(n,s.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(a,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:o};try{yield t,yield r}catch(u){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,ut.CancellationReason.Error,ut.CancellationErrorCode.ConnectionFailure,u)}let c=new ut.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,c),this.receiveMessage(),this.sendAudio(a).then(()=>{},u=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,ut.CancellationReason.Error,ut.CancellationErrorCode.RuntimeError,u)}),this.privResultDeferral.promise})}sendPreAudioMessages(e){return v(this,null,function*(){let t=yield this.fetchConnection();yield this.sendSpeakerRecognition(t,e)})}sendSpeakerRecognition(e,t){return v(this,null,function*(){let r=JSON.stringify(t);return e.send(new TH.SpeechConnectionMessage(Xf.MessageType.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",r))})}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}};Zf.SpeakerServiceRecognizer=Vb});var CM=p(Qf=>{"use strict";Object.defineProperty(Qf,"__esModule",{value:!0});Qf.VoiceServiceRecognizer=void 0;var AH=Ve(),mr=M(),ue=w(),SM=T(),Kb=fs(),$b=class extends SM.ServiceRecognizerBase{constructor(e,t,r,n,s){super(e,t,r,n,s),this.privDeferralMap=new mr.DeferralMap,this.privSpeakerAudioSource=r,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(e){this.privSpeakerAudioSource=e}processTypeSpecificMessages(e){let t=!1,r=new ue.PropertyCollection;switch(e.messageType===mr.MessageType.Text&&r.setProperty(ue.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.profiles":let s=JSON.parse(e.textBody);switch(s.operation.toLowerCase()){case"create":this.handleCreateResponse(s,e.requestId);break;case"delete":case"reset":this.handleResultResponse(s,e.requestId);break;case"fetch":let l=JSON.parse(e.textBody);this.handleFetchResponse(l,e.requestId);break;default:break}t=!0;break;case"speaker.phrases":let o=JSON.parse(e.textBody);this.handlePhrasesResponse(o,e.requestId),t=!0;break;case"speaker.profile.enrollment":let a=JSON.parse(e.textBody),c=new ue.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(a.enrollment?a.enrollment.enrollmentStatus:a.status.statusCode),a.enrollment?JSON.stringify(a.enrollment):void 0,a.status.reason);this.privDeferralMap.getId(e.requestId)&&this.privDeferralMap.complete(e.requestId,c),this.privRequestSession.onSpeechEnded(),t=!0;break;default:break}let n=new mr.Deferred;return n.resolve(t),n.promise}cancelRecognition(e,t,r,n,s){new ue.PropertyCollection().setProperty(SM.CancellationErrorCodePropertyName,ue.CancellationErrorCode[n]);let a=new ue.VoiceProfileEnrollmentResult(ue.ResultReason.Canceled,s,s);this.privDeferralMap.getId(t)&&this.privDeferralMap.complete(t,a)}createProfile(e,t){return v(this,null,function*(){this.voiceProfileType=e.toString();let r=this.connectImpl();try{let n=new mr.Deferred;return yield r,yield this.sendCreateProfile(n,e,t),this.receiveMessage(),n.promise}catch(n){throw n}})}resetProfile(e){return v(this,null,function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("reset",e.profileType,e)})}deleteProfile(e){return v(this,null,function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("delete",e.profileType,e)})}retrieveEnrollmentResult(e){return v(this,null,function*(){return this.voiceProfileType=e.profileType.toString(),this.privExpectedProfileId=e.profileId,this.sendCommonRequest("fetch",e.profileType,e)})}getAllProfiles(e){return v(this,null,function*(){return this.voiceProfileType=e.toString(),this.sendCommonRequest("fetch",e)})}getActivationPhrases(e,t){return v(this,null,function*(){this.voiceProfileType=e.toString();let r=this.connectImpl();try{let n=new mr.Deferred;return yield r,yield this.sendPhrasesRequest(n,e,t),this.receiveMessage(),n.promise}catch(n){throw n}})}enrollProfile(e){return v(this,null,function*(){this.voiceProfileType=e.profileType.toString();let t=new mr.Deferred;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(ue.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);let r=this.connectImpl(),n=this.sendPreAudioMessages(e,t),s=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),o=yield this.privSpeakerAudioSource.format,a=yield this.privSpeakerAudioSource.deviceInfo,c=new AH.ReplayableAudioNode(s,o.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(c,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:a};try{yield r,yield n}catch(h){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,ue.CancellationReason.Error,ue.CancellationErrorCode.ConnectionFailure,h)}let l=new ue.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,l),this.receiveMessage(),this.sendAudio(c).then(()=>{},h=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,ue.CancellationReason.Error,ue.CancellationErrorCode.RuntimeError,h)}),t.promise})}sendPreAudioMessages(e,t){return v(this,null,function*(){let r=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,t),yield this.sendBaseRequest(r,"enroll",this.scenarioFrom(e.profileType),e)})}sendPhrasesRequest(e,t,r){return v(this,null,function*(){let n=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);let s=this.scenarioFrom(t),o={locale:r,scenario:s};return n.send(new Kb.SpeechConnectionMessage(mr.MessageType.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))})}sendCreateProfile(e,t,r){return v(this,null,function*(){let n=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);let s=t===ue.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":t===ue.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",o={locale:r,number:"1",scenario:s};return n.send(new Kb.SpeechConnectionMessage(mr.MessageType.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))})}sendCommonRequest(e,t,r=void 0){return v(this,null,function*(){let n=this.connectImpl();try{let s=new mr.Deferred;this.privRequestSession.onSpeechContext(),yield n;let o=yield this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,s),yield this.sendBaseRequest(o,e,this.scenarioFrom(t),r),this.receiveMessage(),s.promise}catch(s){throw s}})}sendBaseRequest(e,t,r,n){return v(this,null,function*(){let s={scenario:r};return n?s.profileIds=[n.profileId]:s.maxPageSize=-1,e.send(new Kb.SpeechConnectionMessage(mr.MessageType.Text,`speaker.profile.${t}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(s)))})}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}handlePhrasesResponse(e,t){if(this.privDeferralMap.getId(t))if(e.status.statusCode.toLowerCase()!=="success"){let r=ue.ResultReason.Canceled,n=new ue.VoiceProfilePhraseResult(r,e.status.statusCode,e.passPhraseType,[]);this.privDeferralMap.complete(t,n)}else if(e.phrases&&e.phrases.length>0){let r=ue.ResultReason.EnrollingVoiceProfile,n=new ue.VoiceProfilePhraseResult(r,e.status.statusCode,e.passPhraseType,e.phrases);this.privDeferralMap.complete(t,n)}else throw new Error("Voice Profile get activation phrases failed, no phrases received");else throw new Error(`Voice Profile get activation phrases request for requestID ${t} not found`)}handleCreateResponse(e,t){if(e.profiles&&e.profiles.length>0)if(this.privDeferralMap.getId(t)){let r=e.profiles.map(n=>n.profileId);this.privDeferralMap.complete(t,r)}else throw new Error(`Voice Profile create request for requestID ${t} not found`);else throw new Error("Voice Profile create failed, no profile id received")}handleResultResponse(e,t){if(this.privDeferralMap.getId(t)){let r=e.operation.toLowerCase()==="delete"?ue.ResultReason.DeletedVoiceProfile:ue.ResultReason.ResetVoiceProfile,n=e.status.statusCode.toLowerCase()==="success"?r:ue.ResultReason.Canceled,s=new ue.VoiceProfileResult(n,`statusCode: ${e.status.statusCode}, errorDetails: ${e.status.reason}`);this.privDeferralMap.complete(t,s)}else throw new Error(`Voice Profile create request for requestID ${t} not found`)}handleFetchResponse(e,t){if(this.privDeferralMap.getId(t)&&e.profiles[0]){if(this.privExpectedProfileId&&e.profiles.length===1&&e.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;let r=e.profiles[0],n=new ue.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(r.enrollmentStatus),JSON.stringify(r),e.status.reason);this.privDeferralMap.complete(t,n)}else if(e.profiles.length>0){let r=e.profiles,n=[];for(let s of r)n.push(new ue.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(s.enrollmentStatus),JSON.stringify(s),e.status.reason));this.privDeferralMap.complete(t,n)}}else throw new Error(`Voice Profile fetch request for requestID ${t} not found`)}enrollmentReasonFrom(e){switch(e.toLowerCase()){case"enrolled":return ue.ResultReason.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return ue.ResultReason.Canceled;default:return ue.ResultReason.EnrollingVoiceProfile}}scenarioFrom(e){return e===ue.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":e===ue.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}};Qf.VoiceServiceRecognizer=$b});var bM=p(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.type=Ge.connectivity=Ge.Device=Ge.OS=Ge.System=Ge.Context=Ge.SpeechServiceConfig=void 0;var Gb=class{constructor(e){this.context=e}serialize(){return JSON.stringify(this,(e,t)=>{if(t&&typeof t=="object"&&!Array.isArray(t)){let r={};for(let n in t)Object.hasOwnProperty.call(t,n)&&(r[n&&n.charAt(0).toLowerCase()+n.substring(1)]=t[n]);return r}return t})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}};Ge.SpeechServiceConfig=Gb;var Yb=class{constructor(e){this.system=new ev,this.os=e}};Ge.Context=Yb;var ev=class{constructor(){let e="1.40.0";this.name="SpeechSDK",this.version=e,this.build="JavaScript",this.lang="JavaScript"}};Ge.System=ev;var Jb=class{constructor(e,t,r){this.platform=e,this.name=t,this.version=r}};Ge.OS=Jb;var Xb=class{constructor(e,t,r){this.manufacturer=e,this.model=t,this.version=r}};Ge.Device=Xb;var OH;(function(i){i.Bluetooth="Bluetooth",i.Wired="Wired",i.WiFi="WiFi",i.Cellular="Cellular",i.InBuilt="InBuilt",i.Unknown="Unknown"})(OH=Ge.connectivity||(Ge.connectivity={}));var DH;(function(i){i.Phone="Phone",i.Speaker="Speaker",i.Car="Car",i.Headset="Headset",i.Thermostat="Thermostat",i.Microphones="Microphones",i.Deskphone="Deskphone",i.RemoteControl="RemoteControl",i.Unknown="Unknown",i.File="File",i.Stream="Stream"})(DH=Ge.type||(Ge.type={}))});var T=p(E=>{"use strict";var xH=E&&E.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),k=E&&E.__exportStar||function(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&xH(e,i,t)};Object.defineProperty(E,"__esModule",{value:!0});E.AutoDetectSourceLanguagesOpenRangeOptionName=E.ForceDictationPropertyName=E.ServicePropertiesPropertyName=E.CancellationErrorCodePropertyName=E.OutputFormatPropertyName=void 0;k(F0(),E);k(U0(),E);k(cu(),E);k(K0(),E);k(G0(),E);k(O1(),E);k(k1(),E);k(Hd(),E);k(L1(),E);k(j1(),E);k(q1(),E);k(B1(),E);k(H1(),E);k($1(),E);k(J1(),E);k(ex(),E);k(nx(),E);k(ZS(),E);k(sx(),E);k(ox(),E);k(cx(),E);k(lx(),E);k(ux(),E);k(px(),E);k(dx(),E);k(fx(),E);k(vx(),E);k(gx(),E);k(mx(),E);k(_x(),E);k(Sx(),E);k(Cx(),E);k(bx(),E);k(Px(),E);k(Ex(),E);k(Ix(),E);k(Ox(),E);k(Dx(),E);k(xx(),E);k(kx(),E);k(zx(),E);k(qx(),E);k(nM(),E);k(Ob(),E);k(aM(),E);k(cM(),E);var MH=uM();Object.defineProperty(E,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return MH.AvatarSynthesisAdapter}});var kH=hM();Object.defineProperty(E,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return kH.SpeechSynthesisAdapter}});k(pM(),E);k(vM(),E);k(gM(),E);k(mM(),E);k(_M(),E);k(CM(),E);k(bM(),E);E.OutputFormatPropertyName="OutputFormat";E.CancellationErrorCodePropertyName="CancellationErrorCode";E.ServicePropertiesPropertyName="ServiceProperties";E.ForceDictationPropertyName="ForceDictation";E.AutoDetectSourceLanguagesOpenRangeOptionName="OpenRange"});var wM=p(bs=>{"use strict";var NH=bs&&bs.__createBinding||(Object.create?function(i,e,t,r){r===void 0&&(r=t),Object.defineProperty(i,r,{enumerable:!0,get:function(){return e[t]}})}:function(i,e,t,r){r===void 0&&(r=t),i[r]=e[t]}),LH=bs&&bs.__exportStar||function(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&NH(e,i,t)};Object.defineProperty(bs,"__esModule",{value:!0});var jH=T();new jH.AgentConfig;LH(w(),bs)});function tl(i){return class extends i{destroy$=new q;ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.destroy$.unsubscribe()}}}function il(i=!1){return e=>e.pipe(Es(t=>(i&&console.log(t),Ps("CUSTOM_ERROR")))).pipe(xi(t=>t!=="CUSTOM_ERROR"))}function qw(){let i=new Date().getTime(),e=typeof performance<"u"&&performance.now&&performance.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let r=Math.random()*16;return i>0?(r=(i+r)%16|0,i=Math.floor(i/16)):(r=(e+r)%16|0,e=Math.floor(e/16)),(t==="x"?r:r&3|8).toString(16)})}function HM(i){return/[\u0600-\u06FF]+/.test(i)}var Fw=i=>(i.split(" ").map(e=>(HM(e)?"\u202A":"\u202C")+e).join(" "),i);var UM=["video"],VM=["idleVideo"],Bw=(i,e,t)=>({"bg-red-600":i,"bg-green-700":e,"bg-orange-500":t}),rl=class i extends tl(class{}){fullWidth="w-full h-full block ";video=bn.required("video");idleVideo=bn.required("idleVideo");avatarService=re(Zc);start$=new av(1);stop$=new av(1);store=re(Fr);init$=this.start$.asObservable().pipe(Xi(()=>this.store.updateStreamStatus("InProgress"))).pipe(Te(this.destroy$)).pipe(Uc(()=>this.avatarService.startStream().pipe(Es(e=>{throw this.store.updateStreamStatus("Stopped"),e})).pipe(il()))).pipe(Ji(e=>{let{data:{webrtcData:{offer:t,iceServers:r}}}=e;return this.pc=new RTCPeerConnection({iceServers:r,iceTransportPolicy:"relay"}),this.pc.addEventListener("icecandidate",n=>{n.candidate&&this.avatarService.sendCandidate(n.candidate).subscribe()}),this.pc.addEventListener("icegatheringstatechange",n=>{n.target.iceGatheringState=="complete"&&this.video().nativeElement.paused&&(this.video().nativeElement.play().then(),this.store.updateStreamStatus("Started"))}),this.pc.addEventListener("track",n=>{this.video().nativeElement.srcObject=n.streams[0],n.streams[0].getTracks().forEach(s=>{s.onmute=()=>{this.store.updateStreamId(""),this.store.updateStreamStatus("Stopped")}})}),this.store.updateStreamStatus("Started"),Hc(this.pc.setRemoteDescription(new RTCSessionDescription(t))).pipe(Ji(()=>Hc(this.pc.createAnswer()))).pipe(Ji(n=>Hc(this.pc.setLocalDescription(n)).pipe(Yi(()=>n)))).pipe(Ji(n=>this.avatarService.sendAnswer(n)))})).pipe(Yi(()=>""));onlineStatus=Iw(()=>{switch(this.store.streamingStatus()){case"Started":return"\u0645\u062A\u0635\u0644";case"InProgress":return"\u062C\u0627\u0631\u064A \u0627\u0644\u0627\u062A\u0635\u0627\u0644";default:return"\u063A\u064A\u0631 \u0645\u062A\u0635\u0644"}});ngOnInit(){return v(this,null,function*(){Sn(this.destroy$).pipe(Xi(()=>this.store.updateStreamStatus("Stopped"))).pipe(Ji(()=>this.avatarService.closeStream().pipe(il()))).subscribe(),this.stop$.pipe(xi(()=>this.store.hasStream())).pipe(Xi(()=>this.store.updateStreamStatus("Stopped"))).pipe(Te(this.destroy$)).pipe(Ji(()=>this.avatarService.closeStream().pipe(il()))).subscribe(()=>{console.log("CLOSED")})})}ngAfterViewInit(){this.playIdle()}playIdle(){this.idleVideo().nativeElement.src="assets/videos/idle-full.webm",this.idleVideo().nativeElement.muted=!0,this.idleVideo().nativeElement.loop=!0,this.idleVideo().nativeElement.play().then()}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Kc(i)))(r||i)}})();static \u0275cmp=Lt({type:i,selectors:[["app-avatar-video"]],viewQuery:function(t,r){t&1&&(Rn(r.video,UM,5),Rn(r.idleVideo,VM,5)),t&2&&Os(2)},hostVars:1,hostBindings:function(t,r){t&2&&En("class",r.fullWidth)},standalone:!0,features:[oa,qt],decls:14,vars:16,consts:[["video",""],["idleVideo",""],["id","video-wrapper",1,"flex","items-center","w-full","h-full","justify-center"],[1,"flex","flex-col","items-center","w-full","h-full","justify-center"],[1,"flex","gap-1","shadow-2xl","shadow-white","bg-black/20","p-1","mt-2","absolute","z-50","top-0","rounded-md"],[1,"p-4","rounded-full",3,"ngClass"],[1,"p-4","absolute","pulse","rounded-full",3,"ngClass"],[1,"text-white","font-semibold"],["autoplay","",1,"h-full",3,"hidden"],[1,"h-full",3,"hidden"],["src","assets/videos/idle-full.webm","type","video/webm"]],template:function(t,r){t&1&&(L(0,"div",2)(1,"div",3)(2,"div",4),me(3,"div",5)(4,"div",6),L(5,"span",7),we(6),H()(),me(7,"video",8,0),L(9,"video",9,1),me(11,"source",10),H()(),we(12),Pw(13,"async"),H()),t&2&&(F(3),ge("ngClass",gv(8,Bw,r.store.isStreamStopped(),r.store.isStreamStarted(),r.store.isStreamLoading())),F(),ge("ngClass",gv(12,Bw,r.store.isStreamStopped(),r.store.isStreamStarted(),r.store.isStreamLoading())),F(2),zt(r.onlineStatus()),F(),ge("hidden",!r.store.hasStream()),F(2),ge("hidden",r.store.hasStream()),F(3),In(" ",Ew(13,6,r.init$),`
`))},dependencies:[Dw,qr]})};function Qi(i){return getComputedStyle(i)}function Ft(i,e){for(var t in e){var r=e[t];typeof r=="number"&&(r=r+"px"),i.style[t]=r}return i}function nl(i){var e=document.createElement("div");return e.className=i,e}var Ww=typeof Element<"u"&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function Br(i,e){if(!Ww)throw new Error("No element matching method supported");return Ww.call(i,e)}function Ls(i){i.remove?i.remove():i.parentNode&&i.parentNode.removeChild(i)}function Hw(i,e){return Array.prototype.filter.call(i.children,function(t){return Br(t,e)})}var ze={main:"ps",rtl:"ps__rtl",element:{thumb:function(i){return"ps__thumb-"+i},rail:function(i){return"ps__rail-"+i},consuming:"ps__child--consume"},state:{focus:"ps--focus",clicking:"ps--clicking",active:function(i){return"ps--active-"+i},scrolling:function(i){return"ps--scrolling-"+i}}},Kw={x:null,y:null};function $w(i,e){var t=i.element.classList,r=ze.state.scrolling(e);t.contains(r)?clearTimeout(Kw[e]):t.add(r)}function Gw(i,e){Kw[e]=setTimeout(function(){return i.isAlive&&i.element.classList.remove(ze.state.scrolling(e))},i.settings.scrollingThreshold)}function KM(i,e){$w(i,e),Gw(i,e)}var la=function(e){this.element=e,this.handlers={}},Yw={isEmpty:{configurable:!0}};la.prototype.bind=function(e,t){typeof this.handlers[e]>"u"&&(this.handlers[e]=[]),this.handlers[e].push(t),this.element.addEventListener(e,t,!1)};la.prototype.unbind=function(e,t){var r=this;this.handlers[e]=this.handlers[e].filter(function(n){return t&&n!==t?!0:(r.element.removeEventListener(e,n,!1),!1)})};la.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)};Yw.isEmpty.get=function(){var i=this;return Object.keys(this.handlers).every(function(e){return i.handlers[e].length===0})};Object.defineProperties(la.prototype,Yw);var js=function(){this.eventElements=[]};js.prototype.eventElement=function(e){var t=this.eventElements.filter(function(r){return r.element===e})[0];return t||(t=new la(e),this.eventElements.push(t)),t};js.prototype.bind=function(e,t,r){this.eventElement(e).bind(t,r)};js.prototype.unbind=function(e,t,r){var n=this.eventElement(e);n.unbind(t,r),n.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(n),1)};js.prototype.unbindAll=function(){this.eventElements.forEach(function(e){return e.unbindAll()}),this.eventElements=[]};js.prototype.once=function(e,t,r){var n=this.eventElement(e),s=function(o){n.unbind(t,s),r(o)};n.bind(t,s)};function sl(i){if(typeof window.CustomEvent=="function")return new CustomEvent(i);var e=document.createEvent("CustomEvent");return e.initCustomEvent(i,!1,!1,void 0),e}function ol(i,e,t,r,n){r===void 0&&(r=!0),n===void 0&&(n=!1);var s;if(e==="top")s=["contentHeight","containerHeight","scrollTop","y","up","down"];else if(e==="left")s=["contentWidth","containerWidth","scrollLeft","x","left","right"];else throw new Error("A proper axis should be provided");$M(i,t,s,r,n)}function $M(i,e,t,r,n){var s=t[0],o=t[1],a=t[2],c=t[3],l=t[4],u=t[5];r===void 0&&(r=!0),n===void 0&&(n=!1);var h=i.element;i.reach[c]=null,h[a]<1&&(i.reach[c]="start"),h[a]>i[s]-i[o]-1&&(i.reach[c]="end"),e&&(h.dispatchEvent(sl("ps-scroll-"+c)),e<0?h.dispatchEvent(sl("ps-scroll-"+l)):e>0&&h.dispatchEvent(sl("ps-scroll-"+u)),r&&KM(i,c)),i.reach[c]&&(e||n)&&h.dispatchEvent(sl("ps-"+c+"-reach-"+i.reach[c]))}function Ee(i){return parseInt(i,10)||0}function GM(i){return Br(i,"input,[contenteditable]")||Br(i,"select,[contenteditable]")||Br(i,"textarea,[contenteditable]")||Br(i,"button,[contenteditable]")}function YM(i){var e=Qi(i);return Ee(e.width)+Ee(e.paddingLeft)+Ee(e.paddingRight)+Ee(e.borderLeftWidth)+Ee(e.borderRightWidth)}var Ns={isWebKit:typeof document<"u"&&"WebkitAppearance"in document.documentElement.style,supportsTouch:typeof window<"u"&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:typeof navigator<"u"&&navigator.msMaxTouchPoints,isChrome:typeof navigator<"u"&&/Chrome/i.test(navigator&&navigator.userAgent)};function _r(i){var e=i.element,t=Math.floor(e.scrollTop),r=e.getBoundingClientRect();i.containerWidth=Math.round(r.width),i.containerHeight=Math.round(r.height),i.contentWidth=e.scrollWidth,i.contentHeight=e.scrollHeight,e.contains(i.scrollbarXRail)||(Hw(e,ze.element.rail("x")).forEach(function(n){return Ls(n)}),e.appendChild(i.scrollbarXRail)),e.contains(i.scrollbarYRail)||(Hw(e,ze.element.rail("y")).forEach(function(n){return Ls(n)}),e.appendChild(i.scrollbarYRail)),!i.settings.suppressScrollX&&i.containerWidth+i.settings.scrollXMarginOffset<i.contentWidth?(i.scrollbarXActive=!0,i.railXWidth=i.containerWidth-i.railXMarginWidth,i.railXRatio=i.containerWidth/i.railXWidth,i.scrollbarXWidth=Uw(i,Ee(i.railXWidth*i.containerWidth/i.contentWidth)),i.scrollbarXLeft=Ee((i.negativeScrollAdjustment+e.scrollLeft)*(i.railXWidth-i.scrollbarXWidth)/(i.contentWidth-i.containerWidth))):i.scrollbarXActive=!1,!i.settings.suppressScrollY&&i.containerHeight+i.settings.scrollYMarginOffset<i.contentHeight?(i.scrollbarYActive=!0,i.railYHeight=i.containerHeight-i.railYMarginHeight,i.railYRatio=i.containerHeight/i.railYHeight,i.scrollbarYHeight=Uw(i,Ee(i.railYHeight*i.containerHeight/i.contentHeight)),i.scrollbarYTop=Ee(t*(i.railYHeight-i.scrollbarYHeight)/(i.contentHeight-i.containerHeight))):i.scrollbarYActive=!1,i.scrollbarXLeft>=i.railXWidth-i.scrollbarXWidth&&(i.scrollbarXLeft=i.railXWidth-i.scrollbarXWidth),i.scrollbarYTop>=i.railYHeight-i.scrollbarYHeight&&(i.scrollbarYTop=i.railYHeight-i.scrollbarYHeight),JM(e,i),i.scrollbarXActive?e.classList.add(ze.state.active("x")):(e.classList.remove(ze.state.active("x")),i.scrollbarXWidth=0,i.scrollbarXLeft=0,e.scrollLeft=i.isRtl===!0?i.contentWidth:0),i.scrollbarYActive?e.classList.add(ze.state.active("y")):(e.classList.remove(ze.state.active("y")),i.scrollbarYHeight=0,i.scrollbarYTop=0,e.scrollTop=0)}function Uw(i,e){return i.settings.minScrollbarLength&&(e=Math.max(e,i.settings.minScrollbarLength)),i.settings.maxScrollbarLength&&(e=Math.min(e,i.settings.maxScrollbarLength)),e}function JM(i,e){var t={width:e.railXWidth},r=Math.floor(i.scrollTop);e.isRtl?t.left=e.negativeScrollAdjustment+i.scrollLeft+e.containerWidth-e.contentWidth:t.left=i.scrollLeft,e.isScrollbarXUsingBottom?t.bottom=e.scrollbarXBottom-r:t.top=e.scrollbarXTop+r,Ft(e.scrollbarXRail,t);var n={top:r,height:e.railYHeight};e.isScrollbarYUsingRight?e.isRtl?n.right=e.contentWidth-(e.negativeScrollAdjustment+i.scrollLeft)-e.scrollbarYRight-e.scrollbarYOuterWidth-9:n.right=e.scrollbarYRight-i.scrollLeft:e.isRtl?n.left=e.negativeScrollAdjustment+i.scrollLeft+e.containerWidth*2-e.contentWidth-e.scrollbarYLeft-e.scrollbarYOuterWidth:n.left=e.scrollbarYLeft+i.scrollLeft,Ft(e.scrollbarYRail,n),Ft(e.scrollbarX,{left:e.scrollbarXLeft,width:e.scrollbarXWidth-e.railBorderXWidth}),Ft(e.scrollbarY,{top:e.scrollbarYTop,height:e.scrollbarYHeight-e.railBorderYWidth})}function XM(i){var e=i.element;i.event.bind(i.scrollbarY,"mousedown",function(t){return t.stopPropagation()}),i.event.bind(i.scrollbarYRail,"mousedown",function(t){var r=t.pageY-window.pageYOffset-i.scrollbarYRail.getBoundingClientRect().top,n=r>i.scrollbarYTop?1:-1;i.element.scrollTop+=n*i.containerHeight,_r(i),t.stopPropagation()}),i.event.bind(i.scrollbarX,"mousedown",function(t){return t.stopPropagation()}),i.event.bind(i.scrollbarXRail,"mousedown",function(t){var r=t.pageX-window.pageXOffset-i.scrollbarXRail.getBoundingClientRect().left,n=r>i.scrollbarXLeft?1:-1;i.element.scrollLeft+=n*i.containerWidth,_r(i),t.stopPropagation()})}function ZM(i){Vw(i,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"]),Vw(i,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"])}function Vw(i,e){var t=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=i.element,d=null,f=null,g=null;function m(S){S.touches&&S.touches[0]&&(S[n]=S.touches[0].pageY),h[c]=d+g*(S[n]-f),$w(i,l),_r(i),S.stopPropagation(),S.type.startsWith("touch")&&S.changedTouches.length>1&&S.preventDefault()}function y(){Gw(i,l),i[u].classList.remove(ze.state.clicking),i.event.unbind(i.ownerDocument,"mousemove",m)}function b(S,_){d=h[c],_&&S.touches&&(S[n]=S.touches[0].pageY),f=S[n],g=(i[r]-i[t])/(i[s]-i[a]),_?i.event.bind(i.ownerDocument,"touchmove",m):(i.event.bind(i.ownerDocument,"mousemove",m),i.event.once(i.ownerDocument,"mouseup",y),S.preventDefault()),i[u].classList.add(ze.state.clicking),S.stopPropagation()}i.event.bind(i[o],"mousedown",function(S){b(S)}),i.event.bind(i[o],"touchstart",function(S){b(S,!0)})}function QM(i){var e=i.element,t=function(){return Br(e,":hover")},r=function(){return Br(i.scrollbarX,":focus")||Br(i.scrollbarY,":focus")};function n(s,o){var a=Math.floor(e.scrollTop);if(s===0){if(!i.scrollbarYActive)return!1;if(a===0&&o>0||a>=i.contentHeight-i.containerHeight&&o<0)return!i.settings.wheelPropagation}var c=e.scrollLeft;if(o===0){if(!i.scrollbarXActive)return!1;if(c===0&&s<0||c>=i.contentWidth-i.containerWidth&&s>0)return!i.settings.wheelPropagation}return!0}i.event.bind(i.ownerDocument,"keydown",function(s){if(!(s.isDefaultPrevented&&s.isDefaultPrevented()||s.defaultPrevented)&&!(!t()&&!r())){var o=document.activeElement?document.activeElement:i.ownerDocument.activeElement;if(o){if(o.tagName==="IFRAME")o=o.contentDocument.activeElement;else for(;o.shadowRoot;)o=o.shadowRoot.activeElement;if(GM(o))return}var a=0,c=0;switch(s.which){case 37:s.metaKey?a=-i.contentWidth:s.altKey?a=-i.containerWidth:a=-30;break;case 38:s.metaKey?c=i.contentHeight:s.altKey?c=i.containerHeight:c=30;break;case 39:s.metaKey?a=i.contentWidth:s.altKey?a=i.containerWidth:a=30;break;case 40:s.metaKey?c=-i.contentHeight:s.altKey?c=-i.containerHeight:c=-30;break;case 32:s.shiftKey?c=i.containerHeight:c=-i.containerHeight;break;case 33:c=i.containerHeight;break;case 34:c=-i.containerHeight;break;case 36:c=i.contentHeight;break;case 35:c=-i.contentHeight;break;default:return}i.settings.suppressScrollX&&a!==0||i.settings.suppressScrollY&&c!==0||(e.scrollTop-=c,e.scrollLeft+=a,_r(i),n(a,c)&&s.preventDefault())}})}function ek(i){var e=i.element;function t(o,a){var c=Math.floor(e.scrollTop),l=e.scrollTop===0,u=c+e.offsetHeight===e.scrollHeight,h=e.scrollLeft===0,d=e.scrollLeft+e.offsetWidth===e.scrollWidth,f;return Math.abs(a)>Math.abs(o)?f=l||u:f=h||d,f?!i.settings.wheelPropagation:!0}function r(o){var a=o.deltaX,c=-1*o.deltaY;return(typeof a>"u"||typeof c>"u")&&(a=-1*o.wheelDeltaX/6,c=o.wheelDeltaY/6),o.deltaMode&&o.deltaMode===1&&(a*=10,c*=10),a!==a&&c!==c&&(a=0,c=o.wheelDelta),o.shiftKey?[-c,-a]:[a,c]}function n(o,a,c){if(!Ns.isWebKit&&e.querySelector("select:focus"))return!0;if(!e.contains(o))return!1;for(var l=o;l&&l!==e;){if(l.classList.contains(ze.element.consuming))return!0;var u=Qi(l);if(c&&u.overflowY.match(/(scroll|auto)/)){var h=l.scrollHeight-l.clientHeight;if(h>0&&(l.scrollTop>0&&c<0||l.scrollTop<h&&c>0))return!0}if(a&&u.overflowX.match(/(scroll|auto)/)){var d=l.scrollWidth-l.clientWidth;if(d>0&&(l.scrollLeft>0&&a<0||l.scrollLeft<d&&a>0))return!0}l=l.parentNode}return!1}function s(o){var a=r(o),c=a[0],l=a[1];if(!n(o.target,c,l)){var u=!1;i.settings.useBothWheelAxes?i.scrollbarYActive&&!i.scrollbarXActive?(l?e.scrollTop-=l*i.settings.wheelSpeed:e.scrollTop+=c*i.settings.wheelSpeed,u=!0):i.scrollbarXActive&&!i.scrollbarYActive&&(c?e.scrollLeft+=c*i.settings.wheelSpeed:e.scrollLeft-=l*i.settings.wheelSpeed,u=!0):(e.scrollTop-=l*i.settings.wheelSpeed,e.scrollLeft+=c*i.settings.wheelSpeed),_r(i),u=u||t(c,l),u&&!o.ctrlKey&&(o.stopPropagation(),o.preventDefault())}}typeof window.onwheel<"u"?i.event.bind(e,"wheel",s):typeof window.onmousewheel<"u"&&i.event.bind(e,"mousewheel",s)}function tk(i){if(!Ns.supportsTouch&&!Ns.supportsIePointer)return;var e=i.element;function t(g,m){var y=Math.floor(e.scrollTop),b=e.scrollLeft,S=Math.abs(g),_=Math.abs(m);if(_>S){if(m<0&&y===i.contentHeight-i.containerHeight||m>0&&y===0)return window.scrollY===0&&m>0&&Ns.isChrome}else if(S>_&&(g<0&&b===i.contentWidth-i.containerWidth||g>0&&b===0))return!0;return!0}function r(g,m){e.scrollTop-=m,e.scrollLeft-=g,_r(i)}var n={},s=0,o={},a=null;function c(g){return g.targetTouches?g.targetTouches[0]:g}function l(g){return g.pointerType&&g.pointerType==="pen"&&g.buttons===0?!1:!!(g.targetTouches&&g.targetTouches.length===1||g.pointerType&&g.pointerType!=="mouse"&&g.pointerType!==g.MSPOINTER_TYPE_MOUSE)}function u(g){if(l(g)){var m=c(g);n.pageX=m.pageX,n.pageY=m.pageY,s=new Date().getTime(),a!==null&&clearInterval(a)}}function h(g,m,y){if(!e.contains(g))return!1;for(var b=g;b&&b!==e;){if(b.classList.contains(ze.element.consuming))return!0;var S=Qi(b);if(y&&S.overflowY.match(/(scroll|auto)/)){var _=b.scrollHeight-b.clientHeight;if(_>0&&(b.scrollTop>0&&y<0||b.scrollTop<_&&y>0))return!0}if(m&&S.overflowX.match(/(scroll|auto)/)){var P=b.scrollWidth-b.clientWidth;if(P>0&&(b.scrollLeft>0&&m<0||b.scrollLeft<P&&m>0))return!0}b=b.parentNode}return!1}function d(g){if(l(g)){var m=c(g),y={pageX:m.pageX,pageY:m.pageY},b=y.pageX-n.pageX,S=y.pageY-n.pageY;if(h(g.target,b,S))return;r(b,S),n=y;var _=new Date().getTime(),P=_-s;P>0&&(o.x=b/P,o.y=S/P,s=_),t(b,S)&&g.preventDefault()}}function f(){i.settings.swipeEasing&&(clearInterval(a),a=setInterval(function(){if(i.isInitialized){clearInterval(a);return}if(!o.x&&!o.y){clearInterval(a);return}if(Math.abs(o.x)<.01&&Math.abs(o.y)<.01){clearInterval(a);return}if(!i.element){clearInterval(a);return}r(o.x*30,o.y*30),o.x*=.8,o.y*=.8},10))}Ns.supportsTouch?(i.event.bind(e,"touchstart",u),i.event.bind(e,"touchmove",d),i.event.bind(e,"touchend",f)):Ns.supportsIePointer&&(window.PointerEvent?(i.event.bind(e,"pointerdown",u),i.event.bind(e,"pointermove",d),i.event.bind(e,"pointerup",f)):window.MSPointerEvent&&(i.event.bind(e,"MSPointerDown",u),i.event.bind(e,"MSPointerMove",d),i.event.bind(e,"MSPointerUp",f)))}var ik=function(){return{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1}},rk={"click-rail":XM,"drag-thumb":ZM,keyboard:QM,wheel:ek,touch:tk},ua=function(e,t){var r=this;if(t===void 0&&(t={}),typeof e=="string"&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");this.element=e,e.classList.add(ze.main),this.settings=ik();for(var n in t)this.settings[n]=t[n];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var s=function(){return e.classList.add(ze.state.focus)},o=function(){return e.classList.remove(ze.state.focus)};this.isRtl=Qi(e).direction==="rtl",this.isRtl===!0&&e.classList.add(ze.rtl),this.isNegativeScroll=function(){var l=e.scrollLeft,u=null;return e.scrollLeft=-1,u=e.scrollLeft<0,e.scrollLeft=l,u}(),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new js,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=nl(ze.element.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=nl(ze.element.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",s),this.event.bind(this.scrollbarX,"blur",o),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var a=Qi(this.scrollbarXRail);this.scrollbarXBottom=parseInt(a.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=Ee(a.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=Ee(a.borderLeftWidth)+Ee(a.borderRightWidth),Ft(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=Ee(a.marginLeft)+Ee(a.marginRight),Ft(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=nl(ze.element.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=nl(ze.element.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",s),this.event.bind(this.scrollbarY,"blur",o),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var c=Qi(this.scrollbarYRail);this.scrollbarYRight=parseInt(c.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=Ee(c.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?YM(this.scrollbarY):null,this.railBorderYWidth=Ee(c.borderTopWidth)+Ee(c.borderBottomWidth),Ft(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=Ee(c.marginTop)+Ee(c.marginBottom),Ft(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach(function(l){return rk[l](r)}),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",function(l){return r.onScroll(l)}),_r(this)};ua.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,Ft(this.scrollbarXRail,{display:"block"}),Ft(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=Ee(Qi(this.scrollbarXRail).marginLeft)+Ee(Qi(this.scrollbarXRail).marginRight),this.railYMarginHeight=Ee(Qi(this.scrollbarYRail).marginTop)+Ee(Qi(this.scrollbarYRail).marginBottom),Ft(this.scrollbarXRail,{display:"none"}),Ft(this.scrollbarYRail,{display:"none"}),_r(this),ol(this,"top",0,!1,!0),ol(this,"left",0,!1,!0),Ft(this.scrollbarXRail,{display:""}),Ft(this.scrollbarYRail,{display:""}))};ua.prototype.onScroll=function(e){this.isAlive&&(_r(this),ol(this,"top",this.element.scrollTop-this.lastScrollTop),ol(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)};ua.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),Ls(this.scrollbarX),Ls(this.scrollbarY),Ls(this.scrollbarXRail),Ls(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)};ua.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(e){return!e.match(/^ps([-_].+|)$/)}).join(" ")};var Jw=ua;function Xw(i){return class extends i{clone(t){let r=this.constructor;return Object.assign(new r,this,t)}}}var zs=class extends Xw(class{}){constructor(t="",r="user"){super();this.content=t;this.role=r;this.id=qw()}context;end_turn;function_call;tool_calls;id};var qs=class i{http=re(Mw);urlService=re(kw);store=re(Fr);messages=Qt([]);sendMessage(e){return this.messages.update(t=>[...t,new zs(e,"user")]),this.http.post(this.urlService.URLS.CHAT,se({messages:this.messages()},this.store.streamId()?{stream_id:this.store.streamId()}:null)).pipe(Es(t=>{throw new zs().clone({content:t.message,role:"error"}),new Error(t)})).pipe(Yi(t=>(t.message.content=Fw(this.formatText(t.message.content)),t.message=new zs().clone(t.message),this.messages.update(r=>[...r,t.message]),t)))}formatText(e){let t=e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>");return t=t.replace(/\[(.*?)\]/g,'<pre class="d-inline"><small class="px-1 text-primary">$1<i class="mdi mdi-link-variant"></i></small></pre>'),t.trim()}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})};var al=class i{constructor(e){this.elementRef=e}text="";speed=20;animating=new Tt;ngOnInit(){this.animateText()}animateText(){this.animating.emit(!0);let e=0,t="",r=()=>{t+=this.text.charAt(e),this.elementRef.nativeElement.innerHTML=t,e++,e<this.text.length?setTimeout(r,this.speed*Math.random()):this.animating.emit(!1)};r()}static \u0275fac=function(t){return new(t||i)(V(_e))};static \u0275dir=Xt({type:i,selectors:[["","appTextWriterAnimator",""]],inputs:{text:"text",speed:"speed"},outputs:{animating:"animating"},standalone:!0})};var nk=["container"],sk=(i,e)=>e.id,ok=(i,e)=>({"mdi-chevron-down":i,"mdi-chevron-up":e});function ak(i,e){if(i&1){let t=Zi();L(0,"div",7),Ze("animating",function(n){Je(t);let s=jt(2);return Xe(s.animationStatus.set(n))}),H()}if(i&2){let t=jt().$implicit;ge("text",t.content)}}function ck(i,e){if(i&1&&me(0,"div",6),i&2){let t=jt().$implicit;ge("innerHtml",t.content,_w)}}function lk(i,e){if(i&1&&(L(0,"div",12)(1,"div",13)(2,"small",14),we(3),me(4,"i",15),H()(),L(5,"a",16),we(6),H()()),i&2){let t=e.$implicit,r=e.$index;F(3),In(" doc ",r+1," "),F(3),zt(t.filepath)}}function uk(i,e){if(i&1){let t=Zi();L(0,"div")(1,"div",8),Ze("click",function(){Je(t);let n=Ds(6);return Xe(n.hidden=!n.hidden)}),me(2,"i",9),L(3,"span",10),we(4,"References"),H()(),L(5,"div",11,1),fv(7,lk,7,2,"div",12,ww),H()()}if(i&2){let t=Ds(6),r=jt().$implicit;F(2),ge("ngClass",aa(1,ok,t.hidden,!t.hidden)),F(5),vv(r.context.citations)}}function hk(i,e){if(i&1&&(L(0,"div"),jr(1,ak,1,1,"div",5)(2,ck,1,1,"div",6)(3,uk,9,4,"div"),H()),i&2){let t=e.$implicit;bw("message ",t.role,""),F(),hi(t.role==="assistant"?1:2),F(2),hi(t.context&&t.context.citations.length?3:-1)}}var cl=class i{container=bn.required("container");injector=re(Zt);service=re(qs);animationStatus=Qt(!1);ngOnInit(){ca(()=>{new Jw(this.container().nativeElement,{})},{injector:this.injector})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Lt({type:i,selectors:[["app-overlay-chat"]],viewQuery:function(t,r){t&1&&Rn(r.container,nk,5),t&2&&Os()},standalone:!0,features:[qt],decls:5,vars:0,consts:[["container",""],["linkRef",""],["id","chat-container",1,"flex","flex-col","bg-black/40","max-h-80","w-screen","absolute","overflow-hidden","bottom-0","left-0"],[1,"min-h-0","px-6","py-6","flex-auto","flex","flex-col","w-full","h-full","relative","overflow-hidden","space-y-4","[&>.message.user]:justify-end","[&>.message]:text-white"],[3,"class"],["appTextWriterAnimator","",1,"whitespace-pre-wrap","break-words",3,"text"],[1,"whitespace-pre-wrap","break-words",3,"innerHtml"],["appTextWriterAnimator","",1,"whitespace-pre-wrap","break-words",3,"animating","text"],[1,"icon-with-title",3,"click"],[1,"mdi",3,"ngClass"],[1,"title"],["hidden",""],["dir","auto"],[1,"d-inline"],[1,"px-1","text-primary"],[1,"mdi","mdi-link-variant"],[1,"d-inline","citation-link",2,"cursor","pointer"]],template:function(t,r){t&1&&(L(0,"div",2)(1,"div",3,0),fv(3,hk,4,5,"div",4,sk),H()()),t&2&&(F(3),vv(r.service.messages()))},dependencies:[qr,al],styles:['.message[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;font-size:1.875rem;line-height:2.25rem}.message.user[_ngcontent-%COMP%]{align-items:flex-end}.message.user[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-radius:.375rem;border-top-right-radius:0;background-color:#00000080;padding:.5rem}.message.user[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{content:"";position:absolute;right:-12px;top:0;width:12px;height:12px;clip-path:polygon(0 0,100% 0,0 100%);background-color:inherit}.message.assistant[_ngcontent-%COMP%]{align-items:flex-start}.message.assistant[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-radius:.375rem;border-top-left-radius:0;background-color:#0003;padding:.5rem}.message.assistant[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{content:"";position:absolute;left:-12px;top:0;background-color:inherit;width:12px;height:12px;clip-path:polygon(0 0,100% 0,100% 100%)}']})};function ll(i){return i!=null&&`${i}`!="false"}function Tn(i,e=0){return pk(i)?Number(i):arguments.length===2?e:0}function pk(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}function ul(i){return Array.isArray(i)?i:[i]}function Me(i){return i==null?"":typeof i=="string"?i:`${i}px`}function Qe(i){return i instanceof _e?i.nativeElement:i}var _v;try{_v=typeof Intl<"u"&&Intl.v8BreakIterator}catch{_v=!1}var et=(()=>{class i{constructor(t){this._platformId=t,this.isBrowser=this._platformId?xw(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||_v)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(r){return new(r||i)(A(yw))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ha;function dk(){if(ha==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>ha=!0}))}finally{ha=ha||!1}return ha}function ti(i){return dk()?i:!!i.capture}var An;function Zw(){if(An==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return An=!1,An;if("scrollBehavior"in document.documentElement.style)An=!0;else{let i=Element.prototype.scrollTo;i?An=!/\{\s*\[native code\]\s*\}/.test(i.toString()):An=!1}}return An}var yv;function fk(){if(yv==null){let i=typeof document<"u"?document.head:null;yv=!!(i&&(i.createShadowRoot||i.attachShadow))}return yv}function Fs(i){if(fk()){let e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function dt(i){return i.composedPath?i.composedPath()[0]:i.target}function hl(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var vk=new pt("cdk-dir-doc",{providedIn:"root",factory:gk});function gk(){return re(Pe)}var mk=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function yk(i){let e=i?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?mk.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var Bs=(()=>{class i{constructor(t){if(this.value="ltr",this.change=new Tt,t){let r=t.body?t.body.dir:null,n=t.documentElement?t.documentElement.dir:null;this.value=yk(r||n||"ltr")}}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(r){return new(r||i)(A(vk,8))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var bk=20,Ws=(()=>{class i{constructor(t,r,n){this._ngZone=t,this._platform=r,this._scrolled=new q,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=n}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){let r=this.scrollContainers.get(t);r&&(r.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=bk){return this._platform.isBrowser?new na(r=>{this._globalSubscription||this._addGlobalListener();let n=t>0?this._scrolled.pipe(lv(t)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ps()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(t,r){let n=this.getAncestorScrollContainers(t);return this.scrolled(r).pipe(xi(s=>!s||n.indexOf(s)>-1))}getAncestorScrollContainers(t){let r=[];return this.scrollContainers.forEach((n,s)=>{this._scrollableContainsElement(s,t)&&r.push(s)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,r){let n=Qe(r),s=t.getElementRef().nativeElement;do if(n==s)return!0;while(n=n.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let t=this._getWindow();return dw(t.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(r){return new(r||i)(A(xe),A(et),A(Pe,8))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var wk=20,Hs=(()=>{class i{constructor(t,r,n){this._platform=t,this._change=new q,this._changeListener=s=>{this._change.next(s)},this._document=n,r.runOutsideAngular(()=>{if(t.isBrowser){let s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){let t=this.getViewportScrollPosition(),{width:r,height:n}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+n,right:t.left+r,height:n,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let t=this._document,r=this._getWindow(),n=t.documentElement,s=n.getBoundingClientRect(),o=-s.top||t.body.scrollTop||r.scrollY||n.scrollTop||0,a=-s.left||t.body.scrollLeft||r.scrollX||n.scrollLeft||0;return{top:o,left:a}}change(t=wk){return t>0?this._change.pipe(lv(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(r){return new(r||i)(A(et),A(xe),A(Pe,8))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function tP(i,...e){return e.length?e.some(t=>i[t]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}var rP=" ";function Pk(i,e,t){let r=vl(i,e);t=t.trim(),!r.some(n=>n.trim()===t)&&(r.push(t),i.setAttribute(e,r.join(rP)))}function Ek(i,e,t){let r=vl(i,e);t=t.trim();let n=r.filter(s=>s!==t);n.length?i.setAttribute(e,n.join(rP)):i.removeAttribute(e)}function vl(i,e){return i.getAttribute(e)?.match(/\S+/g)??[]}var nP="cdk-describedby-message",pl="cdk-describedby-host",bv=0,sP=(()=>{class i{constructor(t,r){this._platform=r,this._messageRegistry=new Map,this._messagesContainer=null,this._id=`${bv++}`,this._document=t,this._id=re(mw)+"-"+bv++}describe(t,r,n){if(!this._canBeDescribed(t,r))return;let s=Cv(r,n);typeof r!="string"?(iP(r,this._id),this._messageRegistry.set(s,{messageElement:r,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(r,n),this._isElementDescribedByMessage(t,s)||this._addMessageReference(t,s)}removeDescription(t,r,n){if(!r||!this._isElementNode(t))return;let s=Cv(r,n);if(this._isElementDescribedByMessage(t,s)&&this._removeMessageReference(t,s),typeof r=="string"){let o=this._messageRegistry.get(s);o&&o.referenceCount===0&&this._deleteMessageElement(s)}this._messagesContainer?.childNodes.length===0&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){let t=this._document.querySelectorAll(`[${pl}="${this._id}"]`);for(let r=0;r<t.length;r++)this._removeCdkDescribedByReferenceIds(t[r]),t[r].removeAttribute(pl);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(t,r){let n=this._document.createElement("div");iP(n,this._id),n.textContent=t,r&&n.setAttribute("role",r),this._createMessagesContainer(),this._messagesContainer.appendChild(n),this._messageRegistry.set(Cv(t,r),{messageElement:n,referenceCount:0})}_deleteMessageElement(t){this._messageRegistry.get(t)?.messageElement?.remove(),this._messageRegistry.delete(t)}_createMessagesContainer(){if(this._messagesContainer)return;let t="cdk-describedby-message-container",r=this._document.querySelectorAll(`.${t}[platform="server"]`);for(let s=0;s<r.length;s++)r[s].remove();let n=this._document.createElement("div");n.style.visibility="hidden",n.classList.add(t),n.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&n.setAttribute("platform","server"),this._document.body.appendChild(n),this._messagesContainer=n}_removeCdkDescribedByReferenceIds(t){let r=vl(t,"aria-describedby").filter(n=>n.indexOf(nP)!=0);t.setAttribute("aria-describedby",r.join(" "))}_addMessageReference(t,r){let n=this._messageRegistry.get(r);Pk(t,"aria-describedby",n.messageElement.id),t.setAttribute(pl,this._id),n.referenceCount++}_removeMessageReference(t,r){let n=this._messageRegistry.get(r);n.referenceCount--,Ek(t,"aria-describedby",n.messageElement.id),t.removeAttribute(pl)}_isElementDescribedByMessage(t,r){let n=vl(t,"aria-describedby"),s=this._messageRegistry.get(r),o=s&&s.messageElement.id;return!!o&&n.indexOf(o)!=-1}_canBeDescribed(t,r){if(!this._isElementNode(t))return!1;if(r&&typeof r=="object")return!0;let n=r==null?"":`${r}`.trim(),s=t.getAttribute("aria-label");return n?!s||s.trim()!==n:!1}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}static{this.\u0275fac=function(r){return new(r||i)(A(Pe),A(et))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Cv(i,e){return typeof i=="string"?`${e||""}/${i}`:i}function iP(i,e){i.id||(i.id=`${nP}-${e}-${bv++}`)}function da(i){return i.buttons===0||i.detail===0}function fa(i){let e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var Rk=new pt("cdk-input-modality-detector-options"),Ik={ignoreKeys:[18,17,224,91,16]},oP=650,Us=ti({passive:!0,capture:!0}),Tk=(()=>{class i{get mostRecentModality(){return this._modality.value}constructor(t,r,n,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Wc(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=dt(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<oP||(this._modality.next(da(o)?"keyboard":"mouse"),this._mostRecentTarget=dt(o))},this._onTouchstart=o=>{if(fa(o)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=dt(o)},this._options=se(se({},Ik),s),this.modalityDetected=this._modality.pipe(gw(1)),this.modalityChanged=this.modalityDetected.pipe(uv()),t.isBrowser&&r.runOutsideAngular(()=>{n.addEventListener("keydown",this._onKeydown,Us),n.addEventListener("mousedown",this._onMousedown,Us),n.addEventListener("touchstart",this._onTouchstart,Us)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Us),document.removeEventListener("mousedown",this._onMousedown,Us),document.removeEventListener("touchstart",this._onTouchstart,Us))}static{this.\u0275fac=function(r){return new(r||i)(A(et),A(xe),A(Pe),A(Rk,8))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var fl=function(i){return i[i.IMMEDIATE=0]="IMMEDIATE",i[i.EVENTUAL=1]="EVENTUAL",i}(fl||{}),Ak=new pt("cdk-focus-monitor-default-options"),dl=ti({passive:!0,capture:!0}),aP=(()=>{class i{constructor(t,r,n,s,o){this._ngZone=t,this._platform=r,this._inputModalityDetector=n,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new q,this._rootNodeFocusAndBlurListener=a=>{let c=dt(a);for(let l=c;l;l=l.parentElement)a.type==="focus"?this._onFocus(a,l):this._onBlur(a,l)},this._document=s,this._detectionMode=o?.detectionMode||fl.IMMEDIATE}monitor(t,r=!1){let n=Qe(t);if(!this._platform.isBrowser||n.nodeType!==1)return Ps();let s=Fs(n)||this._getDocument(),o=this._elementInfo.get(n);if(o)return r&&(o.checkChildren=!0),o.subject;let a={checkChildren:r,subject:new q,rootNode:s};return this._elementInfo.set(n,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){let r=Qe(t),n=this._elementInfo.get(r);n&&(n.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(n))}focusVia(t,r,n){let s=Qe(t),o=this._getDocument().activeElement;s===o?this._getClosestElementsInfo(s).forEach(([a,c])=>this._originChanged(a,r,c)):(this._setOrigin(r),typeof s.focus=="function"&&s.focus(n))}ngOnDestroy(){this._elementInfo.forEach((t,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===fl.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,r){t.classList.toggle("cdk-focused",!!r),t.classList.toggle("cdk-touch-focused",r==="touch"),t.classList.toggle("cdk-keyboard-focused",r==="keyboard"),t.classList.toggle("cdk-mouse-focused",r==="mouse"),t.classList.toggle("cdk-program-focused",r==="program")}_setOrigin(t,r=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=t,this._originFromTouchInteraction=t==="touch"&&r,this._detectionMode===fl.IMMEDIATE){clearTimeout(this._originTimeoutId);let n=this._originFromTouchInteraction?oP:1;this._originTimeoutId=setTimeout(()=>this._origin=null,n)}})}_onFocus(t,r){let n=this._elementInfo.get(r),s=dt(t);!n||!n.checkChildren&&r!==s||this._originChanged(r,this._getFocusOrigin(s),n)}_onBlur(t,r){let n=this._elementInfo.get(r);!n||n.checkChildren&&t.relatedTarget instanceof Node&&r.contains(t.relatedTarget)||(this._setClasses(r),this._emitOrigin(n,null))}_emitOrigin(t,r){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(r))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;let r=t.rootNode,n=this._rootNodeFocusListenerCount.get(r)||0;n||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,dl),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,dl)}),this._rootNodeFocusListenerCount.set(r,n+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Te(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){let r=t.rootNode;if(this._rootNodeFocusListenerCount.has(r)){let n=this._rootNodeFocusListenerCount.get(r);n>1?this._rootNodeFocusListenerCount.set(r,n-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,dl),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,dl),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,r,n){this._setClasses(t,r),this._emitOrigin(n,r),this._lastFocusOrigin=r}_getClosestElementsInfo(t){let r=[];return this._elementInfo.forEach((n,s)=>{(s===t||n.checkChildren&&s.contains(t))&&r.push([s,n])}),r}_isLastInteractionFromInputLabel(t){let{_mostRecentTarget:r,mostRecentModality:n}=this._inputModalityDetector;if(n!=="mouse"||!r||r===t||t.nodeName!=="INPUT"&&t.nodeName!=="TEXTAREA"||t.disabled)return!1;let s=t.labels;if(s){for(let o=0;o<s.length;o++)if(s[o].contains(r))return!0}return!1}static{this.\u0275fac=function(r){return new(r||i)(A(xe),A(et),A(Tk),A(Pe,8),A(Ak,8))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function wP(i){let e=i.cloneNode(!0),t=e.querySelectorAll("[id]"),r=i.nodeName.toLowerCase();e.removeAttribute("id");for(let n=0;n<t.length;n++)t[n].removeAttribute("id");return r==="canvas"?uP(i,e):(r==="input"||r==="select"||r==="textarea")&&lP(i,e),cP("canvas",i,e,uP),cP("input, textarea, select",i,e,lP),e}function cP(i,e,t,r){let n=e.querySelectorAll(i);if(n.length){let s=t.querySelectorAll(i);for(let o=0;o<n.length;o++)r(n[o],s[o])}}var Dk=0;function lP(i,e){e.type!=="file"&&(e.value=i.value),e.type==="radio"&&e.name&&(e.name=`mat-clone-${e.name}-${Dk++}`)}function uP(i,e){let t=e.getContext("2d");if(t)try{t.drawImage(i,0,0)}catch{}}function Ov(i){let e=i.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function Pv(i,e,t){let{top:r,bottom:n,left:s,right:o}=i;return t>=r&&t<=n&&e>=s&&e<=o}function ga(i,e,t){i.top+=e,i.bottom=i.top+i.height,i.left+=t,i.right=i.left+i.width}function hP(i,e,t,r){let{top:n,right:s,bottom:o,left:a,width:c,height:l}=i,u=c*e,h=l*e;return r>n-h&&r<o+h&&t>a-u&&t<s+u}var _l=class{constructor(e){this._document=e,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:Ov(t)})})}handleScroll(e){let t=dt(e),r=this.positions.get(t);if(!r)return null;let n=r.scrollPosition,s,o;if(t===this._document){let l=this.getViewportScrollPosition();s=l.top,o=l.left}else s=t.scrollTop,o=t.scrollLeft;let a=n.top-s,c=n.left-o;return this.positions.forEach((l,u)=>{l.clientRect&&t!==u&&t.contains(u)&&ga(l.clientRect,a,c)}),n.top=s,n.left=o,{top:a,left:c}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function PP(i,e){let t=i.rootNodes;if(t.length===1&&t[0].nodeType===e.ELEMENT_NODE)return t[0];let r=e.createElement("div");return t.forEach(n=>r.appendChild(n)),r}function Dv(i,e,t){for(let r in e)if(e.hasOwnProperty(r)){let n=e[r];n?i.setProperty(r,n,t?.has(r)?"important":""):i.removeProperty(r)}return i}function Vs(i,e){let t=e?"":"none";Dv(i.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function pP(i,e,t){Dv(i.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},t)}function Sl(i,e){return e&&e!="none"?i+" "+e:i}function dP(i,e){i.style.width=`${e.width}px`,i.style.height=`${e.height}px`,i.style.transform=Cl(e.left,e.top)}function Cl(i,e){return`translate3d(${Math.round(i)}px, ${Math.round(e)}px, 0)`}function fP(i){let e=i.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(i)*e}function xk(i){let e=getComputedStyle(i),t=wv(e,"transition-property"),r=t.find(a=>a==="transform"||a==="all");if(!r)return 0;let n=t.indexOf(r),s=wv(e,"transition-duration"),o=wv(e,"transition-delay");return fP(s[n])+fP(o[n])}function wv(i,e){return i.getPropertyValue(e).split(",").map(r=>r.trim())}var Mk=new Set(["position"]),Ev=class{get element(){return this._preview}constructor(e,t,r,n,s,o,a,c,l){this._document=e,this._rootElement=t,this._direction=r,this._initialDomRect=n,this._previewTemplate=s,this._previewClass=o,this._pickupPositionOnPage=a,this._initialTransform=c,this._zIndex=l}attach(e){this._preview=this._createPreview(),e.appendChild(this._preview),vP(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(e){this._preview.style.transform=e}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(e){this._preview.classList.add(e)}getTransitionDuration(){return xk(this._preview)}addEventListener(e,t){this._preview.addEventListener(e,t)}removeEventListener(e,t){this._preview.removeEventListener(e,t)}_createPreview(){let e=this._previewTemplate,t=this._previewClass,r=e?e.template:null,n;if(r&&e){let s=e.matchSize?this._initialDomRect:null,o=e.viewContainer.createEmbeddedView(r,e.context);o.detectChanges(),n=PP(o,this._document),this._previewEmbeddedView=o,e.matchSize?dP(n,s):n.style.transform=Cl(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else n=wP(this._rootElement),dP(n,this._initialDomRect),this._initialTransform&&(n.style.transform=this._initialTransform);return Dv(n.style,{"pointer-events":"none",margin:vP(n)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Mk),Vs(n,!1),n.classList.add("cdk-drag-preview"),n.setAttribute("popover","manual"),n.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(s=>n.classList.add(s)):n.classList.add(t)),n}};function vP(i){return"showPopover"in i}var gP=ti({passive:!0}),gl=ti({passive:!1}),mP=ti({passive:!1,capture:!0}),kk=800,yP=new Set(["position"]),Rv=class{get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(e){e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>Vs(t,e)))}constructor(e,t,r,n,s,o){this._config=t,this._document=r,this._ngZone=n,this._viewportRuler=s,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=Qt(!1),this._moveEvents=new q,this._pointerMoveSubscription=Di.EMPTY,this._pointerUpSubscription=Di.EMPTY,this._scrollSubscription=Di.EMPTY,this._resizeSubscription=Di.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this.scale=1,this._disabled=!1,this.beforeStarted=new q,this.started=new q,this.released=new q,this.ended=new q,this.entered=new q,this.exited=new q,this.dropped=new q,this.moved=this._moveEvents,this._pointerDown=a=>{if(this.beforeStarted.next(),this._handles.length){let c=this._getTargetHandle(a);c&&!this._disabledHandles.has(c)&&!this.disabled&&this._initializeDragSequence(c,a)}else this.disabled||this._initializeDragSequence(this._rootElement,a)},this._pointerMove=a=>{let c=this._getPointerPositionOnPage(a);if(!this._hasStartedDragging()){let u=Math.abs(c.x-this._pickupPositionOnPage.x),h=Math.abs(c.y-this._pickupPositionOnPage.y);if(u+h>=this._config.dragStartThreshold){let f=Date.now()>=this._dragStartTime+this._getDragStartDelay(a),g=this._dropContainer;if(!f){this._endDragSequence(a);return}(!g||!g.isDragging()&&!g.isReceiving())&&(a.cancelable&&a.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(a)))}return}a.cancelable&&a.preventDefault();let l=this._getConstrainedPointerPosition(c);if(this._hasMoved=!0,this._lastKnownPointerPosition=c,this._updatePointerDirectionDelta(l),this._dropContainer)this._updateActiveDropContainer(l,c);else{let u=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,h=this._activeTransform;h.x=l.x-u.x+this._passiveTransform.x,h.y=l.y-u.y+this._passiveTransform.y,this._applyRootElementTransform(h.x,h.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:l,event:a,distance:this._getDragDistance(l),delta:this._pointerDirectionDelta})})},this._pointerUp=a=>{this._endDragSequence(a)},this._nativeDragStart=a=>{if(this._handles.length){let c=this._getTargetHandle(a);c&&!this._disabledHandles.has(c)&&!this.disabled&&a.preventDefault()}else this.disabled||a.preventDefault()},this.withRootElement(e).withParent(t.parentDragRef||null),this._parentPositions=new _l(r),o.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(r=>Qe(r)),this._handles.forEach(r=>Vs(r,this.disabled)),this._toggleNativeDragInteractions();let t=new Set;return this._disabledHandles.forEach(r=>{this._handles.indexOf(r)>-1&&t.add(r)}),this._disabledHandles=t,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){let t=Qe(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,gl),t.addEventListener("touchstart",this._pointerDown,gP),t.addEventListener("dragstart",this._nativeDragStart,gl)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?Qe(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),Vs(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),Vs(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){let e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){let e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",SP,mP)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let t=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){va(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let t=this._getShadowRoot(),r=this._dropContainer;if(t&&this._ngZone.runOutsideAngular(()=>{t.addEventListener("selectstart",SP,mP)}),r){let n=this._rootElement,s=n.parentNode,o=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment("");s.insertBefore(a,n),this._initialTransform=n.style.transform||"",this._preview=new Ev(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3),this._preview.attach(this._getPreviewInsertionPoint(s,t)),pP(n,!1,yP),this._document.body.appendChild(s.replaceChild(o,n)),this.started.next({source:this,event:e}),r.start(),this._initialContainer=r,this._initialIndex=r.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(r?r.getScrollableParents():[])}_initializeDragSequence(e,t){this._parentDragRef&&t.stopPropagation();let r=this.isDragging(),n=va(t),s=!n&&t.button!==0,o=this._rootElement,a=dt(t),c=!n&&this._lastTouchEventTime&&this._lastTouchEventTime+kk>Date.now(),l=n?fa(t):da(t);if(a&&a.draggable&&t.type==="mousedown"&&t.preventDefault(),r||s||c||l)return;if(this._handles.length){let d=o.style;this._rootElementTapHighlight=d.webkitTapHighlightColor||"",d.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(d=>this._updateOnScroll(d)),this._boundaryElement&&(this._boundaryRect=Ov(this._boundaryElement));let u=this._previewTemplate;this._pickupPositionInElement=u&&u.template&&!u.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,e,t);let h=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:h.x,y:h.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){pP(this._rootElement,!0,yP),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let t=this._dropContainer,r=t.getItemIndex(this),n=this._getPointerPositionOnPage(e),s=this._getDragDistance(n),o=t._isOverContainer(n.x,n.y);this.ended.next({source:this,distance:s,dropPoint:n,event:e}),this.dropped.next({item:this,currentIndex:r,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:s,dropPoint:n,event:e}),t.drop(this,r,this._initialIndex,this._initialContainer,o,s,n,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:r,y:n}){let s=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,e,t,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(r,n),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,t):this._applyPreviewTransform(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let e=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);let t=this._preview.getTransitionDuration();return t===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(r=>{let n=o=>{(!o||this._preview&&dt(o)===this._preview.element&&o.propertyName==="transform")&&(this._preview?.removeEventListener("transitionend",n),r(),clearTimeout(s))},s=setTimeout(n,t*1.5);this._preview.addEventListener("transitionend",n)}))}_createPlaceholderElement(){let e=this._placeholderTemplate,t=e?e.template:null,r;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),r=PP(this._placeholderRef,this._document)):r=wP(this._rootElement),r.style.pointerEvents="none",r.classList.add("cdk-drag-placeholder"),r}_getPointerPositionInElement(e,t,r){let n=t===this._rootElement?null:t,s=n?n.getBoundingClientRect():e,o=va(r)?r.targetTouches[0]:r,a=this._getViewportScrollPosition(),c=o.pageX-s.left-a.left,l=o.pageY-s.top-a.top;return{x:s.left-e.left+c,y:s.top-e.top+l}}_getPointerPositionOnPage(e){let t=this._getViewportScrollPosition(),r=va(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,n=r.pageX-t.left,s=r.pageY-t.top;if(this._ownerSVGElement){let o=this._ownerSVGElement.getScreenCTM();if(o){let a=this._ownerSVGElement.createSVGPoint();return a.x=n,a.y=s,a.matrixTransform(o.inverse())}}return{x:n,y:s}}_getConstrainedPointerPosition(e){let t=this._dropContainer?this._dropContainer.lockAxis:null,{x:r,y:n}=this.constrainPosition?this.constrainPosition(e,this,this._initialDomRect,this._pickupPositionInElement):e;if(this.lockAxis==="x"||t==="x"?n=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||t==="y")&&(r=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:s,y:o}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:c,height:l}=this._getPreviewRect(),u=a.top+o,h=a.bottom-(l-o),d=a.left+s,f=a.right-(c-s);r=_P(r,d,f),n=_P(n,u,h)}return{x:r,y:n}}_updatePointerDirectionDelta(e){let{x:t,y:r}=e,n=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,o=Math.abs(t-s.x),a=Math.abs(r-s.y);return o>this._config.pointerDirectionChangeThreshold&&(n.x=t>s.x?1:-1,s.x=t),a>this._config.pointerDirectionChangeThreshold&&(n.y=r>s.y?1:-1,s.y=r),n}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,Vs(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,gl),e.removeEventListener("touchstart",this._pointerDown,gP),e.removeEventListener("dragstart",this._nativeDragStart,gl)}_applyRootElementTransform(e,t){let r=1/this.scale,n=Cl(e*r,t*r),s=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=s.transform&&s.transform!="none"?s.transform:""),s.transform=Sl(n,this._initialTransform)}_applyPreviewTransform(e,t){let r=this._previewTemplate?.template?void 0:this._initialTransform,n=Cl(e,t);this._preview.setTransform(Sl(n,r))}_getDragDistance(e){let t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(e===0&&t===0||this.isDragging()||!this._boundaryElement)return;let r=this._rootElement.getBoundingClientRect(),n=this._boundaryElement.getBoundingClientRect();if(n.width===0&&n.height===0||r.width===0&&r.height===0)return;let s=n.left-r.left,o=r.right-n.right,a=n.top-r.top,c=r.bottom-n.bottom;n.width>r.width?(s>0&&(e+=s),o>0&&(e-=o)):e=0,n.height>r.height?(a>0&&(t+=a),c>0&&(t-=c)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){let t=this.dragStartDelay;return typeof t=="number"?t:va(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){let t=this._parentPositions.handleScroll(e);if(t){let r=dt(e);this._boundaryRect&&r!==this._boundaryElement&&r.contains(this._boundaryElement)&&ga(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=Fs(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,t){let r=this._previewContainer||"global";if(r==="parent")return e;if(r==="global"){let n=this._document;return t||n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement||n.body}return Qe(r)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(e){return this._handles.find(t=>e.target&&(e.target===t||t.contains(e.target)))}};function _P(i,e,t){return Math.max(e,Math.min(t,i))}function va(i){return i.type[0]==="t"}function SP(i){i.preventDefault()}function EP(i,e,t){let r=CP(e,i.length-1),n=CP(t,i.length-1);if(r===n)return;let s=i[r],o=n<r?-1:1;for(let a=r;a!==n;a+=o)i[a]=i[a+o];i[n]=s}function CP(i,e){return Math.max(0,Math.min(e,i))}var bl=class{constructor(e){this._dragDropRegistry=e,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(e){this.withItems(e)}sort(e,t,r,n){let s=this._itemPositions,o=this._getItemIndexFromPointerPosition(e,t,r,n);if(o===-1&&s.length>0)return null;let a=this.orientation==="horizontal",c=s.findIndex(y=>y.drag===e),l=s[o],u=s[c].clientRect,h=l.clientRect,d=c>o?1:-1,f=this._getItemOffsetPx(u,h,d),g=this._getSiblingOffsetPx(c,s,d),m=s.slice();return EP(s,c,o),s.forEach((y,b)=>{if(m[b]===y)return;let S=y.drag===e,_=S?f:g,P=S?e.getPlaceholderElement():y.drag.getRootElement();y.offset+=_;let O=Math.round(y.offset*(1/y.drag.scale));a?(P.style.transform=Sl(`translate3d(${O}px, 0, 0)`,y.initialTransform),ga(y.clientRect,0,_)):(P.style.transform=Sl(`translate3d(0, ${O}px, 0)`,y.initialTransform),ga(y.clientRect,_,0))}),this._previousSwap.overlaps=Pv(h,t,r),this._previousSwap.drag=l.drag,this._previousSwap.delta=a?n.x:n.y,{previousIndex:c,currentIndex:o}}enter(e,t,r,n){let s=n==null||n<0?this._getItemIndexFromPointerPosition(e,t,r):n,o=this._activeDraggables,a=o.indexOf(e),c=e.getPlaceholderElement(),l=o[s];if(l===e&&(l=o[s+1]),!l&&(s==null||s===-1||s<o.length-1)&&this._shouldEnterAsFirstChild(t,r)&&(l=o[0]),a>-1&&o.splice(a,1),l&&!this._dragDropRegistry.isDragging(l)){let u=l.getRootElement();u.parentElement.insertBefore(c,u),o.splice(s,0,e)}else this._element.appendChild(c),o.push(e);c.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables?.forEach(e=>{let t=e.getRootElement();if(t){let r=this._itemPositions.find(n=>n.drag===e)?.initialTransform;t.style.transform=r||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return(this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions).findIndex(r=>r.drag===e)}updateOnScroll(e,t){this._itemPositions.forEach(({clientRect:r})=>{ga(r,e,t)}),this._itemPositions.forEach(({drag:r})=>{this._dragDropRegistry.isDragging(r)&&r._sortFromLastPointerPosition()})}withElementContainer(e){this._element=e}_cacheItemPositions(){let e=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(t=>{let r=t.getVisibleElement();return{drag:t,offset:0,initialTransform:r.style.transform||"",clientRect:Ov(r)}}).sort((t,r)=>e?t.clientRect.left-r.clientRect.left:t.clientRect.top-r.clientRect.top)}_getItemOffsetPx(e,t,r){let n=this.orientation==="horizontal",s=n?t.left-e.left:t.top-e.top;return r===-1&&(s+=n?t.width-e.width:t.height-e.height),s}_getSiblingOffsetPx(e,t,r){let n=this.orientation==="horizontal",s=t[e].clientRect,o=t[e+r*-1],a=s[n?"width":"height"]*r;if(o){let c=n?"left":"top",l=n?"right":"bottom";r===-1?a-=o.clientRect[c]-s[l]:a+=s[c]-o.clientRect[l]}return a}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;let r=this._itemPositions,n=this.orientation==="horizontal";if(r[0].drag!==this._activeDraggables[0]){let o=r[r.length-1].clientRect;return n?e>=o.right:t>=o.bottom}else{let o=r[0].clientRect;return n?e<=o.left:t<=o.top}}_getItemIndexFromPointerPosition(e,t,r,n){let s=this.orientation==="horizontal",o=this._itemPositions.findIndex(({drag:a,clientRect:c})=>{if(a===e)return!1;if(n){let l=s?n.x:n.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&l===this._previousSwap.delta)return!1}return s?t>=Math.floor(c.left)&&t<Math.floor(c.right):r>=Math.floor(c.top)&&r<Math.floor(c.bottom)});return o===-1||!this._sortPredicate(o,e)?-1:o}},Iv=class{constructor(e,t){this._document=e,this._dragDropRegistry=t,this._previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1},this._relatedNodes=[]}start(e){let t=this._element.childNodes;this._relatedNodes=[];for(let r=0;r<t.length;r++){let n=t[r];this._relatedNodes.push([n,n.nextSibling])}this.withItems(e)}sort(e,t,r,n){let s=this._getItemIndexFromPointerPosition(e,t,r),o=this._previousSwap;if(s===-1||this._activeItems[s]===e)return null;let a=this._activeItems[s];if(o.drag===a&&o.overlaps&&o.deltaX===n.x&&o.deltaY===n.y)return null;let c=this.getItemIndex(e),l=e.getPlaceholderElement(),u=a.getRootElement();s>c?u.after(l):u.before(l),EP(this._activeItems,c,s);let h=this._getRootNode().elementFromPoint(t,r);return o.deltaX=n.x,o.deltaY=n.y,o.drag=a,o.overlaps=u===h||u.contains(h),{previousIndex:c,currentIndex:s}}enter(e,t,r,n){let s=n==null||n<0?this._getItemIndexFromPointerPosition(e,t,r):n;s===-1&&(s=this._getClosestItemIndexToPointer(e,t,r));let o=this._activeItems[s],a=this._activeItems.indexOf(e);a>-1&&this._activeItems.splice(a,1),o&&!this._dragDropRegistry.isDragging(o)?(this._activeItems.splice(s,0,e),o.getRootElement().before(e.getPlaceholderElement())):(this._activeItems.push(e),this._element.appendChild(e.getPlaceholderElement()))}withItems(e){this._activeItems=e.slice()}withSortPredicate(e){this._sortPredicate=e}reset(){let e=this._element,t=this._previousSwap;for(let r=this._relatedNodes.length-1;r>-1;r--){let[n,s]=this._relatedNodes[r];n.parentNode===e&&n.nextSibling!==s&&(s===null?e.appendChild(n):s.parentNode===e&&e.insertBefore(n,s))}this._relatedNodes=[],this._activeItems=[],t.drag=null,t.deltaX=t.deltaY=0,t.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(e){return this._activeItems.indexOf(e)}updateOnScroll(){this._activeItems.forEach(e=>{this._dragDropRegistry.isDragging(e)&&e._sortFromLastPointerPosition()})}withElementContainer(e){e!==this._element&&(this._element=e,this._rootNode=void 0)}_getItemIndexFromPointerPosition(e,t,r){let n=this._getRootNode().elementFromPoint(Math.floor(t),Math.floor(r)),s=n?this._activeItems.findIndex(o=>{let a=o.getRootElement();return n===a||a.contains(n)}):-1;return s===-1||!this._sortPredicate(s,e)?-1:s}_getRootNode(){return this._rootNode||(this._rootNode=Fs(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(e,t,r){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let n=1/0,s=-1;for(let o=0;o<this._activeItems.length;o++){let a=this._activeItems[o];if(a!==e){let{x:c,y:l}=a.getRootElement().getBoundingClientRect(),u=Math.hypot(t-c,r-l);u<n&&(n=u,s=o)}}return s}},bP=.05,RP=.05,pi=function(i){return i[i.NONE=0]="NONE",i[i.UP=1]="UP",i[i.DOWN=2]="DOWN",i}(pi||{}),At=function(i){return i[i.NONE=0]="NONE",i[i.LEFT=1]="LEFT",i[i.RIGHT=2]="RIGHT",i}(At||{}),Tv=class{constructor(e,t,r,n,s){this._dragDropRegistry=t,this._ngZone=n,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new q,this.entered=new q,this.exited=new q,this.dropped=new q,this.sorted=new q,this.receivingStarted=new q,this.receivingStopped=new q,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=Di.EMPTY,this._verticalScrollDirection=pi.NONE,this._horizontalScrollDirection=At.NONE,this._stopScrollTimers=new q,this._cachedShadowRoot=null,this._scrollableElements=[],this._direction="ltr",this._startScrollInterval=()=>{this._stopScrolling(),fw(0,cv).pipe(Te(this._stopScrollTimers)).subscribe(()=>{let a=this._scrollNode,c=this.autoScrollStep;this._verticalScrollDirection===pi.UP?a.scrollBy(0,-c):this._verticalScrollDirection===pi.DOWN&&a.scrollBy(0,c),this._horizontalScrollDirection===At.LEFT?a.scrollBy(-c,0):this._horizontalScrollDirection===At.RIGHT&&a.scrollBy(c,0)})};let o=this.element=Qe(e);this._document=r,this.withOrientation("vertical").withElementContainer(o),t.registerDropContainer(this),this._parentPositions=new _l(r)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,t,r,n){this._draggingStarted(),n==null&&this.sortingDisabled&&(n=this._draggables.indexOf(e)),this._sortStrategy.enter(e,t,r,n),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,r,n,s,o,a,c={}){this._reset(),this.dropped.next({item:e,currentIndex:t,previousIndex:r,container:this,previousContainer:n,isPointerOverContainer:s,distance:o,dropPoint:a,event:c})}withItems(e){let t=this._draggables;return this._draggables=e,e.forEach(r=>r._withDropContainer(this)),this.isDragging()&&(t.filter(n=>n.isDragging()).every(n=>e.indexOf(n)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._direction=e,this._sortStrategy instanceof bl&&(this._sortStrategy.direction=e),this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){if(e==="mixed")this._sortStrategy=new Iv(this._document,this._dragDropRegistry);else{let t=new bl(this._dragDropRegistry);t.direction=this._direction,t.orientation=e,this._sortStrategy=t}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((t,r)=>this.sortPredicate(t,r,this)),this}withScrollableParents(e){let t=this._container;return this._scrollableElements=e.indexOf(t)===-1?[t,...e]:e.slice(),this}withElementContainer(e){if(e===this._container)return this;let t=Qe(this.element),r=this._scrollableElements.indexOf(this._container),n=this._scrollableElements.indexOf(e);return r>-1&&this._scrollableElements.splice(r,1),n>-1&&this._scrollableElements.splice(n,1),this._sortStrategy&&this._sortStrategy.withElementContainer(e),this._cachedShadowRoot=null,this._scrollableElements.unshift(e),this._container=e,this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,r,n){if(this.sortingDisabled||!this._domRect||!hP(this._domRect,bP,t,r))return;let s=this._sortStrategy.sort(e,t,r,n);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let r,n=pi.NONE,s=At.NONE;if(this._parentPositions.positions.forEach((o,a)=>{a===this._document||!o.clientRect||r||hP(o.clientRect,bP,e,t)&&([n,s]=Nk(a,o.clientRect,this._direction,e,t),(n||s)&&(r=a))}),!n&&!s){let{width:o,height:a}=this._viewportRuler.getViewportSize(),c={width:o,height:a,top:0,right:o,bottom:a,left:0};n=IP(c,t),s=TP(c,e),r=window}r&&(n!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||r!==this._scrollNode)&&(this._verticalScrollDirection=n,this._horizontalScrollDirection=s,this._scrollNode=r,(n||s)&&r?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let e=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let e=this._container.style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(e,t){return this._domRect!=null&&Pv(this._domRect,e,t)}_getSiblingContainerFromPosition(e,t,r){return this._siblings.find(n=>n._canReceive(e,t,r))}_canReceive(e,t,r){if(!this._domRect||!Pv(this._domRect,t,r)||!this.enterPredicate(e,this))return!1;let n=this._getShadowRoot().elementFromPoint(t,r);return n?n===this._container||this._container.contains(n):!1}_startReceiving(e,t){let r=this._activeSiblings;!r.has(e)&&t.every(n=>this.enterPredicate(n,this)||this._draggables.indexOf(n)>-1)&&(r.add(e),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:e,receiver:this,items:t}))}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:e,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){let t=this._parentPositions.handleScroll(e);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let e=Fs(this._container);this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let e=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,e))}};function IP(i,e){let{top:t,bottom:r,height:n}=i,s=n*RP;return e>=t-s&&e<=t+s?pi.UP:e>=r-s&&e<=r+s?pi.DOWN:pi.NONE}function TP(i,e){let{left:t,right:r,width:n}=i,s=n*RP;return e>=t-s&&e<=t+s?At.LEFT:e>=r-s&&e<=r+s?At.RIGHT:At.NONE}function Nk(i,e,t,r,n){let s=IP(e,n),o=TP(e,r),a=pi.NONE,c=At.NONE;if(s){let l=i.scrollTop;s===pi.UP?l>0&&(a=pi.UP):i.scrollHeight-l>i.clientHeight&&(a=pi.DOWN)}if(o){let l=i.scrollLeft;t==="rtl"?o===At.RIGHT?l<0&&(c=At.RIGHT):i.scrollWidth+l>i.clientWidth&&(c=At.LEFT):o===At.LEFT?l>0&&(c=At.LEFT):i.scrollWidth-l>i.clientWidth&&(c=At.RIGHT)}return[a,c]}var ml=ti({passive:!1,capture:!0}),yl=new Set,Lk=(()=>{class i{static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275cmp=Lt({type:i,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],standalone:!0,features:[qt],decls:0,vars:0,template:function(r,n){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}"],encapsulation:2,changeDetection:0})}}return i})(),jk=(()=>{class i{constructor(t,r){this._ngZone=t,this._appRef=re(Xc),this._environmentInjector=re(Vc),this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=Qt([]),this._globalListeners=new Map,this._draggingPredicate=n=>n.isDragging(),this.pointerMove=new q,this.pointerUp=new q,this.scroll=new q,this._preventDefaultWhileDragging=n=>{this._activeDragInstances().length>0&&n.preventDefault()},this._persistentTouchmoveListener=n=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&n.preventDefault(),this.pointerMove.next(n))},this._document=r}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,ml)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),this._dragInstances.size===0&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,ml)}startDragging(t,r){if(!(this._activeDragInstances().indexOf(t)>-1)&&(this._loadResets(),this._activeDragInstances.update(n=>[...n,t]),this._activeDragInstances().length===1)){let n=r.type.startsWith("touch");this._globalListeners.set(n?"touchend":"mouseup",{handler:s=>this.pointerUp.next(s),options:!0}).set("scroll",{handler:s=>this.scroll.next(s),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:ml}),n||this._globalListeners.set("mousemove",{handler:s=>this.pointerMove.next(s),options:ml}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((s,o)=>{this._document.addEventListener(o,s.handler,s.options)})})}}stopDragging(t){this._activeDragInstances.update(r=>{let n=r.indexOf(t);return n>-1?(r.splice(n,1),[...r]):r}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(t){return this._activeDragInstances().indexOf(t)>-1}scrolled(t){let r=[this.scroll];return t&&t!==this._document&&r.push(new na(n=>this._ngZone.runOutsideAngular(()=>{let o=a=>{this._activeDragInstances().length&&n.next(a)};return t.addEventListener("scroll",o,!0),()=>{t.removeEventListener("scroll",o,!0)}}))),Sn(...r)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,r)=>{this._document.removeEventListener(r,t.handler,t.options)}),this._globalListeners.clear()}_loadResets(){if(!yl.has(this._appRef)){yl.add(this._appRef);let t=Aw(Lk,{environmentInjector:this._environmentInjector});this._appRef.onDestroy(()=>{yl.delete(this._appRef),yl.size===0&&t.destroy()})}}static{this.\u0275fac=function(r){return new(r||i)(A(xe),A(Pe))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),zk={dragStartThreshold:5,pointerDirectionChangeThreshold:5},qk=(()=>{class i{constructor(t,r,n,s){this._document=t,this._ngZone=r,this._viewportRuler=n,this._dragDropRegistry=s}createDrag(t,r=zk){return new Rv(t,r,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Tv(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static{this.\u0275fac=function(r){return new(r||i)(A(Pe),A(xe),A(Hs),A(jk))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Av=new pt("CDK_DRAG_PARENT");var AP=new pt("CdkDragHandle"),OP=(()=>{class i{get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._stateChanges.next(this)}constructor(t,r){this.element=t,this._parentDrag=r,this._stateChanges=new q,this._disabled=!1,r?._addHandle(this)}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static{this.\u0275fac=function(r){return new(r||i)(V(_e),V(Av,12))}}static{this.\u0275dir=Xt({type:i,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",ks]},standalone:!0,features:[xs([{provide:AP,useExisting:i}]),wn]})}}return i})(),Fk=new pt("CDK_DRAG_CONFIG"),Bk="cdk-drag",Wk=new pt("CdkDropList"),DP=(()=>{class i{static{this._dragInstances=[]}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=t,this._dragRef.disabled=this._disabled}constructor(t,r,n,s,o,a,c,l,u,h,d){this.element=t,this.dropContainer=r,this._ngZone=s,this._viewContainerRef=o,this._dir=c,this._changeDetectorRef=u,this._selfHandle=h,this._parentDrag=d,this._destroyed=new q,this._handles=new Wc([]),this.scale=1,this.started=new Tt,this.released=new Tt,this.ended=new Tt,this.entered=new Tt,this.exited=new Tt,this.dropped=new Tt,this.moved=new na(f=>{let g=this._dragRef.moved.pipe(Yi(m=>({source:this,pointerPosition:m.pointerPosition,event:m.event,delta:m.delta,distance:m.distance}))).subscribe(f);return()=>{g.unsubscribe()}}),this._injector=re(Zt),this._dragRef=l.createDrag(t,{dragStartThreshold:a&&a.dragStartThreshold!=null?a.dragStartThreshold:5,pointerDirectionChangeThreshold:a&&a.pointerDirectionChangeThreshold!=null?a.pointerDirectionChangeThreshold:5,zIndex:a?.zIndex}),this._dragRef.data=this,i._dragInstances.push(this),a&&this._assignDefaults(a),r&&(this._dragRef._withDropContainer(r._dropListRef),r.addItem(this),r._dropListRef.beforeStarted.pipe(Te(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){Pn(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(t){let r=t.rootElementSelector,n=t.freeDragPosition;r&&!r.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,n&&!n.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);let t=i._dragInstances.indexOf(this);t>-1&&i._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(t){let r=this._handles.getValue();r.push(t),this._handles.next(r)}_removeHandle(t){let r=this._handles.getValue(),n=r.indexOf(t);n>-1&&(r.splice(n,1),this._handles.next(r))}_setPreviewTemplate(t){this._previewTemplate=t}_resetPreviewTemplate(t){t===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(t){this._placeholderTemplate=t}_resetPlaceholderTemplate(t){t===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let t=this.element.nativeElement,r=t;this.rootElementSelector&&(r=t.closest!==void 0?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(r||t)}_getBoundaryElement(){let t=this.boundaryElement;return t?typeof t=="string"?this.element.nativeElement.closest(t):Qe(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){let r=this._dir,n=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,o=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.scale=this.scale,t.dragStartDelay=typeof n=="object"&&n?n:Tn(n),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(o).withPreviewContainer(this.previewContainer||"global"),r&&t.withDirection(r.value)}}),t.beforeStarted.pipe(Rs(1)).subscribe(()=>{if(this._parentDrag){t.withParent(this._parentDrag._dragRef);return}let r=this.element.nativeElement.parentElement;for(;r;){if(r.classList.contains(Bk)){t.withParent(i._dragInstances.find(n=>n.element.nativeElement===r)?._dragRef||null);break}r=r.parentElement}})}_handleEvents(t){t.started.subscribe(r=>{this.started.emit({source:this,event:r.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(r=>{this.released.emit({source:this,event:r.event})}),t.ended.subscribe(r=>{this.ended.emit({source:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(r=>{this.entered.emit({container:r.container.data,item:this,currentIndex:r.currentIndex})}),t.exited.subscribe(r=>{this.exited.emit({container:r.container.data,item:this})}),t.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,isPointerOverContainer:r.isPointerOverContainer,item:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event})})}_assignDefaults(t){let{lockAxis:r,dragStartDelay:n,constrainPosition:s,previewClass:o,boundaryElement:a,draggingDisabled:c,rootElementSelector:l,previewContainer:u}=t;this.disabled=c??!1,this.dragStartDelay=n||0,r&&(this.lockAxis=r),s&&(this.constrainPosition=s),o&&(this.previewClass=o),a&&(this.boundaryElement=a),l&&(this.rootElementSelector=l),u&&(this.previewContainer=u)}_setupHandlesListener(){this._handles.pipe(Xi(t=>{let r=t.map(n=>n.element);this._selfHandle&&this.rootElementSelector&&r.push(this.element),this._dragRef.withHandles(r)}),Ji(t=>Sn(...t.map(r=>r._stateChanges.pipe(hv(r))))),Te(this._destroyed)).subscribe(t=>{let r=this._dragRef,n=t.element.nativeElement;t.disabled?r.disableHandle(n):r.enableHandle(n)})}static{this.\u0275fac=function(r){return new(r||i)(V(_e),V(Wk,12),V(Pe),V(xe),V(As),V(Fk,8),V(Bs,8),V(qk),V(Ms),V(AP,10),V(Av,12))}}static{this.\u0275dir=Xt({type:i,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(r,n){r&2&&zr("cdk-drag-disabled",n.disabled)("cdk-drag-dragging",n._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",ks],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",Rw]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[xs([{provide:Av,useExisting:i}]),wn,sa]})}}return i})();function ft(i,e,t,r){return new(t||(t=Promise))(function(n,s){function o(l){try{c(r.next(l))}catch(u){s(u)}}function a(l){try{c(r.throw(l))}catch(u){s(u)}}function c(l){var u;l.done?n(l.value):(u=l.value,u instanceof t?u:new t(function(h){h(u)})).then(o,a)}c((r=r.apply(i,e||[])).next())})}var xn=class{constructor(){this.listeners={}}on(e,t,r){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),r?.once){let n=()=>{this.un(e,n),this.un(e,t)};return this.on(e,n),n}return()=>this.un(e,t)}un(e,t){var r;(r=this.listeners[e])===null||r===void 0||r.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(r=>r(...t))}},xP={decode:function(i,e){return ft(this,void 0,void 0,function*(){let t=new AudioContext({sampleRate:e});return t.decodeAudioData(i).finally(()=>t.close())})},createBuffer:function(i,e){return typeof i[0]=="number"&&(i=[i]),function(t){let r=t[0];if(r.some(n=>n>1||n<-1)){let n=r.length,s=0;for(let o=0;o<n;o++){let a=Math.abs(r[o]);a>s&&(s=a)}for(let o of t)for(let a=0;a<n;a++)o[a]/=s}}(i),{duration:e,length:i[0].length,sampleRate:i[0].length/e,numberOfChannels:i.length,getChannelData:t=>i?.[t],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function kP(i,e){let t=e.xmlns?document.createElementNS(e.xmlns,i):document.createElement(i);for(let[r,n]of Object.entries(e))if(r==="children")for(let[s,o]of Object.entries(e))typeof o=="string"?t.appendChild(document.createTextNode(o)):t.appendChild(kP(s,o));else r==="style"?Object.assign(t.style,n):r==="textContent"?t.textContent=n:t.setAttribute(r,n.toString());return t}function MP(i,e,t){let r=kP(i,e||{});return t?.appendChild(r),r}var Hk=Object.freeze({__proto__:null,createElement:MP,default:MP}),Uk={fetchBlob:function(i,e,t){return ft(this,void 0,void 0,function*(){let r=yield fetch(i,t);if(r.status>=400)throw new Error(`Failed to fetch ${i}: ${r.status} (${r.statusText})`);return function(n,s){ft(this,void 0,void 0,function*(){if(!n.body||!n.headers)return;let o=n.body.getReader(),a=Number(n.headers.get("Content-Length"))||0,c=0,l=h=>ft(this,void 0,void 0,function*(){c+=h?.length||0;let d=Math.round(c/a*100);s(d)}),u=()=>ft(this,void 0,void 0,function*(){let h;try{h=yield o.read()}catch{return}h.done||(l(h.value),yield u())});u()})}(r.clone(),e),r.blob()})}},xv=class extends xn{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)},{once:!0})}onMediaEvent(e,t,r){return this.media.addEventListener(e,t,r),()=>this.media.removeEventListener(e,t,r)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){let e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,t){let r=this.getSrc();if(e&&r===e)return;this.revokeSrc();let n=t instanceof Blob&&(this.canPlayType(t.type)||!e)?URL.createObjectURL(t):e;try{this.media.src=n}catch{this.media.src=e}}destroy(){this.media.pause(),this.isExternalMedia||(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(e){this.media=e}play(){return ft(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=e}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,t){t!=null&&(this.media.preservesPitch=t),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}},ma=class i extends xn{constructor(e,t){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.subscriptions=[],this.options=e;let r=this.parentFromOptionsContainer(e.container);this.parent=r;let[n,s]=this.initHtml();r.appendChild(n),this.container=n,this.scrollContainer=s.querySelector(".scroll"),this.wrapper=s.querySelector(".wrapper"),this.canvasWrapper=s.querySelector(".canvases"),this.progressWrapper=s.querySelector(".progress"),this.cursor=s.querySelector(".cursor"),t&&s.appendChild(t),this.initEvents()}parentFromOptionsContainer(e){let t;if(typeof e=="string"?t=document.querySelector(e):e instanceof HTMLElement&&(t=e),!t)throw new Error("Container not found");return t}initEvents(){let e=t=>{let r=this.wrapper.getBoundingClientRect(),n=t.clientX-r.left,s=t.clientY-r.top;return[n/r.width,s/r.height]};if(this.wrapper.addEventListener("click",t=>{let[r,n]=e(t);this.emit("click",r,n)}),this.wrapper.addEventListener("dblclick",t=>{let[r,n]=e(t);this.emit("dblclick",r,n)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{let{scrollLeft:t,scrollWidth:r,clientWidth:n}=this.scrollContainer,s=t/r,o=(t+n)/r;this.emit("scroll",s,o,t,t+n)}),typeof ResizeObserver=="function"){let t=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{t().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){let e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender())}initDrag(){this.subscriptions.push(function(e,t,r,n,s=3,o=0,a=100){if(!e)return()=>{};let c=matchMedia("(pointer: coarse)").matches,l=()=>{},u=h=>{if(h.button!==o)return;h.preventDefault(),h.stopPropagation();let d=h.clientX,f=h.clientY,g=!1,m=Date.now(),y=O=>{if(O.preventDefault(),O.stopPropagation(),c&&Date.now()-m<a)return;let x=O.clientX,ie=O.clientY,G=x-d,ee=ie-f;if(g||Math.abs(G)>s||Math.abs(ee)>s){let de=e.getBoundingClientRect(),{left:Yt,top:Nt}=de;g||(r?.(d-Yt,f-Nt),g=!0),t(G,ee,x-Yt,ie-Nt),d=x,f=ie}},b=O=>{if(g){let x=O.clientX,ie=O.clientY,G=e.getBoundingClientRect(),{left:ee,top:de}=G;n?.(x-ee,ie-de)}l()},S=O=>{O.relatedTarget&&O.relatedTarget!==document.documentElement||b(O)},_=O=>{g&&(O.stopPropagation(),O.preventDefault())},P=O=>{g&&O.preventDefault()};document.addEventListener("pointermove",y),document.addEventListener("pointerup",b),document.addEventListener("pointerout",S),document.addEventListener("pointercancel",S),document.addEventListener("touchmove",P,{passive:!1}),document.addEventListener("click",_,{capture:!0}),l=()=>{document.removeEventListener("pointermove",y),document.removeEventListener("pointerup",b),document.removeEventListener("pointerout",S),document.removeEventListener("pointercancel",S),document.removeEventListener("touchmove",P),setTimeout(()=>{document.removeEventListener("click",_,{capture:!0})},10)}};return e.addEventListener("pointerdown",u),()=>{l(),e.removeEventListener("pointerdown",u)}}(this.wrapper,(e,t,r)=>{this.emit("drag",Math.max(0,Math.min(1,r/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))}))}getHeight(e,t){var r;let n=((r=this.audioData)===null||r===void 0?void 0:r.numberOfChannels)||1;if(e==null)return 128;if(!isNaN(Number(e)))return Number(e);if(e==="auto"){let s=this.parent.clientHeight||128;return t?.every(o=>!o.overlay)?s/n:s}return 128}initHtml(){let e=document.createElement("div"),t=e.attachShadow({mode:"open"}),r=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return t.innerHTML=`
      <style${r?` nonce="${r}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,t]}setOptions(e){if(this.options.container!==e.container){let t=this.parentFromOptionsContainer(e.container);t.appendChild(this.container),this.parent=t}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){let{scrollWidth:t}=this.scrollContainer,r=t*e;this.setScroll(r)}destroy(){var e,t;this.subscriptions.forEach(r=>r()),this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.unsubscribeOnScroll)===null||t===void 0||t.call(this)}createDelay(e=10){let t,r,n=()=>{t&&clearTimeout(t),r&&r()};return this.timeouts.push(n),()=>new Promise((s,o)=>{n(),r=o,t=setTimeout(()=>{t=void 0,r=void 0,s()},e)})}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";let t=document.createElement("canvas"),r=t.getContext("2d"),n=t.height*(window.devicePixelRatio||1),s=r.createLinearGradient(0,0,0,n),o=1/(e.length-1);return e.forEach((a,c)=>{let l=c*o;s.addColorStop(l,a)}),s}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(e,t,r,n){let s=e[0],o=e[1]||e[0],a=s.length,{width:c,height:l}=r.canvas,u=l/2,h=this.getPixelRatio(),d=t.barWidth?t.barWidth*h:1,f=t.barGap?t.barGap*h:t.barWidth?d/2:0,g=t.barRadius||0,m=c/(d+f)/a,y=g&&"roundRect"in r?"roundRect":"rect";r.beginPath();let b=0,S=0,_=0;for(let P=0;P<=a;P++){let O=Math.round(P*m);if(O>b){let G=Math.round(S*u*n),ee=G+Math.round(_*u*n)||1,de=u-G;t.barAlign==="top"?de=0:t.barAlign==="bottom"&&(de=l-ee),r[y](b*(d+f),de,d,ee,g),b=O,S=0,_=0}let x=Math.abs(s[P]||0),ie=Math.abs(o[P]||0);x>S&&(S=x),ie>_&&(_=ie)}r.fill(),r.closePath()}renderLineWaveform(e,t,r,n){let s=o=>{let a=e[o]||e[0],c=a.length,{height:l}=r.canvas,u=l/2,h=r.canvas.width/c;r.moveTo(0,u);let d=0,f=0;for(let g=0;g<=c;g++){let m=Math.round(g*h);if(m>d){let b=u+(Math.round(f*u*n)||1)*(o===0?-1:1);r.lineTo(d,b),d=m,f=0}let y=Math.abs(a[g]||0);y>f&&(f=y)}r.lineTo(d,u)};r.beginPath(),s(0),s(1),r.fill(),r.closePath()}renderWaveform(e,t,r){if(r.fillStyle=this.convertColorValues(t.waveColor),t.renderFunction)return void t.renderFunction(e,r);let n=t.barHeight||1;if(t.normalize){let s=Array.from(e[0]).reduce((o,a)=>Math.max(o,Math.abs(a)),0);n=s?1/s:1}t.barWidth||t.barGap||t.barAlign?this.renderBarWaveform(e,t,r,n):this.renderLineWaveform(e,t,r,n)}renderSingleCanvas(e,t,r,n,s,o,a){let c=this.getPixelRatio(),l=document.createElement("canvas");l.width=Math.round(r*c),l.height=Math.round(n*c),l.style.width=`${r}px`,l.style.height=`${n}px`,l.style.left=`${Math.round(s)}px`,o.appendChild(l);let u=l.getContext("2d");if(this.renderWaveform(e,t,u),l.width>0&&l.height>0){let h=l.cloneNode(),d=h.getContext("2d");d.drawImage(l,0,0),d.globalCompositeOperation="source-in",d.fillStyle=this.convertColorValues(t.progressColor),d.fillRect(0,0,l.width,l.height),a.appendChild(h)}}renderMultiCanvas(e,t,r,n,s,o){let a=this.getPixelRatio(),{clientWidth:c}=this.scrollContainer,l=r/a,u=Math.min(i.MAX_CANVAS_WIDTH,c,l),h={};if(t.barWidth||t.barGap){let y=t.barWidth||.5,b=y+(t.barGap||y/2);u%b!=0&&(u=Math.floor(u/b)*b)}let d=y=>{if(y<0||y>=f||h[y])return;h[y]=!0;let b=y*u,S=Math.min(l-b,u);if(S<=0)return;let _=e.map(P=>{let O=Math.floor(b/l*P.length),x=Math.floor((b+S)/l*P.length);return P.slice(O,x)});this.renderSingleCanvas(_,t,S,n,b,s,o)},f=Math.ceil(l/u);if(!this.isScrollable){for(let y=0;y<f;y++)d(y);return}let g=this.scrollContainer.scrollLeft/l,m=Math.floor(g*f);d(m-1),d(m),d(m+1),f>1&&(this.unsubscribeOnScroll=this.on("scroll",()=>{let{scrollLeft:y}=this.scrollContainer,b=Math.floor(y/l*f);Object.keys(h).length>i.MAX_NODES&&(s.innerHTML="",o.innerHTML="",h={}),d(b-1),d(b),d(b+1)}))}renderChannel(e,t,r,n){var{overlay:s}=t,o=function(u,h){var d={};for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&h.indexOf(f)<0&&(d[f]=u[f]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var g=0;for(f=Object.getOwnPropertySymbols(u);g<f.length;g++)h.indexOf(f[g])<0&&Object.prototype.propertyIsEnumerable.call(u,f[g])&&(d[f[g]]=u[f[g]])}return d}(t,["overlay"]);let a=document.createElement("div"),c=this.getHeight(o.height,o.splitChannels);a.style.height=`${c}px`,s&&n>0&&(a.style.marginTop=`-${c}px`),this.canvasWrapper.style.minHeight=`${c}px`,this.canvasWrapper.appendChild(a);let l=a.cloneNode();this.progressWrapper.appendChild(l),this.renderMultiCanvas(e,o,r,c,a,l)}render(e){return ft(this,void 0,void 0,function*(){var t;this.timeouts.forEach(c=>c()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);let r=this.getPixelRatio(),n=this.scrollContainer.clientWidth,s=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=s>n;let o=this.options.fillParent&&!this.isScrollable,a=(o?n:s)*r;if(this.wrapper.style.width=o?"100%":`${s}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let c=0;c<e.numberOfChannels;c++){let l=Object.assign(Object.assign({},this.options),(t=this.options.splitChannels)===null||t===void 0?void 0:t[c]);this.renderChannel([e.getChannelData(c)],l,a,c)}else{let c=[e.getChannelData(0)];e.numberOfChannels>1&&c.push(e.getChannelData(1)),this.renderChannel(c,this.options,a,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){var e;if((e=this.unsubscribeOnScroll)===null||e===void 0||e.call(this),delete this.unsubscribeOnScroll,!this.audioData)return;let{scrollWidth:t}=this.scrollContainer,{right:r}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&t!==this.scrollContainer.scrollWidth){let{right:n}=this.progressWrapper.getBoundingClientRect(),s=n-r;s*=2,s=s<0?Math.floor(s):Math.ceil(s),s/=2,this.scrollContainer.scrollLeft+=s}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,t=!1){let{scrollLeft:r,scrollWidth:n,clientWidth:s}=this.scrollContainer,o=e*n,a=r,c=r+s,l=s/2;if(this.isDragging)o+30>c?this.scrollContainer.scrollLeft+=30:o-30<a&&(this.scrollContainer.scrollLeft-=30);else{(o<a||o>c)&&(this.scrollContainer.scrollLeft=o-(this.options.autoCenter?l:0));let u=o-r-l;t&&this.options.autoCenter&&u>0&&(this.scrollContainer.scrollLeft+=Math.min(u,10))}{let u=this.scrollContainer.scrollLeft,h=u/n,d=(u+s)/n;this.emit("scroll",h,d,u,u+s)}}renderProgress(e,t){if(isNaN(e))return;let r=100*e;this.canvasWrapper.style.clipPath=`polygon(${r}% 0, 100% 0, 100% 100%, ${r}% 100%)`,this.progressWrapper.style.width=`${r}%`,this.cursor.style.left=`${r}%`,this.cursor.style.transform=`translateX(-${Math.round(r)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,t)}exportImage(e,t,r){return ft(this,void 0,void 0,function*(){let n=this.canvasWrapper.querySelectorAll("canvas");if(!n.length)throw new Error("No waveform data");if(r==="dataURL"){let s=Array.from(n).map(o=>o.toDataURL(e,t));return Promise.resolve(s)}return Promise.all(Array.from(n).map(s=>new Promise((o,a)=>{s.toBlob(c=>{c?o(c):a(new Error("Could not export image"))},e,t)})))})}};ma.MAX_CANVAS_WIDTH=8e3,ma.MAX_NODES=10;var Mv=class extends xn{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}},wl=class extends xn{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return ft(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(t=>{if(t.status>=400)throw new Error(`Failed to fetch ${e}: ${t.status} (${t.statusText})`);return t.arrayBuffer()}).then(t=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(t)).then(t=>{this.currentSrc===e&&(this.buffer=t,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var e;if(!this.paused)return;this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let t=this.playedDuration*this._playbackRate;t>=this.duration&&(t=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,t),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return ft(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){var t,r;let n=e-this.currentTime;(t=this.bufferNode)===null||t===void 0||t.stop(this.audioContext.currentTime+n),(r=this.bufferNode)===null||r===void 0||r.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(e){return ft(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){let t=!this.paused;t&&this._pause(),this.playedDuration=e/this._playbackRate,t&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,t;return(e=this._duration)!==null&&e!==void 0?e:((t=this.buffer)===null||t===void 0?void 0:t.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){let e=[];if(!this.buffer)return e;let t=this.buffer.numberOfChannels;for(let r=0;r<t;r++)e.push(this.buffer.getChannelData(r));return e}},Vk={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3},Ks=class i extends xv{static create(e){return new i(e)}constructor(e){let t=e.media||(e.backend==="WebAudio"?new wl:void 0);super({media:t,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},Vk,e),this.timer=new Mv;let r=t?void 0:this.getMediaElement();this.renderer=new ma(this.options,r),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();let n=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");let{peaks:s,duration:o}=this.options;(n||s&&o)&&this.load(n,s,o).catch(()=>null)})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){let e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e)}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{let e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",e=>{this.emit("error",e.error)}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,t)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,t))}),this.renderer.on("dblclick",(e,t)=>{this.emit("dblclick",e,t)}),this.renderer.on("scroll",(e,t,r,n)=>{let s=this.getDuration();this.emit("scroll",e*s,t*s,r,n)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}));{let e;this.subscriptions.push(this.renderer.on("drag",t=>{if(!this.options.interact)return;let r;this.renderer.renderProgress(t),clearTimeout(e),this.isPlaying()?r=0:this.options.dragToSeek===!0?r=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(r=this.options.dragToSeek.debounceTime),e=setTimeout(()=>{this.seekTo(t)},r),this.emit("interaction",t*this.getDuration()),this.emit("drag",t)}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(t=>{this.registerPlugin(t)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){return e._init(this),this.plugins.push(e),this.subscriptions.push(e.once("destroy",()=>{this.plugins=this.plugins.filter(t=>t!==e)})),e}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){let t=e/this.getDuration();this.renderer.setScrollPercentage(t)}getActivePlugins(){return this.plugins}loadAudio(e,t,r,n){return ft(this,void 0,void 0,function*(){var s;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!t&&!r){let a=this.options.fetchParams||{};window.AbortController&&!a.signal&&(this.abortController=new AbortController,a.signal=(s=this.abortController)===null||s===void 0?void 0:s.signal);let c=l=>this.emit("loading",l);t=yield Uk.fetchBlob(e,c,a)}this.setSrc(e,t);let o=yield new Promise(a=>{let c=n||this.getDuration();c?a(c):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>a(this.getDuration()),{once:!0}))});if(!e&&!t){let a=this.getMediaElement();a instanceof wl&&(a.duration=o)}if(r)this.decodedData=xP.createBuffer(r,o||0);else if(t){let a=yield t.arrayBuffer();this.decodedData=yield xP.decode(a,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,t,r){return ft(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,t,r)}catch(n){throw this.emit("error",n),n}})}loadBlob(e,t,r){return ft(this,void 0,void 0,function*(){try{return yield this.loadAudio("",e,t,r)}catch(n){throw this.emit("error",n),n}})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:t=8e3,precision:r=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");let n=Math.min(e,this.decodedData.numberOfChannels),s=[];for(let o=0;o<n;o++){let a=this.decodedData.getChannelData(o),c=[],l=a.length/t;for(let u=0;u<t;u++){let h=a.slice(Math.floor(u*l),Math.ceil((u+1)*l)),d=0;for(let f=0;f<h.length;f++){let g=h[f];Math.abs(g)>Math.abs(d)&&(d=g)}c.push(Math.round(d*r)/r)}s.push(c)}return s}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){let t=this.getDuration()*e;this.setTime(t)}playPause(){return ft(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return ft(this,arguments,void 0,function*(e="image/png",t=1,r="dataURL"){return this.renderer.exportImage(e,t,r)})}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach(t=>t.destroy()),this.subscriptions.forEach(t=>t()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}};Ks.BasePlugin=class extends xn{constructor(i){super(),this.subscriptions=[],this.options=i}onInit(){}_init(i){this.wavesurfer=i,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(i=>i())}},Ks.dom=Hk;function kv(i,e,t,r){return new(t||(t=Promise))(function(n,s){function o(l){try{c(r.next(l))}catch(u){s(u)}}function a(l){try{c(r.throw(l))}catch(u){s(u)}}function c(l){var u;l.done?n(l.value):(u=l.value,u instanceof t?u:new t(function(h){h(u)})).then(o,a)}c((r=r.apply(i,e||[])).next())})}var Pl=class{constructor(){this.listeners={}}on(e,t,r){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),r?.once){let n=()=>{this.un(e,n),this.un(e,t)};return this.on(e,n),n}return()=>this.un(e,t)}un(e,t){var r;(r=this.listeners[e])===null||r===void 0||r.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(r=>r(...t))}},Nv=class extends Pl{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}},Lv=class extends Pl{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}},Kk=["audio/webm","audio/wav","audio/mpeg","audio/mp4","audio/mp3"],El=class i extends Nv{constructor(e){var t,r,n,s,o,a;super(Object.assign(Object.assign({},e),{audioBitsPerSecond:(t=e.audioBitsPerSecond)!==null&&t!==void 0?t:128e3,scrollingWaveform:(r=e.scrollingWaveform)!==null&&r!==void 0&&r,scrollingWaveformWindow:(n=e.scrollingWaveformWindow)!==null&&n!==void 0?n:5,continuousWaveform:(s=e.continuousWaveform)!==null&&s!==void 0&&s,renderRecordedAudio:(o=e.renderRecordedAudio)===null||o===void 0||o,mediaRecorderTimeslice:(a=e.mediaRecorderTimeslice)!==null&&a!==void 0?a:void 0})),this.stream=null,this.mediaRecorder=null,this.dataWindow=null,this.isWaveformPaused=!1,this.lastStartTime=0,this.lastDuration=0,this.duration=0,this.timer=new Lv,this.subscriptions.push(this.timer.on("tick",()=>{let c=performance.now()-this.lastStartTime;this.duration=this.isPaused()?this.duration:this.lastDuration+c,this.emit("record-progress",this.duration)}))}static create(e){return new i(e||{})}renderMicStream(e){var t;let r=new AudioContext,n=r.createMediaStreamSource(e),s=r.createAnalyser();n.connect(s),this.options.continuousWaveform&&(s.fftSize=32);let o=s.frequencyBinCount,a=new Float32Array(o),c=0;this.wavesurfer&&((t=this.originalOptions)!==null&&t!==void 0||(this.originalOptions=Object.assign({},this.wavesurfer.options)),this.wavesurfer.options.interact=!1,this.options.scrollingWaveform&&(this.wavesurfer.options.cursorWidth=0));let l=setInterval(()=>{var u,h,d,f;if(!this.isWaveformPaused){if(s.getFloatTimeDomainData(a),this.options.scrollingWaveform){let g=Math.floor((this.options.scrollingWaveformWindow||0)*r.sampleRate),m=Math.min(g,this.dataWindow?this.dataWindow.length+o:o),y=new Float32Array(g);if(this.dataWindow){let b=Math.max(0,g-this.dataWindow.length);y.set(this.dataWindow.slice(-m+o),b)}y.set(a,g-o),this.dataWindow=y}else if(this.options.continuousWaveform){if(!this.dataWindow){let m=this.options.continuousWaveformDuration?Math.round(100*this.options.continuousWaveformDuration):((h=(u=this.wavesurfer)===null||u===void 0?void 0:u.getWidth())!==null&&h!==void 0?h:0)*window.devicePixelRatio;this.dataWindow=new Float32Array(m)}let g=0;for(let m=0;m<o;m++){let y=Math.abs(a[m]);y>g&&(g=y)}if(c+1>this.dataWindow.length){let m=new Float32Array(2*this.dataWindow.length);m.set(this.dataWindow,0),this.dataWindow=m}this.dataWindow[c]=g,c++}else this.dataWindow=a;if(this.wavesurfer){let g=((f=(d=this.dataWindow)===null||d===void 0?void 0:d.length)!==null&&f!==void 0?f:0)/100;this.wavesurfer.load("",[this.dataWindow],this.options.scrollingWaveform?this.options.scrollingWaveformWindow:g).then(()=>{this.wavesurfer&&this.options.continuousWaveform&&(this.wavesurfer.setTime(this.getDuration()/1e3),this.wavesurfer.options.minPxPerSec||this.wavesurfer.setOptions({minPxPerSec:this.wavesurfer.getWidth()/this.wavesurfer.getDuration()}))}).catch(m=>{console.error("Error rendering real-time recording data:",m)})}}},10);return{onDestroy:()=>{clearInterval(l),n?.disconnect(),r?.close()},onEnd:()=>{this.isWaveformPaused=!0,clearInterval(l),this.stopMic()}}}startMic(e){return kv(this,void 0,void 0,function*(){let t;try{t=yield navigator.mediaDevices.getUserMedia({audio:!e?.deviceId||{deviceId:e.deviceId}})}catch(s){throw new Error("Error accessing the microphone: "+s.message)}let{onDestroy:r,onEnd:n}=this.renderMicStream(t);return this.subscriptions.push(this.once("destroy",r)),this.subscriptions.push(this.once("record-end",n)),this.stream=t,t})}stopMic(){this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null,this.mediaRecorder=null)}startRecording(e){return kv(this,void 0,void 0,function*(){let t=this.stream||(yield this.startMic(e));this.dataWindow=null;let r=this.mediaRecorder||new MediaRecorder(t,{mimeType:this.options.mimeType||Kk.find(o=>MediaRecorder.isTypeSupported(o)),audioBitsPerSecond:this.options.audioBitsPerSecond});this.mediaRecorder=r,this.stopRecording();let n=[];r.ondataavailable=o=>{o.data.size>0&&n.push(o.data),this.emit("record-data-available",o.data)};let s=o=>{var a;let c=new Blob(n,{type:r.mimeType});this.emit(o,c),this.options.renderRecordedAudio&&(this.applyOriginalOptionsIfNeeded(),(a=this.wavesurfer)===null||a===void 0||a.load(URL.createObjectURL(c)))};r.onpause=()=>s("record-pause"),r.onstop=()=>s("record-end"),r.start(this.options.mediaRecorderTimeslice),this.lastStartTime=performance.now(),this.lastDuration=0,this.duration=0,this.isWaveformPaused=!1,this.timer.start(),this.emit("record-start")})}getDuration(){return this.duration}isRecording(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="recording"}isPaused(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="paused"}isActive(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)!=="inactive"}stopRecording(){var e;this.isActive()&&((e=this.mediaRecorder)===null||e===void 0||e.stop(),this.timer.stop())}pauseRecording(){var e,t;this.isRecording()&&(this.isWaveformPaused=!0,(e=this.mediaRecorder)===null||e===void 0||e.requestData(),(t=this.mediaRecorder)===null||t===void 0||t.pause(),this.timer.stop(),this.lastDuration=this.duration)}resumeRecording(){var e;this.isPaused()&&(this.isWaveformPaused=!1,(e=this.mediaRecorder)===null||e===void 0||e.resume(),this.timer.start(),this.lastStartTime=performance.now(),this.emit("record-resume"))}static getAvailableAudioDevices(){return kv(this,void 0,void 0,function*(){return navigator.mediaDevices.enumerateDevices().then(e=>e.filter(t=>t.kind==="audioinput"))})}destroy(){this.applyOriginalOptionsIfNeeded(),super.destroy(),this.stopRecording(),this.stopMic()}applyOriginalOptionsIfNeeded(){this.wavesurfer&&this.originalOptions&&(this.wavesurfer.setOptions(this.originalOptions),delete this.originalOptions)}};var $i=WM(wM());var Ti=function(i){return i[i.FADING_IN=0]="FADING_IN",i[i.VISIBLE=1]="VISIBLE",i[i.FADING_OUT=2]="FADING_OUT",i[i.HIDDEN=3]="HIDDEN",i}(Ti||{}),Zb=class{constructor(e,t,r,n=!1){this._renderer=e,this.element=t,this.config=r,this._animationForciblyDisabledThroughCss=n,this.state=Ti.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},PM=ti({passive:!0,capture:!0}),Qb=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let t=dt(e);t&&this._events.get(e.type)?.forEach((r,n)=>{(n===t||n.contains(t))&&r.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,r,n){let s=this._events.get(t);if(s){let o=s.get(r);o?o.add(n):s.set(r,new Set([n]))}else this._events.set(t,new Map([[r,new Set([n])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,PM)})}removeHandler(e,t,r){let n=this._events.get(e);if(!n)return;let s=n.get(t);s&&(s.delete(r),s.size===0&&n.delete(t),n.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,PM)))}},EM={enterDuration:225,exitDuration:150},zH=800,RM=ti({passive:!0,capture:!0}),IM=["mousedown","touchstart"],TM=["mouseup","mouseleave","touchend","touchcancel"],ew=class i{static{this._eventManager=new Qb}constructor(e,t,r,n){this._target=e,this._ngZone=t,this._platform=n,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,n.isBrowser&&(this._containerElement=Qe(r))}fadeInRipple(e,t,r={}){let n=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=se(se({},EM),r.animation);r.centered&&(e=n.left+n.width/2,t=n.top+n.height/2);let o=r.radius||qH(e,t,n),a=e-n.left,c=t-n.top,l=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=`${a-o}px`,u.style.top=`${c-o}px`,u.style.height=`${o*2}px`,u.style.width=`${o*2}px`,r.color!=null&&(u.style.backgroundColor=r.color),u.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(u);let h=window.getComputedStyle(u),d=h.transitionProperty,f=h.transitionDuration,g=d==="none"||f==="0s"||f==="0s, 0s"||n.width===0&&n.height===0,m=new Zb(this,u,r,g);u.style.transform="scale3d(1, 1, 1)",m.state=Ti.FADING_IN,r.persistent||(this._mostRecentTransientRipple=m);let y=null;return!g&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let b=()=>{y&&(y.fallbackTimer=null),clearTimeout(_),this._finishRippleTransition(m)},S=()=>this._destroyRipple(m),_=setTimeout(S,l+100);u.addEventListener("transitionend",b),u.addEventListener("transitioncancel",S),y={onTransitionEnd:b,onTransitionCancel:S,fallbackTimer:_}}),this._activeRipples.set(m,y),(g||!l)&&this._finishRippleTransition(m),m}fadeOutRipple(e){if(e.state===Ti.FADING_OUT||e.state===Ti.HIDDEN)return;let t=e.element,r=se(se({},EM),e.config.animation);t.style.transitionDuration=`${r.exitDuration}ms`,t.style.opacity="0",e.state=Ti.FADING_OUT,(e._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let t=Qe(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,IM.forEach(r=>{i._eventManager.addHandler(this._ngZone,r,t,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{TM.forEach(t=>{this._triggerElement.addEventListener(t,this,RM)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Ti.FADING_IN?this._startFadeOutTransition(e):e.state===Ti.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let t=e===this._mostRecentTransientRipple,{persistent:r}=e.config;e.state=Ti.VISIBLE,!r&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Ti.HIDDEN,t!==null&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel),t.fallbackTimer!==null&&clearTimeout(t.fallbackTimer)),e.element.remove()}_onMousedown(e){let t=da(e),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+zH;!this._target.rippleDisabled&&!t&&!r&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!fa(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let t=e.changedTouches;if(t)for(let r=0;r<t.length;r++)this.fadeInRipple(t[r].clientX,t[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let t=e.state===Ti.VISIBLE||e.config.terminateOnPointerUp&&e.state===Ti.FADING_IN;!e.config.persistent&&t&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(IM.forEach(t=>i._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(TM.forEach(t=>e.removeEventListener(t,this,RM)),this._pointerUpEventsRegistered=!1))}};function qH(i,e,t){let r=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),n=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(r*r+n*n)}var FH=new pt("mat-ripple-global-options"),AM=(()=>{class i{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,r,n,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new ew(this,r,t,n)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:se(se(se({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,r=0,n){return typeof t=="number"?this._rippleRenderer.fadeInRipple(t,r,se(se({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,se(se({},this.rippleConfig),t))}static{this.\u0275fac=function(r){return new(r||i)(V(_e),V(xe),V(et),V(FH,8),V(Ts,8))}}static{this.\u0275dir=Xt({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(r,n){r&2&&zr("mat-ripple-unbounded",n.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}}return i})();var Fc=class{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;e!=null&&(this._attachedHost=null,e.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},Bc=class extends Fc{constructor(e,t,r,n,s){super(),this.component=e,this.viewContainerRef=t,this.injector=r,this.componentFactoryResolver=n,this.projectableNodes=s}},tv=class extends Fc{constructor(e,t,r,n){super(),this.templateRef=e,this.viewContainerRef=t,this.context=r,this.injector=n}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}},tw=class extends Fc{constructor(e){super(),this.element=e instanceof _e?e.nativeElement:e}},iw=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){if(e instanceof Bc)return this._attachedPortal=e,this.attachComponentPortal(e);if(e instanceof tv)return this._attachedPortal=e,this.attachTemplatePortal(e);if(this.attachDomPortal&&e instanceof tw)return this._attachedPortal=e,this.attachDomPortal(e)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var iv=class extends iw{constructor(e,t,r,n,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=r,this._defaultInjector=n,this.attachDomPortal=o=>{this._document;let a=o.element;a.parentNode;let c=this._document.createComment("dom-portal");a.parentNode.insertBefore(c,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=s}attachComponentPortal(e){let r=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),n;return e.viewContainerRef?(n=e.viewContainerRef.createComponent(r,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>n.destroy())):(n=r.create(e.injector||this._defaultInjector||Zt.NULL),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),this._attachedPortal=e,n}attachTemplatePortal(e){let t=e.viewContainerRef,r=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return r.rootNodes.forEach(n=>this.outletElement.appendChild(n)),r.detectChanges(),this.setDisposeFn(()=>{let n=t.indexOf(r);n!==-1&&t.remove(n)}),this._attachedPortal=e,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}};var OM=Zw(),rw=class{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){let e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Me(-this._previousScrollPosition.left),e.style.top=Me(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let e=this._document.documentElement,t=this._document.body,r=e.style,n=t.style,s=r.scrollBehavior||"",o=n.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),OM&&(r.scrollBehavior=n.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),OM&&(r.scrollBehavior=s,n.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let t=this._document.body,r=this._viewportRuler.getViewportSize();return t.scrollHeight>r.height||t.scrollWidth>r.width}};var nw=class{constructor(e,t,r,n){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=r,this._config=n,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(this._scrollSubscription)return;let e=this._scrollDispatcher.scrolled(0).pipe(xi(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{let t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},rv=class{enable(){}disable(){}attach(){}};function sw(i,e){return e.some(t=>{let r=i.bottom<t.top,n=i.top>t.bottom,s=i.right<t.left,o=i.left>t.right;return r||n||s||o})}function DM(i,e){return e.some(t=>{let r=i.top<t.top,n=i.bottom>t.bottom,s=i.left<t.left,o=i.right>t.right;return r||n||s||o})}var ow=class{constructor(e,t,r,n){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=r,this._config=n,this._scrollSubscription=null}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(!this._scrollSubscription){let e=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(e).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:n}=this._viewportRuler.getViewportSize();sw(t,[{width:r,height:n,bottom:n,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},BH=(()=>{class i{constructor(t,r,n,s){this._scrollDispatcher=t,this._viewportRuler=r,this._ngZone=n,this.noop=()=>new rv,this.close=o=>new nw(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new rw(this._viewportRuler,this._document),this.reposition=o=>new ow(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}static{this.\u0275fac=function(r){return new(r||i)(A(Ws),A(Hs),A(xe),A(Pe))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),aw=class{constructor(e){if(this.scrollStrategy=new rv,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){let t=Object.keys(e);for(let r of t)e[r]!==void 0&&(this[r]=e[r])}}};var cw=class{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}};var jM=(()=>{class i{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){let r=this._attachedOverlays.indexOf(t);r>-1&&this._attachedOverlays.splice(r,1),this._attachedOverlays.length===0&&this.detach()}static{this.\u0275fac=function(r){return new(r||i)(A(Pe))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),WH=(()=>{class i extends jM{constructor(t,r){super(t),this._ngZone=r,this._keydownListener=n=>{let s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){let a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(n)):a.next(n);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static{this.\u0275fac=function(r){return new(r||i)(A(Pe),A(xe,8))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),HH=(()=>{class i extends jM{constructor(t,r,n){super(t),this._platform=r,this._ngZone=n,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=dt(s)},this._clickListener=s=>{let o=dt(s),a=s.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;let c=this._attachedOverlays.slice();for(let l=c.length-1;l>-1;l--){let u=c[l];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(xM(u.overlayElement,o)||xM(u.overlayElement,a))break;let h=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>h.next(s)):h.next(s)}}}add(t){if(super.add(t),!this._isAttached){let r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static{this.\u0275fac=function(r){return new(r||i)(A(Pe),A(et),A(xe,8))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function xM(i,e){let t=typeof ShadowRoot<"u"&&ShadowRoot,r=e;for(;r;){if(r===i)return!0;r=t&&r instanceof ShadowRoot?r.host:r.parentNode}return!1}var zM=(()=>{class i{constructor(t,r){this._platform=r,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let t="cdk-overlay-container";if(this._platform.isBrowser||hl()){let n=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<n.length;s++)n[s].remove()}let r=this._document.createElement("div");r.classList.add(t),hl()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}static{this.\u0275fac=function(r){return new(r||i)(A(Pe),A(et))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),lw=class{constructor(e,t,r,n,s,o,a,c,l,u=!1,h){this._portalOutlet=e,this._host=t,this._pane=r,this._config=n,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=c,this._outsideClickDispatcher=l,this._animationsDisabled=u,this._injector=h,this._backdropElement=null,this._backdropClick=new q,this._attachments=new q,this._detachments=new q,this._locationChanges=Di.EMPTY,this._backdropClickHandler=d=>this._backdropClick.next(d),this._backdropTransitionendHandler=d=>{this._disposeBackdrop(d.target)},this._keydownEvents=new q,this._outsidePointerEvents=new q,this._renders=new q,n.scrollStrategy&&(this._scrollStrategy=n.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=n.positionStrategy,this._afterRenderRef=Tw(()=>Cw(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=Pn(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof t?.onDestroy=="function"&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){let e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=se(se({},this._config),e),this._updateElementSize()}setDirection(e){this._config=ra(se({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){let e=this._config.direction;return e?typeof e=="string"?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let e=this._pane.style;e.width=Me(this._config.width),e.height=Me(this._config.height),e.minWidth=Me(this._config.minWidth),e.minHeight=Me(this._config.minHeight),e.maxWidth=Me(this._config.maxWidth),e.maxHeight=Me(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){let e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(e){if(this._animationsDisabled){this._disposeBackdrop(e);return}e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,r){let n=ul(t||[]).filter(s=>!!s);n.length&&(r?e.classList.add(...n):e.classList.remove(...n))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let e=this._renders.pipe(Te(Sn(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){let e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},MM="cdk-overlay-connected-position-bounding-box",UH=/([A-Za-z%]+)$/,uw=class{get positions(){return this._preferredPositions}constructor(e,t,r,n,s){this._viewportRuler=t,this._document=r,this._platform=n,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new q,this._resizeSubscription=Di.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._overlayRef&&this._overlayRef,this._validatePositions(),e.hostElement.classList.add(MM),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._originRect,t=this._overlayRect,r=this._viewportRect,n=this._containerRect,s=[],o;for(let a of this._preferredPositions){let c=this._getOriginPoint(e,n,a),l=this._getOverlayPoint(c,t,a),u=this._getOverlayFit(l,t,r,a);if(u.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(a,c);return}if(this._canFitWithFlexibleDimensions(u,l,r)){s.push({position:a,origin:c,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(c,a)});continue}(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:l,originPoint:c,position:a,overlayRect:t})}if(s.length){let a=null,c=-1;for(let l of s){let u=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);u>c&&(c=u,a=l)}this._isPushed=!1,this._applyPosition(a.position,a.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(o.position,o.originPoint);return}this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&ws(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(MM),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,e.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,r){let n;if(r.originX=="center")n=e.left+e.width/2;else{let o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;n=r.originX=="start"?o:a}t.left<0&&(n-=t.left);let s;return r.originY=="center"?s=e.top+e.height/2:s=r.originY=="top"?e.top:e.bottom,t.top<0&&(s-=t.top),{x:n,y:s}}_getOverlayPoint(e,t,r){let n;r.overlayX=="center"?n=-t.width/2:r.overlayX==="start"?n=this._isRtl()?-t.width:0:n=this._isRtl()?0:-t.width;let s;return r.overlayY=="center"?s=-t.height/2:s=r.overlayY=="top"?0:-t.height,{x:e.x+n,y:e.y+s}}_getOverlayFit(e,t,r,n){let s=NM(t),{x:o,y:a}=e,c=this._getOffset(n,"x"),l=this._getOffset(n,"y");c&&(o+=c),l&&(a+=l);let u=0-o,h=o+s.width-r.width,d=0-a,f=a+s.height-r.height,g=this._subtractOverflows(s.width,u,h),m=this._subtractOverflows(s.height,d,f),y=g*m;return{visibleArea:y,isCompletelyWithinViewport:s.width*s.height===y,fitsInViewportVertically:m===s.height,fitsInViewportHorizontally:g==s.width}}_canFitWithFlexibleDimensions(e,t,r){if(this._hasFlexibleDimensions){let n=r.bottom-t.y,s=r.right-t.x,o=kM(this._overlayRef.getConfig().minHeight),a=kM(this._overlayRef.getConfig().minWidth),c=e.fitsInViewportVertically||o!=null&&o<=n,l=e.fitsInViewportHorizontally||a!=null&&a<=s;return c&&l}return!1}_pushOverlayOnScreen(e,t,r){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};let n=NM(t),s=this._viewportRect,o=Math.max(e.x+n.width-s.width,0),a=Math.max(e.y+n.height-s.height,0),c=Math.max(s.top-r.top-e.y,0),l=Math.max(s.left-r.left-e.x,0),u=0,h=0;return n.width<=s.width?u=l||-o:u=e.x<this._viewportMargin?s.left-r.left-e.x:0,n.height<=s.height?h=c||-a:h=e.y<this._viewportMargin?s.top-r.top-e.y:0,this._previousPushAmount={x:u,y:h},{x:e.x+u,y:e.y+h}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){let r=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!VH(this._lastScrollVisibility,r)){let n=new cw(e,r);this._positionChanges.next(n)}this._lastScrollVisibility=r}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;let t=this._boundingBox.querySelectorAll(this._transformOriginSelector),r,n=e.overlayY;e.overlayX==="center"?r="center":this._isRtl()?r=e.overlayX==="start"?"right":"left":r=e.overlayX==="start"?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${r} ${n}`}_calculateBoundingBoxRect(e,t){let r=this._viewportRect,n=this._isRtl(),s,o,a;if(t.overlayY==="top")o=e.y,s=r.height-o+this._viewportMargin;else if(t.overlayY==="bottom")a=r.height-e.y+this._viewportMargin*2,s=r.height-a+this._viewportMargin;else{let f=Math.min(r.bottom-e.y+r.top,e.y),g=this._lastBoundingBoxSize.height;s=f*2,o=e.y-f,s>g&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-g/2)}let c=t.overlayX==="start"&&!n||t.overlayX==="end"&&n,l=t.overlayX==="end"&&!n||t.overlayX==="start"&&n,u,h,d;if(l)d=r.width-e.x+this._viewportMargin*2,u=e.x-this._viewportMargin;else if(c)h=e.x,u=r.right-e.x;else{let f=Math.min(r.right-e.x+r.left,e.x),g=this._lastBoundingBoxSize.width;u=f*2,h=e.x-f,u>g&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.x-g/2)}return{top:o,left:h,bottom:a,right:d,width:u,height:s}}_setBoundingBoxStyles(e,t){let r=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));let n={};if(this._hasExactPosition())n.top=n.left="0",n.bottom=n.right=n.maxHeight=n.maxWidth="",n.width=n.height="100%";else{let s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;n.height=Me(r.height),n.top=Me(r.top),n.bottom=Me(r.bottom),n.width=Me(r.width),n.left=Me(r.left),n.right=Me(r.right),t.overlayX==="center"?n.alignItems="center":n.alignItems=t.overlayX==="end"?"flex-end":"flex-start",t.overlayY==="center"?n.justifyContent="center":n.justifyContent=t.overlayY==="bottom"?"flex-end":"flex-start",s&&(n.maxHeight=Me(s)),o&&(n.maxWidth=Me(o))}this._lastBoundingBoxSize=r,ws(this._boundingBox.style,n)}_resetBoundingBoxStyles(){ws(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){ws(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){let r={},n=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(n){let u=this._viewportRuler.getViewportScrollPosition();ws(r,this._getExactOverlayY(t,e,u)),ws(r,this._getExactOverlayX(t,e,u))}else r.position="static";let a="",c=this._getOffset(t,"x"),l=this._getOffset(t,"y");c&&(a+=`translateX(${c}px) `),l&&(a+=`translateY(${l}px)`),r.transform=a.trim(),o.maxHeight&&(n?r.maxHeight=Me(o.maxHeight):s&&(r.maxHeight="")),o.maxWidth&&(n?r.maxWidth=Me(o.maxWidth):s&&(r.maxWidth="")),ws(this._pane.style,r)}_getExactOverlayY(e,t,r){let n={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);if(this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,r)),e.overlayY==="bottom"){let o=this._document.documentElement.clientHeight;n.bottom=`${o-(s.y+this._overlayRect.height)}px`}else n.top=Me(s.y);return n}_getExactOverlayX(e,t,r){let n={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,r));let o;if(this._isRtl()?o=e.overlayX==="end"?"left":"right":o=e.overlayX==="end"?"right":"left",o==="right"){let a=this._document.documentElement.clientWidth;n.right=`${a-(s.x+this._overlayRect.width)}px`}else n.left=Me(s.x);return n}_getScrollVisibility(){let e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),r=this._scrollables.map(n=>n.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:DM(e,r),isOriginOutsideView:sw(e,r),isOverlayClipped:DM(t,r),isOverlayOutsideView:sw(t,r)}}_subtractOverflows(e,...t){return t.reduce((r,n)=>r-Math.max(n,0),e)}_getNarrowedViewportRect(){let e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+e-this._viewportMargin,bottom:r.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return t==="x"?e.offsetX==null?this._offsetX:e.offsetX:e.offsetY==null?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&ul(e).forEach(t=>{t!==""&&this._appliedPanelClasses.indexOf(t)===-1&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){let e=this._origin;if(e instanceof _e)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();let t=e.width||0,r=e.height||0;return{top:e.y,bottom:e.y+r,left:e.x,right:e.x+t,height:r,width:t}}};function ws(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function kM(i){if(typeof i!="number"&&i!=null){let[e,t]=i.split(UH);return!t||t==="px"?parseFloat(e):null}return i||null}function NM(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}function VH(i,e){return i===e?!0:i.isOriginClipped===e.isOriginClipped&&i.isOriginOutsideView===e.isOriginOutsideView&&i.isOverlayClipped===e.isOverlayClipped&&i.isOverlayOutsideView===e.isOverlayOutsideView}var LM="cdk-global-overlay-wrapper",hw=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){let t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(LM),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:n,height:s,maxWidth:o,maxHeight:a}=r,c=(n==="100%"||n==="100vw")&&(!o||o==="100%"||o==="100vw"),l=(s==="100%"||s==="100vh")&&(!a||a==="100%"||a==="100vh"),u=this._xPosition,h=this._xOffset,d=this._overlayRef.getConfig().direction==="rtl",f="",g="",m="";c?m="flex-start":u==="center"?(m="center",d?g=h:f=h):d?u==="left"||u==="end"?(m="flex-end",f=h):(u==="right"||u==="start")&&(m="flex-start",g=h):u==="left"||u==="start"?(m="flex-start",f=h):(u==="right"||u==="end")&&(m="flex-end",g=h),e.position=this._cssPosition,e.marginLeft=c?"0":f,e.marginTop=l?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=c?"0":g,t.justifyContent=m,t.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,r=t.style;t.classList.remove(LM),r.justifyContent=r.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}},KH=(()=>{class i{constructor(t,r,n,s){this._viewportRuler=t,this._document=r,this._platform=n,this._overlayContainer=s}global(){return new hw}flexibleConnectedTo(t){return new uw(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static{this.\u0275fac=function(r){return new(r||i)(A(Hs),A(Pe),A(et),A(zM))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),$H=0,nv=(()=>{class i{constructor(t,r,n,s,o,a,c,l,u,h,d,f){this.scrollStrategies=t,this._overlayContainer=r,this._componentFactoryResolver=n,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=c,this._document=l,this._directionality=u,this._location=h,this._outsideClickDispatcher=d,this._animationsModuleType=f}create(t){let r=this._createHostElement(),n=this._createPaneElement(r),s=this._createPortalOutlet(n),o=new aw(t);return o.direction=o.direction||this._directionality.value,new lw(s,r,n,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(Vc))}position(){return this._positionBuilder}_createPaneElement(t){let r=this._document.createElement("div");return r.id=`cdk-overlay-${$H++}`,r.classList.add("cdk-overlay-pane"),t.appendChild(r),r}_createHostElement(){let t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(Xc)),new iv(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static{this.\u0275fac=function(r){return new(r||i)(A(BH),A(zM),A(Sw),A(KH),A(WH),A(Zt),A(xe),A(Pe),A(Bs),A(Ow),A(HH),A(Ts,8))}}static{this.\u0275prov=ve({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var JH=["tooltip"],XH=20;var ZH=new pt("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let i=re(nv);return()=>i.scrollStrategies.reposition({scrollThrottle:XH})}});function QH(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var eU=new pt("mat-tooltip-default-options",{providedIn:"root",factory:QH});var qM="tooltip-panel",FM=ti({passive:!0}),tU=8,iU=8,rU=24,nU=200,BM=(()=>{class i{get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=ll(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){let r=ll(t);this._disabled!==r&&(this._disabled=r,r?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=Tn(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=Tn(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(t){let r=this._message;this._message=t!=null?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(r)}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(t,r,n,s,o,a,c,l,u,h,d,f){this._overlay=t,this._elementRef=r,this._scrollDispatcher=n,this._viewContainerRef=s,this._ngZone=o,this._platform=a,this._ariaDescriber=c,this._focusMonitor=l,this._dir=h,this._defaultOptions=d,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._tooltipComponent=sU,this._viewportMargin=8,this._cssClassPrefix="mat-mdc",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._touchstartTimeout=null,this._destroyed=new q,this._injector=re(Zt),this._scrollStrategy=u,this._document=f,d&&(this._showDelay=d.showDelay,this._hideDelay=d.hideDelay,d.position&&(this.position=d.position),d.positionAtOrigin&&(this.positionAtOrigin=d.positionAtOrigin),d.touchGestures&&(this.touchGestures=d.touchGestures),d.tooltipClass&&(this.tooltipClass=d.tooltipClass)),h.change.pipe(Te(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=tU}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Te(this._destroyed)).subscribe(t=>{t?t==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let t=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([r,n])=>{t.removeEventListener(r,n,FM)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,r){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let n=this._createOverlay(r);this._detach(),this._portal=this._portal||new Bc(this._tooltipComponent,this._viewContainerRef);let s=this._tooltipInstance=n.attach(this._portal).instance;s._triggerElement=this._elementRef.nativeElement,s._mouseLeaveHideDelay=this._hideDelay,s.afterHidden().pipe(Te(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),s.show(t)}hide(t=this.hideDelay){let r=this._tooltipInstance;r&&(r.isVisible()?r.hide(t):(r._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){let s=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&s._origin instanceof _e)return this._overlayRef;this._detach()}let r=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),n=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin?t||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(r);return n.positionChanges.pipe(Te(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:n,panelClass:`${this._cssClassPrefix}-${qM}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Te(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Te(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Te(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&s.keyCode===27&&!tP(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){let r=t.getConfig().positionStrategy,n=this._getOrigin(),s=this._getOverlayPosition();r.withPositions([this._addOffset(se(se({},n.main),s.main)),this._addOffset(se(se({},n.fallback),s.fallback))])}_addOffset(t){let r=iU,n=!this._dir||this._dir.value=="ltr";return t.originY==="top"?t.offsetY=-r:t.originY==="bottom"?t.offsetY=r:t.originX==="start"?t.offsetX=n?-r:r:t.originX==="end"&&(t.offsetX=n?r:-r),t}_getOrigin(){let t=!this._dir||this._dir.value=="ltr",r=this.position,n;r=="above"||r=="below"?n={originX:"center",originY:r=="above"?"top":"bottom"}:r=="before"||r=="left"&&t||r=="right"&&!t?n={originX:"start",originY:"center"}:(r=="after"||r=="right"&&t||r=="left"&&!t)&&(n={originX:"end",originY:"center"});let{x:s,y:o}=this._invertPosition(n.originX,n.originY);return{main:n,fallback:{originX:s,originY:o}}}_getOverlayPosition(){let t=!this._dir||this._dir.value=="ltr",r=this.position,n;r=="above"?n={overlayX:"center",overlayY:"bottom"}:r=="below"?n={overlayX:"center",overlayY:"top"}:r=="before"||r=="left"&&t||r=="right"&&!t?n={overlayX:"end",overlayY:"center"}:(r=="after"||r=="right"&&t||r=="left"&&!t)&&(n={overlayX:"start",overlayY:"center"});let{x:s,y:o}=this._invertPosition(n.overlayX,n.overlayY);return{main:n,fallback:{overlayX:s,overlayY:o}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),Pn(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,r){return this.position==="above"||this.position==="below"?r==="top"?r="bottom":r==="bottom"&&(r="top"):t==="end"?t="start":t==="start"&&(t="end"),{x:t,y:r}}_updateCurrentPositionClass(t){let{overlayY:r,originX:n,originY:s}=t,o;if(r==="center"?this._dir&&this._dir.value==="rtl"?o=n==="end"?"left":"right":o=n==="start"?"left":"right":o=r==="bottom"&&s==="top"?"above":"below",o!==this._currentPosition){let a=this._overlayRef;if(a){let c=`${this._cssClassPrefix}-${qM}-`;a.removePanelClass(c+this._currentPosition),a.addPanelClass(c+o)}this._currentPosition=o}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{this._setupPointerExitEventsIfNeeded();let r;t.x!==void 0&&t.y!==void 0&&(r=t),this.show(void 0,r)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{let r=t.targetTouches?.[0],n=r?{x:r.clientX,y:r.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let s=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,n)},this._defaultOptions.touchLongPressShowDelay??s)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",r=>{let n=r.relatedTarget;(!n||!this._overlayRef?.overlayElement.contains(n))&&this.hide()}],["wheel",r=>this._wheelListener(r)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let r=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};t.push(["touchend",r],["touchcancel",r])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([r,n])=>{this._elementRef.nativeElement.addEventListener(r,n,FM)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){let r=this._document.elementFromPoint(t.clientX,t.clientY),n=this._elementRef.nativeElement;r!==n&&!n.contains(r)&&this.hide()}}_disableNativeGesturesIfNecessary(){let t=this.touchGestures;if(t!=="off"){let r=this._elementRef.nativeElement,n=r.style;(t==="on"||r.nodeName!=="INPUT"&&r.nodeName!=="TEXTAREA")&&(n.userSelect=n.msUserSelect=n.webkitUserSelect=n.MozUserSelect="none"),(t==="on"||!r.draggable)&&(n.webkitUserDrag="none"),n.touchAction="none",n.webkitTapHighlightColor="transparent"}}_syncAriaDescription(t){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,t,"tooltip"),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}static{this.\u0275fac=function(r){return new(r||i)(V(nv),V(_e),V(Ws),V(As),V(xe),V(et),V(sP),V(aP),V(ZH),V(Bs),V(eU,8),V(Pe))}}static{this.\u0275dir=Xt({type:i,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(r,n){r&2&&zr("mat-mdc-tooltip-disabled",n.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"],standalone:!0})}}return i})(),sU=(()=>{class i{constructor(t,r,n){this._changeDetectorRef=t,this._elementRef=r,this._isMultiline=!1,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new q,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide",this._animationsDisabled=n==="NoopAnimations"}show(t){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>rU&&t.width>=nU}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){let r=this._tooltip.nativeElement,n=this._showAnimation,s=this._hideAnimation;if(r.classList.remove(t?s:n),r.classList.add(t?n:s),this._isVisible!==t&&(this._isVisible=t,this._changeDetectorRef.markForCheck()),t&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let o=getComputedStyle(r);(o.getPropertyValue("animation-duration")==="0s"||o.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(r.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}static{this.\u0275fac=function(r){return new(r||i)(V(Ms),V(_e),V(Ts,8))}}static{this.\u0275cmp=Lt({type:i,selectors:[["mat-tooltip-component"]],viewQuery:function(r,n){if(r&1&&$c(JH,7),r&2){let s;Gc(s=Yc())&&(n._tooltip=s.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(r,n){r&1&&Ze("mouseleave",function(o){return n._handleMouseLeave(o)})},standalone:!0,features:[qt],decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(r,n){if(r&1){let s=Zi();L(0,"div",1,0),Ze("animationend",function(a){return Je(s),Xe(n._handleAnimationEnd(a))}),L(2,"div",2),we(3),H()()}r&2&&(zr("mdc-tooltip--multiline",n._isMultiline),ge("ngClass",n.tooltipClass),F(3),zt(n.message))},dependencies:[qr],styles:['.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-app-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-app-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-app-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-app-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-app-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-app-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-app-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-app-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}}return i})();var oU=["waves"],aU=i=>({"!-right-14":i}),cU=(i,e)=>({"bg-red-500":i,"bg-green-500":e}),lU=i=>({hidden:i}),uU=i=>({"translate-x-full":i}),hU=(i,e)=>({"bg-green-700":i,"bg-red-600":e});function pU(i,e){if(i&1&&(L(0,"span",12),we(1),H()),i&2){let t=jt();F(),zt(t.loading)}}function dU(i,e){if(i&1&&(L(0,"span",13),we(1),H()),i&2){let t=jt();F(),zt(t.clickToSpeech)}}function fU(i,e){if(i&1&&(L(0,"span",12),we(1),H()),i&2){let t=jt();F(),zt(t.listeningOngoing)}}function vU(i,e){if(i&1&&(L(0,"span",12),we(1),H()),i&2){let t=jt();F(),zt(t.clickToSend)}}function gU(i,e){if(i&1&&(L(0,"button",32)(1,"div",37)(2,"span"),we(3),H()()()),i&2){let t=jt();F(3),zt(t.avatarVideoComponent().onlineStatus())}}function mU(i,e){if(i&1){let t=Zi();L(0,"button",38),Ze("click",function(){Je(t);let n=jt();return Xe(n.toggleStream())}),we(1),H()}if(i&2){let t=jt();ge("ngClass",aa(2,hU,t.store.isStreamStarted(),t.store.isStreamStopped())),F(),In(" ",t.avatarVideoComponent().onlineStatus()," ")}}var sv=class i extends tl(class{}){avatarVideoComponent=dv.required();overlayChatComponent=dv.required();waves=bn.required("waves");store=re(Fr);chatService=re(qs);avatarService=re(Zc);injector=re(Zt);fullscreen=pv();recognizedText=Qt("");recognizingText=Qt("");speechService=re(zw);recognizing$=pv();recognized$=new q;accept$=new q;recognizingStatus=Qt(!1);clickToSpeech="\u0627\u0636\u063A\u0637 \u0644\u0644\u062A\u062D\u062F\u062B";loading="\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644";listeningOngoing="\u062C\u0627\u0631\u0649 \u0627\u0644\u0627\u0633\u062A\u0645\u0627\u0639";clickToSend="\u0623\u0636\u063A\u0637 \u0644\u0644\u0623\u0631\u0633\u0627\u0644";settingsOpened=!1;lang={cancel_recording:"\u0627\u0644\u063A\u0627\u0621 \u0627\u0644\u062A\u0633\u062C\u064A\u0644",clear_chat_history:"\u0645\u0633\u062D \u0633\u062C\u0644 \u0627\u0644\u0645\u062D\u0627\u062F\u062B\u0629",stop_talking:"\u062A\u0648\u0642\u0641 \u0639\u0646 \u0627\u0644\u062D\u062F\u064A\u062B",settings:"\u0627\u0644\u0627\u0639\u062F\u0627\u062F\u0627\u062A"};ngOnInit(){return v(this,null,function*(){this.listenToAccept(),yield this.prepareRecorder()})}prepareRecorder(){return v(this,null,function*(){this.recordingStream=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!1}),this.waveSurfer=new Ks({waveColor:"white",progressColor:"white",container:this.waves().nativeElement,height:"auto"}),this.recorder=this.waveSurfer.registerPlugin(El.create({scrollingWaveform:!1})),this.recorder.renderMicStream(this.recordingStream);let e=$i.AudioConfig.fromDefaultMicrophoneInput(),t=$i.AutoDetectSourceLanguageConfig.fromLanguages(["ar-QA","en-US"]);this.recognizer=$i.SpeechRecognizer.FromConfig($i.SpeechConfig.fromAuthorizationToken(this.store.speechToken.token(),this.store.speechToken.region()),t,e),this.recognizer.recognizing=(r,n)=>{n.result.reason===$i.ResultReason.RecognizingSpeech&&(this.recognizingText.set(this.recognizedText()+" "+n.result.text),this.recognizing$.emit(this.recognizingText()),this.recognizingStatus.set(!0))},this.recognizer.recognized=(r,n)=>{n.result.reason===$i.ResultReason.RecognizedSpeech&&this.store.isRecordingStarted()&&(this.recognizedText.update(s=>s+" "+n.result.text),this.recognized$.next(),this.recognizingStatus.set(!1))},this.recognizer.canceled=()=>{this.store.recordingInProgress(),this.speechService.generateSpeechToken().pipe(Rs(1)).subscribe(()=>{this.prepareRecorder().then(()=>this.startRecording())})}})}startRecording(){this.store.recordingInProgress(),this.recognizer.startContinuousRecognitionAsync(()=>{this.recognizer.internalData.privConnectionPromise.__zone_symbol__state===!0&&this.store.recordingStarted(),this.recognizingStatus.set(!0)})}stopRecording(){this.recognizer.stopContinuousRecognitionAsync(()=>{this.store.recordingStopped()})}toggleRecording(){this.store.isRecordingLoading()||(this.store.isRecordingStarted()?this.acceptText():this.startRecording())}acceptText(){this.accept$.next()}rejectText(){this.recognizingText.set(""),this.recognizedText.set(""),this.recognizing$.emit(""),this.recognizingStatus.set(!1),this.stopRecording()}goToEndOfChat(){setTimeout(()=>{let e=this.overlayChatComponent().container().nativeElement.querySelectorAll(".user");e[e.length-1].scrollIntoView(!0)},100)}listenToAccept(){this.accept$.pipe(Yi(()=>this.recognizedText())).pipe(xi(e=>!!e)).pipe(Te(this.destroy$)).pipe(Xi(()=>{this.recognizedText.set(""),this.recognizingText.set(""),this.recognizingStatus.set(!1),this.recognizing$.emit(""),this.stopRecording()})).pipe(Xi(()=>this.goToEndOfChat())).pipe(Uc(e=>this.chatService.sendMessage(e))).pipe(vw(200)).subscribe(()=>{let e=this.overlayChatComponent().container().nativeElement.querySelectorAll(".assistant"),t=setInterval(()=>e[e.length-1].scrollIntoView(!1),200),r=ca(()=>{this.overlayChatComponent().animationStatus()||(clearInterval(t),r.destroy())},{injector:this.injector})})}clearChat(){this.chatService.messages.set([])}interruptAvatar(){this.avatarService.interruptAvatar().pipe(Rs(1)).subscribe()}toggleStream(){this.store.isStreamLoading()||(this.store.isStreamStopped()?this.avatarVideoComponent().start$.next():this.avatarVideoComponent().stop$.next())}toggleSettings(){this.settingsOpened=!this.settingsOpened}static \u0275fac=(()=>{let e;return function(r){return(e||(e=Kc(i)))(r||i)}})();static \u0275cmp=Lt({type:i,selectors:[["app-screen-control"]],viewQuery:function(t,r){t&1&&Rn(r.waves,oU,5),t&2&&Os()},inputs:{avatarVideoComponent:[1,"avatarVideoComponent"],overlayChatComponent:[1,"overlayChatComponent"]},outputs:{fullscreen:"fullscreen",recognizing$:"recognizing$"},standalone:!0,features:[oa,qt],decls:51,vars:24,consts:[["waves",""],["id","toolbar","cdkDrag","",1,"w-20","relative","flex","justify-center","items-start","text-white","flex-col","rounded-md","p-2","pt-36","bg-black/50"],["cdkDragHandle",""],["width","24px","fill","currentColor","viewBox","0 0 24 24",1,"absolute","cursor-move","top-1","right-1"],["d","M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z"],["d","M0 0h24v24H0z","fill","none"],[1,"absolute","w-1/2","right-0","top-16","transition-all","duration-300",3,"ngClass"],[1,"w-full","bg-red-500","rounded-full",3,"click","matTooltip"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24"],["d","M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"],["aria-label","record",1,"absolute","top-8","left-1/2","disabled:bg-gray-400","-translate-x-1/2","flex","flex-col","p-2","bg-white","size-28","overflow-hidden","rounded-full",3,"pointerdown","contextmenu","disabled"],[1,"relative","flex","items-center","justify-center"],[1,"absolute","z-20","font-semibold","text-white"],[1,"absolute","z-20","font-semibold","text-black"],[1,"size-24","overflow-hidden","transition-all","rounded-full","relative",3,"ngClass"],[1,"w-full","mt-5","pointer-events-none","h-full","opacity-90",3,"ngClass"],["matRipple","",1,"text-white",3,"click","matTooltip"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"w-full"],["d","M15.46 15.88L16.88 14.46L19 16.59L21.12 14.47L22.54 15.88L20.41 18L22.54 20.12L21.12 21.54L19 19.41L16.88 21.54L15.46 20.12L17.59 18L15.47 15.88M12 3C17.5 3 22 6.58 22 11C22 11.58 21.92 12.14 21.78 12.68C20.95 12.25 20 12 19 12C15.69 12 13 14.69 13 18L13.08 18.95L12 19C10.76 19 9.57 18.82 8.47 18.5C5.55 21 2 21 2 21C4.33 18.67 4.7 17.1 4.75 16.5C3.05 15.07 2 13.14 2 11C2 6.58 6.5 3 12 3Z"],[1,"text-white",3,"click","matTooltip"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","x","0px","y","0px","viewBox","0 0 100 125",1,"w-full"],["d","M26.547,64.063c-0.187,0-0.374-0.071-0.518-0.212c-2.761-2.731-4.221-6.021-4.221-9.516c0-2.814,0.979-5.564,2.833-7.953   c0.25-0.321,0.711-0.381,1.034-0.131c0.321,0.25,0.38,0.713,0.13,1.034c-1.651,2.128-2.523,4.565-2.523,7.049   c0,3.092,1.309,6.02,3.783,8.467c0.289,0.286,0.292,0.753,0.006,1.042C26.928,63.99,26.737,64.063,26.547,64.063z"],["d","M28.144,62.235c-0.188,0-0.375-0.071-0.519-0.213c-2.18-2.156-3.332-4.758-3.332-7.522c0-2.227,0.774-4.402,2.239-6.29   c0.249-0.321,0.712-0.381,1.034-0.13c0.321,0.25,0.38,0.712,0.131,1.034c-1.263,1.627-1.931,3.49-1.931,5.387   c0,2.362,1.001,4.601,2.895,6.475c0.29,0.286,0.292,0.753,0.007,1.042C28.523,62.162,28.333,62.235,28.144,62.235z"],["d","M29.549,59.614c-0.188,0-0.375-0.071-0.519-0.213c-1.329-1.315-2.061-2.971-2.061-4.665c0-1.385,0.479-2.736,1.387-3.905   c0.25-0.321,0.713-0.38,1.034-0.131c0.321,0.25,0.38,0.712,0.131,1.034c-0.705,0.909-1.078,1.947-1.078,3.002   c0,1.315,0.562,2.566,1.624,3.616c0.288,0.287,0.291,0.753,0.005,1.042C29.928,59.542,29.738,59.614,29.549,59.614z"],["d","M64.743,57.484c1.783-3.587,5.967-10.445,6.667-15.297c0.902-6.253-1.999-17.147-11.604-19.727   c-9.604-2.578-18.19,1.069-21.595,3.997c-0.813,0.699-1.447,1.597-1.956,2.564L64.743,57.484z"],["d","M33.92,40.824c-1.134,1.348-3.885,4.769-4.089,6.455c-0.257,2.127,3.242,2.192,3.242,2.192l-0.405,4.19l2.321,1.031   l-1.934,0.387c0,0,0.772,2.192,0.257,3.481s-0.516,6.188,3.353,5.028c3.867-1.16,6.188,14.827,6.188,14.827L61.21,68.09   L33.92,40.824z"],["d","M50.25,9.33c-22.472,0-40.753,18.282-40.753,40.753S27.778,90.835,50.25,90.835s40.753-18.282,40.753-40.753  S72.722,9.33,50.25,9.33z M85.003,50.083c0,8.496-3.068,16.285-8.149,22.329L27.898,23.499c6.048-5.093,13.846-8.169,22.352-8.169  C69.413,15.33,85.003,30.92,85.003,50.083z M15.497,50.083c0-8.501,3.073-16.295,8.16-22.341l48.956,48.914  c-6.049,5.099-13.852,8.18-22.363,8.18C31.087,84.835,15.497,69.245,15.497,50.083z"],["id","settings",1,"bg-black/50","fixed","right-0","rounded","p-4","transition-transform",3,"ngClass"],[1,"relative","flex","flex-col"],["aria-label","Settings",1,"absolute","-top-2","-left-14","z-20","bg-black/50","rounded-l","text-white",3,"click","matTooltip"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-10","animate-spin"],["d","M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"],["aria-label","close stream",1,"text-white","cursor-progress","size-20","bg-orange-500","rounded-full"],["matRipple","","aria-label","close stream",1,"text-white","size-20","rounded-full",3,"ngClass"],["matRipple","",1,"text-white",3,"click"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-20"],["d","M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z"],[1,"pulse","rounded-full","w-full","h-full","bg-primary","flex","justify-center","items-center"],["matRipple","","aria-label","close stream",1,"text-white","size-20","rounded-full",3,"click","ngClass"]],template:function(t,r){if(t&1){let n=Zi();L(0,"div",1)(1,"button",2),Cn(),L(2,"svg",3),me(3,"path",4)(4,"path",5),H()(),Is(),L(5,"div",6)(6,"button",7),Ze("click",function(){return Je(n),Xe(r.rejectText())}),Cn(),L(7,"svg",8)(8,"title"),we(9,"close"),H(),me(10,"path",9),H()()(),Is(),L(11,"button",10),Ze("pointerdown",function(){return Je(n),Xe(r.toggleRecording())})("contextmenu",function(o){return Je(n),Xe(o.preventDefault())}),L(12,"div",11),jr(13,pU,2,1,"span",12)(14,dU,2,1,"span",13)(15,fU,2,1,"span",12)(16,vU,2,1,"span",12),L(17,"div",14),me(18,"div",15,0),H()()(),L(20,"button",16),Ze("click",function(){return Je(n),Xe(r.clearChat())}),Cn(),L(21,"svg",17)(22,"title"),we(23,"remove chat"),H(),me(24,"path",18),H()(),Is(),L(25,"button",19),Ze("click",function(){return Je(n),Xe(r.interruptAvatar())}),Cn(),L(26,"svg",20)(27,"g"),me(28,"path",21),H(),L(29,"g"),me(30,"path",22),H(),L(31,"g"),me(32,"path",23),H(),L(33,"g"),me(34,"path",24)(35,"path",25),H(),me(36,"path",26),H()()(),Is(),L(37,"div",27)(38,"div",28)(39,"button",29),Ze("click",function(){return Je(n),Xe(r.toggleSettings())}),Cn(),L(40,"svg",30)(41,"title"),we(42,"cog"),H(),me(43,"path",31),H()(),jr(44,gU,4,1,"button",32)(45,mU,2,5,"button",33),Is(),L(46,"button",34),Ze("click",function(){return Je(n),Xe(r.fullscreen.emit())}),Cn(),L(47,"svg",35)(48,"title"),we(49,"fullscreen"),H(),me(50,"path",36),H()()()()}t&2&&(F(5),ge("ngClass",Jc(15,aU,r.store.isRecordingStarted())),F(),ge("matTooltip",r.lang.cancel_recording),F(5),ge("disabled",r.store.isRecordingLoading()||r.recognizingStatus()),F(2),hi(r.store.isRecordingLoading()?13:-1),F(),hi(r.store.isRecordingStopped()?14:-1),F(),hi(r.store.isRecordingStarted()&&r.recognizingStatus()?15:-1),F(),hi(r.store.isRecordingStarted()&&!r.recognizingStatus()?16:-1),F(),ge("@recordButton",r.store.recording())("ngClass",aa(17,cU,r.recognizingStatus(),!r.recognizingStatus())),F(),ge("ngClass",Jc(20,lU,!r.store.isRecordingStarted())),F(2),ge("matTooltip",r.lang.clear_chat_history),F(5),ge("matTooltip",r.lang.stop_talking),F(12),ge("ngClass",Jc(22,uU,!r.settingsOpened)),F(2),ge("matTooltip",r.lang.settings),F(5),hi(r.store.isStreamLoading()?44:45))},dependencies:[DP,OP,qr,AM,BM],data:{animation:[Nw("recordButton",[el("InProgress",Qc({transform:"scale(1)",backgroundColor:"gray"})),el("Started",Qc({transform:"scale(1)"})),el("Stopped",Qc({transform:"scale(0)"})),jw("* <=> *",[Lw("150ms ease-in-out")])])]}})};function yU(i,e){i&1&&(L(0,"div",4)(1,"div",5),me(2,"div")(3,"div")(4,"div")(5,"div"),H()())}var pw=class i{fullScreen="h-screen w-screen flex items-center justify-center";text=Qt("");element=re(_e);store=re(Fr);recognizing(e){this.text.set(e)}toggleFullScreen(){document.fullscreenElement?document.exitFullscreen().then():this.element.nativeElement.requestFullscreen().then()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Lt({type:i,selectors:[["app-avatar"]],hostVars:1,hostBindings:function(t,r){t&2&&En("class",r.fullScreen)},standalone:!0,features:[qt],decls:8,vars:4,consts:[["avatarVideoComponent",""],["overlayChatComponent",""],[1,"absolute","top-10","left-10","size-28",3,"recognizing$","fullscreen","overlayChatComponent","avatarVideoComponent"],[1,"bg-black/40","absolute","top-1/2","text-white","font-sans","left-1/2","-translate-x-1/2"],[1,"z-50","flex","items-center","justify-center","w-full","bg-black/50","h-full","fixed"],[1,"lds-ellipsis"]],template:function(t,r){if(t&1){let n=Zi();me(0,"app-avatar-video",null,0)(2,"app-overlay-chat",null,1),L(4,"app-screen-control",2),Ze("recognizing$",function(o){return Je(n),Xe(r.recognizing(o))})("fullscreen",function(){return Je(n),Xe(r.toggleFullScreen())}),H(),L(5,"div",3),we(6),H(),jr(7,yU,6,0,"div",4)}if(t&2){let n=Ds(1),s=Ds(3);F(4),ge("overlayChatComponent",s)("avatarVideoComponent",n),F(2),zt(r.text()),F(),hi(r.store.isStreamLoading()?7:-1)}},dependencies:[rl,cl,sv]})};export{pw as default};
