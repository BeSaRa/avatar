import{a as be}from"./chunk-UEO5FFUU.js";import{e as ue}from"./chunk-UIAIQN6Q.js";import{a as de}from"./chunk-YYMWAFPC.js";import{ja as _e,ka as fe}from"./chunk-VAHSMXEG.js";import{b as ie,d as v,f as ne,g as oe,j as ae,l as le,m as se,n as pe,s as ce,u as me}from"./chunk-YFGTI2A5.js";import"./chunk-EJJBCPAK.js";import{b as ee,f as te,g as re}from"./chunk-UZWBSRIL.js";import{Aa as m,Ba as d,Ca as b,Cc as K,Da as S,Db as w,Ea as q,Gb as L,Hb as c,Mb as h,Nb as I,Pb as U,Qb as M,Rb as o,Sb as a,Tb as _,Ub as W,V as E,Vb as A,Wb as N,Xb as T,_b as f,a as O,ac as p,ca as F,cd as X,dd as Y,ea as P,fb as Z,ha as j,jc as H,kb as l,kc as Q,lc as R,mc as u,na as C,nc as g,oc as $,ra as B,sc as G,uc as J,vb as x,wc as y,xb as k,zb as z}from"./chunk-QOFJAIQO.js";var D=/^(https?:\/\/)?([\w-]+\.)+[\w-]+(\/[\w\-.,@?^=%&:/~+#]*)?(\?[^\s#]*)?(#[^\s]*)?$/;var V=class i{http=C(ee);urlService=C(te);generateReport(r){let e=`${this.urlService.URLS.MEDIA}/search`;return this.http.post(e,{search_text:r})}crawlWebPages(r){let e=`${this.urlService.URLS.MEDIA}/crawl`;return this.http.post(e,O({},r))}static \u0275fac=function(e){return new(e||i)};static \u0275prov=j({token:i,factory:i.\u0275fac,providedIn:"root"})};var he=["inputURLS"],ye=["inputTopics"],Ce=i=>({"mb-1":i}),we=i=>({"bg-red-50 !border-red-400":i});function Se(i,r){if(i&1&&(b(),o(0,"svg",27),_(1,"path",33),a()),i&2){let e=p(2);c("matTooltip",e.lang.locals.required)}}function Te(i,r){if(i&1){let e=T();G(0),o(1,"div",13)(2,"div",25)(3,"input",26,2),f("keyup.enter",function(){m(e);let n=p();return n.addTopic(),d(n.focusLastInput("topic"))})("keyup.backspace",function(){let n=m(e).$index,s=p();return d(s.removeOnErase(n,"topic"))}),a(),w(5,Se,2,1,":svg:svg",27),a(),o(6,"button",28),f("click",function(){m(e);let n=p();return d(n.addTopic())}),b(),o(7,"svg",29),_(8,"path",30),a()(),S(),o(9,"button",31),f("click",function(){let n=m(e).$index,s=p();return d(s.removeTopic(n))}),b(),o(10,"svg",29),_(11,"path",32),a()()()}if(i&2){let e=r.$implicit,t=r.$index,n=p(),s=e.invalid&&e.touched&&e.dirty;l(),c("ngClass",y(6,Ce,n.topics.length>1)),l(2),c("placeholder",n.lang.locals.topics)("formControlName",t)("ngClass",y(8,we,s)),l(2),h(s?5:-1),l(4),L("disabled",n.topics.controls.length<=1?!0:null)}}function Re(i,r){if(i&1&&(b(),o(0,"svg",27),_(1,"path",33),a()),i&2){let e=p().$implicit,t=p();c("matTooltip",e.errors!=null&&e.errors.pattern?t.lang.locals.invalid_url:t.lang.locals.required)}}function Ve(i,r){if(i&1){let e=T();G(0),o(1,"div",13)(2,"div",25)(3,"input",34,3),f("keyup.enter",function(){m(e);let n=p();return n.addUrl(),d(n.focusLastInput("urls"))})("keyup.backspace",function(){let n=m(e).$index,s=p();return d(s.removeOnErase(n,"urls"))}),a(),w(5,Re,2,1,":svg:svg",27),a(),o(6,"button",28),f("click",function(){m(e);let n=p();return d(n.addUrl())}),b(),o(7,"svg",29),_(8,"path",30),a()(),S(),o(9,"button",31),f("click",function(){let n=m(e).$index,s=p();return d(s.removeUrl(n))}),b(),o(10,"svg",29),_(11,"path",32),a()()()}if(i&2){let e=r.$implicit,t=r.$index,n=p(),s=e.invalid&&e.touched&&e.dirty;l(),c("ngClass",y(6,Ce,n.urls.length>1)),l(2),c("placeholder",n.lang.locals.web_page_urls)("formControlName",t)("ngClass",y(8,we,s)),l(2),h(s?5:-1),l(4),L("disabled",n.urls.controls.length<=1?!0:null)}}function Ee(i,r){if(i&1&&N(0,19),i&2){p();let e=R(40);c("ngTemplateOutlet",e)}}function Fe(i,r){if(i&1&&N(0,19),i&2){p();let e=R(40);c("ngTemplateOutlet",e)}}function ke(i,r){if(i&1&&(o(0,"div",24)(1,"span",35),u(2),a(),o(3,"a",36),b(),o(4,"svg",37),_(5,"path",38),a()()()),i&2){let e=p();c("@fadeInSlideUp",e.animateTrigger()),l(2),g(e.reportName()),l(),c("href",e.reportUrl(),Z)}}function Le(i,r){i&1&&(o(0,"div",39)(1,"div",40),b(),o(2,"svg",41),_(3,"path",42)(4,"path",43),a(),S(),o(5,"span",44),u(6,"Loading..."),a()()())}var ge=class i extends de(class{}){lang=C(re);crawlerService=C(V);fb=C(ce);reportName=x("");reportUrl=x("");loaderUrl=x(!1);loaderTopic=x(!1);inputURLS=k("inputURLS");inputTopics=k("inputTopics");crawlerForm=this.fb.group({topics:this.fb.array([this.fb.control("",v.required)]),urls:this.fb.array([this.fb.control("",[v.required,v.pattern(D)])])});animateTrigger=x(!1);get topics(){return this.crawlerForm.get("topics")}get urls(){return this.crawlerForm.get("urls")}addTopic(){this.topics.push(this.fb.control("",v.required))}addUrl(){this.urls.push(this.fb.control("",[v.required,v.pattern(D)]))}removeTopic(r){this.topics.removeAt(r)}removeUrl(r){this.urls.removeAt(r)}focusLastInput(r){let e=setTimeout(()=>{let t=r==="topic"?this.inputTopics():this.inputURLS(),n=t.length-1;t[n]?.nativeElement.focus(),clearTimeout(e)})}removeOnErase(r,e){let t=e==="topic"?this.inputTopics():this.inputURLS(),n=e==="topic"?this.removeTopic:this.removeUrl;!t[r].nativeElement.value&&r>0&&(n.bind(this)(r),r>0&&t[r-1].nativeElement.focus())}crawlWebPages(){if(this.crawlerForm.markAllAsTouched(),this.crawlerForm.controls.topics.controls.forEach(e=>e.markAsDirty()),this.crawlerForm.controls.urls.controls.forEach(e=>e.markAsDirty()),this.crawlerForm.invalid)return;let r=this.crawlerForm.getRawValue();this.loaderTopic.set(!0),this.crawlerService.crawlWebPages(r).pipe(F(this.destroy$)).pipe(E(()=>this.loaderTopic.set(!1))).subscribe()}generateReport(r){r&&(this.loaderUrl.set(!0),this.crawlerService.generateReport(r).pipe(F(this.destroy$)).pipe(P(()=>this.animateTrigger.set(!this.animateTrigger()))).pipe(E(()=>this.loaderUrl.set(!1))).subscribe(e=>{e&&e.data&&(this.reportName.set(ue(e.data.report_url)),this.reportUrl.set(e.data.report_url))}))}static \u0275fac=(()=>{let r;return function(t){return(r||(r=q(i)))(t||i)}})();static \u0275cmp=B({type:i,selectors:[["app-web-crawler-report"]],viewQuery:function(e,t){e&1&&(H(t.inputURLS,he,5),H(t.inputTopics,ye,5)),e&2&&Q(2)},standalone:!0,features:[z,J],decls:41,vars:13,consts:[["generateReportInput",""],["spinner",""],["inputTopics",""],["inputURLS",""],[1,"shadow","bg-gray-100","w-full","text-gray-700","rounded-md","p-4"],[1,"font-medium","text-xl","text-center"],[1,"flex","justify-between","items-center"],[1,"contents",3,"ngSubmit","formGroup"],[1,"flex","flex-col","w-1/2","p-4","bg-gray-200","rounded-md","m-4","border-2","border-gray-300","max-h-[60vh]","overflow-auto"],[1,"text-gray-400","font-medium","text-lg"],["formArrayName","topics"],[1,"mb-4"],["for","topics"],[1,"flex","gap-2",3,"ngClass"],["formArrayName","urls"],["for","page-url"],["type","submit","type","button",1,"bg-primary","rounded-md","w-1/3","text-white","p-1",3,"click"],[1,"flex","justify-center","items-center"],[1,"me-4"],[3,"ngTemplateOutlet"],[1,"flex","flex-col","w-1/2","p-4","bg-gray-200","rounded-md","m-4","border-2","border-gray-300","mb-auto"],["for","report-text"],["type","text",1,"rounded-md","p-2","w-full","border-2","border-gray-300","outline-none","focus:border-primary",3,"placeholder"],["type","button",1,"bg-primary","rounded-md","w-1/3","text-white","p-1",3,"click"],[1,"flex","justify-between","items-center","bg-blue-100","border","border-dashed","border-gray-400","rounded-md","p-4","mt-4"],[1,"relative","w-full"],["id","topics","type","text",1,"rounded-md","p-2","w-full","border-2","border-gray-300","outline-none","focus:border-primary",3,"keyup.enter","keyup.backspace","placeholder","formControlName","ngClass"],["matTooltipPosition","above","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"absolute","size-5","fill-red-400","left-0","top-3","ml-2","cursor-pointer",3,"matTooltip"],["type","button",1,"bg-primary","p-3","rounded-md",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-4","fill-white"],["d","M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"],["type","button",1,"bg-primary","p-3","rounded-md","disabled:bg-primary/70",3,"click"],["d","M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"],["d","M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z"],["id","page-url","type","text",1,"rounded-md","p-2","w-full","border-2","border-gray-300","outline-none","focus:border-primary",3,"keyup.enter","keyup.backspace","placeholder","formControlName","ngClass"],[1,"font-medium","text-lg"],["target","_blank",3,"href"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-6","fill-blue-500"],["d","M2 12H4V17H20V12H22V17C22 18.11 21.11 19 20 19H4C2.9 19 2 18.11 2 17V12M12 15L17.55 9.54L16.13 8.13L13 11.25V2H11V11.25L7.88 8.13L6.46 9.55L12 15Z"],[1,"loader","flex","items-center","justify-center"],["role","status"],["aria-hidden","true","viewBox","0 0 100 101","fill","none","xmlns","http://www.w3.org/2000/svg",1,"inline","size-4","text-gray-200","animate-spin","fill-primary"],["d","M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z","fill","currentColor"],["d","M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z","fill","currentFill"],[1,"sr-only"]],template:function(e,t){if(e&1){let n=T();o(0,"div",4)(1,"h1",5),u(2),a(),o(3,"div",6)(4,"form",7),f("ngSubmit",function(){return m(n),d(t.crawlWebPages())}),o(5,"section",8)(6,"span",9),u(7),a(),W(8,10),o(9,"div",11)(10,"label",12),u(11),a(),U(12,Te,12,10,"div",13,I),a(),A(),W(14,14),o(15,"div",11)(16,"label",15),u(17),a(),U(18,Ve,12,10,"div",13,I),a(),A(),o(20,"button",16),f("click",function(){return m(n),d(t.crawlWebPages())}),o(21,"div",17)(22,"span",18),u(23),a(),w(24,Ee,1,1,"ng-container",19),a()()()(),o(25,"section",20)(26,"span",9),u(27),a(),o(28,"div",11)(29,"label",21),u(30),a(),_(31,"input",22,0),a(),o(33,"button",23),f("click",function(){m(n);let ve=R(32);return d(t.generateReport(ve.value))}),o(34,"div",17)(35,"span",18),u(36),a(),w(37,Fe,1,1,"ng-container",19),a()(),w(38,ke,6,3,"div",24),a()()(),w(39,Le,7,0,"ng-template",null,1,K)}e&2&&(l(2),g(t.lang.locals.web_crawler_and_report_generator),l(2),c("formGroup",t.crawlerForm),l(3),g(t.lang.locals.crawl_web_pages),l(4),g(t.lang.locals.topics),l(),M(t.topics.controls),l(5),g(t.lang.locals.web_page_urls),l(),M(t.urls.controls),l(5),$(" ",t.lang.locals.crawl_web_pages," "),l(),h(t.loaderTopic()?24:-1),l(3),g(t.lang.locals.generate_report),l(3),g(t.lang.locals.search_text_for_report),l(),c("placeholder",t.lang.locals.search_text_for_report),l(5),$(" ",t.lang.locals.generate_report," "),l(),h(t.loaderUrl()?37:-1),l(),h(t.reportUrl()?38:-1))},dependencies:[me,ae,ie,ne,oe,le,pe,se,X,fe,_e,Y],data:{animation:[be]}})};export{ge as WebCrawlerReportComponent};
