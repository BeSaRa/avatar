import{b as A}from"./chunk-55XIR25M.js";import{a as S}from"./chunk-WPFYNPVQ.js";import{a as v}from"./chunk-7YC6CIPS.js";import{b as h,c as u,d as m,e as l,g as d}from"./chunk-UUNGGFH6.js";import{K as n,a,ha as i,ka as p,na as c,ta as r,x as o}from"./chunk-FK5TGTUL.js";var R=new m(()=>!1);var f=class s{urlService=r(v);http=r(d);store=r(A);config=r(S);constructor(){this.store.idleAvatar()||this.store.updateIdleAvatar(this.config.CONFIG.IDLE_AVATARS[0])}startStream(t){return this.http.post(this.urlService.URLS.AVATAR+"/start-stream",{},{params:a({},t?{size:"life-size"}:void 0)}).pipe(p(e=>this.store.updateStreamId(e.data.id)))}closeStream(){let t=this.store.streamId();return this.store.updateStreamId(""),this.http.delete(this.urlService.URLS.AVATAR+`/close-stream/${t}`)}retrieveStream(){return this.http.get(this.urlService.URLS.AVATAR+`/retrieve-stream/${this.store.streamId()}`)}checkStreamStatus(){return this.http.get(this.urlService.URLS.AVATAR+`/stream-status/${this.store.streamId()}`)}sendCandidate(t){return this.http.post(this.urlService.URLS.AVATAR+`/send-candidate/${this.store.streamId()}`,{candidate:t})}sendAnswer(t){return this.http.put(this.urlService.URLS.AVATAR+`/send-answer/${this.store.streamId()}`,{answer:t})}interruptAvatar(){return this.http.delete(this.urlService.URLS.AVATAR+`/stop-render/${this.store.streamId()}`)}renderText(t){return this.http.post(this.urlService.URLS.AVATAR+`/render-text/${this.store.streamId()}`,{text:t})}updateVideo(t){return this.http.post(this.urlService.URLS.AVATAR+"/update-video",{text:t})}retrieveVideo(){return this.http.get(this.urlService.URLS.AVATAR+"/retrieve-video").pipe(i(t=>t.status==="RENDERING"?n(5e3).pipe(i(()=>this.retrieveVideo())):o(t.data)))}greeting(t,e){let g=`${this.urlService.URLS.AVATAR}/greeting/${t}/${this.store.streamId()}`,C=new u().append("is_ar",e);return this.http.post(g,null,{params:C})}getMSICEServerInfo(){return this.http.get(`https://${this.store.speechToken.region()}.tts.speech.microsoft.com/cognitiveservices/avatar/relay/token/v1`,{context:new l().set(R,!0),headers:new h().set("Authorization",`Bearer ${this.store.speechToken.token()}`)})}static \u0275fac=function(e){return new(e||s)};static \u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})};export{R as a,f as b};
