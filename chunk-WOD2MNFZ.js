import{a as Se}from"./chunk-KFY2JLCV.js";import{a as pi}from"./chunk-F5W5PDIZ.js";import"./chunk-JTV7DZOG.js";import{a as ei,b as ni,c as oi,d as ai,e as di}from"./chunk-5QVJ6TFJ.js";import{a as Re,b as be}from"./chunk-35U2WCIG.js";import{a as Gt,c as $t,d as jt,e as Ut,f as Zt,g as qt}from"./chunk-HBSPQJRU.js";import"./chunk-FBBBI26N.js";import{a as ii}from"./chunk-RIPR3X5H.js";import"./chunk-OPQ2WZRT.js";import"./chunk-KGG47OAJ.js";import{b as Kt}from"./chunk-OFSU3TTI.js";import{a as ci}from"./chunk-FAMFBZKA.js";import{a as Jt}from"./chunk-IHOFWBF3.js";import"./chunk-P62G7WM7.js";import{a as li}from"./chunk-A67SDJRS.js";import"./chunk-E5X2H3KA.js";import"./chunk-NYB4G32D.js";import{b as ri,c as si}from"./chunk-INJDVHFI.js";import{b as Wt,d as Yt,e as Qt,i as Xt}from"./chunk-ZDLFVXAQ.js";import{a as pe}from"./chunk-QUM7UX6R.js";import{la as Dt,ma as Ht,na as zt,pa as me,qa as ti}from"./chunk-IC37TOFE.js";import{c as Mt,h as Ft,l as Ne,n as Bt,s as Ot,t as Nt,u as Rt,z as ye}from"./chunk-BS45UVUA.js";import"./chunk-OK5S6IU3.js";import{a as At,b as B}from"./chunk-75V3BFQA.js";import{a as kt,b as Ve,f as it}from"./chunk-ZZL437ZE.js";import{$b as s,Ac as N,B as ge,Bc as wt,Cb as h,Db as ae,Eb as Ct,Fa as ut,Ga as u,Ha as g,Hb as le,Ia as V,Ic as Tt,Ja as G,Jc as k,Ka as te,Kc as ie,Lc as A,Ma as gt,Mb as C,Mc as ce,N as Ie,Oc as R,P as se,Pb as Q,Pc as xe,Qa as ft,Qb as d,Qc as q,Rb as Z,Rc as It,Sa as _e,Sb as Fe,Ta as w,Ua as ht,Ub as xt,V as lt,Vb as f,Wb as L,X as ct,Y as dt,Yb as T,Z as ke,Zb as I,_b as r,a as ue,ac as m,b as Pe,dc as Be,dd as E,ea as pt,ec as x,fd as ne,ga as fe,ha as ee,hc as _,i as J,ja as O,jc as c,lb as U,ld as Vt,ma as Ae,ob as _t,q as rt,qc as yt,r as st,rb as a,rc as bt,rd as F,sa as b,sb as vt,sc as St,td as Et,u as Te,uc as X,ud as Lt,vc as ve,vd as Pt,wa as P,wc as Ce,xc as p,ya as mt,yc as M,yd as de,za as Me,zc as y,zd as Oe}from"./chunk-JDPSA7SZ.js";var W=i=>{let n=i.split(":"),e=parseInt(n[0],10),t=parseInt(n[1],10),o=parseFloat(n[2]);return e*3600+t*60+o},mi=i=>{let n=Math.floor(i/3600),e=Math.floor(i%3600/60),t=(i%60).toFixed(3);return`${n.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}:${t.padStart(6,"0")}`},ui=(i,n)=>{if(!i||i.length===0||n===0)return 0;let e=i.map(v=>({start:W(v.adjustedStart),end:W(v.adjustedEnd)}));e.sort((v,S)=>v.start-S.start);let t=0,o=e[0].start,l=e[0].end;for(let v=1;v<e.length;v++){let{start:S,end:H}=e[v];S<=l?l=Math.max(l,H):(t+=l-o,o=S,l=H)}return t+=l-o,t/n*100},Ii=i=>i.map(n=>{let e=n.properties?Object.values(n.properties).join(" "):"";return e?`${e} ${n.type}`:n.type}),gi=i=>i.map(n=>Pe(ue({},n),{clothingList:n.clothing?Ii(n.clothing):[]})),fi=i=>{let e=[...new Set(i.map(l=>l.iabName).filter(Boolean))],t=i.filter(l=>!l.iabName).map(l=>({id:l.id,name:l.name})),o=e.map(l=>{let v=l?.split(" ")[0]||null,S=i.filter(Y=>Y.iabName===l).map(Y=>({id:Y.id,name:Y.name})),H=v!==null&&S.some(Y=>Y.name===v),z=H?i.find(Y=>Y.name===v)?.id??null:null;return{groupName:v,groupId:z,children:S.filter(Y=>Y.name!==v),isParentClickable:H}});return t.length&&o.push({groupName:null,groupId:null,children:t,isParentClickable:!1}),o};var $=class i{http=b(it);urlService=b(At);httpBackEnd=b(kt);videoDuration=h("");videoLengthInSeconds=E(()=>W(this.videoDuration()));timelineSeek=new st(0);subtitleFile=h("");getListOfVideos(){let n=`${this.urlService.URLS.VIDEO_ANALYZER}/videos`;return this.http.get(n).pipe(ge(e=>e.data.videos))}uploadVideo(n,e="en-US"){let t=`${this.urlService.URLS.VIDEO_ANALYZER}/upload`,o=new Ve().append("language",e),l=new FormData;return l.append("file",n),this.http.post(t,l,{params:o})}indexVideo(n,e="en-US"){let t=`${this.urlService.URLS.VIDEO_ANALYZER}/index`,o=new Ve().append("vid",n).append("bot_name","video-indexer").append("language",e);return this.http.get(t,{params:o})}getVideo(n){let e=`${this.urlService.URLS.VIDEO_ANALYZER}/get_vi`,t=new Ve().append("vid",n);return this.http.get(e,{params:t})}startVideoChat(n){let e=`${this.urlService.URLS.VIDEO_ANALYZER}/start-video-chat`,t=new Ve().append("video_id",n).append("bot_name","video-indexer");return this.http.post(e,null,{params:t})}getVttFile(n){return new it(this.httpBackEnd).get(n,{responseType:"text"}).pipe(ge(t=>{console.log("VTT Content Fetched:",t);let o=new Blob([t],{type:"text/vtt"});return URL.createObjectURL(o)}))}static \u0275fac=function(e){return new(e||i)};static \u0275prov=Ae({token:i,factory:i.\u0275fac,providedIn:"root"})};var Vi=(i,n)=>n.id,Ei=()=>({suppressScrollX:!0}),Li=()=>[1,2,3,4,5,6],Pi=i=>({"border-2 bg-gray-100 p-2 shadow-md rounded-md !border-primary/50 [&_span]:font-bold":i});function ki(i,n){i&1&&(r(0,"div",8),m(1,"div",9)(2,"div",10),s())}function Ai(i,n){i&1&&T(0,ki,3,0,"div",8,L),i&2&&I(ie(0,Li))}function Mi(i,n){if(i&1){let e=x();r(0,"button",12),_("click",function(){let o=u(e).$implicit,l=c(2);return g(l.selectedVideo.set(o))}),m(1,"img",13),r(2,"span",14),p(3),s()()}if(i&2){let e,t=n.$implicit,o=c(2);d("ngClass",A(5,Pi,((e=o.selectedVideo())==null?null:e.id)===t.id)),a(),d("src",t.thumbnail_url,U)("alt","video_thumb"+t.name),a(),d("title",t.name),a(),M(t.name)}}function Fi(i,n){if(i&1&&T(0,Mi,4,7,"button",11,Vi),i&2){let e=c();I(e.videos())}}var De=class i extends pe(class{}){lang=b(B);videoAnalyzerService=b($);ref=b(Gt);videos=h([]);selectedVideo=h(void 0);isLoading=h(!0);language=h("");ngOnInit(){this.getAllVideos()}onVideoSelect(){this.ref.close(this.selectedVideo())}getAllVideos(){this.videoAnalyzerService.getListOfVideos().pipe(ee(this.destroy$),O(n=>{this.videos.set(n),this.isLoading.set(!1)})).subscribe()}static \u0275fac=(()=>{let n;return function(t){return(n||(n=te(i)))(t||i)}})();static \u0275cmp=P({type:i,selectors:[["app-list-videos-popup"]],standalone:!0,features:[le,k],decls:14,vars:7,consts:[[1,"flex","flex-col","w-[min(500,80vw)]"],[1,"p-4","bg-primary","text-white"],["appPerfectScroll","",3,"perfectScrollOptions"],[1,"p-4","min-h-0","flex","flex-auto","flex-col"],[1,"grid","grid-cols-2","md:grid-cols-3","gap-4"],[1,"flex","w-full","justify-between","mt-6","space-x-2","gap-4","p-4"],["type","button","mat-dialog-close","",1,"bg-gray-300","w-1/2","text-gray-800","font-medium","py-2","px-4","rounded-lg","hover:bg-gray-400","focus:ring-2","focus:ring-gray-200","focus:outline-none"],["type","button",1,"bg-primary/90","w-1/2","text-white","font-medium","py-2","px-4","rounded-lg","hover:bg-primary","focus:ring-4","focus:ring-gray-300","focus:outline-none","disabled:opacity-50",3,"click","disabled"],[1,"flex","flex-col","space-y-4","p-4","size-60","animate-pulse"],[1,"bg-gray-200","rounded-md","h-36","w-full"],[1,"bg-gray-200","rounded","h-4","w-3/4","mx-auto"],["type","button",1,"flex","flex-col","group","justify-center","items-center","space-y-4","size-60","hover:border-2","hover:bg-gray-100","hover:p-2","hover:shadow-md","hover:rounded-md","hover:border-primary/20","cursor-pointer","transition-all","focus:outline-none",3,"ngClass"],["type","button",1,"flex","flex-col","group","justify-center","items-center","space-y-4","size-60","hover:border-2","hover:bg-gray-100","hover:p-2","hover:shadow-md","hover:rounded-md","hover:border-primary/20","cursor-pointer","transition-all","focus:outline-none",3,"click","ngClass"],["loading","lazy",1,"border","border-transparent","rounded-md",3,"src","alt"],[1,"group-hover:font-bold","text-pretty","text-center","truncate",3,"title"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"div",1),p(2),s(),r(3,"mat-dialog-content",2)(4,"div",3)(5,"div",4),C(6,Ai,2,1)(7,Fi,2,0),s()()()(),r(8,"mat-dialog-actions")(9,"div",5)(10,"button",6),p(11),s(),r(12,"button",7),_("click",function(){return t.onVideoSelect()}),p(13),s()()()),e&2&&(a(2),M(t.lang.locals.videos_list),a(),d("perfectScrollOptions",ie(6,Ei)),a(3),f(t.isLoading()?6:7),a(5),y(" ",t.lang.locals.cancel," "),a(),d("disabled",!t.selectedVideo()),a(),y(" ",t.lang.locals.confirm," "))},dependencies:[qt,jt,Zt,Ut,Se,F]})};var Ee=class i extends be{messages=h([]);status=h(!1);conversationId=h("");sendMessage(n){let e=`${this.urlService.URLS.CHAT}/video-indexer`;return this.messages.update(t=>[...t,new Re(n,"user")]),this.http.post(e,ue(ue({messages:this.messages()},this.store.streamId()?{stream_id:this.store.streamId()}:null),this.conversationId()?{conversation_id:this.conversationId()}:null)).pipe(se(t=>{throw new Re().clone({content:t.message,role:"error"}),new Error(t)}),ge(t=>(t.message.content=Yt(Qt(t.message.content,t.message)),t.message=new Re().clone(t.message),this.conversationId.set(t.message.conversation_id),this.messages.update(o=>[...o,t.message]),t)))}static \u0275fac=(()=>{let n;return function(t){return(n||(n=te(i)))(t||i)}})();static \u0275prov=Ae({token:i,factory:i.\u0275fac,providedIn:"root"})};var Bi=["chatContainer"],Oi=["chatBody"],Ni=["textArea"],Ri=["recorder"],Di=(i,n)=>n.id,Hi=i=>({hidden:i}),zi=(i,n)=>({"w-full h-full inset-0":i,"ltr:left-5 rtl:right-5":n});function Gi(i,n){if(i&1&&(r(0,"option",21),p(1),s()),i&2){let e=n.$implicit;d("value",e),a(),M(e)}}function $i(i,n){if(i&1&&(r(0,"select",7),T(1,Gi,2,2,"option",21,L),R(3,"async"),s()),i&2){let e=c();d("matTooltip",e.lang.locals.change_bot+`
`+e.lang.locals.change_bot_note)("matTooltipClass","whitespace-pre-line")("formControl",e.chatService.botNameCtrl),a(),I(xe(3,3,e.botNames$))}}function ji(i,n){i&1&&(V(),r(0,"svg",23),m(1,"path",24),s())}function Ui(i,n){i&1&&(V(),r(0,"svg",23),m(1,"path",25),s())}function Zi(i,n){if(i&1){let e=x();r(0,"button",22),_("click",function(){u(e);let o=c();return g(o.fullScreenToggle())}),C(1,ji,2,0,":svg:svg",23)(2,Ui,2,0,":svg:svg",23),s()}if(i&2){let e=c();a(),f(e.fullscreenStatus()?1:2)}}function qi(i,n){if(i&1){let e=x();r(0,"button",22),_("click",function(){u(e);let o=c();return g(o.toggleChat())}),V(),r(1,"svg",23),m(2,"path",26),s()()}}function Ki(i,n){if(i&1&&(r(0,"div",27)(1,"p"),p(2),s()()),i&2){let e=c().$implicit;a(2),M(e.content)}}function Wi(i,n){if(i&1){let e=x();r(0,"div",28)(1,"span",30),_("animating",function(o){u(e);let l=c(2);return g(l.animating.set(o))}),s()()}if(i&2){let e=c().$implicit,t=c();a(),d("stop",t.stopAnimate())("text",e.content)}}function Yi(i,n){if(i&1&&(r(0,"div",29)(1,"p"),p(2),s()()),i&2){let e=c().$implicit;a(2),M(e.content)}}function Qi(i,n){if(i&1&&C(0,Ki,3,1,"div",27)(1,Wi,2,2,"div",28)(2,Yi,3,1,"div",29),i&2){let e=n.$implicit;f(e.isUser()?0:e.isAssistant()?1:2)}}function Xi(i,n){i&1&&(r(0,"div",10),m(1,"div",31)(2,"div",32)(3,"div",33)(4,"div",34)(5,"div",35),s())}function Ji(i,n){if(i&1){let e=x();r(0,"div",11)(1,"span"),p(2),s(),r(3,"button",36),_("click",function(){u(e);let o=c();return g(o.rateConversation(o.feedbackOptions.LIKE))}),V(),r(4,"svg",37),m(5,"path",38),s(),p(6),s(),G(),r(7,"button",39),_("click",function(){u(e);let o=c();return g(o.rateConversation(o.feedbackOptions.DISLIKE))}),V(),r(8,"svg",37),m(9,"path",40),s(),p(10),s()()}if(i&2){let e=c();d("@slideFromBottom",void 0),a(2),M(e.lang.locals.rate_conversation),a(4),y(" ",e.lang.locals.i_like," "),a(4),y(" ",e.lang.locals.i_dislike," ")}}function en(i,n){if(i&1){let e=x();r(0,"button",41),_("click",function(){u(e);let o=c();return g(o.clearChatHistory())}),V(),r(1,"svg",15),m(2,"path",42),s()()}if(i&2){let e=c();d("matTooltip",e.lang.locals.clear_chat_history)}}function tn(i,n){if(i&1){let e=x();r(0,"button",43),_("click",function(){u(e);let o=c();return g(o.stopAnimate.set(!0))}),V(),r(1,"svg",44),m(2,"path",45),s()()}if(i&2){let e=c();d("matTooltip",e.lang.locals.send)}}function nn(i,n){if(i&1){let e=x();r(0,"app-recorder",46,3),_("recognized$",function(o){u(e);let l=c();return g(l.messageCtrl.setValue(o))})("recognizing$",function(o){u(e);let l=c();return g(l.messageCtrl.setValue(o))}),s()}}function on(i,n){if(i&1){let e=x();r(0,"button",41),_("click",function(){u(e);let o=c();return g(o.toggleAvatar())}),V(),r(1,"svg",44),m(2,"path",47),s()()}if(i&2){let e=c();d("matTooltip",e.lang.locals.open_avatar)}}function an(i,n){if(i&1&&(r(0,"div",20)(1,"div",48)(2,"span",49),V(),r(3,"svg",50),m(4,"path",51),s(),p(5),s()(),G(),m(6,"app-avatar-video",52)(7,"app-avatar-interrupter-btn",53),s()),i&2){let e=c();a(5),y(" ",e.lang.locals.avatar_chat," "),a(),d("size",void 0)}}var He=class i extends pe(class{}){lang=b(B);chatService=b(be,{skipSelf:!0});injector=b(gt);document=b(Vt);chatHistoryService=b(li);status=h(!0);showAvatarBtn=w(!0);showClearMsgBtn=w(!0);showFullScreenBtn=w(!0);showHideBtn=w(!0);showRatingBox=w(!0);showRecorderBtn=w(!0);title=w(this.lang.locals.chat);containerClass=w("");botNameOptions=w.required();clearMessageOnly=w(!1);chatContainer=ae.required("chatContainer");chatBodyContainer=ae("chatBody");messageInput=ae.required("textArea");recorder=ae("recorder");avatarOn=!1;fullscreenStatus=h(!1);answerInProgress=h(!1);animating=h(!1);stopAnimate=h(!1);ratingDone=h(!1);botNames$=this.chatHistoryService.getAllBotNames();feedbackOptions=ci;chatBodyContainerEffect=ne(()=>{this.chatBodyContainer()?this.scrollbarRef=new Jt(this.chatBodyContainer().nativeElement):this.scrollbarRef&&this.scrollbarRef.destroy()});answerInProgressEffect=ne(()=>{this.answerInProgress()?this.messageCtrl.disable():this.messageCtrl.enable()});animatingEffect=ne(()=>{if(!this.animating()){let n=this.chatBodyContainer()?.nativeElement?.querySelectorAll(".chat-message"),e=n&&n[n.length-1];e&&e.scrollIntoView(!0)}});statusEffect=ne(()=>{if(this.status()){let n=setTimeout(()=>{this.messageInput().nativeElement.focus(),clearTimeout(n)})}});messageCtrl=new Ne("",{nonNullable:!0});sendMessage$=new rt;ngOnInit(){this.listenToSendMessage(),this.listenToBotNameChange()}listenToBotNameChange(){this.chatService.onBotNameChange().pipe(ee(this.destroy$),pt(()=>!this.botNameOptions().showBotSelection)).subscribe()}toggleChat(){this.status.update(n=>!n)}fullScreenToggle(){console.log(this.chatContainer().nativeElement),this.document.fullscreenElement?this.document.exitFullscreen().then(()=>this.fullscreenStatus.set(!1)):this.chatContainer().nativeElement.requestFullscreen().then(()=>this.fullscreenStatus.set(!0))}listenToSendMessage(){return this.sendMessage$.pipe(ee(this.destroy$)).pipe(Ie(()=>!!this.messageCtrl.value.trim())).pipe(ge(()=>this.messageCtrl.value.trim())).pipe(O(()=>this.stopAnimate.set(!1))).pipe(O(()=>this.messageCtrl.setValue(""))).pipe(O(()=>this.recorder()?.cleartext())).pipe(O(()=>this.answerInProgress.set(!0))).pipe(O(()=>this.goToEndOfChat())).pipe(ct(n=>this.chatService.sendMessage(n,this.botNameOptions().showBotSelection?this.chatService.botNameCtrl.value:this.botNameOptions().botName).pipe(se(e=>{throw this.answerInProgress.set(!1),new Error(e)})).pipe(Wt()))).subscribe(()=>{this.answerInProgress.set(!1),Promise.resolve().then(()=>{this.messageInput()?.nativeElement?.focus();let n=setTimeout(()=>{this.scrollToTop(),clearInterval(n)},50)})})}scrollToTop(){let n=this.chatBodyContainer()?.nativeElement?.querySelectorAll(".chat-message"),e=n&&n[n.length-1],t=setInterval(()=>{e&&e.scrollIntoView(!0)},50);ne(o=>{!this.animating()&&t&&clearInterval(t),o(()=>{t&&clearInterval(t)})},{injector:this.injector})}goToEndOfChat(){let n=setTimeout(()=>{let e=this.chatBodyContainer()?.nativeElement?.querySelectorAll(".user-message");e&&e[e.length-1]?.scrollIntoView(!0),clearTimeout(n)})}clearChatHistory(){if(this.clearMessageOnly()){this.chatService.messages.set([]);return}this.chatService.messages.set([]),this.chatService.conversationId.set(""),this.ratingDone.set(!1)}toggleAvatar(){this.avatarOn=!this.avatarOn}detectFullScreenMode(){let n=!!this.document.fullscreenElement;n||this.fullscreenStatus.set(n)}rateConversation(n){let e=this.chatService.conversationId();this.chatHistoryService.addFeedback(e,n).pipe(ee(this.destroy$)).subscribe(()=>{this.ratingDone.set(!0)})}static \u0275fac=(()=>{let n;return function(t){return(n||(n=te(i)))(t||i)}})();static \u0275cmp=P({type:i,selectors:[["app-chat-container"]],viewQuery:function(e,t){e&1&&(X(t.chatContainer,Bi,5),X(t.chatBodyContainer,Oi,5),X(t.messageInput,Ni,5),X(t.recorder,Ri,5)),e&2&&ve(4)},hostBindings:function(e,t){e&1&&_("fullscreenchange",function(){return t.detectFullScreenMode()},!1,_t)},inputs:{showAvatarBtn:[1,"showAvatarBtn"],showClearMsgBtn:[1,"showClearMsgBtn"],showFullScreenBtn:[1,"showFullScreenBtn"],showHideBtn:[1,"showHideBtn"],showRatingBox:[1,"showRatingBox"],showRecorderBtn:[1,"showRecorderBtn"],title:[1,"title"],containerClass:[1,"containerClass"],botNameOptions:[1,"botNameOptions"],clearMessageOnly:[1,"clearMessageOnly"]},standalone:!0,features:[le,k],decls:29,vars:24,consts:[["chatContainer",""],["chatBody",""],["textArea",""],["recorder",""],[3,"ngClass"],[1,"bg-gray-200","border-b","border-primary/40","flex","justify-between","items-center","px-4","py-2"],[1,"flex","justify-center","items-center","gap-2"],[1,"block","p-1","w-24","text-sm","border-b-2","bg-transparent","border-gray-400","focus:ring-primary","focus:border-primary","outline-none",3,"matTooltip","matTooltipClass","formControl"],["matRipple","",1,"bg-gray-400","hover:bg-primary","border","rounded-full","p-1","text-white"],[1,"flex-auto","overflow-hidden","flex","flex-col","relative","min-h-0","p-4"],[1,"spinner","justify-center","flex","gap-1"],[1,"sticky","bottom-0","left-0","w-56","self-end","scale-90","hover:scale-95","hover:duration-300","hover:transition-transform","bg-gray-300/30","p-1","rounded-tl-md","rounded-tr-md","border","border-gray-300","border-b-0","shadow-sm","text-gray-700","flex","items-center","justify-evenly","gap-4","mt-auto","[&_button]:flex","[&_button]:flex-col","[&_button]:justify-center","[&_button]:items-center","[&_button]:text-sm","[&_button]:leading-none"],[1,"p-4","gap-2","flex","justify-center","items-stretch"],[1,"rounded-full","bg-white","relative","text-primary","hover:bg-gray-200","shadow","shadow-primary","overflow-hidden","border","flex-shrink-0","flex-grow-0","flex","items-center","justify-center","outline-none","ring-offset-1","focus:ring-2","ring-primary","size-12",3,"matTooltip"],[1,"bg-primary","rounded","outline-none","ring-offset-1","focus:ring-2","ring-primary","text-white","px-2",3,"click","matTooltip","disabled"],["xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 256 256",1,"size-8"],["d","M227.32,28.68a16,16,0,0,0-15.66-4.08l-.15,0L19.57,82.84a16,16,0,0,0-2.49,29.8L102,154l41.3,84.87A15.86,15.86,0,0,0,157.74,248q.69,0,1.38-.06a15.88,15.88,0,0,0,14-11.51l58.2-191.94c0-.05,0-.1,0-.15A16,16,0,0,0,227.32,28.68ZM157.83,231.85l-.05.14,0-.07-40.06-82.3,48-48a8,8,0,0,0-11.31-11.31l-48,48L24.08,98.25l-.07,0,.14,0L216,40Z"],[1,"relative","w-full"],[1,"border","w-full","outline-none","rounded","focus:ring-2","ring-offset-1","ring-primary","resize-none","p-2",3,"keydown.enter","formControl"],[1,"absolute","top-2","right-0","mr-1","rounded-full","bg-white","text-primary","hover:bg-gray-200","overflow-hidden","border-primary","border-2","flex-shrink-0","flex-grow-0","flex","items-center","justify-center","outline-none","ring-offset-1","focus:ring-2","ring-primary","size-7",3,"matTooltip"],["cdkDrag","",1,"bg-black","border","rounded-md","border-gray-200","size-80","z-30","rtl:right-[500px]","ltr:left-[500px]","rtl:mr-5","ltr:ml-m","absolute","bottom-10","overflow-hidden"],[3,"value"],["matRipple","",1,"bg-gray-400","hover:bg-primary","border","rounded-full","p-1","text-white",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 256 256",1,"size-6"],["d","M144,104V64a8,8,0,0,1,16,0V84.69l42.34-42.35a8,8,0,0,1,11.32,11.32L171.31,96H192a8,8,0,0,1,0,16H152A8,8,0,0,1,144,104Zm-40,40H64a8,8,0,0,0,0,16H84.69L42.34,202.34a8,8,0,0,0,11.32,11.32L96,171.31V192a8,8,0,0,0,16,0V152A8,8,0,0,0,104,144Zm67.31,16H192a8,8,0,0,0,0-16H152a8,8,0,0,0-8,8v40a8,8,0,0,0,16,0V171.31l42.34,42.35a8,8,0,0,0,11.32-11.32ZM104,56a8,8,0,0,0-8,8V84.69L53.66,42.34A8,8,0,0,0,42.34,53.66L84.69,96H64a8,8,0,0,0,0,16h40a8,8,0,0,0,8-8V64A8,8,0,0,0,104,56Z"],["d","M216,48V96a8,8,0,0,1-16,0V67.31l-42.34,42.35a8,8,0,0,1-11.32-11.32L188.69,56H160a8,8,0,0,1,0-16h48A8,8,0,0,1,216,48ZM98.34,146.34,56,188.69V160a8,8,0,0,0-16,0v48a8,8,0,0,0,8,8H96a8,8,0,0,0,0-16H67.31l42.35-42.34a8,8,0,0,0-11.32-11.32ZM208,152a8,8,0,0,0-8,8v28.69l-42.34-42.35a8,8,0,0,0-11.32,11.32L188.69,200H160a8,8,0,0,0,0,16h48a8,8,0,0,0,8-8V160A8,8,0,0,0,208,152ZM67.31,56H96a8,8,0,0,0,0-16H48a8,8,0,0,0-8,8V96a8,8,0,0,0,16,0V67.31l42.34,42.35a8,8,0,0,0,11.32-11.32Z"],["d","M176,128a8,8,0,0,1-8,8H88a8,8,0,0,1,0-16h80A8,8,0,0,1,176,128Zm56,0A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"],[1,"user-message","chat-message","ltr:self-end","min-w-[min(400px,100%)]","rtl:self-start","rtl:!rounded-tr-none","ltr:!rounded-tr-none"],[1,"assistant-message","chat-message","whitespace-break-spaces","ltr:self-start","min-w-[min(400px,100%)]","rtl:self-end","rtl:!rounded-tl-none","ltr:!rounded-tr-none"],[1,"system-message","chat-message"],["appTextWriterAnimator","",3,"animating","stop","text"],[1,"rect1"],[1,"rect2"],[1,"rect3"],[1,"rect4"],[1,"rect5"],[1,"bg-transparent","text-primary/80","hover:text-primary",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-6","fill-current"],["d","M5,9V21H1V9H5M9,21A2,2 0 0,1 7,19V9C7,8.45 7.22,7.95 7.59,7.59L14.17,1L15.23,2.06C15.5,2.33 15.67,2.7 15.67,3.11L15.64,3.43L14.69,8H21C22.11,8 23,8.9 23,10V12C23,12.26 22.95,12.5 22.86,12.73L19.84,19.78C19.54,20.5 18.83,21 18,21H9M9,19H18.03L21,12V10H12.21L13.34,4.68L9,9.03V19Z"],[1,"bg-transparent","text-gray-600","hover:text-gray-700",3,"click"],["d","M19,15V3H23V15H19M15,3A2,2 0 0,1 17,5V15C17,15.55 16.78,16.05 16.41,16.41L9.83,23L8.77,21.94C8.5,21.67 8.33,21.3 8.33,20.88L8.36,20.57L9.31,16H3C1.89,16 1,15.1 1,14V12C1,11.74 1.05,11.5 1.14,11.27L4.16,4.22C4.46,3.5 5.17,3 6,3H15M15,5H5.97L3,12V14H11.78L10.65,19.32L15,14.97V5Z"],[1,"rounded-full","bg-white","relative","text-primary","hover:bg-gray-200","shadow","shadow-primary","overflow-hidden","border","flex-shrink-0","flex-grow-0","flex","items-center","justify-center","outline-none","ring-offset-1","focus:ring-2","ring-primary","size-12",3,"click","matTooltip"],["d","M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM96,40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96Zm96,168H64V64H192ZM112,104v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Z"],[1,"absolute","top-2","right-0","mr-1","rounded-full","bg-white","text-primary","hover:bg-gray-200","overflow-hidden","border-primary","border-2","flex-shrink-0","flex-grow-0","flex","items-center","justify-center","outline-none","ring-offset-1","focus:ring-2","ring-primary","size-7",3,"click","matTooltip"],["xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 24 24",1,"size-8"],["d","M18,18H6V6H18V18Z"],[3,"recognized$","recognizing$"],["d","M18.72,14.76C19.07,13.91 19.26,13 19.26,12C19.26,11.28 19.15,10.59 18.96,9.95C18.31,10.1 17.63,10.18 16.92,10.18C13.86,10.18 11.15,8.67 9.5,6.34C8.61,8.5 6.91,10.26 4.77,11.22C4.73,11.47 4.73,11.74 4.73,12A7.27,7.27 0 0,0 12,19.27C13.05,19.27 14.06,19.04 14.97,18.63C15.54,19.72 15.8,20.26 15.78,20.26C14.14,20.81 12.87,21.08 12,21.08C9.58,21.08 7.27,20.13 5.57,18.42C4.53,17.38 3.76,16.11 3.33,14.73H2V10.18H3.09C3.93,6.04 7.6,2.92 12,2.92C14.4,2.92 16.71,3.87 18.42,5.58C19.69,6.84 20.54,8.45 20.89,10.18H22V14.67H22V14.69L22,14.73H21.94L18.38,18L13.08,17.4V15.73H17.91L18.72,14.76M9.27,11.77C9.57,11.77 9.86,11.89 10.07,12.11C10.28,12.32 10.4,12.61 10.4,12.91C10.4,13.21 10.28,13.5 10.07,13.71C9.86,13.92 9.57,14.04 9.27,14.04C8.64,14.04 8.13,13.54 8.13,12.91C8.13,12.28 8.64,11.77 9.27,11.77M14.72,11.77C15.35,11.77 15.85,12.28 15.85,12.91C15.85,13.54 15.35,14.04 14.72,14.04C14.09,14.04 13.58,13.54 13.58,12.91A1.14,1.14 0 0,1 14.72,11.77Z"],[1,"w-full","flex"],[1,"w-full","bg-gray-200","p-2","text-center","relative"],["cdkDragHandle","","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-6","absolute","top-0","right-0","cursor-move","fill-gray-500","m-2"],["d","M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"],[1,"w-full",3,"size"],[1,"absolute","z-10","top-12","w-12","mx-4"]],template:function(e,t){if(e&1){let o=x();r(0,"div",4,0)(2,"div",4)(3,"div",5)(4,"div",6)(5,"span"),p(6),s(),C(7,$i,4,5,"select",7),s(),r(8,"div"),C(9,Zi,3,1,"button",8)(10,qi,3,0,"button",8),s()(),r(11,"div",9,1),T(13,Qi,3,1,null,null,Di),C(15,Xi,6,0,"div",10)(16,Ji,11,4,"div",11),s(),r(17,"div",12),C(18,en,3,1,"button",13),r(19,"button",14),_("click",function(){return u(o),g(t.sendMessage$.next())}),V(),r(20,"svg",15),m(21,"path",16),s()(),G(),r(22,"div",17)(23,"input",18,2),_("keydown.enter",function(){return u(o),g(t.sendMessage$.next())}),s(),C(25,tn,3,1,"button",19),s(),C(26,nn,2,0,"app-recorder")(27,on,3,1,"button",13),s()(),C(28,an,8,2,"div",20),s()}e&2&&(d("ngClass",A(19,Hi,!t.status())),a(2),xt("z-20 bg-white w-[500px] ",t.containerClass()," h-[600px] relative shadow-2xl rounded-md overflow-hidden bottom-5 max-h-full max-w-full flex flex-col"),d("ngClass",ce(21,zi,t.fullscreenStatus(),!t.fullscreenStatus())),a(4),M(t.title()),a(),f(t.botNameOptions().showBotSelection?7:-1),a(2),f(t.showFullScreenBtn()?9:-1),a(),f(t.showHideBtn()?10:-1),a(3),I(t.chatService.messages()),a(2),f(t.answerInProgress()?15:-1),a(),f(t.chatService.messages().length>1&&!t.ratingDone()&&t.showRatingBox()?16:-1),a(2),f(t.showClearMsgBtn()?18:-1),a(),d("matTooltip",t.lang.locals.send)("disabled",t.answerInProgress()),a(4),d("formControl",t.messageCtrl),a(2),f(t.animating()?25:-1),a(),f(t.showRecorderBtn()?26:-1),a(),f(t.showAvatarBtn()?27:-1),a(),f(t.avatarOn?28:-1))},dependencies:[ye,Nt,Rt,Mt,Ot,Ft,Bt,ti,me,F,ei,ii,ni,di,ai,oi,Lt]})};var rn=["timelineSvg"];function sn(i,n){if(i&1){let e=x();V(),r(0,"rect",12),_("mousemove",function(o){u(e);let l=c().$implicit,v=c();return g(v.onRectMouseMoveOptimized(o,!0,l==null?null:l.instanceTooltipColor))})("mouseleave",function(){u(e);let o=c(2);return g(o.hideTooltip())})("click",function(o){let l=u(e),v=l.$implicit,S=l.$index,H=c(2);return g(H.onInstanceClick(S,v,o))}),s()}if(i&2){let e,t=n.$implicit,o=c().$implicit,l=c();d("ngClass",(e=o==null?null:o.instanceColor)!==null&&e!==void 0?e:"fill-primary"),Q("width",l.calculateWidth(t))("x",l.calculatePosition(t))}}function ln(i,n){if(i&1&&T(0,sn,1,3,":svg:rect",11,L),i&2){let e=n.$implicit;I(e.instances)}}function cn(i,n){if(i&1&&(r(0,"div",13)(1,"div",14),p(2),m(3,"div",15),s()()),i&2){let e=c();Z("left",e.tooltipPosition+"px"),d("ngClass",e.tooltipBackgroundClass),a(2),y(" ",e.tooltipTime," "),a(),d("ngClass",e.tooltipBackgroundClass)}}var j=class i{instanceGroup=w.required();instanceClicked=_e();timelineSvg;progressWidth=0;tooltipVisible=!1;tooltipPosition=0;currentInstanceIndex=0;currentPercentage=0;tooltipTime="";tooltipBackgroundClass="bg-gray-800";lastMouseMoveTime=0;ngZone=b(ft);videoAnalyzer=b($);lang=b(B);onRectMouseMoveOptimized(n,e=!1,t){let o=performance.now();o-this.lastMouseMoveTime<16||(this.lastMouseMoveTime=o,this.ngZone.runOutsideAngular(()=>{let l=this.timelineSvg.nativeElement.getBoundingClientRect(),v=n.clientX-l.left,S=l.width,H=v/S*100;this.tooltipPosition=v-22,this.tooltipTime=this.percentageToTime(H),this.tooltipBackgroundClass=t??"bg-gray-300",e&&(this.tooltipBackgroundClass=t??"bg-primary"),this.ngZone.run(()=>{this.tooltipVisible=!0})}))}onTimelineClick(n){let e=this.timelineSvg.nativeElement.getBoundingClientRect(),t=n.clientX-e.left,o=e.width,l=t/o*100;this.progressWidth=l,this.currentPercentage=l;let v=this.percentageToTime(l);this.videoAnalyzer.timelineSeek.next(W(v))}calculateWidth(n){let e=this.timeToPercentage(n.adjustedStart);return(this.timeToPercentage(n.adjustedEnd)-e).toFixed(2)+"%"}calculatePosition(n){return this.timeToPercentage(n.adjustedStart).toFixed(2)+"%"}onInstanceClick(n,e,t){t.stopPropagation();let o=this.timelineSvg.nativeElement.getBoundingClientRect(),l=t.clientX-o.left,v=o.width,S=l/v*100;this.progressWidth=S,this.currentPercentage=S;let H=this.percentageToTime(S);this.instanceClicked.emit(n),this.videoAnalyzer.timelineSeek.next(W(H))}hideTooltip(){this.tooltipVisible=!1}navigateToInstance(n){let e=this.timeToPercentage(n.adjustedStart);this.progressWidth=e,this.currentPercentage=e;let t=n.adjustedStart;this.videoAnalyzer.timelineSeek.next(W(t))}navigateToNextInstance(){let n=null;for(let e of this.instanceGroup())for(let t of e.instances)this.timeToPercentage(t.adjustedStart)>this.currentPercentage&&(!n||this.timeToPercentage(t.adjustedStart)<this.timeToPercentage(n.adjustedStart))&&(n=t);n&&this.navigateToInstance(n)}navigateToPreviousInstance(){let n=null;for(let e of this.instanceGroup())for(let t of e.instances)this.timeToPercentage(t.adjustedStart)<this.currentPercentage&&(!n||this.timeToPercentage(t.adjustedStart)>this.timeToPercentage(n.adjustedStart))&&(n=t);n&&this.navigateToInstance(n)}timeToPercentage(n){let e=this.parseTimeToSeconds(n),t=this.parseTimeToSeconds(this.videoAnalyzer.videoDuration());return e/t*100}percentageToTime(n){let e=this.parseTimeToSeconds(this.videoAnalyzer.videoDuration()),t=n/100*e;return this.secondsToTime(t)}parseTimeToSeconds(n){let[e,t,o]=n.split(/[:.]/).map(Number);return(e||0)*3600+(t||0)*60+(o||0)}secondsToTime(n){let e=Math.floor(n/3600),t=Math.floor(n%3600/60),o=Math.floor(n%60);return`${e}:${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-insights-timeline"]],viewQuery:function(e,t){if(e&1&&yt(rn,7),e&2){let o;bt(o=St())&&(t.timelineSvg=o.first)}},inputs:{instanceGroup:[1,"instanceGroup"]},outputs:{instanceClicked:"instanceClicked"},standalone:!0,features:[k],decls:17,vars:4,consts:[["timelineSvg",""],[1,"relative","w-full","h-12"],["width","100%","height","50","xmlns","http://www.w3.org/2000/svg",1,"w-full","h-full","group",3,"mouseleave","click"],["width","100%","height","12","y","30",1,"fill-gray-300","cursor-pointer",3,"mousemove","mouseleave"],["height","5","y","42",1,"fill-gray-700","transition-all","duration-300","opacity-0","group-hover:opacity-100"],[1,"absolute","bottom-0","transform","-translate-y-full","text-white","text-xs","p-2","rounded","shadow","z-10",3,"left","ngClass"],[1,"flex","justify-between","mt-2"],[1,"inline-flex","py-[1cap]","justify-center","items-center","gap-[.5cap]","px-4","w-1/5","bg-gray-300","shadow-sm","text-gray-800","text-sm","rounded","hover:bg-primary","hover:underline","hover:text-white","transition-all",3,"click"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-[3cap]"],["d","M5.59,7.41L7,6L13,12L7,18L5.59,16.59L10.17,12L5.59,7.41M11.59,7.41L13,6L19,12L13,18L11.59,16.59L16.17,12L11.59,7.41Z"],["d","M18.41,7.41L17,6L11,12L17,18L18.41,16.59L13.83,12L18.41,7.41M12.41,7.41L11,6L5,12L11,18L12.41,16.59L7.83,12L12.41,7.41Z"],["height","12","y","30",1,"cursor-pointer","transition-colors",3,"ngClass"],["height","12","y","30",1,"cursor-pointer","transition-colors",3,"mousemove","mouseleave","click","ngClass"],[1,"absolute","bottom-0","transform","-translate-y-full","text-white","text-xs","p-2","rounded","shadow","z-10",3,"ngClass"],[1,"relative"],[1,"absolute","left-1/2","transform","-translate-x-1/2","mt-1","w-2","h-2","rotate-45",3,"ngClass"]],template:function(e,t){if(e&1){let o=x();r(0,"div",1),V(),r(1,"svg",2,0),_("mouseleave",function(){return u(o),g(t.hideTooltip())})("click",function(v){return u(o),g(t.onTimelineClick(v))}),r(3,"rect",3),_("mousemove",function(v){return u(o),g(t.onRectMouseMoveOptimized(v))})("mouseleave",function(){return u(o),g(t.hideTooltip())}),s(),m(4,"rect",4),T(5,ln,2,0,null,null,L),s(),C(7,cn,4,5,"div",5),s(),G(),r(8,"div",6)(9,"button",7),_("click",function(){return u(o),g(t.navigateToPreviousInstance())}),V(),r(10,"svg",8),m(11,"path",9),s(),p(12),s(),G(),r(13,"button",7),_("click",function(){return u(o),g(t.navigateToNextInstance())}),p(14),V(),r(15,"svg",8),m(16,"path",10),s()()()}e&2&&(a(4),Q("width",t.progressWidth+"%"),a(),I(t.instanceGroup()),a(2),f(t.tooltipVisible?7:-1),a(5),y(" ",t.lang.locals.previous," "),a(2),y(" ",t.lang.locals.next," "))},dependencies:[F]})};var oe=class i{transform(n,e){return ui(n,e)}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=Me({name:"appearancePercentage",type:i,pure:!0,standalone:!0})};var dn=i=>({"outline outline-2 outline-offset-2 outline-primary":i});function pn(i,n){if(i&1){let e=x();r(0,"div",7),_("keydown",function(){let o=u(e).$implicit,l=c();return g(l.selectedPerson.set(o))})("click",function(){let o=u(e).$implicit,l=c();return g(l.selectedPerson.set(o))}),r(1,"picture",8),m(2,"div",9),s()()}if(i&2){let e,t=n.$implicit,o=c();a(),d("ngClass",A(3,dn,((e=o.selectedPerson())==null?null:e.id)===t.id)),a(),Z("background-image","url("+t.thumbnail_url+")")}}function mn(i,n){i&1&&(V(),r(0,"svg",23),m(1,"path",25),s())}function un(i,n){i&1&&(V(),r(0,"svg",23),m(1,"path",26),s())}function gn(i,n){if(i&1){let e=x();r(0,"button",21),_("click",function(){u(e);let o=c(2);return g(o.toggleDescription())}),r(1,"span",22),p(2),s(),C(3,mn,2,0,":svg:svg",23)(4,un,2,0,":svg:svg",23),s(),r(5,"a",24),p(6),s()}if(i&2){let e,t=c(2);a(2),y(" ",t.lang.locals.show_description," "),a(),f(t.showBiography()?3:4),a(2),d("href","https://www.bing.com/search?q="+((e=t.selectedPerson())==null?null:e.name),U),a(),M(t.lang.locals.find_on_bing)}}function fn(i,n){if(i&1&&(r(0,"div",20)(1,"p"),p(2),r(3,"a",27),p(4),s()()()),i&2){let e,t,o=c(2);Q("aria-hidden",!o.showBiography())("aria-expanded",o.showBiography()),a(2),y(" ",(e=o.selectedPerson())==null?null:e.description,"... "),a(),d("href","https://www.bing.com/search?q="+((t=o.selectedPerson())==null?null:t.name),U),a(),M(o.lang.locals.read_more)}}function hn(i,n){if(i&1&&(r(0,"div",5)(1,"div",10)(2,"picture",11),m(3,"div",12),s()(),r(4,"div",13)(5,"p",14),p(6),V(),r(7,"svg",15),R(8,"percent"),m(9,"path",16),s()(),G(),r(10,"p",17),p(11),s(),r(12,"div",18)(13,"p",19),p(14),R(15,"appearancePercentage"),R(16,"number"),s(),C(17,gn,7,4),s(),C(18,fn,5,5,"div",20),s()()),i&2){let e,t,o,l,v,S=c();a(3),Z("background-image","url("+((e=S.selectedPerson())==null?null:e.thumbnail_url)+")"),a(3),y(" ",(t=S.selectedPerson())==null?null:t.name," "),a(),d("matTooltip",q(8,10,(o=S.selectedPerson())==null?null:o.confidence,"3.2-2")+"certintyThis celebrity identification is an esitmate and might be incorrect."),a(4),M((l=S.selectedPerson())==null?null:l.title),a(3),wt(" ",S.lang.locals.appear_in," ",q(16,16,q(15,13,S.selectedPerson().instances,S.videoAnalyzer.videoLengthInSeconds()),"1.2-2")," % ",S.lang.locals.of_video," "),a(3),f((v=S.selectedPerson())!=null&&v.referenceId?17:-1),a(),f(S.showBiography()?18:-1)}}var ze=class i{people=w.required();selectedPerson=h(void 0);instanceGroup=E(()=>this.selectedPerson()?[{instances:this.selectedPerson()?.instances}]:[]);showBiography=h(!1);videoAnalyzer=b($);lang=b(B);toggleDescription(){this.showBiography.update(()=>!this.showBiography())}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-insights-people"]],inputs:{people:[1,"people"]},standalone:!0,features:[k],decls:9,vars:4,consts:[[1,"p-4","w-full"],[1,"text-xl","font-semibold","text-gray-700","p-4"],[1,"p-4","flex-col"],[1,"flex","gap-2"],["role","tab","tabindex","-1",1,"relative","size-10","bg-transparent","transition-all","hover:scale-110","ease-in-out","duration-300"],[1,"inline-flex","items-center","gap-4"],[3,"instanceGroup"],["role","tab","tabindex","-1",1,"relative","size-10","bg-transparent","transition-all","hover:scale-110","ease-in-out","duration-300",3,"keydown","click"],[1,"flex","justify-center","items-center","size-10","rounded-full","cursor-pointer",3,"ngClass"],[1,"relative","size-10","rounded-full","bg-cover","bg-center"],[1,"relative","size-20","bg-transparent"],[1,"flex","justify-center","items-center","size-20","rounded-full"],[1,"relative","size-20","rounded-full","bg-cover","bg-center"],[1,"flex","flex-col"],[1,"font-light","text-lg","text-gray-700"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"absolute","size-3","-left-3","-mx-1","top-0",3,"matTooltip"],["d","M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z"],[1,"font-light","text-sm","text-gray-500"],[1,"flex","justify-between","gap-4","text-sm"],[1,"text-gray-500","font-light"],[1,"text-gray-500","text-sm"],["type","button",1,"inline-flex","items-center","gap-2","bg-transparent","outline-none","text-primary",3,"click"],[1,"hover:underline"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-3"],[1,"text-gray-500","hover:text-primary","hover:underline",3,"href"],["d","M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"],["d","M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"],[3,"href"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h2",1),p(2),s(),r(3,"div",2)(4,"div",3),T(5,pn,3,5,"div",4,L),s()(),C(7,hn,19,19,"div",5),m(8,"app-insights-timeline",6),s()),e&2&&(a(2),N("",t.people().length," ",t.lang.locals.people,""),a(3),I(t.people()),a(2),f(t.selectedPerson()?7:-1),a(),d("instanceGroup",t.instanceGroup()))},dependencies:[j,F,de,oe,me,Oe]})};var _n=i=>({"outline outline-2 outline-offset-2 outline-primary":i});function vn(i,n){if(i&1){let e=x();r(0,"div",6),_("keydown",function(){let o=u(e).$implicit,l=c();return g(l.selectedObservedPerson.set(o))})("click",function(){let o=u(e).$implicit,l=c();return g(l.selectedObservedPerson.set(o))}),r(1,"picture",7),m(2,"div",8),s()()}if(i&2){let e,t=n.$implicit,o=c();a(),d("ngClass",A(3,_n,((e=o.selectedObservedPerson())==null?null:e.id)===t.id)),a(),Z("background-image","url("+t.thumbnail_url+")")}}function Cn(i,n){if(i&1&&(r(0,"p",16),p(1),R(2,"titlecase"),s()),i&2){let e=n.$implicit;a(),M(xe(2,1,e))}}function xn(i,n){if(i&1&&(r(0,"div",4)(1,"div",9)(2,"picture",10),m(3,"div",11),s()(),r(4,"div",12)(5,"p",13),p(6),s(),r(7,"p",14),p(8),R(9,"appearancePercentage"),R(10,"number"),s(),r(11,"div",15),T(12,Cn,3,3,"p",16,L),s()()()),i&2){let e,t,o=c();a(3),Z("background-image","url("+((e=o.selectedObservedPerson())==null?null:e.thumbnail_url)+")"),a(3),y("Observed person ",o.selectedObservedPerson().id+1,""),a(2),y(" Appears in ",q(10,7,q(9,4,o.selectedObservedPerson().instances,o.videoAnalyzer.videoLengthInSeconds()),"1.2-2")," % "),a(4),I((t=o.selectedObservedPerson())==null?null:t.clothingList)}}var Ge=class i{observedPeople=w.required({transform:gi});selectedObservedPerson=h(void 0);instanceGroup=E(()=>this.selectedObservedPerson()?[{instances:this.selectedObservedPerson()?.instances}]:[]);videoAnalyzer=b($);static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-insights-observed-people"]],inputs:{observedPeople:[1,"observedPeople"]},standalone:!0,features:[k],decls:8,vars:3,consts:[[1,"p-4","w-full"],[1,"text-xl","font-semibold","text-gray-700","p-4"],[1,"flex","flex-wrap","gap-2","p-4"],["role","tab","tabindex","-1",1,"relative","w-10","h-20","bg-transparent","transition-all","hover:scale-110","ease-in-out","duration-300"],[1,"inline-flex","items-start","gap-4","p-4"],[3,"instanceGroup"],["role","tab","tabindex","-1",1,"relative","w-10","h-20","bg-transparent","transition-all","hover:scale-110","ease-in-out","duration-300",3,"keydown","click"],[1,"flex","justify-center","items-center","w-10","h-20","cursor-pointer",3,"ngClass"],[1,"relative","w-10","h-20","bg-cover","bg-center"],[1,"relative","w-14","h-28","bg-transparent"],[1,"flex","justify-center","items-center","w-14","h-28"],[1,"relative","w-14","h-28","bg-cover","bg-center"],[1,"flex","flex-col"],[1,"font-light","text-lg","text-gray-700"],[1,"font-light","text-gray-500"],[1,"flex","flex-nowrap","gap-2"],[1,"font-light","text-sm","text-gray-500"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h2",1),p(2),s(),r(3,"div",2),T(4,vn,3,5,"div",3,L),s(),C(6,xn,14,10,"div",4),m(7,"app-insights-timeline",5),s()),e&2&&(a(2),y("",t.observedPeople().length," Observed people"),a(2),I(t.observedPeople()),a(2),f(t.selectedObservedPerson()?6:-1),a(),d("instanceGroup",t.instanceGroup()))},dependencies:[j,F,oe,de,Pt]})};var yn=(i,n)=>({"rounded-xl border border-gray-700 cursor-pointer px-4":i,"!bg-primary !text-white":n}),bn=i=>({"!bg-primary !text-white":i});function Sn(i,n){if(i&1){let e=x();r(0,"button",7),_("click",function(o){u(e);let l=c().$implicit,v=c();return g(l.groupId?v.selectedTopicId.set(l.groupId):o.stopPropagation())}),p(1),s(),r(2,"span",8),p(3,"/"),s()}if(i&2){let e=c().$implicit,t=c();d("ngClass",ce(2,yn,e.isParentClickable,t.selectedTopicId()===e.groupId)),a(),y(" ",e.groupName," ")}}function wn(i,n){if(i&1){let e=x();r(0,"button",9),_("click",function(){let o=u(e).$implicit,l=c(2);return g(l.selectedTopicId.set(o.id))}),p(1),s()}if(i&2){let e=n.$implicit,t=c(2);d("ngClass",A(2,bn,t.selectedTopicId()===e.id)),a(),y(" ",e.name," ")}}function Tn(i,n){if(i&1&&(r(0,"div",3)(1,"div",5),C(2,Sn,4,5),T(3,wn,2,4,"button",6,L),s()()),i&2){let e=n.$implicit;a(2),f(e.groupName?2:-1),a(),I(e.children)}}var $e=class i{topics=w.required();selectedTopicId=h(void 0);groupedTopics=E(()=>fi(this.topics()));instances=E(()=>this.topics().find(n=>n.id===this.selectedTopicId())?.instances??[]);instanceGroup=E(()=>this.instances().length>0?[{instances:this.instances()}]:[]);lang=b(B);static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-insights-topics"]],inputs:{topics:[1,"topics"]},standalone:!0,features:[k],decls:7,vars:3,consts:[[1,"p-4","w-full"],[1,"text-xl","font-semibold","text-gray-700","p-4"],[1,"flex","flex-col","p-4","space-y-2"],[1,"flex","flex-col"],[3,"instanceGroup"],[1,"flex","justify-start","items-center","gap-1","flex-wrap"],["type","button",1,"bg-transparent","outline-none","rounded-xl","text-sm","border","border-gray-700","text-700","px-4","text-gray-700",3,"ngClass"],["type","button",1,"bg-transparent","cursor-default","outline-none","rounded-xl","text-sm","text-700","text-gray-700",3,"click","ngClass"],[1,"text-gray-700"],["type","button",1,"bg-transparent","outline-none","rounded-xl","text-sm","border","border-gray-700","text-700","px-4","text-gray-700",3,"click","ngClass"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h2",1),p(2),s(),r(3,"div",2),T(4,Tn,5,1,"div",3,L),s(),m(6,"app-insights-timeline",4),s()),e&2&&(a(2),N("",t.topics().length," ",t.lang.locals.topics,""),a(2),I(t.groupedTopics()),a(2),d("instanceGroup",t.instanceGroup()))},dependencies:[j,F]})};var In=i=>({"!bg-primary !text-white":i});function Vn(i,n){if(i&1){let e=x();r(0,"button",6),_("click",function(){let o=u(e).$implicit,l=c();return g(l.selectedAudioId.set(o.id))}),p(1),s()}if(i&2){let e=n.$implicit,t=c();d("ngClass",A(2,In,t.selectedAudioId()===e.id)),a(),y(" ",e.type," ")}}var je=class i{audioEffects=w.required();selectedAudioId=h(void 0);lang=b(B);instances=E(()=>this.audioEffects().find(n=>n.id===this.selectedAudioId())?.instances??[]);instanceGroup=E(()=>this.instances().length>0?[{instances:this.instances()}]:[]);static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-insights-audio-effects"]],inputs:{audioEffects:[1,"audioEffects"]},standalone:!0,features:[k],decls:8,vars:3,consts:[[1,"p-4","w-full"],[1,"text-xl","font-semibold","text-gray-700","p-4"],[1,"flex","p-4"],[1,"flex","flex-wrap","gap-2"],["type","button",1,"bg-transparent","outline-none","rounded-xl","text-sm","border","border-gray-700","text-700","px-4","text-gray-700",3,"ngClass"],[3,"instanceGroup"],["type","button",1,"bg-transparent","outline-none","rounded-xl","text-sm","border","border-gray-700","text-700","px-4","text-gray-700",3,"click","ngClass"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h2",1),p(2),s(),r(3,"div",2)(4,"div",3),T(5,Vn,2,4,"button",4,L),s()(),m(7,"app-insights-timeline",5),s()),e&2&&(a(2),N("",t.audioEffects().length," ",t.lang.locals.audio_effects,""),a(3),I(t.audioEffects()),a(2),d("instanceGroup",t.instanceGroup()))},dependencies:[j,F]})};var hi=i=>({"!bg-primary !text-white":i});function En(i,n){if(i&1){let e=x();r(0,"button",8),_("click",function(){let o=u(e).$implicit,l=c(2);return g(l.selectedLabelId.set(o.id))}),p(1),s()}if(i&2){let e=n.$implicit,t=c(2);d("ngClass",A(2,hi,t.selectedLabelId()===e.id)),a(),y(" ",e.name," ")}}function Ln(i,n){if(i&1){let e=x();T(0,En,2,4,"button",6,L),r(2,"button",7),_("click",function(){u(e);let o=c();return g(o.showAll.set(!0))}),p(3),s()}if(i&2){let e=c();I(e.visibleLabels()),a(2),d("title",e.lang.locals.show_more),a(),y(" +",e.remainingCount()," ")}}function Pn(i,n){if(i&1){let e=x();r(0,"button",8),_("click",function(){let o=u(e).$implicit,l=c(2);return g(l.selectedLabelId.set(o.id))}),p(1),s()}if(i&2){let e=n.$implicit,t=c(2);d("ngClass",A(2,hi,t.selectedLabelId()===e.id)),a(),y(" ",e.name," ")}}function kn(i,n){if(i&1&&T(0,Pn,2,4,"button",6,L),i&2){let e=c();I(e.labels())}}var Ue=class i{labels=w.required();selectedLabelId=h(void 0);lang=b(B);instances=E(()=>this.labels().find(n=>n.id===this.selectedLabelId())?.instances??[]);instanceGroup=E(()=>this.instances().length>0?[{instances:this.instances()}]:[]);maxItems=10;showAll=h(!1);visibleLabels=E(()=>this.showAll()?this.labels():this.labels().slice(0,this.maxItems));remainingCount=E(()=>Math.max(this.labels().length-this.maxItems,0));static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-insights-labels"]],inputs:{labels:[1,"labels"]},standalone:!0,features:[k],decls:8,vars:4,consts:[[1,"p-4","w-full"],[1,"text-xl","font-semibold","text-gray-700","p-4"],[1,"flex","p-4"],[1,"flex","flex-wrap","gap-2"],[1,"bg-gray-300","text-gray-700","rounded-xl","text-sm","border","border-gray-700","px-4",3,"title"],[3,"instanceGroup"],["type","button",1,"bg-transparent","outline-none","rounded-xl","text-sm","border","border-gray-700","text-700","px-4","text-gray-700",3,"ngClass"],[1,"bg-gray-300","text-gray-700","rounded-xl","text-sm","border","border-gray-700","px-4",3,"click","title"],["type","button",1,"bg-transparent","outline-none","rounded-xl","text-sm","border","border-gray-700","text-700","px-4","text-gray-700",3,"click","ngClass"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h2",1),p(2),s(),r(3,"div",2)(4,"div",3),C(5,Ln,4,2,"button",4)(6,kn,2,0),s()(),m(7,"app-insights-timeline",5),s()),e&2&&(a(2),N("",t.labels().length," ",t.lang.locals.labels,""),a(3),f(t.labels().length>t.maxItems&&!t.showAll()?5:6),a(2),d("instanceGroup",t.instanceGroup()))},dependencies:[j,F]})};var An=(i,n)=>({$implicit:i,type:"LOCATION",label:n}),Mn=(i,n)=>({$implicit:i,type:"PEOPLE",label:n}),Fn=(i,n)=>({$implicit:i,type:"BRAND",label:n}),_i=i=>({"!bg-primary !text-white":i});function Bn(i,n){i&1&&Be(0)}function On(i,n){if(i&1&&C(0,Bn,1,0,"ng-container",6),i&2){let e=c(),t=Ce(10);d("ngTemplateOutlet",t)("ngTemplateOutletContext",ce(2,An,e.namedLocations,e.lang.locals.locations))}}function Nn(i,n){i&1&&Be(0)}function Rn(i,n){if(i&1&&C(0,Nn,1,0,"ng-container",6),i&2){let e=c(),t=Ce(10);d("ngTemplateOutlet",t)("ngTemplateOutletContext",ce(2,Mn,e.namedPeople,e.lang.locals.people))}}function Dn(i,n){i&1&&Be(0)}function Hn(i,n){if(i&1&&C(0,Dn,1,0,"ng-container",6),i&2){let e=c(),t=Ce(10);d("ngTemplateOutlet",t)("ngTemplateOutletContext",ce(2,Fn,e.brands,e.lang.locals.brands))}}function zn(i,n){i&1&&(V(),r(0,"svg",13),m(1,"path",16),s())}function Gn(i,n){i&1&&(V(),r(0,"svg",13),m(1,"path",17),s())}function $n(i,n){if(i&1&&(r(0,"div",15)(1,"p"),p(2),r(3,"a",18),p(4,"read more"),s()()()),i&2){let e,t,o=c(2);Q("aria-hidden",!o.showDescription())("aria-expanded",o.showDescription()),a(2),y("",(e=o.selectedEntity())==null?null:e.description,"... "),a(),d("href",(t=o.selectedEntity())==null?null:t.referenceUrl,U)}}function jn(i,n){if(i&1){let e=x();r(0,"div",4)(1,"div",7)(2,"span",8),p(3),V(),r(4,"svg",9),R(5,"appearancePercentage"),R(6,"number"),R(7,"percent"),m(8,"path",10),s()(),G(),r(9,"button",11),_("click",function(){u(e);let o=c();return g(o.toggleDescription())}),r(10,"span",12),p(11),s(),C(12,zn,2,0,":svg:svg",13)(13,Gn,2,0,":svg:svg",13),s(),r(14,"a",14),p(15),s()(),C(16,$n,5,4,"div",15),s()}if(i&2){let e,t,o,l=c();a(3),y("",(e=l.selectedEntity())==null?null:e.name," "),a(),d("matTooltip",l.lang.locals.appear_in+q(6,10,q(5,7,l.selectedEntity().instances,l.videoAnalyzer.videoLengthInSeconds()),"1.2-2")+"%. "+l.lang.locals.of_video+q(7,13,(t=l.selectedEntity())==null?null:t.confidence,"3.2-2")+l.lang.locals.certainty+". "+l.lang.locals.this_is_an_estimated_identification_and_might_be_incorrect),a(7),y(" ",l.lang.locals.show_description," "),a(),f(l.showDescription()?12:13),a(2),d("href","https://www.bing.com/search?q="+((o=l.selectedEntity())==null?null:o.referenceId),U),a(),M(l.lang.locals.find_on_bing),a(),f(l.showDescription()?16:-1)}}function Un(i,n){if(i&1){let e=x();r(0,"button",24),_("click",function(){let o=u(e).$implicit,l=c(2).type,v=c();return v.selectedEntity.set(o),g(v.selectedEntityType.set(l))}),p(1),s()}if(i&2){let e,t=n.$implicit,o=c(2).type,l=c();d("ngClass",A(2,_i,((e=l.selectedEntity())==null?null:e.id)===t.id&&l.selectedEntityType()===o)),a(),y(" ",t.name," ")}}function Zn(i,n){if(i&1){let e=x();T(0,Un,2,4,"button",22,L),r(2,"button",23),_("click",function(){u(e);let o=c().type,l=c();return g(l.toggleShowAll(o))}),p(3),s()}if(i&2){let e=c().type,t=c();I(t.visibleEntities[e]()),a(2),d("title",t.lang.locals.show_more),a(),y(" +",t.remainingCount[e]()," ")}}function qn(i,n){if(i&1){let e=x();r(0,"button",24),_("click",function(){let o=u(e).$implicit,l=c(2).type,v=c();return v.selectedEntity.set(o),g(v.selectedEntityType.set(l))}),p(1),s()}if(i&2){let e,t=n.$implicit,o=c(2).type,l=c();d("ngClass",A(2,_i,((e=l.selectedEntity())==null?null:e.id)===t.id&&l.selectedEntityType()===o)),a(),y(" ",t.name," ")}}function Kn(i,n){if(i&1&&T(0,qn,2,4,"button",22,L),i&2){let e=c().$implicit;I(e())}}function Wn(i,n){if(i&1&&(r(0,"div")(1,"span",19),p(2),s()(),r(3,"div",20),C(4,Zn,4,2,"button",21)(5,Kn,2,0),s()),i&2){let e=n.$implicit,t=n.type,o=n.label,l=c();a(2),N("",e().length," ",o,""),a(2),f(e().length>l.maxItems&&!l.showAll()[t]?4:5)}}var Ze=class i{lang=b(B);videoAnalyzer=b($);brands=w.required();namedLocations=w.required();namedPeople=w.required();selectedEntity=h(void 0);selectedEntityType=h(void 0);showDescription=h(!1);instanceGroup=E(()=>this.selectedEntity()?[{instances:this.selectedEntity()?.instances}]:[]);maxItems=10;showAll=h({BRAND:!1,LOCATION:!1,PEOPLE:!1});toggleShowAll(n){this.showAll.update(e=>Pe(ue({},e),{[n]:!0}))}visibleEntities={BRAND:E(()=>this.showAll().BRAND?this.brands():this.brands().slice(0,this.maxItems)),LOCATION:E(()=>this.showAll().LOCATION?this.namedLocations():this.namedLocations().slice(0,this.maxItems)),PEOPLE:E(()=>this.showAll().PEOPLE?this.namedPeople():this.namedPeople().slice(0,this.maxItems))};remainingCount={BRAND:E(()=>Math.max(this.brands().length-this.maxItems,0)),LOCATION:E(()=>Math.max(this.namedLocations().length-this.maxItems,0)),PEOPLE:E(()=>Math.max(this.namedPeople().length-this.maxItems,0))};entitiesCount=E(()=>[this.brands(),this.namedLocations(),this.namedPeople()].map(n=>n?.length??0).reduce((n,e)=>n+e,0));toggleDescription(){this.showDescription.update(()=>!this.showDescription())}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-insights-named-entities"]],inputs:{brands:[1,"brands"],namedLocations:[1,"namedLocations"],namedPeople:[1,"namedPeople"]},standalone:!0,features:[k],decls:11,vars:7,consts:[["namedEntity",""],[1,"p-4","w-full"],[1,"text-xl","font-semibold","text-gray-700","p-4"],[1,"flex","flex-col","space-y-2"],[1,"flex","flex-col","space-y-2","p-4"],[3,"instanceGroup"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","flex-row","gap-8","items-center","text-gray-700","text-sm"],[1,"relative","text-base"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"absolute","size-3","-left-3","-mx-1","top-0",3,"matTooltip"],["d","M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z"],["type","button",1,"inline-flex","items-center","gap-2","bg-transparent","outline-none","text-primary",3,"click"],[1,"hover:underline"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-3"],[1,"hover:text-primary","hover:underline",3,"href"],[1,"text-gray-500","text-sm"],["d","M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"],["d","M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"],[3,"href"],[1,"text-xs","text-gray-400","p-4"],[1,"flex","flex-wrap","gap-2","p-4","!pt-0"],[1,"bg-gray-300","text-gray-700","rounded-xl","text-sm","border","border-gray-700","px-4",3,"title"],["type","button",1,"bg-transparent","outline-none","rounded-xl","text-sm","border","border-gray-700","text-700","px-4","text-gray-700",3,"ngClass"],[1,"bg-gray-300","text-gray-700","rounded-xl","text-sm","border","border-gray-700","px-4",3,"click","title"],["type","button",1,"bg-transparent","outline-none","rounded-xl","text-sm","border","border-gray-700","text-700","px-4","text-gray-700",3,"click","ngClass"]],template:function(e,t){if(e&1&&(r(0,"div",1)(1,"h2",2),p(2),s(),r(3,"div",3),C(4,On,1,5,"ng-container")(5,Rn,1,5,"ng-container")(6,Hn,1,5,"ng-container"),s(),C(7,jn,17,16,"div",4),m(8,"app-insights-timeline",5),s(),C(9,Wn,6,3,"ng-template",null,0,It)),e&2){let o;a(2),N("",t.entitiesCount()," ",t.lang.locals.named_entity,""),a(2),f(t.namedLocations().length?4:-1),a(),f(t.namedPeople().length?5:-1),a(),f(t.brands().length?6:-1),a(),f(t.selectedEntity()&&((o=t.selectedEntity())!=null&&o.referenceId)?7:-1),a(),d("instanceGroup",t.instanceGroup())}},dependencies:[j,F,Et,oe,me,de,Oe]})};function Yn(i,n){if(i&1&&(r(0,"div",3),m(1,"div",5),r(2,"span",6),p(3),R(4,"appearancePercentage"),R(5,"number"),s(),r(6,"span",6),p(7),s()()),i&2){let e=n.$implicit,t=c();a(),d("ngClass",t.colorMap[e.type].bg),a(),d("ngClass",t.colorMap[e.type].text),a(),y(" ",q(5,8,q(4,5,e.instances,t.videoAnalyzer.videoLengthInSeconds()),"1.2-2"),"% "),a(3),d("ngClass",t.colorMap[e.type].text),a(),y(" ",t.translateMap[e.type]," ")}}var qe=class i{lang=b(B);videoAnalyzer=b($);emotions=w.required();colorMap={Anger:{text:"text-red-600",bg:"bg-red-600",fill:"fill-red-600"},Fear:{text:"text-purple-700",bg:"bg-purple-700",fill:"fill-purple-700"},Joy:{text:"text-yellow-400",bg:"bg-yellow-400",fill:"fill-yellow-400"},Neutral:{text:"text-gray-400",bg:"bg-gray-400",fill:"fill-gray-400"},Sad:{text:"text-blue-500",bg:"bg-blue-500",fill:"fill-blue-500"}};translateMap={Anger:this.lang.locals.anger,Fear:this.lang.locals.fear,Joy:this.lang.locals.joy,Sad:this.lang.locals.sad,Neutral:this.lang.locals.neutral};instanceGroup=E(()=>this.emotions().map(n=>({instanceColor:this.colorMap[n.type].fill,instanceTooltipColor:this.colorMap[n.type].bg,instances:n.instances})));static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-insights-emotions"]],inputs:{emotions:[1,"emotions"]},standalone:!0,features:[k],decls:7,vars:3,consts:[[1,"p-4","w-full"],[1,"text-xl","font-semibold","text-gray-700","p-4"],[1,"flex","items-center","gap-2"],[1,"inline-flex","items-center","gap-2"],[3,"instanceGroup"],[1,"size-2","rounded-full",3,"ngClass"],[3,"ngClass"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h2",1),p(2),s(),r(3,"div",2),T(4,Yn,8,11,"div",3,L),s(),m(6,"app-insights-timeline",4),s()),e&2&&(a(2),N("",t.emotions().length," ",t.lang.locals.emotions,""),a(2),I(t.emotions()),a(2),d("instanceGroup",t.instanceGroup()))},dependencies:[j,oe,de,F]})};var nt=i=>({"outline outline-2 outline-offset-2 outline-primary":i});function Qn(i,n){if(i&1){let e=x();r(0,"div",5),_("keydown",function(){let o=u(e).$implicit,l=c();return g(l.selectedScene.set(o))})("click",function(){let o=u(e).$implicit,l=c();return g(l.selectedScene.set(o))}),r(1,"picture",6),m(2,"div",7),s()()}if(i&2){let e,t,o=n.$implicit,l=c();d("matTooltip",o.tooltipMessage),Q("aria-selected",((e=l.selectedScene())==null?null:e.scene_id)===o.scene_id),a(),d("ngClass",A(5,nt,((t=l.selectedScene())==null?null:t.scene_id)===o.scene_id)),a(),Z("background-image","url("+o.scene_image+")")}}function Xn(i,n){if(i&1){let e=x();r(0,"div",5),_("keydown",function(){let o=u(e).$implicit,l=c(2);return g(l.selectedShot.set(o))})("click",function(){let o=u(e).$implicit,l=c(2);return g(l.selectedShot.set(o))}),r(1,"picture",6),m(2,"div",7),s()()}if(i&2){let e,t,o=n.$implicit,l=c(2);d("matTooltip",o.tooltipMessage),Q("aria-selected",((e=l.selectedShot())==null?null:e.id)===o.id),a(),d("ngClass",A(5,nt,((t=l.selectedShot())==null?null:t.id)===o.id)),a(),Z("background-image","url("+o.image+")")}}function Jn(i,n){if(i&1&&(r(0,"div",2)(1,"span",8),p(2),s(),r(3,"div",3),T(4,Xn,3,7,"div",4,L),s()()),i&2){let e=c();a(2),N("",e.selectedShots().length," ",e.lang.locals.shots_in_this_scene,""),a(2),I(e.selectedShots())}}function eo(i,n){if(i&1){let e=x();r(0,"div",5),_("keydown",function(){let o=u(e).$implicit,l=c(2);return g(l.selectedKeyFrame.set(o))})("click",function(){let o=u(e).$implicit,l=c(2);return g(l.selectedKeyFrame.set(o))}),r(1,"picture",6),m(2,"div",7),s()()}if(i&2){let e,t,o=n.$implicit,l=c(2);d("matTooltip",o.tooltipMessage),Q("aria-selected",((e=l.selectedKeyFrame())==null?null:e.id)===o.id),a(),d("ngClass",A(5,nt,((t=l.selectedKeyFrame())==null?null:t.id)===o.id)),a(),Z("background-image","url("+o.image+")")}}function to(i,n){if(i&1&&(r(0,"div",2)(1,"span",8),p(2),s(),r(3,"div",3),T(4,eo,3,7,"div",4,L),s()()),i&2){let e=c();a(2),N("",e.selectedKeyFrames().length," ",e.lang.locals.keyframes_in_this_shot,""),a(2),I(e.selectedKeyFrames())}}var Ke=class i{lang=b(B);scenes=w.required();shots=w.required();processedScenes=E(()=>this.scenes()&&this.shots()?this.processScenesAndShots(this.scenes(),this.shots()):[]);selectedScene=h(void 0);selectedShots=E(()=>this.selectedScene()?.shots??[]);selectedShot=h(void 0);selectedKeyFrames=E(()=>this.selectedShot()?.keyframes??[]);selectedKeyFrame=h(void 0);constructor(){ne(()=>{let n=this.processedScenes();n.length&&this.selectedScene.set(n[0])},{allowSignalWrites:!0}),ne(()=>{let n=this.selectedShots();n.length&&this.selectedShot.set(n[0])},{allowSignalWrites:!0}),ne(()=>{let n=this.selectedKeyFrames();n.length&&this.selectedKeyFrame.set(n[0])},{allowSignalWrites:!0})}processScenesAndShots(n,e){return n.map((t,o)=>{let l=t.instances[0],v=W(l.adjustedStart),S=W(l.adjustedEnd),H=`Scene #${String(o+1).padStart(2,"0")}; ${l.adjustedStart} - ${l.adjustedEnd}`,z=e.filter(re=>{let Le=re.instances[0],he=W(Le.adjustedStart),Je=W(Le.adjustedEnd);return v<=he&&he<S||v<Je&&Je<=S}),xi=z[0]?.keyFrames?.[0]?.thumbnail_url??null,yi=z.map((re,Le)=>{let he=re.instances[0],bi=(re.keyFrames?.[0]).thumbnail_url??null,Si=`Shot #${String(Le+1).padStart(2,"0")}; ${he.adjustedStart} - ${he.adjustedEnd}`+(re.tags?.length?` (${re.tags.join(", ")})`:""),wi=re.keyFrames?.map(et=>{let tt=et.instances?.[0],Ti=`KeyFrame: ${tt?.adjustedStart} - ${tt?.adjustedEnd}`;return{id:et.id,image:et.thumbnail_url,instance:tt,tooltipMessage:Ti}})??[];return{id:re.id,image:bi,instance:he,tooltipMessage:Si,keyframes:wi}});return{scene_id:t.id,scene_instance:l,scene_image:xi,shots:yi,tooltipMessage:H}})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-insights-scenes"]],inputs:{scenes:[1,"scenes"],shots:[1,"shots"]},standalone:!0,features:[k],decls:9,vars:4,consts:[[1,"p-4","w-full"],[1,"text-xl","font-semibold","text-gray-700","p-4"],[1,"flex","flex-col","space-y-2"],[1,"flex","flex-wrap","gap-2"],["role","option","tabindex","-1",1,"relative","w-24","h-14","bg-transparent","transition-all","hover:scale-110","ease-in-out","duration-300",3,"matTooltip"],["role","option","tabindex","-1",1,"relative","w-24","h-14","bg-transparent","transition-all","hover:scale-110","ease-in-out","duration-300",3,"keydown","click","matTooltip"],[1,"flex","justify-center","items-center","w-24","h-14","cursor-pointer",3,"ngClass"],[1,"relative","w-24","h-14","bg-cover","bg-center"],[1,"text-sm","text-gray-400"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h2",1),p(2),s(),r(3,"div",2)(4,"div",3),T(5,Qn,3,7,"div",4,L),s(),C(7,Jn,6,2,"div",2)(8,to,6,2,"div",2),s()()),e&2&&(a(2),N("",t.scenes().length," ",t.lang.locals.scenes,""),a(3),I(t.processedScenes()),a(2),f(t.selectedShots().length?7:-1),a(),f(t.selectedKeyFrames().length?8:-1))},dependencies:[F,me]})};var io=(i,n)=>n.languageCode,no=i=>({"!bg-gray-100":i});function oo(i,n){i&1&&(V(),r(0,"svg",7),m(1,"path",9),s())}function ao(i,n){i&1&&(V(),r(0,"svg",7),m(1,"path",10),s())}function ro(i,n){if(i&1){let e=x();r(0,"button",13),_("click",function(){let o=u(e).$implicit,l=c(2);return g(l.selectLanguage(o.name,o.languageCode))}),r(1,"span"),p(2),s()()}if(i&2){let e=n.$implicit,t=c(2);d("ngClass",A(2,no,e.name===t.selectedLanguage())),a(2),M(e.name)}}function so(i,n){if(i&1&&(r(0,"div",11),T(1,ro,3,4,"button",12,io),s()),i&2){let e=c();a(),I(e.languages)}}var we=class i extends pe(class{}){onLanguageChange=_e();languageControl=new Ne("en-US",{nonNullable:!0});languages=[{name:"Afrikaans",languageCode:"af-ZA",isRTL:!1},{name:"Arabic",languageCode:"ar-QA",isRTL:!0},{name:"Armenian",languageCode:"hy-AM",isRTL:!1},{name:"Bangla",languageCode:"bn-BD",isRTL:!1},{name:"Bosnian",languageCode:"bs-Latn",isRTL:!1},{name:"Bulgarian",languageCode:"bg-BG",isRTL:!1},{name:"Catalan",languageCode:"ca-ES",isRTL:!1},{name:"Chinese (Cantonese, Traditional)",languageCode:"zh-HK",isRTL:!1},{name:"Chinese (Simplified)",languageCode:"zh-Hans",isRTL:!1},{name:"Chinese (Traditional)",languageCode:"zh-Hant",isRTL:!1},{name:"Croatian",languageCode:"hr-HR",isRTL:!1},{name:"Czech",languageCode:"cs-CZ",isRTL:!1},{name:"Danish",languageCode:"da-DK",isRTL:!1},{name:"Dutch",languageCode:"nl-NL",isRTL:!1},{name:"English (Australia)",languageCode:"en-AU",isRTL:!1},{name:"English (United Kingdom)",languageCode:"en-GB",isRTL:!1},{name:"English (United States)",languageCode:"en-US",isRTL:!1},{name:"Estonian",languageCode:"et-EE",isRTL:!1},{name:"Filipino",languageCode:"fil-PH",isRTL:!1},{name:"Finnish",languageCode:"fi-FI",isRTL:!1},{name:"French",languageCode:"fr-FR",isRTL:!1},{name:"French (Canada)",languageCode:"fr-CA",isRTL:!1},{name:"German",languageCode:"de-DE",isRTL:!1},{name:"Greek",languageCode:"el-GR",isRTL:!1},{name:"Gujarati",languageCode:"gu-IN",isRTL:!1},{name:"Hebrew",languageCode:"he-IL",isRTL:!0},{name:"Hindi",languageCode:"hi-IN",isRTL:!1},{name:"Hungarian",languageCode:"hu-HU",isRTL:!1},{name:"Icelandic",languageCode:"is-IS",isRTL:!1},{name:"Indonesian",languageCode:"id-ID",isRTL:!1},{name:"Irish",languageCode:"ga-IE",isRTL:!1},{name:"Italian",languageCode:"it-IT",isRTL:!1},{name:"Japanese",languageCode:"ja-JP",isRTL:!1},{name:"Kannada",languageCode:"kn-IN",isRTL:!1},{name:"Kiswahili",languageCode:"sw-KE",isRTL:!1},{name:"Korean",languageCode:"ko-KR",isRTL:!1},{name:"Latvian",languageCode:"lv-LV",isRTL:!1},{name:"Lithuanian",languageCode:"lt-LT",isRTL:!1},{name:"Malay",languageCode:"ms-MY",isRTL:!1},{name:"Malayalam",languageCode:"ml-IN",isRTL:!1},{name:"Norwegian",languageCode:"nb-NO",isRTL:!1},{name:"Persian",languageCode:"fa-IR",isRTL:!0},{name:"Polish",languageCode:"pl-PL",isRTL:!1},{name:"Portuguese (Brazil)",languageCode:"pt-BR",isRTL:!1},{name:"Portuguese (Portugal)",languageCode:"pt-PT",isRTL:!1},{name:"Romanian",languageCode:"ro-RO",isRTL:!1},{name:"Russian",languageCode:"ru-RU",isRTL:!1},{name:"Serbian (Cyrillic)",languageCode:"sr-Cyrl-RS",isRTL:!1},{name:"Serbian (Latin)",languageCode:"sr-Latn-RS",isRTL:!1},{name:"Slovak",languageCode:"sk-SK",isRTL:!1},{name:"Slovenian",languageCode:"sl-SI",isRTL:!1},{name:"Spanish",languageCode:"es-ES",isRTL:!1},{name:"Spanish (Mexico)",languageCode:"es-MX",isRTL:!1},{name:"Swedish",languageCode:"sv-SE",isRTL:!1},{name:"Tamil",languageCode:"ta-IN",isRTL:!1},{name:"Telugu",languageCode:"te-IN",isRTL:!1},{name:"Thai",languageCode:"th-TH",isRTL:!1},{name:"Turkish",languageCode:"tr-TR",isRTL:!1},{name:"Ukrainian",languageCode:"uk-UA",isRTL:!1},{name:"Urdu",languageCode:"ur-PK",isRTL:!1},{name:"Vietnamese",languageCode:"vi-VN",isRTL:!1}];isDropdownOpen=h(!1);selectedLanguage=h("English (United States)");dropdownPositions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"}];toggleDropdown(){this.isDropdownOpen.update(()=>!this.isDropdownOpen())}selectLanguage(n,e){this.selectedLanguage.set(n),this.onLanguageChange.emit(e),this.isDropdownOpen.set(!1)}static \u0275fac=(()=>{let n;return function(t){return(n||(n=te(i)))(t||i)}})();static \u0275cmp=P({type:i,selectors:[["app-supported-language"]],outputs:{onLanguageChange:"onLanguageChange"},standalone:!0,features:[le,k],decls:11,vars:6,consts:[["trigger","cdkOverlayOrigin"],[1,"relative","w-48"],["cdkOverlayOrigin","",1,"w-full","flex","justify-between","items-center","px-4","py-2","text-gray-700","focus:bg-gray-300","bg-gray-200","rounded-md","text-xs",3,"click"],[1,"flex","items-center","space-x-2","gap-2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-500"],["d","M17.9,17.39C17.64,16.59 16.89,16 16,16H15V13A1,1 0 0,0 14,12H8V10H10A1,1 0 0,0 11,9V7H13A2,2 0 0,0 15,5V4.59C17.93,5.77 20,8.64 20,12C20,14.08 19.2,15.97 17.9,17.39M11,19.93C7.05,19.44 4,16.08 4,12C4,11.38 4.08,10.78 4.21,10.21L9,15V16A2,2 0 0,0 11,18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"],[1,"mx-1"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-500"],["cdkConnectedOverlay","",3,"overlayOutsideClick","detach","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"],["d","M7 10l5 5 5-5H7z"],["d","M7 14l5-5 5 5H7z"],["appPerfectScroll","",1,"bg-white","border","border-gray-300","max-h-48","shadow-lg","rounded-md","w-full"],["type","button",1,"w-full","px-4","py-2","hover:bg-gray-100","cursor-pointer","flex","items-center","space-x-2",3,"ngClass"],["type","button",1,"w-full","px-4","py-2","hover:bg-gray-100","cursor-pointer","flex","items-center","space-x-2",3,"click","ngClass"]],template:function(e,t){if(e&1){let o=x();r(0,"div",1)(1,"button",2,0),_("click",function(){return u(o),g(t.toggleDropdown())}),r(3,"span",3),V(),r(4,"svg",4),m(5,"path",5),s(),G(),r(6,"span",6),p(7),s()(),C(8,oo,2,0,":svg:svg",7)(9,ao,2,0,":svg:svg",7),s(),C(10,so,3,0,"ng-template",8),_("overlayOutsideClick",function(){return u(o),g(t.isDropdownOpen.set(!1))})("detach",function(){return u(o),g(t.isDropdownOpen.set(!1))}),s()}if(e&2){let o=Ce(2);a(7),M(t.selectedLanguage()||"Choose a language"),a(),f(t.isDropdownOpen?9:8),a(2),d("cdkConnectedOverlayOrigin",o)("cdkConnectedOverlayOpen",t.isDropdownOpen())("cdkConnectedOverlayPositions",t.dropdownPositions)("cdkConnectedOverlayWidth",o.elementRef.nativeElement.offsetWidth)}},dependencies:[ye,zt,Ht,Dt,Se,F]})};var We=class i{transform(n){if(!n)return"00:00:00";let e=n.split(":"),t=parseFloat(e[2]),o=Math.round(t),l=parseInt(e[1]),S=parseInt(e[0]).toString().padStart(2,"0"),H=l.toString().padStart(2,"0"),z=o.toString().padStart(2,"0");return`${S}:${H}:${z}`}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=Me({name:"timeFormat",type:i,pure:!0,standalone:!0})};function lo(i,n){if(i&1&&(r(0,"div",1)(1,"div",2)(2,"div",3)(3,"span"),p(4),R(5,"timeFormat"),s()()(),r(6,"div",4)(7,"p",5),p(8),s()()()),i&2){let e=n.$implicit;a(4),M(xe(5,2,e.instances[0].adjustedStart)),a(4),M(e.text)}}var Ye=class i{transcript=w.required();static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-timeline"]],inputs:{transcript:[1,"transcript"]},standalone:!0,features:[k],decls:3,vars:0,consts:[[1,"w-full","flex","flex-col"],[1,"flex","justify-center","items-center","gap-2","p-2","hover:bg-gray-300","hover:text-gray-500"],[1,"w-3/12"],[1,"bg-primary","rounded-sm","text-xs","w-16","text-center","p-1","text-white"],[1,"w-9/12"],[1,"text-gray-500"]],template:function(e,t){e&1&&(r(0,"div",0),T(1,lo,9,4,"div",1,L),s()),e&2&&(a(),I(t.transcript()))},dependencies:[We]})};var co=["tab"],at=()=>({suppressScrollX:!0}),ot=()=>[];function po(i,n){if(i&1&&m(0,"app-video-insights-people",9),i&2){let e=c(2);d("people",e.videoInsights().faces)}}function mo(i,n){if(i&1&&m(0,"hr",10)(1,"app-video-insights-observed-people",11),i&2){let e=c(2);a(),d("observedPeople",e.videoInsights().observedPeople)}}function uo(i,n){if(i&1&&m(0,"hr",10)(1,"app-video-insights-topics",12),i&2){let e=c(2);a(),d("topics",e.videoInsights().topics)}}function go(i,n){if(i&1&&m(0,"hr",10)(1,"app-video-insights-audio-effects",13),i&2){let e=c(2);a(),d("audioEffects",e.videoInsights().audioEffects)}}function fo(i,n){if(i&1&&m(0,"hr",10)(1,"app-video-insights-labels",14),i&2){let e=c(2);a(),d("labels",e.videoInsights().labels)}}function ho(i,n){if(i&1&&m(0,"hr",10)(1,"app-video-insights-named-entities",15),i&2){let e,t,o,l=c(2);a(),d("brands",(e=l.videoInsights().brands)!==null&&e!==void 0?e:ie(3,ot))("namedLocations",(t=l.videoInsights().namedLocations)!==null&&t!==void 0?t:ie(4,ot))("namedPeople",(o=l.videoInsights().namedPeople)!==null&&o!==void 0?o:ie(5,ot))}}function _o(i,n){if(i&1&&m(0,"hr",10)(1,"app-video-insights-emotions",16),i&2){let e=c(2);a(),d("emotions",e.videoInsights().emotions)}}function vo(i,n){if(i&1&&m(0,"hr",10)(1,"app-video-insights-scenes",17),i&2){let e=c(2);a(),d("scenes",e.videoInsights().scenes)("shots",e.videoInsights().shots)}}function Co(i,n){if(i&1&&(r(0,"div",8),C(1,po,1,1,"app-video-insights-people",9)(2,mo,2,1)(3,uo,2,1)(4,go,2,1)(5,fo,2,1)(6,ho,2,6)(7,_o,2,1)(8,vo,2,2),s()),i&2){let e,t,o,l,v,S,H,z=c();d("perfectScrollOptions",ie(9,at)),a(),f((e=z.videoInsights().faces)!=null&&e.length?1:-1),a(),f((t=z.videoInsights().observedPeople)!=null&&t.length?2:-1),a(),f((o=z.videoInsights().topics)!=null&&o.length?3:-1),a(),f((l=z.videoInsights().audioEffects)!=null&&l.length?4:-1),a(),f((v=z.videoInsights().labels)!=null&&v.length?5:-1),a(),f((S=z.videoInsights().brands)!=null&&S.length||(S=z.videoInsights().namedLocations)!=null&&S.length||(S=z.videoInsights().namedPeople)!=null&&S.length?6:-1),a(),f((H=z.videoInsights().emotions)!=null&&H.length?7:-1),a(),f(z.videoInsights().scenes.length?8:-1)}}function xo(i,n){if(i&1&&(r(0,"div",8),m(1,"app-video-timeline",18),s()),i&2){let e=c();d("perfectScrollOptions",ie(2,at)),a(),d("transcript",e.videoInsights().transcript)}}function yo(i,n){if(i&1&&(r(0,"div",8)(1,"p",19),p(2),s()()),i&2){let e=c();d("perfectScrollOptions",ie(2,at)),a(2),y(" ",e.videoSummary()," ")}}var Qe=class i{lang=b(B);videoInsights=w.required();videoSummary=w.required();onInsightsLangChange=_e();activeTab=h("INSIGHTS");indicatorWidth=h("0px");indicatorTransform=h("translateX(0)");tabs=Ct("tab");setActiveTab(n){this.activeTab.set(n),this.updateIndicator()}ngAfterViewInit(){setTimeout(()=>{debugger;this.updateIndicator()})}updateIndicator(){let n=this.tabs(),e=this.getActiveIndex();if(e!==-1){let t=n[e].nativeElement;this.indicatorWidth.set(`${t.offsetWidth}px`),this.indicatorTransform.set(`translateX(${t.offsetLeft}px)`)}}getActiveIndex(){return["INSIGHTS","TIMELINE","SUMMARY"].indexOf(this.activeTab())}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-video-insights"]],viewQuery:function(e,t){e&1&&X(t.tabs,co,5),e&2&&ve()},inputs:{videoInsights:[1,"videoInsights"],videoSummary:[1,"videoSummary"]},outputs:{onInsightsLangChange:"onInsightsLangChange"},standalone:!0,features:[k],decls:19,vars:16,consts:[["tab",""],[1,"flex","flex-col"],[1,"flex","items-center","sticky","top-0","bg-gray-100","shadow-sm","z-10","p-2"],[1,"w-1/2"],[3,"onLanguageChange"],[1,"relative","flex","justify-between","items-center","m-2","bg-gray-200","rounded-md"],["type","button",1,"relative","w-full","text-xs","p-2","focus:outline-none","rounded-md","text-primary","font-semibold","hover:underline","hover:cursor-pointer","z-10",3,"click"],[1,"absolute","top-0","left-0","h-full","bg-primary","transition-all","duration-300","rounded-md","z-0"],["appPerfectScroll","",1,"bg-gray-100","h-[300px]",3,"perfectScrollOptions"],[3,"people"],[1,"h-0.5","bg-gray-200"],[3,"observedPeople"],[3,"topics"],[3,"audioEffects"],[3,"labels"],[3,"brands","namedLocations","namedPeople"],[3,"emotions"],[3,"scenes","shots"],[3,"transcript"],[1,"text-gray-500","text-sm","leading-8","text-justify","p-4"]],template:function(e,t){if(e&1){let o=x();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"app-supported-language",4),_("onLanguageChange",function(v){return u(o),g(t.onInsightsLangChange.emit(v))}),s()(),r(4,"div",3)(5,"div",5)(6,"button",6,0),_("click",function(){return u(o),g(t.setActiveTab("INSIGHTS"))}),p(8),s(),r(9,"button",6,0),_("click",function(){return u(o),g(t.setActiveTab("TIMELINE"))}),p(11),s(),r(12,"button",6,0),_("click",function(){return u(o),g(t.setActiveTab("SUMMARY"))}),p(14),s(),m(15,"div",7),s()()(),C(16,Co,9,10,"div",8)(17,xo,2,3,"div",8)(18,yo,3,3,"div",8),s()}e&2&&(a(6),Fe("text-white",t.activeTab()==="INSIGHTS"),a(2),y(" ",t.lang.locals.insights," "),a(),Fe("text-white",t.activeTab()==="TIMELINE"),a(2),y(" ",t.lang.locals.transcript," "),a(),Fe("text-white",t.activeTab()==="SUMMARY"),a(2),y(" ",t.lang.locals.video_summary," "),a(),Z("width",t.indicatorWidth())("transform",t.indicatorTransform()),a(),f(t.activeTab()==="INSIGHTS"?16:-1),a(),f(t.activeTab()==="TIMELINE"?17:-1),a(),f(t.activeTab()==="SUMMARY"?18:-1))},dependencies:[ze,Ge,$e,je,Ue,Se,Ze,qe,Ke,we,Ye]})};var Xe=class i{constructor(n){this.el=n}videoUrl=w.required();audioUrl=w.required();mediaSource;videoSourceBuffer;audioContext;audioBuffer;audioBufferSource;isPlaying=!1;ngAfterViewInit(){this.videoUrl()&&this.audioUrl()&&this.initializeStreaming()}ngOnChanges(n){(n.videoUrl&&this.videoUrl()||n.audioUrl&&this.audioUrl())&&this.initializeStreaming()}initializeStreaming(){if(!this.videoUrl()||!this.audioUrl())return;let n=this.el.nativeElement;this.mediaSource=new MediaSource,n.src=URL.createObjectURL(this.mediaSource),this.mediaSource.addEventListener("sourceopen",()=>J(this,null,function*(){yield this.setupMediaStreaming()})),n.addEventListener("play",()=>this.playAudio()),n.addEventListener("pause",()=>this.stopAudio()),n.addEventListener("seeking",()=>this.syncAudioToVideo()),n.addEventListener("ratechange",()=>this.adjustPlaybackRate())}setupMediaStreaming(){return J(this,null,function*(){let n='video/mp4; codecs="avc1.64001E"',e='audio/mp4; codecs="mp4a.40.2"';MediaSource.isTypeSupported(n)?(this.videoSourceBuffer=this.mediaSource.addSourceBuffer(n),yield this.streamVideo(this.videoUrl(),this.videoSourceBuffer)):console.error("Video format not supported"),MediaSource.isTypeSupported(e)?(this.audioContext=new AudioContext,this.audioBuffer=yield this.fetchAndDecodeAudio(this.audioUrl())):console.error("Audio format not supported")})}streamVideo(n,e){return J(this,null,function*(){let o=(yield fetch(n)).body.getReader(),l=()=>J(this,null,function*(){let{done:v,value:S}=yield o.read();if(v){this.mediaSource.endOfStream();return}e.updating||e.appendBuffer(S),e.addEventListener("updateend",l)});l()})}fetchAndDecodeAudio(n){return J(this,null,function*(){let t=yield(yield fetch(n)).arrayBuffer();return yield this.audioContext.decodeAudioData(t)})}playAudio(){this.audioBuffer&&(this.stopAudio(),this.audioBufferSource=this.audioContext.createBufferSource(),this.audioBufferSource.buffer=this.audioBuffer,this.audioBufferSource.connect(this.audioContext.destination),this.audioBufferSource.start(0,this.el.nativeElement.currentTime),this.isPlaying=!0)}stopAudio(){this.audioBufferSource&&(this.audioBufferSource.stop(),this.audioBufferSource.disconnect(),this.audioBufferSource=null),this.isPlaying=!1}syncAudioToVideo(){this.isPlaying&&(this.stopAudio(),this.playAudio())}adjustPlaybackRate(){this.audioBufferSource&&(this.audioBufferSource.playbackRate.value=this.el.nativeElement.playbackRate)}static \u0275fac=function(e){return new(e||i)(vt(ht))};static \u0275dir=mt({type:i,selectors:[["","appSyncVideoAudio",""]],inputs:{videoUrl:[1,"videoUrl"],audioUrl:[1,"audioUrl"]},standalone:!0,features:[ut]})};var bo=["selectedVideo"],So=["chatBox"],wo=["fileInput"],To=i=>({"!w-full":i}),vi=i=>({"bg-primary border-2 text-white shadow-lg scale-105":i}),Io=i=>({showBotSelection:!1,botName:i});function Vo(i,n){if(i&1&&m(0,"app-chat-container",18,1),i&2){let e=c(2);d("botNameOptions",A(6,Io,e.botName()))("title",e.lang.locals.video_analyzer)("showAvatarBtn",!0)("showFullScreenBtn",!1)("showHideBtn",!1)("clearMessageOnly",!0)}}function Eo(i,n){if(i&1){let e=x();r(0,"app-video-insights",20),_("onInsightsLangChange",function(o){u(e);let l=c(3);return g(l.handelTranslateInsights(o))}),s()}if(i&2){let e=c(3);d("videoSummary",e.videoSummary())("videoInsights",e.insights().videos[0].insights)}}function Lo(i,n){if(i&1&&C(0,Eo,1,2,"app-video-insights",19),i&2){let e=c(2);f(e.insights()&&e.insights().videos[0]?0:-1)}}function Po(i,n){if(i&1){let e=x();r(0,"div",4)(1,"div",15)(2,"button",16),_("click",function(){u(e);let o=c();return g(o.selectedTab.set("CHAT"))}),p(3),s(),r(4,"button",16),_("click",function(){u(e);let o=c();return g(o.selectedTab.set("INSIGHTS"))}),p(5),s()(),r(6,"div",17),C(7,Vo,2,8,"app-chat-container",18)(8,Lo,1,1),s()()}if(i&2){let e=c();d("@slideIn",void 0),a(2),d("ngClass",A(7,vi,e.selectedTab()==="CHAT")),a(),y(" ",e.lang.locals.chat_about_video," "),a(),d("ngClass",A(9,vi,e.selectedTab()==="INSIGHTS")),a(),y(" ",e.lang.locals.insights," "),a(2),f(e.selectedTab()==="CHAT"?7:-1),a(),f(e.selectedTab()==="INSIGHTS"?8:-1)}}function ko(i,n){if(i&1){let e=x();r(0,"div",6)(1,"span",21),p(2),s(),r(3,"app-supported-language",22),_("onLanguageChange",function(o){u(e);let l=c();return g(l.onLanguageSelected(o))}),s()()}if(i&2){let e=c();d("@slideFromBottom",void 0),a(2),M(e.lang.locals.choose_language)}}function Ao(i,n){if(i&1&&(r(0,"div",11)(1,"div",23)(2,"span",24),p(3),s()(),r(4,"video",25,2),m(6,"source",26)(7,"track",27),s()()),i&2){let e,t,o,l=c();a(2),d("title",(e=l.video())==null||e.file==null?null:e.file.name),a(),M((t=l.video())==null||t.file==null?null:t.file.name),a(),d("poster",l.poster(),U),a(2),d("src",(o=l.video())==null?null:o.base64,U),a(),d("src",l.videoCaption(),U)}}function Mo(i,n){if(i&1&&(r(0,"div",11)(1,"div",23)(2,"span",24),p(3),s()(),r(4,"video",28,2),m(6,"track",27),s()()),i&2){let e,t,o,l=c();a(2),d("title",(e=l.videoData())==null?null:e.name),a(),M((t=l.videoData())==null?null:t.name),a(),d("poster",(o=l.videoData())==null?null:o.thumbnail_url,U)("videoUrl",l.videoUrl())("audioUrl",l.audioUrl()),a(2),d("src",l.videoCaption(),U)}}function Fo(i,n){if(i&1&&(V(),r(0,"svg",31)(1,"g",32),m(2,"path",33),s(),r(3,"g",34),m(4,"path",35)(5,"path",36),s()(),G(),r(6,"p",37),p(7),s()),i&2){let e=c(2);a(7),M(e.lang.locals.uploading_file_msg)}}function Bo(i,n){if(i&1&&(V(),r(0,"svg",38),m(1,"g",39)(2,"g",40),r(3,"g",41),m(4,"path",42)(5,"path",43),s()(),G(),r(6,"p",37),p(7),s()),i&2){let e=c(2);a(7),N("",e.lang.locals.file_info_msg," ",e.indexingProgress(),"")}}function Oo(i,n){if(i&1&&(m(0,"div",29),r(1,"div",30),C(2,Fo,8,1)(3,Bo,8,2),s()),i&2){let e=c();a(2),f(e.isLoading()==="UPLOAD"?2:-1),a(),f(e.isLoading()==="GET_INFO"?3:-1)}}var Ci=class i extends pe(class{}){lang=b(B);fileUploaderService=b(pi);videoAnalyzerService=b($);videoIndexerChatService=b(Ee);video=h(void 0);videoData=h(void 0);videoUrl=h(void 0);audioUrl=h(void 0);insights=h(void 0);dialog=b($t);store=b(Kt);selectedVideo=ae("selectedVideo");chatContainer=ae("chatBox");poster=h("");isLoading=h(void 0);botName=h("");indexingProgress=h("");selectedTab=h("INSIGHTS");videoCaption=h("");videoId=h("");videoSummary=h("");videoLang=h("");showSupportedLanguage=h(!1);fileInput=ae.required("fileInput");ngOnInit(){this.videoAnalyzerService.timelineSeek.pipe(O(n=>{this.selectedVideo()?.nativeElement&&n&&(this.selectedVideo().nativeElement.currentTime=n)})).subscribe()}uploadVideo(n){return J(this,null,function*(){let e=n.target;if(!e?.files||e.files.length===0){console.warn("No files selected for upload.");return}try{let t=Array.from(e.files);this.isLoading.set("UPLOAD");let o=yield this.fileUploaderService.uploadFiles(t);if(!o?.length)throw new Error("File upload failed. No files returned from the server.");this.handleVideoUpload(o[0])}catch(t){console.error("Error during file upload:",t),this.isLoading.set(void 0)}})}handleVideoUpload(n){this.videoAnalyzerService.uploadVideo(n.file,this.videoLang()).pipe(ee(this.destroy$),O(()=>{this.chatContainer()?.clearChatHistory(),this.video.set(n),this.videoData.set(void 0),this.videoUrl.set(void 0),this.isLoading.set("GET_INFO")}),fe(({data:e})=>this.processUploadedVideo(e.video_id)),se(e=>(console.error("Error during video processing:",e),Te)),ke(()=>this.generateVideoThumbnail())).subscribe()}processUploadedVideo(n){return this.videoAnalyzerService.indexVideo(n).pipe(dt(e=>e.status_code!==200?(this.indexingProgress.set(("videos"in e.data&&Array.isArray(e.data.videos)?e.data?.videos?.[0]?.processingProgress:"")||""),this.videoAnalyzerService.indexVideo(n).pipe(lt(2e3))):Te),Ie(e=>e.status_code===200),O(({data:e})=>{this.videoAnalyzerService.videoDuration.set(e.res_data.duration),this.videoId.set(n),this.insights.set(e.res_data),this.videoSummary.set(e.summary)}),fe(({data:e})=>this.videoAnalyzerService.getVttFile(e.video_caption).pipe(O(t=>this.videoCaption.set(t)))),fe(()=>this.videoAnalyzerService.startVideoChat(n).pipe(O(e=>{this.videoIndexerChatService.conversationId.set(e.data)}))),se(e=>(console.error("Error during video indexing:",e),Te)),ke(()=>{this.isLoading.set(void 0),this.indexingProgress.set("")}))}generateVideoThumbnail(){return J(this,null,function*(){try{let n=this.selectedVideo()?.nativeElement;if(!n){console.warn("Video element not found for thumbnail capture.");return}this.videoAnalyzerService.videoDuration.set(mi(n.duration)),setTimeout(()=>J(this,null,function*(){try{let e=yield Xt(n);this.poster.set(e)}catch(e){console.error("Error capturing video thumbnail:",e)}}),1e3)}catch(n){console.error("Error generating video thumbnail:",n)}})}openVideosList(){this.dialog.open(De).afterClosed().pipe(O(()=>this.isLoading.set("GET_INFO")),Ie(n=>!!n),fe(n=>this.handleSelectedVideo(n)),ke(()=>this.isLoading.set(void 0)),se(n=>(console.error("Error fetching video data:",n),Te))).subscribe()}handleSelectedVideo(n){return this.videoAnalyzerService.indexVideo(n.id).pipe(ee(this.destroy$),O(({data:e})=>{this.videoAnalyzerService.videoDuration.set(e.res_data.duration),this.videoId.set(n.id),this.insights.set(e.res_data),this.chatContainer()?.clearChatHistory(),this.video.set(void 0),this.videoData.set(n)}),fe(({data:e})=>this.videoAnalyzerService.getVttFile(e.video_caption).pipe(O(t=>{this.videoCaption.set(t),this.videoUrl.set(e.video_stream_url),this.audioUrl.set(e.audio_stream_url),this.videoSummary.set(e.summary),this.selectedVideo()?.nativeElement.load()}))),fe(()=>this.videoAnalyzerService.startVideoChat(n.id).pipe(O(e=>this.videoIndexerChatService.conversationId.set(e.data)))))}handelTranslateInsights(n){this.videoAnalyzerService.indexVideo(this.videoId(),n).pipe(ee(this.destroy$),O(({data:e})=>{this.insights.set(e.res_data)})).subscribe()}toggleLanguageDropdown(n){n.preventDefault(),this.showSupportedLanguage.set(!0)}onLanguageSelected(n){n&&(this.videoLang.set(n),this.showSupportedLanguage.set(!1),setTimeout(()=>{this.fileInput().nativeElement.click()},100))}static \u0275fac=(()=>{let n;return function(t){return(n||(n=te(i)))(t||i)}})();static \u0275cmp=P({type:i,selectors:[["app-video-analyzer"]],viewQuery:function(e,t){e&1&&(X(t.selectedVideo,bo,5),X(t.chatContainer,So,5),X(t.fileInput,wo,5)),e&2&&ve(3)},standalone:!0,features:[Tt([{provide:be,useExisting:Ee}]),le,k],decls:18,vars:10,consts:[["fileInput",""],["chatBox",""],["selectedVideo",""],[1,"flex","justify-between","items-center"],[1,"flex","flex-col","space-y-2","w-1/2","h-full"],[1,"flex","flex-col","justify-center","items-center","space-y-6","w-1/2","transition-all","ease-out","duration-200",3,"ngClass"],[1,"flex","flex-col"],["type","file","accept","video/*","id","video_uploader",1,"hidden",3,"change"],[1,"inline-flex","gap-2","justify-center","items-center","text-xl","shadow-lg","border-none","w-2/5","text-center","focus:outline-none","hover:scale-110","hover:border-gray-500","cursor-pointer","bg-gray-300","text-gray-700","rounded-md","p-4","transition-all","ease-in-out","duration-200",3,"click"],["fill","currentColor","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24",1,"size-6"],["d","M2 12H4V17H20V12H22V17C22 18.11 21.11 19 20 19H4C2.9 19 2 18.11 2 17V12M12 2L6.46 7.46L7.88 8.88L11 5.75V15H13V5.75L16.13 8.88L17.55 7.45L12 2Z"],[1,"relative","flex","justify-center","items-center","w-2/3","h-60","rounded-md","border","border-gray-300","shadow-sm","bg-black","overflow-hidden"],[1,"h-1","block","w-1/2"],["type","button",1,"inline-flex","gap-2","justify-center","items-center","text-xl","shadow-lg","text-gray-300","bg-transparent","p-4","w-2/5","text-center","border","border-gray-300","focus:outline-none","hover:scale-110","rounded-md","transition-all","ease-in-out","duration-200",3,"click"],["d","M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"],[1,"flex","gap-4","justify-between","items-center","w-full"],["type","button",1,"inline-flex","flex-col","gap-2","justify-center","transition-all","ease-in-out","items-center","h-full","p-3","mt-4","bg-gray-300","text-gray-700","border-gray-300","border","active:bg-primary","active:text-white","outline-none","text-lg","hover:bg-primary","hover:text-white","w-3/4","focus:w-full","rounded-2xl","w-1/2",3,"click","ngClass"],[1,"flex-grow","flex","justify-center","items-center","border","border-gray-200","p-2","rounded-md","w-full"],["containerClass","!static !w-full !h-[350px] text-gray-700",1,"w-full",3,"botNameOptions","title","showAvatarBtn","showFullScreenBtn","showHideBtn","clearMessageOnly"],[1,"w-full",3,"videoSummary","videoInsights"],[1,"w-full",3,"onInsightsLangChange","videoSummary","videoInsights"],[1,"text-sm","text-gray-300"],[3,"onLanguageChange"],[1,"absolute","w-full","flex","justify-center","items-center","top-0","bg-black/40","p-2"],[1,"truncate",3,"title"],["controls","",1,"selected-video","h-full","bg-transparent","bg-cover",3,"poster"],[3,"src"],["kind","captions","default","",3,"src"],["appSyncVideoAudio","","controls","",1,"selected-video","h-full","bg-transparent","bg-cover",3,"poster","videoUrl","audioUrl"],[1,"bg-black","opacity-50","fixed","inset-0","z-50"],[1,"fixed","inset-0","z-50","flex","flex-col","items-center","justify-center","text-white"],["width","228px","height","228px","viewBox","0 0 1024.00 1024.00","version","1.1","xmlns","http://www.w3.org/2000/svg","fill","#000000","stroke","#000000","stroke-width","0.01024",1,"icon","opacity-100"],[1,"cloud"],["d","M768 810.7c-23.6 0-42.7-19.1-42.7-42.7s19.1-42.7 42.7-42.7c94.1 0 170.7-76.6 170.7-170.7 0-89.6-70.1-164.3-159.5-170.1L754 383l-10.7-22.7c-42.2-89.3-133-147-231.3-147s-189.1 57.7-231.3 147L270 383l-25.1 1.6c-89.5 5.8-159.5 80.5-159.5 170.1 0 94.1 76.6 170.7 170.7 170.7 23.6 0 42.7 19.1 42.7 42.7s-19.1 42.7-42.7 42.7c-141.2 0-256-114.8-256-256 0-126.1 92.5-232.5 214.7-252.4C274.8 195.7 388.9 128 512 128s237.2 67.7 297.3 174.2C931.5 322.1 1024 428.6 1024 554.7c0 141.1-114.8 256-256 256z",1,"fill-gray-100"],[1,"arrow"],["d","M640 789.3c-10.9 0-21.8-4.2-30.2-12.5L512 679l-97.8 97.8c-16.6 16.7-43.7 16.7-60.3 0-16.7-16.7-16.7-43.7 0-60.3l128-128c16.6-16.7 43.7-16.7 60.3 0l128 128c16.7 16.7 16.7 43.7 0 60.3-8.4 8.4-19.3 12.5-30.2 12.5z",1,"fill-gray-400"],["d","M512 960c-23.6 0-42.7-19.1-42.7-42.7V618.7c0-23.6 19.1-42.7 42.7-42.7s42.7 19.1 42.7 42.7v298.7c0 23.5-19.1 42.6-42.7 42.6z",1,"fill-gray-400"],[1,"mt-4","text-lg","animate-pulse","opacity-100"],["width","228px","height","228px","fill","#000000","viewBox","0 0 24 24","id","analysis-left","data-name","Line Color","xmlns","http://www.w3.org/2000/svg",1,"icon","line-color","magnifier-animation"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["id","secondary","d","M5.83,12.12,3,15M8,7a3,3,0,1,0,3,3A3,3,0,0,0,8,7Zm3,10h6m-2-4h2",1,"stroke-gray-300",2,"fill","none","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],["id","primary","d","M8,3H20a1,1,0,0,1,1,1V20a1,1,0,0,1-1,1H8a1,1,0,0,1-1-1V17",1,"stroke-gray-400",2,"fill","none","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"]],template:function(e,t){if(e&1){let o=x();r(0,"div",3),C(1,Po,9,11,"div",4),r(2,"div",5),C(3,ko,4,2,"div",6),r(4,"input",7,0),_("change",function(v){return u(o),g(t.uploadVideo(v))}),s(),r(6,"button",8),_("click",function(v){return u(o),g(t.toggleLanguageDropdown(v))}),p(7),V(),r(8,"svg",9),m(9,"path",10),s()(),C(10,Ao,8,5,"div",11),G(),m(11,"hr",12),r(12,"button",13),_("click",function(){return u(o),g(t.openVideosList())}),p(13),V(),r(14,"svg",9),m(15,"path",14),s()(),C(16,Mo,7,6,"div",11),s()(),C(17,Oo,4,2)}e&2&&(a(),f(t.video()||t.videoData()?1:-1),a(),d("ngClass",A(8,To,!t.video()&&!t.videoData())),a(),f(t.showSupportedLanguage()?3:-1),a(4),y(" ",t.lang.locals.upload_video," "),a(3),f(t.video()?10:-1),a(3),y(" ",t.lang.locals.choose_video_from_list," "),a(3),f(t.videoData()?16:-1),a(),f(t.isLoading()?17:-1))},dependencies:[ye,He,F,Qe,Xe,we],styles:["@keyframes _ngcontent-%COMP%_cloudMove{0%,to{transform:translateY(0)}50%{transform:translateY(-20px)}}@keyframes _ngcontent-%COMP%_arrowMove{0%{transform:translateY(10px);opacity:.5}50%{transform:translateY(-80px);opacity:1}to{transform:translateY(10px);opacity:.5}}.magnifier-animation[_ngcontent-%COMP%]   #secondary[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_magnifier-bounce 2s infinite;transform-origin:8px 7px}@keyframes _ngcontent-%COMP%_magnifier-bounce{0%,to{transform:scale(1)}50%{transform:scale(1.2)}}.cloud[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_cloudMove 2s infinite ease-in-out}.arrow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_arrowMove 1.5s infinite ease-in-out}.selected-video[_ngcontent-%COMP%]::cue{font-size:1rem;line-height:1.5rem}"],data:{animation:[si,ri]}})};export{Ci as VideoAnalyzerComponent};
