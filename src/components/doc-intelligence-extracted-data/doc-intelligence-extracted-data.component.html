<mat-accordion class="w-full mt-4">
  <!-- Loop through each section dynamically -->
  @for (section of mappedData() | keyvalue; track section.key) {
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title class="text-lg text-gray-800">
          {{ getLocalizedKey(section.key) }}
        </mat-panel-title>
      </mat-expansion-panel-header>

      <!-- ✅ Table Wrapper for Overflow Fix -->
      <div class="overflow-x-auto w-full">
        <table class="w-full border border-gray-300 rounded-lg shadow-md">
          <thead class="bg-primary text-white text-left">
            <tr>
              @for (column of asRecord(section.value) | keyvalue; track column.key) {
                <th class="px-4 py-2 border text-center">
                  {{ getLocalizedKey(column.key) }}
                </th>
              }
            </tr>
          </thead>
          <tbody>
            <tr>
              @for (column of asRecord(section.value) | keyvalue; track column.key) {
                <td class="px-4 py-2 border-b text-center">
                  <!-- ✅ If the value is a nested object, display it as a sub-table inside the cell -->
                  @if (isObject(column.value)) {
                    <div class="border p-2 bg-gray-100 rounded-md shadow-sm">
                      <table class="w-full border border-gray-200 rounded-lg">
                        <thead>
                          <tr class="bg-gray-300">
                            @for (subColumn of asRecord(column.value) | keyvalue; track subColumn.key) {
                              <th class="px-2 py-1 border text-center">
                                {{ getLocalizedKey(subColumn.key) }}
                              </th>
                            }
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            @for (subColumn of asRecord(column.value) | keyvalue; track subColumn.key) {
                              <td class="px-2 py-1 border text-center">
                                {{ subColumn.value || 'N/A' }}
                              </td>
                            }
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  } @else {
                    <span class="text-gray-700">{{ column.value || 'N/A' }}</span>
                  }
                </td>
              }
            </tr>
          </tbody>
        </table>
      </div>
    </mat-expansion-panel>
  }
</mat-accordion>
